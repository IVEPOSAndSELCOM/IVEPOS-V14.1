package com.intuition.ivepos.paytm;

import android.app.Dialog;
import android.app.ProgressDialog;
import android.bluetooth.BluetoothDevice;
import android.content.ComponentName;
import android.content.ContentValues;
import android.content.Context;
import android.content.Intent;
import android.content.ServiceConnection;
import android.content.SharedPreferences;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.graphics.Typeface;
import android.graphics.drawable.BitmapDrawable;
import android.graphics.drawable.Drawable;
import android.hardware.usb.UsbDevice;
import android.hardware.usb.UsbDeviceConnection;
import android.hardware.usb.UsbEndpoint;
import android.hardware.usb.UsbInterface;
import android.hardware.usb.UsbManager;
import android.net.ConnectivityManager;
import android.net.NetworkInfo;
import android.net.Uri;
import android.os.AsyncTask;
import android.os.Build;
import android.os.Bundle;
import android.os.Environment;
import android.os.IBinder;
import android.text.Editable;
import android.text.Html;
import android.text.TextWatcher;
import android.util.Log;
import android.util.TypedValue;
import android.view.Gravity;
import android.view.View;
import android.view.ViewGroup;
import android.view.WindowManager;
import android.view.inputmethod.InputMethodManager;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.EditText;
import android.widget.FilterQueryProvider;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.RelativeLayout;
import android.widget.SimpleCursorAdapter;
import android.widget.Spinner;
import android.widget.TableLayout;
import android.widget.TableRow;
import android.widget.TextView;
import android.widget.TimePicker;
import android.widget.Toast;

import com.epson.epos2.Epos2Exception;
import com.epson.epos2.printer.Printer;
import com.epson.epos2.printer.PrinterStatusInfo;
import com.epson.epos2.printer.ReceiveListener;
import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.GoogleApiAvailability;
import com.google.android.material.textfield.TextInputLayout;
import com.google.api.client.extensions.android.http.AndroidHttp;
import com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential;
import com.google.api.client.googleapis.extensions.android.gms.auth.GooglePlayServicesAvailabilityIOException;
import com.google.api.client.googleapis.extensions.android.gms.auth.UserRecoverableAuthIOException;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson2.JacksonFactory;
import com.google.api.client.repackaged.org.apache.commons.codec.binary.Base64;
import com.google.api.client.util.ExponentialBackOff;
import com.google.api.services.gmail.Gmail;
import com.google.api.services.gmail.GmailScopes;
import com.google.api.services.gmail.model.Label;
import com.google.api.services.gmail.model.ListLabelsResponse;
import com.intuition.ivepos.A4.A4_Printer_new;
import com.intuition.ivepos.BluetoothPrintDriver;
import com.intuition.ivepos.Cash_Card_Credit_Sales;
import com.intuition.ivepos.Cash_Card_Credit_Sales1;
import com.intuition.ivepos.EmailSetup;
import com.intuition.ivepos.EmailSetup_Google;
import com.intuition.ivepos.EmailSetup_Recipients;
import com.intuition.ivepos.Global;
import com.intuition.ivepos.Global1;
import com.intuition.ivepos.R;
import com.intuition.ivepos.SendMailTask_Hotmail_Outlook_attachment_GenOrderlist;
import com.intuition.ivepos.SendMailTask_Hotmail_Outlook_attachment_GenOrderlist1;
import com.intuition.ivepos.SendMailTask_Hotmail_Outlook_homebill;
import com.intuition.ivepos.SendMailTask_Office365_attachment_GenOrderlist;
import com.intuition.ivepos.SendMailTask_Office365_attachment_GenOrderlist1;
import com.intuition.ivepos.SendMailTask_Office365_homebill;
import com.intuition.ivepos.SendMailTask_Yahoo_attachment_GenOrderlist;
import com.intuition.ivepos.SendMailTask_Yahoo_attachment_GenOrderlist1;
import com.intuition.ivepos.SendMailTask_Yahoo_homebill;
import com.intuition.ivepos.ShowMsg;
import com.intuition.ivepos.SplashScreenActivity_Selection;
import com.intuition.ivepos.SpnModelsItem;
import com.intuition.ivepos.Utils;
import com.intuition.ivepos.WifiPrintDriver;
import com.intuition.ivepos.WifiPrintDriver2;
import com.intuition.ivepos.mSwipe.ApplicationData;
import com.intuition.ivepos.mSwipe.Logs;
import com.intuition.ivepos.wisepos.ReceiptBitmap;
import com.mswipetech.wisepad.sdk.Print;
import com.mswipetech.wisepad.sdk.device.MSWisepadDeviceController;
import com.mswipetech.wisepad.sdk.device.MSWisepadDeviceControllerResponseListener;
import com.mswipetech.wisepad.sdk.device.WisePadConnection;
import com.socsi.smartposapi.printer.Align;
import com.socsi.smartposapi.printer.FontLattice;
import com.socsi.smartposapi.printer.TextEntity;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.FileOutputStream;
import java.io.FileWriter;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Date;
import java.util.Formatter;
import java.util.HashMap;
import java.util.Hashtable;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.activation.FileDataSource;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.Session;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;

import androidx.annotation.Nullable;
import androidx.annotation.RequiresApi;
import androidx.appcompat.app.AppCompatActivity;
import au.com.bytecode.opencsv.CSVWriter;
import pub.devrel.easypermissions.AfterPermissionGranted;
import pub.devrel.easypermissions.EasyPermissions;

import static com.intuition.ivepos.BluetoothPrintDriver.BT_Write;

/**
 * Created by Rohithkumar on 7/10/2017.
 */

public class Cash_Card_Credit_Sales2 extends AppCompatActivity implements ReceiveListener {


    public SQLiteDatabase db = null;
    public SQLiteDatabase db1 = null;
    String billno, date, time, user, date11, date111;
    ListView listView, listView1, listviewdis, listView2;
    LinearLayout saleslist, cardlist, creditlist;
    SimpleCursorAdapter adapter, dataAdapterr;

    float dsirsq1, dsirsq2, dsirsq3, dsirsq4;
    String dis_val, dis_status, dis_ty;
    String ropq;

    String Itemtype, itemtotal, id5, total1quan;

    String strpaymentmethod, strbilltype, max, iittnn, iittnnquan, iittnntable, iittnnindprice, iittnnindtotalprice, bill_coun, iittnninddate, cardnum;

    int level;
    String total, total1, discount;

    Cursor cursor1;
    Spinner getlisting;

    EditText editText1_filter, editText2_filter;


    String billnumb, datee, timee;
    String ipnamegets, portgets, statusnets, addgets, namegets, statussusbs;
    String ipnamegets_counter, portgets_counter, statusnets_counter;


    String ipnameget, portget, statusnet, nameget, addget, statussusb;
    String ipnameget_counter, portget_counter, statusnet_counter;
    String assa, assa1, assa2;

    TextView tv8, disc_tv;
    float ss;
    String ss1;

    File file=null, file1=null;
    SimpleDateFormat sdff2, sdff1;
    String currentDateandTimee1;
    String timee1;
    private View mView;
    String sub, compna, companynameis;
    ImageView imageViewPicture;
    byte[] img;


    private int hour;
    private int minute;

    byte[][] allbuf, allbuf1, allbuf2, allbuf3, allbuf4, allbuf5, allbuf6, allbuf7, allbuf8, allbuf9, allbuf10, allbuf11, allbufqty, allbufitems, allbufmodifiers, allbufsubtot,
            allbuftax, allbufdisc, allbufrounded, allbuffulltot, allbuf12, allbuf13, allbuf14,allbufbillno,allbuftime,allbufline1,allbufline,allbufcust,allbufcustname,
            allbufcustadd,allbufcustph,allbufcustemail, allbuftaxestype2, allbuftaxestype1, allbuf1122, allbufKOT;
    String strcompanyname, straddress1, straddress2, straddress3, strphone, stremailid, strwebsite, strtaxone, strbillone;

    byte[] setHT32, setHT321, setHT33, setHT34, setHT3212, setHT32122, setHTKOT, feedcut2;
    int nPaperWidth;
    int charlength, charlength1, charlength2, quanlentha;
    String NAME, tableidaa, tableida;
    String paymmethodaa, paymmethoda, billtypeaa, billtypea;
    TextView tvkot;
    EditText search;

    String total_disc_print_q;
    String taxpe, dsirs, subro, alltotal1;

    TextView totalsales, totalsales_r, noofbills, avgsales, avgsales_r;

    String response;
    GoogleAccountCredential mCredential;
    ProgressDialog mProgress;

    static final int REQUEST_ACCOUNT_PICKER = 1000;
    static final int REQUEST_AUTHORIZATION = 1001;
    static final int REQUEST_GOOGLE_PLAY_SERVICES = 1002;
    static final int REQUEST_PERMISSION_GET_ACCOUNTS = 1003;

    private static final String BUTTON_TEXT = "Call Gmail API";
    private static final String PREF_ACCOUNT_NAME = "accountName";
    private static final String[] SCOPES = { GmailScopes.GMAIL_SEND };


    EditText email_id_send;
    String emailPattern = "[a-zA-Z0-9._-]+@[a-z]+\\.+[a-z]+";

    TextView editText1, editText2, editText11, editText22;
    TextView editText_from_day_hide, editText_from_day_visible, editText_to_day_hide, editText_to_day_visible;
    private int year, year1;
    private int month, month1;
    private int day, day1;

    String onee, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve;
    String onee1, two1, three1, four1, five1, six1, seven1, eight1, nine1, ten1, eleven1, twelve1;

    int clickcount=1, clickcounts = 1;

    List toEmailList;
    int dineinsales, takeawaysales, homedeliverysales, refunded;
    String dineinsalesstr, takeawaysalesstr, homedeliverysalesstr, refundedstr, rupper1;
    String total11, total111, total111card, totalbillis;
    String oone1, ppone, mmax, ppercen;

    String str_print_ty;

    private Context mContext = null;

    private Printer mPrinter = null;
    int barcodeWidth, barcodeHeight, pageAreaHeight, pageAreaWidth;

    private EditText mEditTarget = null;
    private Spinner mSpnSeries = null;
    private Spinner mSpnLang = null;
    Bitmap logoData, yourBitmap;

    private WifiPrintDriver wifiSocket = null;
    private WifiPrintDriver2 wifiSocket2 = null;

    TextView mTextView1, mTextView2;

    String insert1_cc = "", insert1_rs = "", str_country;
    String u_name;
    String account_selection;

    public MSWisepadDeviceController mMSWisepadDeviceController = null;
    private ArrayList<byte[]> mPrintData;

    boolean mswipe_text = true;

    byte[] testBytes;
    byte[] command;
    private UsbManager mUsbManager;
    private UsbDevice mDevice;
    private UsbDeviceConnection mConnection;
    private UsbInterface mInterface;
    private UsbEndpoint mEndPoint;
    private static Boolean forceCLaim = true;
    HashMap<String, UsbDevice> mDeviceList;
    Iterator<UsbDevice> mDeviceIterator;

    Formatter fmt;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.cash_card_credit_saleslist2);

        SharedPreferences sharedpreferences_select =  SplashScreenActivity_Selection.getDefaultSharedPreferencesMultiProcess(Cash_Card_Credit_Sales2.this);
        account_selection= sharedpreferences_select.getString("account_selection", null);

        mContext = this;

        mSpnSeries = (Spinner) findViewById(R.id.spnModel);
        ArrayAdapter<SpnModelsItem> seriesAdapter = new ArrayAdapter<SpnModelsItem>(Cash_Card_Credit_Sales2.this, android.R.layout.simple_spinner_item);
        seriesAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        seriesAdapter.add(new SpnModelsItem(getString(R.string.printerseries_t82), Printer.TM_T82));
        mSpnSeries.setAdapter(seriesAdapter);
        mSpnSeries.setSelection(0);

        mSpnLang = (Spinner) findViewById(R.id.spnLang);
        ArrayAdapter<SpnModelsItem> langAdapter = new ArrayAdapter<SpnModelsItem>(Cash_Card_Credit_Sales2.this, android.R.layout.simple_spinner_item);
        langAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        langAdapter.add(new SpnModelsItem(getString(R.string.lang_ank), Printer.MODEL_ANK));
        mSpnLang.setAdapter(langAdapter);
        mSpnLang.setSelection(0);


//        try {
//            com.epson.epos2.Log.setLogSettings(mContext, com.epson.epos2.Log.PERIOD_TEMPORARY, com.epson.epos2.Log.OUTPUT_STORAGE, null, 0, 1, com.epson.epos2.Log.LOGLEVEL_LOW);
//        } catch (Exception e) {
////            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here8", Toast.LENGTH_SHORT).show();
//            ShowMsg.showException(e, "setLogSettings", mContext);
//        }
        mEditTarget = (EditText) findViewById(R.id.edtTarget);

        editText1_filter = new EditText(Cash_Card_Credit_Sales2.this);
        editText2_filter = new EditText(Cash_Card_Credit_Sales2.this);

        editText1 = (TextView) findViewById(R.id.editText1);
//        editText1.setText(currentDateandTime1);
        editText2 = (TextView) findViewById(R.id.editText2);
//        editText2.setText(currentDateandTime1);

        editText11 = (TextView) findViewById(R.id.editText11);
//        editText11.setText(currentDateandTime2);


        editText22 = (TextView) findViewById(R.id.editText22);
//        editText22.setText(currentDateandTime2);


        editText_from_day_hide = (TextView) findViewById(R.id.editText_from_day_hide);
        editText_from_day_visible = (TextView) findViewById(R.id.editText_from_day_visible);


        editText_to_day_hide = (TextView) findViewById(R.id.editText_to_day_hide);
        editText_to_day_visible = (TextView) findViewById(R.id.editText_to_day_visible);


        editText11.setOnClickListener(new View.OnClickListener() {

            @Override
            public void onClick(View v) {

                Calendar now = Calendar.getInstance();
                com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
                        datePickerListener,now.get(Calendar.YEAR), now.get(Calendar.MONTH), now.get(Calendar.DAY_OF_MONTH)
                );

                dpd.show(Cash_Card_Credit_Sales2.this.getFragmentManager(), "Datepickerdialog");




            }

            com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener datePickerListener
                    = new com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener() {

                @Override
                public void onDateSet(com.wdullaer.materialdatetimepicker.date.DatePickerDialog datePickerDialog, int selectedYear1, int selectedMonth1, int selectedDay1) {
                    year1 = selectedYear1;
                    month1 = selectedMonth1;
                    day1 = selectedDay1;

                    // set selected date into textview
                    populateSetDate(year1, month1 + 1, day1);
                }
            };





            public void populateSetDate(int year, int month, int day) {
                TextView mEdit = (TextView) findViewById(R.id.editText1);
                TextView mEdit1  = (TextView) findViewById(R.id.editText11);
                if (month == 1 && day < 10) {
                    mEdit.setText(year + " " + "0" + 1 + " " + "0" + day);
                    onee1 = "0" + day + " " + "Jan" + " " + year;
                    mEdit1.setText(onee1);
                } else {
                    if (month == 1) {
                        mEdit.setText(year + " " + "0" + 1 + " " + day);
                        onee = day + " " + "Jan" + " " + year;
                        mEdit1.setText(onee);
                    }
                }

                if (month == 2 && day < 10) {
                    mEdit.setText(year + " " + "0" + 2 + " " + "0" + day);
                    two1 = "0" + day + " " + "Feb" + " " + year;
                    mEdit1.setText(two1);
                } else {
                    if (month == 2) {
                        mEdit.setText(year + " " + "0" + 2 + " " + day);
                        two = day + " " + "Feb" + " " + year;
                        mEdit1.setText(two);
                    }
                }

                if (month == 3 && day < 10) {
                    mEdit.setText(year + " " + "0" + 3 + " " + "0" + day);
                    three1 = "0" + day + " " + "Mar" + " " + year;
                    mEdit1.setText(three1);
                } else {
                    if (month == 3) {
                        mEdit.setText(year + " " + "0" + 3 + " " + day);
                        three = day + " " + "Mar" + " " + year;
                        mEdit1.setText(three);
                    }
                }

                if (month == 4 && day < 10) {
                    mEdit.setText(year + " " + "0" + 4 + " " + "0" + day);
                    four1 = "0" + day + " " + "Apr" + " " + year;
                    mEdit1.setText(four1);
                } else {
                    if (month == 4) {
                        mEdit.setText(year + " " + "0" + 4 + " " + day);
                        four = day + " " + "Apr" + " " + year;
                        mEdit1.setText(four);
                    }
                }

                if (month == 5 && day < 10) {
                    mEdit.setText(year + " " + "0" + 5 + " " + "0" + day);
                    five1 = "0" + day + " " + "May" + " " + year;
                    mEdit1.setText(five1);
                } else {
                    if (month == 5) {
                        mEdit.setText(year + " " + "0" + 5 + " " + day);
                        five = day + " " + "May" + " " + year;
                        mEdit1.setText(five);
                    }
                }

                if (month == 6 && day < 10) {
                    mEdit.setText(year + " " + "0" + 6 + " " + "0" + day);
                    six1 = "0" + day + " " + "Jun" + " " + year;
                    mEdit1.setText(six1);
                } else {
                    if (month == 6) {
                        mEdit.setText(year + " " + "0" + 6 + " " + day);
                        six = day + " " + "Jun" + " " + year;
                        mEdit1.setText(six);
                    }
                }

                if (month == 7 && day < 10) {
                    mEdit.setText(year + " " + "0" + 7 + " " + "0" + day);
                    seven1 = "0" + day + " " + "Jul" + " " + year;
                    mEdit1.setText(seven1);
                } else {
                    if (month == 7) {
                        mEdit.setText(year + " " + "0" + 7 + " " + day);
                        seven = day + " " + "Jul" + " " + year;
                        mEdit1.setText(seven);
                    }
                }

                if (month == 8 && day < 10) {
                    mEdit.setText(year + " " + "0" + 8 + " " + "0" + day);
                    eight1 = "0" + day + " " + "Aug" + " " + year;
                    mEdit1.setText(eight1);
                } else {
                    if (month == 8) {
                        mEdit.setText(year + " " + "0" + 8 + " " + day);
                        eight = day + " " + "Aug" + " " + year;
                        mEdit1.setText(eight);
                    }
                }

                if (month == 9 && day < 10) {
                    mEdit.setText(year + " " + "0" + 9 + " " + "0" + day);
                    nine1 = "0" + day + " " + "Sep" + " " + year;
                    mEdit1.setText(nine1);
                } else {
                    if (month == 9) {
                        mEdit.setText(year + " " + "0" + 9 + " " + day);
                        nine = day + " " + "Sep" + " " + year;
                        mEdit1.setText(nine);
                    }
                }

                if (month == 10 && day < 10) {
                    mEdit.setText(year + " " + 10 + " " + "0" + day);
                    ten1 = "0" + day + " " + "Oct" + " " + year;
                    mEdit1.setText(ten1);
                } else {
                    if (month == 10) {
                        mEdit.setText(year + " " + 10 + " " + day);
                        ten = day + " " + "Oct" + " " + year;
                        mEdit1.setText(ten);
                    }
                }

                if (month == 11 && day < 10) {
                    mEdit.setText(year + " " + 11 + " " + "0" + day);
                    eleven1 = "0" + day + " " + "Nov" + " " + year;
                    mEdit1.setText(eleven1);
                } else {
                    if (month == 11) {
                        mEdit.setText(year + " " + 11 + " " + day);
                        eleven = day + " " + "Nov" + " " + year;
                        mEdit1.setText(eleven);
                    }
                }

                if (month == 12 && day < 10) {
                    mEdit.setText(year + " " + 12 + " " + "0" + day);
                    twelve1 = "0" + day + " " + "Dec" + " " + year;
                    mEdit1.setText(twelve1);
                } else {
                    if (month == 12) {
                        mEdit.setText(year + " " + 12 + " " + day);
                        twelve = day + " " + "Dec" + " " + year;
                        mEdit1.setText(twelve);
                    }
                }

            }

        });


        editText22.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
//                Calendar now = Calendar.getInstance();
//                com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
//                        datePickerListener,
//                        now.get(Calendar.YEAR),
//                        now.get(Calendar.MONTH),
//                        now.get(Calendar.DAY_OF_MONTH)
//
//
//                );
//
//                dpd.show(getActivity().getFragmentManager(), "Datepickerdialog");
                //if (clickcount == 1){
                Calendar now = Calendar.getInstance();
                com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
                        datePickerListener,now.get(Calendar.YEAR), now.get(Calendar.MONTH), now.get(Calendar.DAY_OF_MONTH)
                );

                dpd.show(Cash_Card_Credit_Sales2.this.getFragmentManager(), "Datepickerdialog");
                clickcount++;
//                }else {
//                    Calendar now = Calendar.getInstance();
//                    com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
//                            datePickerListener, year, month, day
//                    );
//
//                    dpd.show(getActivity().getFragmentManager(), "Datepickerdialog");
//                }

            }

            com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener datePickerListener
                    = new com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener() {

                @Override
                public void onDateSet(com.wdullaer.materialdatetimepicker.date.DatePickerDialog datePickerDialog, int selectedYear, int selectedMonth, int selectedDay) {
                    year = selectedYear;
                    month = selectedMonth;
                    day = selectedDay;

                    // set selected date into textview
                    populateSetDate(year, month + 1, day);
                }
            };

//                // when dialog box is closed, below method will be called.
//                public void onDateSet(DatePicker view, int selectedYear,
//                                      int selectedMonth, int selectedDay) {
//
//
//
//
//                }
//            };


            public void populateSetDate(int year, int month, int day) {
                TextView mEdit = (TextView) findViewById(R.id.editText2);
                TextView mEdit1  = (TextView) findViewById(R.id.editText22);
                if (month == 1 && day < 10) {
                    mEdit.setText(year + " " + "0" + 1 + " " + "0" + day);
                    onee1 = "0" + day + " " + "Jan" + " " + year;
                    mEdit1.setText(onee1);
                } else {
                    if (month == 1) {
                        mEdit.setText(year + " " + "0" + 1 + " " + day);
                        onee = day + " " + "Jan" + " " + year;
                        mEdit1.setText(onee);
                    }
                }

                if (month == 2 && day < 10) {
                    mEdit.setText(year + " " + "0" + 2 + " " + "0" + day);
                    two1 = "0" + day + " " + "Feb" + " " + year;
                    mEdit1.setText(two1);
                } else {
                    if (month == 2) {
                        mEdit.setText(year + " " + "0" + 2 + " " + day);
                        two = day + " " + "Feb" + " " + year;
                        mEdit1.setText(two);
                    }
                }

                if (month == 3 && day < 10) {
                    mEdit.setText(year + " " + "0" + 3 + " " + "0" + day);
                    three1 = "0" + day + " " + "Mar" + " " + year;
                    mEdit1.setText(three1);
                } else {
                    if (month == 3) {
                        mEdit.setText(year + " " + "0" + 3 + " " + day);
                        three = day + " " + "Mar" + " " + year;
                        mEdit1.setText(three);
                    }
                }

                if (month == 4 && day < 10) {
                    mEdit.setText(year + " " + "0" + 4 + " " + "0" + day);
                    four1 = "0" + day + " " + "Apr" + " " + year;
                    mEdit1.setText(four1);
                } else {
                    if (month == 4) {
                        mEdit.setText(year + " " + "0" + 4 + " " + day);
                        four = day + " " + "Apr" + " " + year;
                        mEdit1.setText(four);
                    }
                }

                if (month == 5 && day < 10) {
                    mEdit.setText(year + " " + "0" + 5 + " " + "0" + day);
                    five1 = "0" + day + " " + "May" + " " + year;
                    mEdit1.setText(five1);
                } else {
                    if (month == 5) {
                        mEdit.setText(year + " " + "0" + 5 + " " + day);
                        five = day + " " + "May" + " " + year;
                        mEdit1.setText(five);
                    }
                }

                if (month == 6 && day < 10) {
                    mEdit.setText(year + " " + "0" + 6 + " " + "0" + day);
                    six1 = "0" + day + " " + "Jun" + " " + year;
                    mEdit1.setText(six1);
                } else {
                    if (month == 6) {
                        mEdit.setText(year + " " + "0" + 6 + " " + day);
                        six = day + " " + "Jun" + " " + year;
                        mEdit1.setText(six);
                    }
                }

                if (month == 7 && day < 10) {
                    mEdit.setText(year + " " + "0" + 7 + " " + "0" + day);
                    seven1 = "0" + day + " " + "Jul" + " " + year;
                    mEdit1.setText(seven1);
                } else {
                    if (month == 7) {
                        mEdit.setText(year + " " + "0" + 7 + " " + day);
                        seven = day + " " + "Jul" + " " + year;
                        mEdit1.setText(seven);
                    }
                }

                if (month == 8 && day < 10) {
                    mEdit.setText(year + " " + "0" + 8 + " " + "0" + day);
                    eight1 = "0" + day + " " + "Aug" + " " + year;
                    mEdit1.setText(eight1);
                } else {
                    if (month == 8) {
                        mEdit.setText(year + " " + "0" + 8 + " " + day);
                        eight = day + " " + "Aug" + " " + year;
                        mEdit1.setText(eight);
                    }
                }

                if (month == 9 && day < 10) {
                    mEdit.setText(year + " " + "0" + 9 + " " + "0" + day);
                    nine1 = "0" + day + " " + "Sep" + " " + year;
                    mEdit1.setText(nine1);
                } else {
                    if (month == 9) {
                        mEdit.setText(year + " " + "0" + 9 + " " + day);
                        nine = day + " " + "Sep" + " " + year;
                        mEdit1.setText(nine);
                    }
                }

                if (month == 10 && day < 10) {
                    mEdit.setText(year + " " + 10 + " " + "0" + day);
                    ten1 = "0" + day + " " + "Oct" + " " + year;
                    mEdit1.setText(ten1);
                } else {
                    if (month == 10) {
                        mEdit.setText(year + " " + 10 + " " + day);
                        ten = day + " " + "Oct" + " " + year;
                        mEdit1.setText(ten);
                    }
                }

                if (month == 11 && day < 10) {
                    mEdit.setText(year + " " + 11 + " " + "0" + day);
                    eleven1 = "0" + day + " " + "Nov" + " " + year;
                    mEdit1.setText(eleven1);
                } else {
                    if (month == 11) {
                        mEdit.setText(year + " " + 11 + " " + day);
                        eleven = day + " " + "Nov" + " " + year;
                        mEdit1.setText(eleven);
                    }
                }

                if (month == 12 && day < 10) {
                    mEdit.setText(year + " " + 12 + " " + "0" + day);
                    twelve1 = "0" + day + " " + "Dec" + " " + year;
                    mEdit1.setText(twelve1);
                } else {
                    if (month == 12) {
                        mEdit.setText(year + " " + 12 + " " + day);
                        twelve = day + " " + "Dec" + " " + year;
                        mEdit1.setText(twelve);
                    }
                }

            }

//            class SelectDateFragment extends DialogFragment implements DatePickerDialog.OnDateSetListener {
//                @Override
//                public Dialog onCreateDialog(Bundle savedInstanceState) {
//                    final Calendar calendar = Calendar.getInstance();
//                    int yy = calendar.get(Calendar.YEAR);
//                    int mm = calendar.get(Calendar.MONTH);
//                    int dd = calendar.get(Calendar.DAY_OF_MONTH);
//                    return new DatePickerDialog(getActivity(), this, yy, mm, dd);
//                }
//
//
//                @Override
//                public void onDateSet(DatePicker view, int yy, int mm, int dd) {
//                    populateSetDate(yy, mm + 1, dd);
//                }
//            }

        });

        editText_from_day_visible.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                android.app.TimePickerDialog timePickerDialog = new android.app.TimePickerDialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog, timePickerListener_open, hour, minute,
                        false);

                timePickerDialog.show();
            }
        });

        editText_to_day_visible.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                android.app.TimePickerDialog timePickerDialog = new android.app.TimePickerDialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog, timePickerListener_close, hour, minute,
                        false);

                timePickerDialog.show();
            }
        });

        listView = (ListView) findViewById(R.id.listView11);

        search = (EditText) findViewById(R.id.searchView);

        saleslist = (LinearLayout) findViewById(R.id.sales_list);
        cardlist = (LinearLayout) findViewById(R.id.sales_list_card);
        creditlist = (LinearLayout) findViewById(R.id.sales_list_credit);

        InputMethodManager imm = (InputMethodManager) getSystemService(INPUT_METHOD_SERVICE);
        imm.hideSoftInputFromWindow(search.getWindowToken(), 0);

        getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_HIDDEN);

        ImageView deleteicon = (ImageView) findViewById(R.id.delete_icon);
        deleteicon.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                search.setText("");
            }
        });

        LinearLayout back_activity = (LinearLayout) findViewById(R.id.back_activity);
        back_activity.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                finish();
            }
        });

        db = openOrCreateDatabase("mydb_Salesdata", Context.MODE_PRIVATE, null);
        db1 = openOrCreateDatabase("mydb_Appdata", Context.MODE_PRIVATE, null);

        Cursor cursor_country = db1.rawQuery("SELECT * FROM Country_Selection", null);
        if (cursor_country.moveToFirst()){
            str_country = cursor_country.getString(1);
        }

        if (str_country.toString().equals("Rupee") || str_country.toString().equals("India")) {
            insert1_cc = "\u20B9";
            insert1_rs = "Rs.";
        }else {
            if (str_country.toString().equals("Pound") || str_country.toString().equals("UK Pound")) {
                insert1_cc = "\u00a3";
                insert1_rs = "BP.";
            }else {
                if (str_country.toString().equals("Euro") || str_country.toString().equals("UK Euro")) {
                    insert1_cc = "\u20ac";
                    insert1_rs = "EU.";
                }else {
                    if (str_country.toString().equals("Dollar")) {
                        insert1_cc = "\u0024";
                        insert1_rs = "\u0024";
                    }else {
                        if (str_country.toString().equals("Dinar")) {
                            insert1_cc = "D";
                            insert1_rs = "KD.";
                        }else {
                            if (str_country.toString().equals("Shilling")) {
                                insert1_cc = "S";
                                insert1_rs = "S.";
                            }else {
                                if (str_country.toString().equals("Ringitt")) {
                                    insert1_cc = "R";
                                    insert1_rs = "RM.";
                                }else {
                                    if (str_country.toString().equals("Rial")) {
                                        insert1_cc = "R";
                                        insert1_rs = "OR.";
                                    }else {
                                        if (str_country.toString().equals("Yen")) {
                                            insert1_cc = "\u00a5";
                                            insert1_rs = "\u00a5";
                                        }else {
                                            if (str_country.toString().equals("Papua New Guinean")) {
                                                insert1_cc = "K";
                                                insert1_rs = "K.";
                                            }else {
                                                if (str_country.toString().equals("UAE")) {
                                                    insert1_cc = "D";
                                                    insert1_rs = "DH.";
                                                }else {
                                                    if (str_country.toString().equals("South African Rand")) {
                                                        insert1_cc = "R";
                                                        insert1_rs = "R.";
                                                    }else {
                                                        if (str_country.toString().equals("Congolese Franc")) {
                                                            insert1_cc = "F";
                                                            insert1_rs = "FC.";
                                                        }else {
                                                            if (str_country.toString().equals("Qatari Riyals")) {
                                                                insert1_cc = "QAR";
                                                                insert1_rs = "QAR.";
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        Cursor ccornn = db1.rawQuery("SELECT * FROM BTConn", null);
        if (ccornn.moveToFirst()) {
            nameget = ccornn.getString(1);
            addget = ccornn.getString(2);
            statussusb = ccornn.getString(3);
            mEditTarget.setText(addget);
        }

        getlisting = (Spinner) findViewById(R.id.chocolate_category);

        tvkot = new TextView(Cash_Card_Credit_Sales2.this);
        totalsales_r = new TextView(Cash_Card_Credit_Sales2.this);
        avgsales_r = new TextView(Cash_Card_Credit_Sales2.this);
        final Calendar c = Calendar.getInstance();
        // Current Hour
        hour = c.get(Calendar.HOUR_OF_DAY);
        // Current Minute
        minute = c.get(Calendar.MINUTE);

        mCredential = GoogleAccountCredential.usingOAuth2(
                Cash_Card_Credit_Sales2.this.getApplicationContext(), Arrays.asList(SCOPES))
                .setBackOff(new ExponentialBackOff());

        mProgress = new ProgressDialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);
        mProgress.setMessage(getString(R.string.setmessage14));

        Bundle extras = getIntent().getExtras();
        String player1name = extras.getString("PLAYER1NAME");
        String player2name = extras.getString("PLAYER2NAME");
        String player3name = extras.getString("PLAYER3NAME");
        String str_edittext1 = extras.getString("edittext1");
        String str_edittext11 = extras.getString("edittext11");
        String str_edittext2 = extras.getString("edittext2");
        String str_edittext22 = extras.getString("edittext22");
        String str_edittext_from_day_visible = extras.getString("edittext_from_day_visible");
        String str_edittext_from_day_hide = extras.getString("edittext_from_day_hide");
        String str_edittext_to_day_visible = extras.getString("edittext_to_day_visible");
        String str_edittext_to_day_hide = extras.getString("edittext_to_day_hide");

        editText1_filter.setText(player1name);
        editText2_filter.setText(player2name);

        editText1.setText(str_edittext1);
        editText11.setText(str_edittext11);
        editText2.setText(str_edittext2);
        editText22.setText(str_edittext22);
        editText_from_day_visible.setText(str_edittext_from_day_visible);
        editText_from_day_hide.setText(str_edittext_from_day_hide);
        editText_to_day_visible.setText(str_edittext_to_day_visible);
        editText_to_day_hide.setText(str_edittext_to_day_hide);

        if (player3name.toString().equals("UPI QR")) {
            getlisting.setSelection(0);
        }

//        Toast.makeText(Cash_Card_Credit_Sales2.this, "1 "+editText1_filter.getText().toString(), Toast.LENGTH_SHORT).show();
//        Toast.makeText(Cash_Card_Credit_Sales2.this, "2 "+editText1_filter.getText().toString(), Toast.LENGTH_SHORT).show();

        DownloadMusicfromInternet downloadMusicfromInternet = new DownloadMusicfromInternet();
        downloadMusicfromInternet.execute(editText1_filter.getText().toString() + editText2_filter.getText().toString());

        final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
        if (cursor_country1.moveToFirst()){
            str_country = cursor_country1.getString(1);
        }

        final String Text = getlisting.getSelectedItem().toString();

        //dialog.dismiss();
        if (Text.equals("All")) {
            cardlist.setVisibility(View.INVISIBLE);
            saleslist.setVisibility(View.VISIBLE);
            creditlist.setVisibility(View.INVISIBLE);
//            final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 GROUP By billno ORDER BY datetimee DESC";
            final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";
            Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
            // The desired columns to be bound
            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "sales"};
            // the XML defined views which the data will be bound to
            //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
            //Log.e("Checamos que hay id", String.valueOf(R.id.name));
            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//            listView.setAdapter(adapter);
            adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                @Override
                public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                    if (view.getId() == R.id.inn) {
                        final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                        TextView dateTextView = (TextView) view;
                        if (tadl_id.toString().equals("India")){
                            dateTextView.setText(insert1_cc);
                        }else {
                            dateTextView.setText(insert1_cc);
                        }
                        return true;
                    }
                    return false;
                }
            });
            listView.setAdapter(adapter);

            adapter.setFilterQueryProvider(new FilterQueryProvider() {
                public Cursor runQuery(CharSequence constraint) {
                    return fetchCountriesByName(constraint.toString());
                }
            });
        }else {
            if (Text.equals("UPI QR")) {
                cardlist.setVisibility(View.INVISIBLE);
                saleslist.setVisibility(View.VISIBLE);
                creditlist.setVisibility(View.INVISIBLE);
                final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' GROUP By billno ORDER BY datetimee DESC";

                Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                // The desired columns to be bound
                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                listView.setAdapter(adapter);
                adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                    @Override
                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                        if (view.getId() == R.id.inn) {
                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                            TextView dateTextView = (TextView) view;
                            if (tadl_id.toString().equals("India")){
                                dateTextView.setText(insert1_cc);
                            }else {
                                dateTextView.setText(insert1_cc);
                            }
                            return true;
                        }
                        return false;
                    }
                });
                listView.setAdapter(adapter);

                adapter.setFilterQueryProvider(new FilterQueryProvider() {
                    public Cursor runQuery(CharSequence constraint) {
                        return fetchCountriesByName_cash(constraint.toString());
                    }
                });
            }else {
                if (Text.equals("Mobikwik")) {
                    cardlist.setVisibility(View.INVISIBLE);
                    saleslist.setVisibility(View.VISIBLE);
                    creditlist.setVisibility(View.INVISIBLE);
//                    cardlist.setVisibility(View.VISIBLE);
//                    saleslist.setVisibility(View.INVISIBLE);
//                    creditlist.setVisibility(View.INVISIBLE);
//                            listView1 = (ListView) findViewById(R.id.listView12);

                    final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Mobikwik' GROUP By billno ORDER BY datetimee DESC";

                    Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
//                    // The desired columns to be bound
                    final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                    final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                    adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                    listView.setAdapter(adapter);
                    adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                        @Override
                        public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                            if (view.getId() == R.id.inn) {
                                final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                TextView dateTextView = (TextView) view;
                                if (tadl_id.toString().equals("India")){
                                    dateTextView.setText(insert1_cc);
                                }else {
                                    dateTextView.setText(insert1_cc);
                                }
                                return true;
                            }
                            return false;
                        }
                    });
                    listView.setAdapter(adapter);

//                    final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                    // the XML defined views which the data will be bound to
//                    //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                    final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                    //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                    adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                    listView.setAdapter(adapter);

                    adapter.setFilterQueryProvider(new FilterQueryProvider() {
                        public Cursor runQuery(CharSequence constraint) {
                            return fetchCountriesByName_card(constraint.toString());
                        }
                    });
                }else {
                    if (Text.equals("Freecharge")) {
                        cardlist.setVisibility(View.INVISIBLE);
                        saleslist.setVisibility(View.VISIBLE);
                        creditlist.setVisibility(View.INVISIBLE);

                        final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                        Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                        // The desired columns to be bound
                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);
                        adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                            @Override
                            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                if (view.getId() == R.id.inn) {
                                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                    TextView dateTextView = (TextView) view;
                                    if (tadl_id.toString().equals("India")){
                                        dateTextView.setText(insert1_cc);
                                    }else {
                                        dateTextView.setText(insert1_cc);
                                    }
                                    return true;
                                }
                                return false;
                            }
                        });
                        listView.setAdapter(adapter);
//                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                        // the XML defined views which the data will be bound to
//                        //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                        //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);

                        adapter.setFilterQueryProvider(new FilterQueryProvider() {
                            public Cursor runQuery(CharSequence constraint) {
                                return fetchCountriesByName_free(constraint.toString());
                            }
                        });
                    } else {
                        cardlist.setVisibility(View.INVISIBLE);
                        saleslist.setVisibility(View.VISIBLE);
                        creditlist.setVisibility(View.INVISIBLE);

                        final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                        Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                        // The desired columns to be bound
                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);
                        adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                            @Override
                            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                if (view.getId() == R.id.inn) {
                                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                    TextView dateTextView = (TextView) view;
                                    if (tadl_id.toString().equals("India")){
                                        dateTextView.setText(insert1_cc);
                                    }else {
                                        dateTextView.setText(insert1_cc);
                                    }
                                    return true;
                                }
                                return false;
                            }
                        });
                        listView.setAdapter(adapter);

//                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                        // the XML defined views which the data will be bound to
//                        //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                        //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);

                        adapter.setFilterQueryProvider(new FilterQueryProvider() {
                            public Cursor runQuery(CharSequence constraint) {
                                return fetchCountriesByName_free(constraint.toString());
                            }
                        });
//                        cardlist.setVisibility(View.INVISIBLE);
//                        saleslist.setVisibility(View.VISIBLE);
//                        creditlist.setVisibility(View.INVISIBLE);
////                        cardlist.setVisibility(View.INVISIBLE);
////                        saleslist.setVisibility(View.INVISIBLE);
////                        creditlist.setVisibility(View.VISIBLE);
////                            listView1 = (ListView) findViewById(R.id.listView12);
//
//                        final String selectQuery = "SELECT * FROM Customerdetails WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' AND credit != ''";
//
//                        Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
//                        // The desired columns to be bound
//                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan"};
//                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales};
//                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);
////                        final String[] fromFieldNames = {"date1", "time1", "billnumber", "rupees", "credit"};
////                        // the XML defined views which the data will be bound to
////                        //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
////                        final int[] toViewsID = {R.id.date, R.id.time, R.id.billno, R.id.sales, R.id.credit};
////                        //Log.e("Checamos que hay id", String.valueOf(R.id.name));
////                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_creditsales, cursor1, fromFieldNames, toViewsID, 0);
////                        listView.setAdapter(adapter);
//
//                        adapter.setFilterQueryProvider(new FilterQueryProvider() {
//                            public Cursor runQuery(CharSequence constraint) {
//                                return fetchCountriesByName_credit(constraint.toString());
//                            }
//                        });
                    }
                }
            }
        }


        search.addTextChangedListener(new TextWatcher() {

            public void afterTextChanged(Editable s) {
            }

            public void beforeTextChanged(CharSequence s, int start,
                                          int count, int after) {
            }

            public void onTextChanged(CharSequence s, int start,
                                      int before, int count) {
                adapter.getFilter().filter(s.toString());
            }
        });


        getlisting.setOnItemSelectedListener(new AdapterView.OnItemSelectedListener() {
            @Override
            public void onItemSelected(AdapterView<?> parent, View view, int position, long id) {
                String spineerseleitem = parent.getItemAtPosition(position).toString();
                if (spineerseleitem.equals("All")) {
                    cardlist.setVisibility(View.INVISIBLE);
                    saleslist.setVisibility(View.VISIBLE);
                    creditlist.setVisibility(View.INVISIBLE);
//                    final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 GROUP By billno ORDER BY datetimee DESC";
                    final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                    Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                    // The desired columns to be bound
                    final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "sales"};
                    // the XML defined views which the data will be bound to
                    //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
                    final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                    //Log.e("Checamos que hay id", String.valueOf(R.id.name));
                    adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                    listView.setAdapter(adapter);
                    adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                        @Override
                        public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                            if (view.getId() == R.id.inn) {
                                final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                TextView dateTextView = (TextView) view;
                                if (tadl_id.toString().equals("India")){
                                    dateTextView.setText(insert1_cc);
                                }else {
                                    dateTextView.setText(insert1_cc);
                                }
                                return true;
                            }
                            return false;
                        }
                    });
                    listView.setAdapter(adapter);

                    adapter.setFilterQueryProvider(new FilterQueryProvider() {
                        public Cursor runQuery(CharSequence constraint) {
                            return fetchCountriesByName(constraint.toString());
                        }
                    });
                }else {
                    if (spineerseleitem.equals("UPI QR")) {
                        cardlist.setVisibility(View.INVISIBLE);
                        saleslist.setVisibility(View.VISIBLE);
                        creditlist.setVisibility(View.INVISIBLE);
                        final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' GROUP By billno ORDER BY datetimee DESC";

                        Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                        // The desired columns to be bound
                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);
                        adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                            @Override
                            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                if (view.getId() == R.id.inn) {
                                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                    TextView dateTextView = (TextView) view;
                                    if (tadl_id.toString().equals("India")){
                                        dateTextView.setText(insert1_cc);
                                    }else {
                                        dateTextView.setText(insert1_cc);
                                    }
                                    return true;
                                }
                                return false;
                            }
                        });
                        listView.setAdapter(adapter);

                        adapter.setFilterQueryProvider(new FilterQueryProvider() {
                            public Cursor runQuery(CharSequence constraint) {
                                return fetchCountriesByName_cash(constraint.toString());
                            }
                        });
                    }else {
                        if (spineerseleitem.equals("Mobikwik")) {
                            cardlist.setVisibility(View.INVISIBLE);
                            saleslist.setVisibility(View.VISIBLE);
                            creditlist.setVisibility(View.INVISIBLE);
//                            cardlist.setVisibility(View.VISIBLE);
//                            saleslist.setVisibility(View.INVISIBLE);
//                            creditlist.setVisibility(View.INVISIBLE);
//                            listView1 = (ListView) findViewById(R.id.listView12);

                            final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Mobikwik' GROUP By billno ORDER BY datetimee DESC";

                            Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                            // The desired columns to be bound
                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);
                            adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                @Override
                                public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                    if (view.getId() == R.id.inn) {
                                        final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                        TextView dateTextView = (TextView) view;
                                        if (tadl_id.toString().equals("India")){
                                            dateTextView.setText(insert1_cc);
                                        }else {
                                            dateTextView.setText(insert1_cc);
                                        }
                                        return true;
                                    }
                                    return false;
                                }
                            });
                            listView.setAdapter(adapter);

//                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                            // the XML defined views which the data will be bound to
//                            //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                            //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);

                            adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                public Cursor runQuery(CharSequence constraint) {
                                    return fetchCountriesByName_card(constraint.toString());
                                }
                            });
                        }else {
                            if (spineerseleitem.equals("Freecharge")) {
                                cardlist.setVisibility(View.INVISIBLE);
                                saleslist.setVisibility(View.VISIBLE);
                                creditlist.setVisibility(View.INVISIBLE);

                                final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                                Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                                // The desired columns to be bound
                                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);
                                adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                    @Override
                                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                        if (view.getId() == R.id.inn) {
                                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                            TextView dateTextView = (TextView) view;
                                            if (tadl_id.toString().equals("India")){
                                                dateTextView.setText(insert1_cc);
                                            }else {
                                                dateTextView.setText(insert1_cc);
                                            }
                                            return true;
                                        }
                                        return false;
                                    }
                                });
                                listView.setAdapter(adapter);

//                                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                                // the XML defined views which the data will be bound to
//                                //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                                //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);

                                adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                    public Cursor runQuery(CharSequence constraint) {
                                        return fetchCountriesByName_free(constraint.toString());
                                    }
                                });
                            } else {
                                cardlist.setVisibility(View.INVISIBLE);
                                saleslist.setVisibility(View.VISIBLE);
                                creditlist.setVisibility(View.INVISIBLE);
//                                cardlist.setVisibility(View.INVISIBLE);
//                                saleslist.setVisibility(View.INVISIBLE);
//                                creditlist.setVisibility(View.VISIBLE);
//                            listView1 = (ListView) findViewById(R.id.listView12);
                                final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

//                                final String selectQuery = "SELECT * FROM Customerdetails WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' AND credit != ''";

                                Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                                // The desired columns to be bound
                                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);
                                adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                    @Override
                                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                        if (view.getId() == R.id.inn) {
                                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                            TextView dateTextView = (TextView) view;
                                            if (tadl_id.toString().equals("India")){
                                                dateTextView.setText(insert1_cc);
                                            }else {
                                                dateTextView.setText(insert1_cc);
                                            }
                                            return true;
                                        }
                                        return false;
                                    }
                                });
                                listView.setAdapter(adapter);

//                                final String[] fromFieldNames = {"date1", "time1", "billnumber", "rupees", "credit"};
//                                // the XML defined views which the data will be bound to
//                                //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                                final int[] toViewsID = {R.id.date, R.id.time, R.id.billno, R.id.sales, R.id.credit};
//                                //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_creditsales, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);

                                adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                    public Cursor runQuery(CharSequence constraint) {
                                        return fetchCountriesByName_free(constraint.toString());
                                    }
                                });
                            }
                        }
                    }
                }

            }

            @Override
            public void onNothingSelected(AdapterView<?> parent) {

            }
        });

        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long id) {
                view.setSelected(true);
                final Cursor cursor2 = (Cursor) parent.getItemAtPosition(position);


                final String Text = getlisting.getSelectedItem().toString();
                if (Text.equals("Freecharge")) {
                    billnumb = cursor2.getString(cursor2.getColumnIndex("billnumber"));
                    datee = cursor2.getString(cursor2.getColumnIndex("date1"));
                    timee = cursor2.getString(cursor2.getColumnIndex("time1"));
                }else {
                    billnumb = cursor2.getString(cursor2.getColumnIndex("billno"));
                    datee = cursor2.getString(cursor2.getColumnIndex("date"));
                    timee = cursor2.getString(cursor2.getColumnIndex("time"));
                }

                TableLayout.LayoutParams tableLayoutParams = new TableLayout.LayoutParams();
                final TableLayout tableLayoutt1 = new TableLayout(Cash_Card_Credit_Sales2.this);

                final TableRow tableRow = new TableRow(Cash_Card_Credit_Sales2.this);
                tableRow.setOrientation(LinearLayout.HORIZONTAL);
                tableRow.setPadding(55, 0, 0, 0);

//                                    Spinner spinner = (Spinner)view.findViewById(R.id.billdetails);
//                                    ArrayList<String> my_tax = new ArrayList<String>();
//                                    db = Cash_Card_Credit_Sales2.this.openOrCreateDatabase("mydb", Context.MODE_PRIVATE, null);
//                                    Cursor alltaxes = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"' AND type = 'Item' ", null);
//                                    if (alltaxes.moveToFirst()) {
//                                        do {
//
//                                            String ID = alltaxes.getString(0);
//                                            String NAME = alltaxes.getString(1);
//                                            String Qua = alltaxes.getString(2);
//                                            my_tax.add(Qua+"   "+NAME);
//
//                                        } while (alltaxes.moveToNext());
//                                    }
//                                    alltaxes = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "' AND type = 'Modifier' ", null);
//                                    if (alltaxes.moveToFirst()) {
//                                        do {
//
//                                            String ID = alltaxes.getString(0);
//                                            String NAME = alltaxes.getString(1);
//                                            String Qua = alltaxes.getString(2);
//                                            my_tax.add(Qua+"   "+NAME+"(Modifier)");
//
//                                        } while (alltaxes.moveToNext());
//                                    }
//                                    ArrayAdapter my_AdapterTax = new ArrayAdapter(Cash_Card_Credit_Sales2.this, R.layout.spinner_row,
//                                            my_tax);
//                                    spinner.setAdapter(my_AdapterTax);

                //Toast.makeText(Cash_Card_Credit_Sales2.this, "Bill number is "+billnumb, Toast.LENGTH_SHORT).show();
                Cursor bi = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"' AND type = 'Item' AND mod_assigned = 'yes'", null);
                if (bi.moveToFirst()){
                    do {

                        String na = bi.getString(1);
//                                            Toast.makeText(Cash_Card_Credit_Sales2.this, "Items are "+na, Toast.LENGTH_SHORT).show();

                        TextView tvmod = new TextView(Cash_Card_Credit_Sales2.this);
                        tvmod.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tvmod.setPadding(100, 0, 0, 0);
                        tvmod.setText(na);
                        tvmod.setPadding(0, 0, 0, 0);
                        tvmod.setTextColor(Color.parseColor("#000000"));
                        tableRow.addView(tvmod);


                        Cursor mo = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"' AND type = 'Modifier' AND parent = '"+na+"'", null);
                        if (mo.moveToFirst()){
                            do {
                                String mod = mo.getString(1);
//                                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "modifiers of "+na+" is "+mod, Toast.LENGTH_SHORT).show();

                                TextView tvmod1 = new TextView(Cash_Card_Credit_Sales2.this);
                                tvmod1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                //tvmod.setPadding(100, 0, 0, 0);
                                tvmod1.setText(mod);
                                tvmod1.setPadding(0, 0, 0, 0);
                                tvmod1.setTextColor(Color.parseColor("#000000"));
                                tableRow.addView(tvmod1);
                            }while (mo.moveToNext());
                        }
                    }while (bi.moveToNext());
                }
                bi.close();
                Cursor bii = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"' AND type = 'Item' AND mod_assigned = 'no'", null);
                if (bii.moveToFirst()){
                    do {
                        String na = bii.getString(1);
//                                            Toast.makeText(Cash_Card_Credit_Sales2.this, "Items are "+na, Toast.LENGTH_SHORT).show();

                        TextView tvmod = new TextView(Cash_Card_Credit_Sales2.this);
                        tvmod.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tvmod.setPadding(100, 0, 0, 0);
                        tvmod.setText(na);
                        tvmod.setPadding(0, 0, 0, 0);
                        tvmod.setTextColor(Color.parseColor("#000000"));
                        tableRow.addView(tvmod);

                    }while (bii.moveToNext());
                }
                bii.close();

                tableLayoutt1.addView(tableRow);


                Cursor alert = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
                if (alert.moveToFirst()){
                    do {
                        String paym = alert.getString(5);
                        String billt = alert.getString(6);

                        TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                        tv.setText(paym);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setText(billt);

                        ContentValues cv = new ContentValues();
                        if (tv.getText().toString().equals("")){
                            cv.put("paymentmethod", "  Upiqr");
                            String where  = "billnumber = '" +billnumb+ "' ";
                            db.update("Billnumber", cv, where, new String[]{});
                        }

                    } while (alert.moveToNext());
                }

                Cursor alert1 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
                if (alert1.moveToFirst()){
                    do {
                        String paym = alert1.getString(5);
                        String billt = alert1.getString(6);

                        TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                        tv.setText(paym);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setText(billt);

                        ContentValues cv = new ContentValues();
                        if (tv1.getText().toString().equals("")){
                            cv.put("billtype", "  Dine-in");
                            String where  = "billnumber = '" +billnumb+ "' ";
                            db.update("Billnumber", cv, where, new String[]{});
                        }

                    } while (alert1.moveToNext());
                }

                Cursor alert2 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"'", null);
                if (alert2.moveToFirst()){
                    do {
                        String paym = alert2.getString(17);

                        TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                        tv.setText(paym);

                        ContentValues cv = new ContentValues();
                        if (tv.getText().toString().equals("")){
                            cv.put("paymentmethod", "  Upiqr");
                            String where  = "bill_no = '" +billnumb+ "' ";
                            db.update("All_Sales", cv, where, new String[]{});
                        }

                    } while (alert2.moveToNext());
                }

                Cursor alert3 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"'", null);
                if (alert3.moveToFirst()){
                    do {
                        String billt = alert3.getString(16);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setText(billt);

                        ContentValues cv = new ContentValues();
                        if (tv1.getText().toString().equals("")){
                            cv.put("billtype", "  Dine-in");
                            String where  = "bill_no = '" +billnumb+ "' ";
                            db.update("All_Sales", cv, where, new String[]{});
                        }

                    } while (alert3.moveToNext());
                }


                final Dialog dialog = new Dialog(Cash_Card_Credit_Sales2.this, R.style.notitle);
                dialog.setContentView(R.layout.full_orderlist1);
                dialog.setTitle(Html.fromHtml("<font color='#ffffff'>Tax</font>"));

                TableLayout tableLayoutt = (TableLayout) dialog.findViewById(R.id.lytpedidooo);
                tableLayoutt.removeAllViews();

                Button okcl = (Button)dialog.findViewById(R.id.btncancel);
                okcl.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        dialog.dismiss();
                    }
                });

                TextView rs = (TextView) dialog.findViewById(R.id.rs);
                rs.setText(insert1_cc);

                Button print = (Button)dialog.findViewById(R.id.btnprint);
                print.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
//                                dialog.dismiss();
                        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
                        if (connnet.moveToFirst()) {
                            ipnameget = connnet.getString(1);
                            portget = connnet.getString(2);
                            statusnet = connnet.getString(3);
                        }

                        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
                        if (connnet_counter.moveToFirst()) {
                            ipnameget_counter = connnet_counter.getString(1);
                            portget_counter = connnet_counter.getString(2);
                            statusnet_counter = connnet_counter.getString(3);
                        }
                        connnet_counter.close();

                        Cursor conn = db1.rawQuery("SELECT * FROM BTConn", null);
                        if (conn.moveToFirst()) {
                            nameget = conn.getString(1);
                            addget = conn.getString(2);
                            statussusb = conn.getString(3);
                        }

                        Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
                        if (cc.moveToFirst()) {
                            String Na = cc.getString(1);
                            if (Na.equals("A4")) {
//                                Toast.makeText(getApplicationContext(), "A4", Toast.LENGTH_LONG).show();
                                Intent intent = new Intent(Cash_Card_Credit_Sales2.this, A4_Printer_new.class);
                                intent.putExtra("billnumber", billnumb);
                                startActivity(intent);
                            }else {
                                if (statusnet.equals("ok")  || statusnet_counter.equals("ok") || statussusb.equals("ok")) {

                                    printbillcopy1(dialog);
                                    //dialog.dismiss();


                                }else {

                                    String printer_type="";
                                    Cursor aallrows = db1.rawQuery("SELECT * FROM Printer_type WHERE _id = '1'", null);
                                    if (aallrows.moveToFirst()) {
                                        do {
                                            printer_type = aallrows.getString(1);

                                        } while (aallrows.moveToNext());
                                    }
                                    aallrows.close();

                                    if(printer_type.equalsIgnoreCase("wiseposplus")) {
                                        if (MSWisepadDeviceController.getDeviceType() == MSWisepadDeviceController.DeviceType.WISEPOS_NEO) {
                                            mPrintData = new ArrayList<>();

                                            Log.e(Cash_Card_Credit_Sales2.class.getSimpleName(), "mPrintData: " + mPrintData);
                                            byte[] receiptData = neoprintbillcopy1(dialog);
                                            mPrintData.add(receiptData);


                                            if (mPrintData != null && mPrintData.size() > 0) {
                                                mMSWisepadDeviceController.print(mPrintData);
                                            }

                                        } else {
                                            wiseposprintbillcopy1(dialog);

                                        }
                                    }else {

                                        final Dialog dialogconn = new Dialog(Cash_Card_Credit_Sales2.this, R.style.notitle);
                                        dialogconn.setContentView(R.layout.dialog_printer_conn_error_orderlist);

                                        Button conti = (Button) dialogconn.findViewById(R.id.ok);
                                        conti.setOnClickListener(new View.OnClickListener() {
                                            @Override
                                            public void onClick(View v) {
                                                //Toast.makeText(Cash_Card_Credit_Sales2.this, "checkprinterconncash11", Toast.LENGTH_SHORT).show();
                                                dialogconn.dismiss();
                                            }
                                        });

                                        dialogconn.show();
                                    }
                                }
                                //printbillcopy1(dialog);
                            }
                        }
                        cc.close();
                    }
                });

                Button mail = (Button)dialog.findViewById(R.id.btnmail);
                mail.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        //dialog.dismiss();
                        email(dialog);

                    }
                });

//                        ImageView cl = (ImageView)dialog.findViewById(R.id.closetext);
//                        cl.setOnClickListener(new View.OnClickListener() {
//                            @Override
//                            public void onClick(View v) {
//                                dialog.dismiss();
//                            }
//                        });

                TextView bilnumb = (TextView)dialog.findViewById(R.id.billnumb);
                bilnumb.setText(String.valueOf(billnumb));

                Cursor billtypee = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + billnumb + "' ", null);
                if (billtypee.moveToFirst()) {
                    bill_coun = billtypee.getString(11);
                }
                billtypee.close();

                TextView billid_value = (TextView)dialog.findViewById(R.id.billid_value);
                billid_value.setText(String.valueOf(bill_coun));

                TextView datees = (TextView)dialog.findViewById(R.id.date);
                datees.setText(datee);
                TextView timees = (TextView)dialog.findViewById(R.id.time);
                timees.setText(timee);

                LinearLayout custadd = (LinearLayout)dialog.findViewById(R.id.address);
                TextView custname = (TextView)dialog.findViewById(R.id.cust_name);
                TextView custaddr = (TextView)dialog.findViewById(R.id.cust_address);
                TextView custph = (TextView)dialog.findViewById(R.id.cust_phno);
                TextView custema = (TextView)dialog.findViewById(R.id.cust_emailid);

                LinearLayout comments = (LinearLayout) dialog.findViewById(R.id.comments);
                TextView sale_comm = (TextView) dialog.findViewById(R.id.sale_comm);
                sale_comm.setText("");
                Cursor cursor_sale_comm = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
                if (cursor_sale_comm.moveToFirst()){
                    String string_sale_comm = cursor_sale_comm.getString(13);
                    sale_comm.setText(string_sale_comm);
                    if (sale_comm.getText().toString().equals("")){
                        comments.setVisibility(View.GONE);
                    }else {
                        comments.setVisibility(View.VISIBLE);
                    }
                }

                TextView subtotoalam = (TextView)dialog.findViewById(R.id.subtotal);
                TextView discpercent = (TextView)dialog.findViewById(R.id.dispercent);
                TextView discval = (TextView)dialog.findViewById(R.id.discount);
                TextView savingsval = (TextView)dialog.findViewById(R.id.disc_savings);
                TextView taxvalue = (TextView)dialog.findViewById(R.id.tax);
                TextView roundedoffvalue = (TextView)dialog.findViewById(R.id.roundedoff);
                TextView loyalty_points = (TextView)dialog.findViewById(R.id.loyalty_points);
                TextView loyalty_amount = (TextView)dialog.findViewById(R.id.loyalty_amount);
                TextView total = (TextView)dialog.findViewById(R.id.totalold);

                TextView compname = (TextView)dialog.findViewById(R.id.compname);
                TextView compadd1 = (TextView)dialog.findViewById(R.id.address1);
                TextView compadd2 = (TextView)dialog.findViewById(R.id.address2);
                TextView compadd3 = (TextView)dialog.findViewById(R.id.address3);
                TextView compphnoo = (TextView)dialog.findViewById(R.id.phoneno);
                TextView compemail = (TextView)dialog.findViewById(R.id.emailid);
                TextView compwebsite = (TextView)dialog.findViewById(R.id.website);
                TextView comptaxlicen = (TextView)dialog.findViewById(R.id.taxlineone);

                TextView tableidd = (TextView) dialog.findViewById(R.id.tableid);
                TextView paymenttypee = (TextView) dialog.findViewById(R.id.paymenttype);
                TextView paymentmethodd = (TextView) dialog.findViewById(R.id.paymentmethod);


                Cursor all = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"'", null);
                if(all.moveToFirst()){
                    String tab_id = all.getString(15);
                    String billtype = all.getString(16);
                    String cashcard = all.getString(17);

                    Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tab_id + "'", null);
                    if (vbnm.moveToFirst()){
                        assa1 = vbnm.getString(1);
                        assa2 = vbnm.getString(2);
                    }
                    TextView cx = new TextView(Cash_Card_Credit_Sales2.this);
                    cx.setText(assa1);
                    if (cx.getText().toString().equals("")){
                        tableidd.setText(assa2);
                    }else {
                        tableidd.setText(assa1);
                    }

                    paymenttypee.setText(billtype);
                    paymentmethodd.setText(cashcard);
                }

                TextView foo = (TextView)dialog.findViewById(R.id.footer);



                Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
                if (cursor3.moveToFirst()){
                    sub = cursor3.getString(7);
                    subtotoalam.setText(sub);
                }

                Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '"+billnumb+"'", null);
                if (cursor4.moveToFirst()){
                    String taxpe = cursor4.getString(5);
                    discpercent.setText(taxpe);
                }

                Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '"+billnumb+"'", null);
                if (cursor5.moveToFirst()){
                    String dsirs = cursor5.getString(7);
                    float dsirsq = Float.parseFloat(dsirs);
                    String rop = String.format("%.2f", dsirsq);
                    discval.setText(rop);
                }

                Cursor cursor51 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE bill_no = '"+billnumb+"' AND disc_thereornot = 'yes'", null);
                if (cursor51.moveToFirst()){
                    float dsirsq = cursor51.getFloat(0);
                    String rop = String.format("%.2f", dsirsq);
                    savingsval.setText(rop);
                }

                Cursor cursor6 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
                if (cursor6.moveToFirst()){
                    String sub = cursor6.getString(8);
                    if (sub.equals("")){
                        taxvalue.setText("0.0");
                    }else {
                        float vv = Float.parseFloat(sub);
                        taxvalue.setText(String.format("%.2f", vv));
                    }

                }

                Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
                if (cursor7.moveToFirst()){
                    String sub = cursor7.getString(9);
                    String point = cursor7.getString(16);
                    String amount = cursor7.getString(17);
                    roundedoffvalue.setText(sub);
                    loyalty_points.setText(point);
                    loyalty_amount.setText(amount);
                }

                Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
                if (cursor8.moveToFirst()){
                    String sub = cursor8.getString(2);
                    total.setText(sub);
                }

                Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursorr.moveToFirst()) {

                    do {

                        String nbg = ccursorr.getString(0);
                        String name = ccursorr.getString(1);
                        String value = ccursorr.getString(2);
                        String pq = ccursorr.getString(5);
                        String itna = ccursorr.getString(2);
                        String pricee = ccursorr.getString(3);
                        String tototot = ccursorr.getString(4);

                        final String newid = ccursorr.getString(20);


                        if (pq.equals(getString(R.string.action_item))){
                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));



                            final TableRow row1 = new TableRow(Cash_Card_Credit_Sales2.this);
                            row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                            final TableRow row2 = new TableRow(Cash_Card_Credit_Sales2.this);
                            row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT));

                            //TableLayout.LayoutParams tableLayoutParams = new TableLayout.LayoutParams();
                            final TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
                            final TableLayout tableLayout_disc = new TableLayout(Cash_Card_Credit_Sales2.this);

                            TableRow.LayoutParams lp, lp1, lp2;

                            TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                            tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                            //tv.setTextSize(18);
                            //tv.setTypeface(Typeface.MONOSPACE);
                            tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tv.setPadding(0, 0, 0, 0);
                            //text = ccursorr.getString(1);
                            tv.setText(value);
                            row.addView(tv);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.6f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv1.setTypeface(Typeface.MONOSPACE);
                            tv1.setGravity(Gravity.CENTER_VERTICAL);
                            tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tv1.setTextSize(15);
                            //tv.setPadding(0, 0, 0, 0);
                            //text = ccursorr.getString(1);
                            tv1.setText(name);
                            String value1 = tv1.getText().toString();
                            row.addView(tv1);

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 4.5f);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.0f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv2.setTypeface(Typeface.MONOSPACE);
                            //tv2.append(value + "% " + name);
                            tv2.setText(pricee);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tv2.setTextColor(R.color.black);
                            row.addView(tv2);

//                                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                                            //lp1 = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 1.5f);
//                                            textView1.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                                                    android.widget.TableRow.LayoutParams.WRAP_CONTENT, 1.5f));
//                                            //tv.setBackgroundResource(R.drawable.cell_shape);
//                                            textView1.setGravity(Gravity.RIGHT | Gravity.CENTER_VERTICAL);
//                                            textView1.setText(insert1_cc);
//                                            //textView1.setBackgroundResource(R.drawable.rs_border);
//                                            textView1.setPadding(0, 0, 5, 0);
//                                            //textView1.setTextColor(R.color.black);
//                                            textView1.setTextSize(14);
//                                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv2.setTypeface(Typeface.MONOSPACE);
                            //tv2.setPadding(0, 0, 1, 0);
                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            tv3.setText(tototot);
                            //tv3.setTextColor(R.color.black);
                            //row.addView(tv3);



                            String value2 = tv3.getText().toString();

                            //tableLayoutt.addView(row);

                            Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                            if (modcursor.moveToFirst()){
                                do {

                                    final String modiname = modcursor.getString(1);
                                    final String modiquan = modcursor.getString(2);
                                    String modiprice = modcursor.getString(3);
                                    String moditotal = modcursor.getString(4);
                                    final String modiid = modcursor.getString(0);

                                    final TableRow tableRow11 = new TableRow(Cash_Card_Credit_Sales2.this);
                                    tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                                    final TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                                    // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                                    tvv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.70f));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    //tv.setGravity(Gravity.CENTER);
                                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    //tvv.setTypeface(Typeface.MONOSPACE);
                                    tvv.setText("");
                                    tableRow11.addView(tvv);

                                    TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
                                    //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                    tv4.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.6f));
                                    //tv3.setPadding(5, 0, 0, 0);
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tv4.setText(modiname);
                                    tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    //tv4.setTypeface(Typeface.MONOSPACE);
                                    tv4.setGravity(Gravity.CENTER_VERTICAL);
                                    //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                    //tv3.setTextColor(R.color.black);
                                    tableRow11.addView(tv4);

                                    TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
                                    //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                    tv5.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.0f));
                                    //tv3.setPadding(5, 0, 0, 0);
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    // tv5.setTypeface(Typeface.MONOSPACE);
                                    //tv2.setPadding(0, 0, 1, 0);
                                    tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    tv5.setText(String.valueOf(Float.parseFloat(modiprice)));
                                    //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                    //tv3.setTextColor(R.color.black);
                                    tableRow11.addView(tv5);

                                    TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                                    //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                    tv6.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    //tv3.setPadding(5, 0, 0, 0);
                                    tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    // tv6.setTypeface(Typeface.MONOSPACE);
                                    tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tv6.setText("");
                                    //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                    //tv3.setTextColor(R.color.black);
                                    tableRow11.addView(tv6);


                                    final TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
                                    //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                    tv7.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    //tv7.setTypeface(Typeface.MONOSPACE);
                                    //tv3.setPadding(0,0,10,0);
                                    tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);

                                    //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                                    final String number = tv.getText().toString();
                                    float newmul = Float.parseFloat(number);
                                    //final float in = Float.parseFloat(cursor.getString(4));
                                    String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                    //newmul = Integer.parseInt(multiply);
                                    //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                                    //row.addView(tv3);

                                    row.removeView(tv8);

                                    Cursor cursor41 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '"+billnumb+"'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                                    if (cursor41.moveToFirst()){
                                        float sub2a = cursor41.getFloat(0);
                                        String sub2a1 = String.valueOf(sub2a);
                                        ss = Float.parseFloat(sub2a1)+Float.parseFloat(tototot);
                                        ss1 = String.valueOf(ss);
                                        //Toast.makeText(Cash_Card_Credit_Sales2.this, "1 "+ss1, Toast.LENGTH_SHORT).show();
                                    }

                                    tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                                    tv8.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                    //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    //tv3.setPadding(0, 0, 10, 0);
                                    //tv8.setTypeface(Typeface.MONOSPACE);
                                    tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);

                                    final String numberr = tv.getText().toString();
                                    float newmulr = Float.parseFloat(numberr);
                                    //final float in = Float.parseFloat(cursor.getString(4));
                                    String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                                    //newmul = Integer.parseInt(multiply);
                                    tv8.setText(ss1);
                                    row.addView(tv8);


                                    tableLayout1.addView(tableRow11);
                                }while (modcursor.moveToNext());

                                Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                                if (disc_cursor.moveToFirst()){
                                    do {
                                        String disc_vv = disc_cursor.getString(12);
                                        String disc_there = disc_cursor.getString(30);
                                        if(disc_there.toString().equals(getString(R.string.no))){

                                        }else {
                                            ///Toast.makeText(Cash_Card_Credit_Sales2.this, "aaa " +disc_vv, Toast.LENGTH_SHORT).show();

                                            final TableRow row_disc = new TableRow(Cash_Card_Credit_Sales2.this);
                                            row_disc.setLayoutParams(new TableLayout.LayoutParams(
                                                    TableRow.LayoutParams.MATCH_PARENT,
                                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
                                            //row_disc.setPadding(padding_in_px, padding_in_px1, padding_in_px, padding_in_px1);

                                            TextView textView2 = new TextView(Cash_Card_Credit_Sales2.this);
                                            textView2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 3.44f));
                                            textView2.setText("");
                                            row_disc.addView(textView2);

                                            disc_tv = new TextView(Cash_Card_Credit_Sales2.this);
                                            disc_tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.60f));
                                            disc_tv.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                            disc_tv.setText("-" + disc_cursor.getString(31));
                                            disc_tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                            row_disc.addView(disc_tv);

                                            tableLayout_disc.addView(row_disc);
                                        }
                                    }while(disc_cursor.moveToNext());
                                }
                            }
                            else {
                                tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                                tv8.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv8.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                                //tv3.setPadding(0, 0, 10, 0);
                                //tv8.setTypeface(Typeface.MONOSPACE);
                                tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);

                                final String number = tv.getText().toString();
                                float newmul = Float.parseFloat(number);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                float multiply_new = Float.parseFloat(multiply);
                                //newmul = Integer.parseInt(multiply);
                                tv8.setText(String.format("%.2f", multiply_new));
                                row.addView(tv8);

                                Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                                if (disc_cursor.moveToFirst()){
                                    do {
                                        String disc_vv = disc_cursor.getString(12);
                                        String disc_there = disc_cursor.getString(30);
                                        if(disc_there.toString().equals(getString(R.string.no))){

                                        }else {
                                            ///Toast.makeText(Cash_Card_Credit_Sales2.this, "aaa " +disc_vv, Toast.LENGTH_SHORT).show();

                                            final TableRow row_disc = new TableRow(Cash_Card_Credit_Sales2.this);
                                            row_disc.setLayoutParams(new TableLayout.LayoutParams(
                                                    TableRow.LayoutParams.MATCH_PARENT,
                                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
                                            //row_disc.setPadding(padding_in_px, padding_in_px1, padding_in_px, padding_in_px1);

                                            TextView textView2 = new TextView(Cash_Card_Credit_Sales2.this);
                                            textView2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 3.44f));
                                            textView2.setText("");
                                            row_disc.addView(textView2);

                                            disc_tv = new TextView(Cash_Card_Credit_Sales2.this);
                                            disc_tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.60f));
                                            disc_tv.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                            disc_tv.setText("-" + disc_cursor.getString(31));
                                            disc_tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                            row_disc.addView(disc_tv);

                                            tableLayout_disc.addView(row_disc);
                                        }
                                    }while(disc_cursor.moveToNext());
                                }
                            }

                            tableLayoutt.addView(row);

                            tableLayoutt.addView(tableLayout1);

                            tableLayoutt.addView(tableLayout_disc);

                        }



                    } while (ccursorr.moveToNext());
                }

                TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
                tableLayout1.removeAllViews();

                TableLayout tableLayout2 = (TableLayout) dialog.findViewById(R.id.lytpedidoo);
                tableLayout2.removeAllViews();
//here
                Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor.moveToFirst()) {

                    do {
                        String name = ccursor.getString(10);
                        String value = ccursor.getString(9);
                        String pq = ccursor.getString(50);
                        String itna = ccursor.getString(1);

                        TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                        v.setText(value);

                        TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                        v1.setText(name);
                        if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                                || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                        }else {
                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tvv.setTypeface(Typeface.MONOSPACE);
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            //tv1.setTypeface(Typeface.MONOSPACE);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format(Locale.US,"%.2f", vbn);
                            tv1.setText(value);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                            tv2.append(name);
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            tv3.setText(String.valueOf(tota1));
                            row.addView(tv3);

                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            String value2 = tv3.getText().toString();

                            tableLayout1.addView(row);
                        }
                    } while (ccursor.moveToNext());
                }
                ccursor.close();

                Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor2.moveToFirst()) {

                    do {
                        String name = ccursor2.getString(35);
                        String value = ccursor2.getString(36);
                        String pq = ccursor2.getString(50);
                        String itna = ccursor2.getString(1);

                        TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                        v.setText(value);

                        TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                        v1.setText(name);
                        if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                                || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                        }else {
                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tvv.setTypeface(Typeface.MONOSPACE);
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            //tv1.setTypeface(Typeface.MONOSPACE);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format(Locale.US,"%.2f", vbn);
                            tv1.setText(value);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                            tv2.append(name);
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                            float tota = mul;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            //tv3.setPadding(0,0,10,0);
                            tv3.setText(String.valueOf(tota1));
                            row.addView(tv3);

                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            String value2 = tv3.getText().toString();

                            tableLayout1.addView(row);
                        }
                    } while (ccursor2.moveToNext());
                }
                ccursor2.close();

                Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor3.moveToFirst()) {

                    do {
                        String name = ccursor3.getString(37);
                        String value = ccursor3.getString(38);
                        String pq = ccursor3.getString(50);
                        String itna = ccursor3.getString(1);

                        TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                        v.setText(value);

                        TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                        v1.setText(name);
                        if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                                || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                        }else {
                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tvv.setTypeface(Typeface.MONOSPACE);
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            //tv1.setTypeface(Typeface.MONOSPACE);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format(Locale.US,"%.2f", vbn);
                            tv1.setText(value);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                            tv2.append(name);
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                            float tota = mul;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            //tv3.setPadding(0,0,10,0);
                            tv3.setText(String.valueOf(tota1));
                            row.addView(tv3);

                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            String value2 = tv3.getText().toString();

                            tableLayout1.addView(row);
                        }
                    } while (ccursor3.moveToNext());
                }
                ccursor3.close();

                Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor4.moveToFirst()) {

                    do {
                        String name = ccursor4.getString(39);
                        String value = ccursor4.getString(40);
                        String pq = ccursor4.getString(50);
                        String itna = ccursor4.getString(1);

                        TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                        v.setText(value);

                        TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                        v1.setText(name);
                        if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                                || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                        }else {
                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tvv.setTypeface(Typeface.MONOSPACE);
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            //tv1.setTypeface(Typeface.MONOSPACE);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format(Locale.US,"%.2f", vbn);
                            tv1.setText(value);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                            tv2.append(name);
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                            float tota = mul;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            //tv3.setPadding(0,0,10,0);
                            tv3.setText(String.valueOf(tota1));
                            row.addView(tv3);

                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            String value2 = tv3.getText().toString();

                            tableLayout1.addView(row);
                        }
                    } while (ccursor4.moveToNext());
                }
                ccursor4.close();

                Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor5.moveToFirst()) {

                    do {
                        String name = ccursor5.getString(41);
                        String value = ccursor5.getString(42);
                        String pq = ccursor5.getString(50);
                        String itna = ccursor5.getString(1);

                        TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                        v.setText(value);

                        TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                        v1.setText(name);
                        if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                                || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                        }else {
                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tvv.setTypeface(Typeface.MONOSPACE);
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            //tv1.setTypeface(Typeface.MONOSPACE);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format(Locale.US,"%.2f", vbn);
                            tv1.setText(value);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                            tv2.append(name);
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                            float tota = mul;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            //tv3.setPadding(0,0,10,0);
                            tv3.setText(String.valueOf(tota1));
                            row.addView(tv3);

                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            String value2 = tv3.getText().toString();

                            tableLayout1.addView(row);
                        }
                    } while (ccursor5.moveToNext());
                }
                ccursor5.close();

                ArrayList<String> groupList = new ArrayList<String>();

                float sum_p = 0;
                for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                    TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                    TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

                    if (groupList.contains(mTextView.getText().toString())) {

                    }else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        sum_p = 0;
                        for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                            TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                            mTextView1 = (TextView) mRow1.getChildAt(0);
                            mTextView2 = (TextView) mRow1.getChildAt(2);
                            if (groupList.contains(mTextView.getText().toString())) {
                                if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                    sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                                }
                            } else {
                                if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                    groupList.add(mTextView.getText().toString());
                                    sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                                }
                            }
                        }
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                        String mod1 = mTextView.getText().toString() + "" + String.format("%.2f", sum_p);
                        String mod12 = mTextView.getText().toString();

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                        //tvv.setTypeface(Typeface.MONOSPACE);
                        tvv.setText(mod12);
                        row.addView(tvv);

                        TextView tvv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.5f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv1.setGravity(Gravity.START);
                        tvv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                        //tvv.setTypeface(Typeface.MONOSPACE);
                        tvv1.setText("");
                        row.addView(tvv1);

                        TextView tvv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.4f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv2.setGravity(Gravity.END);
                        tvv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                        //tvv.setTypeface(Typeface.MONOSPACE);
                        tvv2.setText(String.format("%.2f", sum_p));
                        row.addView(tvv2);

                        tableLayout2.addView(row);

//                        String match = "@";
//                        int aposition = mTextView.getText().toString().indexOf(match);
                        String mod2 = mTextView.getText().toString();
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, " "+mod2, Toast.LENGTH_LONG).show();
                        Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor6.moveToFirst()) {
                            String hsn = ccursor6.getString(34);

                            TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                            hsn_hsn.setText(hsn);

                            if (hsn_hsn.getText().toString().equals("")) {
                            } else {

                            }
                        }

                    }
                }

                db1 = Cash_Card_Credit_Sales2.this.openOrCreateDatabase("mydb_Appdata", Context.MODE_PRIVATE, null);



                String phon = "0";
                Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
                if (caddress1.moveToFirst()) {
                    phon = caddress1.getString(2);
                }
                caddress1.close();

                TextView tvvs = new TextView(Cash_Card_Credit_Sales2.this);
                tvvs.setText(phon);


                Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
                if (us_name1.moveToLast()){
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "user id there", Toast.LENGTH_LONG).show();
                    String na53 = us_name1.getString(53);
                    String na38 = us_name1.getString(38);
                    String na39 = us_name1.getString(39);
                    String na40 = us_name1.getString(40);
                    String na41 = us_name1.getString(41);
                    String na42 = us_name1.getString(42);
                    String na43 = us_name1.getString(43);
                    String na44 = us_name1.getString(44);
                    String na45 = us_name1.getString(45);
                    String na46 = us_name1.getString(46);
                    String na47 = us_name1.getString(47);
                    String na48 = us_name1.getString(48);
                    String na49 = us_name1.getString(49);
                    String na50 = us_name1.getString(50);
                    String na51 = us_name1.getString(51);
                    String na52 = us_name1.getString(52);
                    String na38_value = us_name1.getString(54);
                    String na39_value = us_name1.getString(55);
                    String na40_value = us_name1.getString(56);
                    String na41_value = us_name1.getString(57);
                    String na42_value = us_name1.getString(58);
                    String na43_value = us_name1.getString(59);
                    String na44_value = us_name1.getString(60);
                    String na45_value = us_name1.getString(61);
                    String na46_value = us_name1.getString(62);
                    String na47_value = us_name1.getString(63);
                    String na48_value = us_name1.getString(64);
                    String na49_value = us_name1.getString(65);
                    String na50_value = us_name1.getString(66);
                    String na51_value = us_name1.getString(67);
                    String na52_value = us_name1.getString(68);

                    String proc = us_name1.getString(69);

                    TextView hid = new TextView(Cash_Card_Credit_Sales2.this);
                    hid.setText(proc);

                    if (hid.getText().toString().equals("off")){
                        Cursor cursorr = null;
                        if (paymenttypee.getText().toString().equals("  Dine-in") || paymenttypee.getText().toString().equals(getString(R.string.general)) || paymenttypee.getText().toString().equals("  Others")){
                            cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        }
                        if (paymenttypee.getText().toString().equals("  Takeaway") || paymenttypee.getText().toString().equals("  Main")){
                            cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        }
                        if (paymenttypee.getText().toString().equals("  Home delivery")){
                            cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                        if (cursorr.moveToFirst()) {

                            do {

                                String name = cursorr.getString(1);
                                String value = cursorr.getString(2);

                                final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                                row.setLayoutParams(new TableLayout.LayoutParams(
                                        TableRow.LayoutParams.MATCH_PARENT,
                                        TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.MONOSPACE);
//                                row.addView(tv);

                                TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                                tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tvv.setGravity(Gravity.START);
                                tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                //tvv.setTypeface(Typeface.MONOSPACE);
                                tvv.setText(name);

                                TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                                tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                tv1.setGravity(Gravity.START);
                                //tv1.setTypeface(Typeface.MONOSPACE);
                                float vbn = Float.parseFloat(value);
                                String bvn = String.format(Locale.US,"%.2f", vbn);
                                tv1.setText(value);
                                String value1 = tv1.getText().toString();

                                TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                                //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                                //tv2.setLayoutParams(lp);
                                tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                //tv2.setTypeface(Typeface.MONOSPACE);
                                tv2.setGravity(Gravity.START);
                                tv2.append(name);
                                tv2.setPadding(0, 0, 20, 0);
                                tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                row.addView(tv2);

                                TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                                textView1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.5f));
                                textView1.setTextSize(16);
                                row.addView(textView1);

                                TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                                tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.4f));
                                //tv3.setPadding(0,0,10,0);
                                //tv3.setTypeface(Typeface.MONOSPACE);
                                tv3.setGravity(Gravity.END);
                                tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                float tota = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                                float tota = mul;
                                String tota1 = String.format(Locale.US,"%.2f", tota);
                                tv3.setText(String.valueOf(tota1));
                                row.addView(tv3);


                                tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                String value2 = tv3.getText().toString();

                                tableLayout2.addView(row);


                            } while (cursorr.moveToNext());

                            cursorr.close();
                        }
                    }else {
                        for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                            int i1 = 0;
                            if (i2 == 38) {
                                i1 = 54;
                            }
                            if (i2 == 39) {
                                i1 = 55;
                            }
                            if (i2 == 40) {
                                i1 = 56;
                            }
                            if (i2 == 41) {
                                i1 = 57;
                            }
                            if (i2 == 42) {
                                i1 = 58;
                            }
                            if (i2 == 43) {
                                i1 = 59;
                            }
                            if (i2 == 44) {
                                i1 = 60;
                            }
                            if (i2 == 45) {
                                i1 = 61;
                            }
                            if (i2 == 46) {
                                i1 = 62;
                            }
                            if (i2 == 47) {
                                i1 = 63;
                            }
                            if (i2 == 48) {
                                i1 = 64;
                            }
                            if (i2 == 49) {
                                i1 = 65;
                            }
                            if (i2 == 50) {
                                i1 = 66;
                            }
                            if (i2 == 51) {
                                i1 = 67;
                            }
                            if (i2 == 52) {
                                i1 = 68;
                            }


                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            TableRow.LayoutParams lp, lp1, lp2;

                            TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                            tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv.setGravity(Gravity.START);
                            tv.setTextSize(15);
                            //text = cursor.getString(1);
//                String v = na;

                            tv.setText(us_name1.getString(i2));


                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            //text = cursor.getString(1);
                            tv1.setText(us_name1.getString(i1));
                            String value1 = "0";
                            if (tv1.getText().toString().equals("")) {

                            } else {
                                value1 = tv1.getText().toString();
                            }


                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                tv2.setGravity(Gravity.START);
                            tv2.append(us_name1.getString(i2));
//                                tv2.setPadding(0, 0, 20, 0);
                                tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(tv2);
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.5f));
//                                textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(textView1);

//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                            TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.4f));
                                tv33.setGravity(Gravity.END);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                            float tota = mul;
                            tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            tv33.setText(String.valueOf(tota1));
                            //tv3.setTextColor(Color.parseColor("#000000"));
                            //row.addView(tv3);


                            row.addView(tv33);

                            String value2 = tv33.getText().toString();
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                            if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                                    || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                            } else {
                                tableLayout2.addView(row);
                            }

                        }
                    }

                }else {
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "user id not there", Toast.LENGTH_LONG).show();
                    Cursor cursorr = null;
                    if (paymenttypee.getText().toString().equals("  Dine-in") || paymenttypee.getText().toString().equals(getString(R.string.general)) || paymenttypee.getText().toString().equals("  Others")){
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymenttypee.getText().toString().equals("  Takeaway") || paymenttypee.getText().toString().equals("  Main")){
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymenttypee.getText().toString().equals("  Home delivery")){
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                    if (cursorr.moveToFirst()) {

                        do {

                            String name = cursorr.getString(1);
                            String value = cursorr.getString(2);

                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.MONOSPACE);
//                                row.addView(tv);

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            //tvv.setTypeface(Typeface.MONOSPACE);
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            //tv1.setTypeface(Typeface.MONOSPACE);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format(Locale.US,"%.2f", vbn);
                            tv1.setText(value);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                            //tv2.setLayoutParams(lp);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            //tv2.setTypeface(Typeface.MONOSPACE);
                            tv2.setGravity(Gravity.START);
                            tv2.append(name);
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.5f));
                            textView1.setTextSize(16);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.4f));
                            //tv3.setPadding(0,0,10,0);
                            //tv3.setTypeface(Typeface.MONOSPACE);
                            tv3.setGravity(Gravity.END);
                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                            float tota = mul;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            tv3.setText(String.valueOf(tota1));
                            row.addView(tv3);


                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                            String value2 = tv3.getText().toString();

                            tableLayout2.addView(row);


                        } while (cursorr.moveToNext());
                    }
                    cursorr.close();
                }
                us_name1.close();

//                ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
//                if (ccursor.moveToFirst()) {
//
//                    do {
//
//                        String name = ccursor.getString(1);
//                        String value = ccursor.getString(2);
//
//                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT));
//                        row.setGravity(Gravity.CENTER);
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
////                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                tv.setTextSize(16);
////                                tv.setTypeface(Typeface.MONOSPACE);
////                                row.addView(tv);
//
//                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
//                        //tvv.setTypeface(Typeface.MONOSPACE);
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        //tv1.setTypeface(Typeface.MONOSPACE);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format("%.2f", vbn);
//                        tv1.setText(value);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
//                        //tv2.setLayoutParams(lp);
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        //tv2.setTypeface(Typeface.MONOSPACE);
//                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%");
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        textView1.setTextSize(16);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
////                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
////                tv3.setLayoutParams(lp2);
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        //tv3.setPadding(0,0,10,0);
//                        //tv3.setTypeface(Typeface.MONOSPACE);
//                        tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
//                        float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                        float tota = mul;
//                        String tota1 = String.format("%.2f", tota);
//                        tv3.setText(String.valueOf(tota1));
//                        row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
//                        String value2 = tv3.getText().toString();
//
//                        tableLayout1.addView(row);
//
//
//                    } while (ccursor.moveToNext());
//                }

                dialog.show();
            }
        });


        Button btnok = (Button) findViewById(R.id.okok);
        btnok.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {

                String r1, r2, r3, r4;
                r1 = editText1.getText().toString();
                r2 = editText2.getText().toString();
                if (r1.toString().contains(" ")) {
                    r1 = r1.replace(" ", "");
                }
                if (r2.toString().contains(" ")) {
                    r2 = r2.replace(" ", "");
                }

                r3 = editText_from_day_hide.getText().toString();
                r4 = editText_to_day_hide.getText().toString();
                if (r3.toString().contains(":")) {
                    r3 = r3.replace(":", "");
                }
                if (r4.toString().contains(":")) {
                    r4 = r4.replace(":", "");
                }

                editText1_filter.setText(r1 + "" + r3);
                editText2_filter.setText(r2 + "" + r4);

                DownloadMusicfromInternet downloadMusicfromInternet = new DownloadMusicfromInternet();
                downloadMusicfromInternet.execute(editText1_filter.getText().toString() + editText2_filter.getText().toString());


                final String Text = getlisting.getSelectedItem().toString();

                //dialog.dismiss();
                if (Text.equals("All")) {
                    cardlist.setVisibility(View.INVISIBLE);
                    saleslist.setVisibility(View.VISIBLE);
                    creditlist.setVisibility(View.INVISIBLE);
//                    final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 GROUP By billno ORDER BY datetimee DESC";
                    final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                    Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                    // The desired columns to be bound
                    final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "sales"};
                    // the XML defined views which the data will be bound to
                    //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
                    final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                    //Log.e("Checamos que hay id", String.valueOf(R.id.name));
                    adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                    listView.setAdapter(adapter);
                    adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                        @Override
                        public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                            if (view.getId() == R.id.inn) {
                                final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                TextView dateTextView = (TextView) view;
                                if (tadl_id.toString().equals("India")){
                                    dateTextView.setText(insert1_cc);
                                }else {
                                    dateTextView.setText(insert1_cc);
                                }
                                return true;
                            }
                            return false;
                        }
                    });
                    listView.setAdapter(adapter);

                    adapter.setFilterQueryProvider(new FilterQueryProvider() {
                        public Cursor runQuery(CharSequence constraint) {
                            return fetchCountriesByName(constraint.toString());
                        }
                    });
                }else {
                    if (Text.equals("UPI QR")) {
                        cardlist.setVisibility(View.INVISIBLE);
                        saleslist.setVisibility(View.VISIBLE);
                        creditlist.setVisibility(View.INVISIBLE);
                        final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' GROUP By billno ORDER BY datetimee DESC";

                        Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                        // The desired columns to be bound
                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);
                        adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                            @Override
                            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                if (view.getId() == R.id.inn) {
                                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                    TextView dateTextView = (TextView) view;
                                    if (tadl_id.toString().equals("India")){
                                        dateTextView.setText(insert1_cc);
                                    }else {
                                        dateTextView.setText(insert1_cc);
                                    }
                                    return true;
                                }
                                return false;
                            }
                        });
                        listView.setAdapter(adapter);

                        adapter.setFilterQueryProvider(new FilterQueryProvider() {
                            public Cursor runQuery(CharSequence constraint) {
                                return fetchCountriesByName_cash(constraint.toString());
                            }
                        });
                    }else {
                        if (Text.equals("Mobikwik")) {
                            cardlist.setVisibility(View.INVISIBLE);
                            saleslist.setVisibility(View.VISIBLE);
                            creditlist.setVisibility(View.INVISIBLE);
//                            cardlist.setVisibility(View.VISIBLE);
//                            saleslist.setVisibility(View.INVISIBLE);
//                            creditlist.setVisibility(View.INVISIBLE);
//                            listView1 = (ListView) findViewById(R.id.listView12);

                            final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Mobikwik' GROUP By billno ORDER BY datetimee DESC";

                            Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                            // The desired columns to be bound
                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);
                            adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                @Override
                                public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                    if (view.getId() == R.id.inn) {
                                        final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                        TextView dateTextView = (TextView) view;
                                        if (tadl_id.toString().equals("India")){
                                            dateTextView.setText(insert1_cc);
                                        }else {
                                            dateTextView.setText(insert1_cc);
                                        }
                                        return true;
                                    }
                                    return false;
                                }
                            });
                            listView.setAdapter(adapter);

//                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                            // the XML defined views which the data will be bound to
//                            //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                            //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);

                            adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                public Cursor runQuery(CharSequence constraint) {
                                    return fetchCountriesByName_card(constraint.toString());
                                }
                            });
                        }else {
                            if (Text.equals("Freecharge")) {
                                cardlist.setVisibility(View.INVISIBLE);
                                saleslist.setVisibility(View.VISIBLE);
                                creditlist.setVisibility(View.INVISIBLE);
//                                cardlist.setVisibility(View.INVISIBLE); //0000
//                                saleslist.setVisibility(View.INVISIBLE);
//                                creditlist.setVisibility(View.VISIBLE);
//                            listView1 = (ListView) findViewById(R.id.listView12);

                                final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                                Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                                // The desired columns to be bound
                                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);
                                adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                    @Override
                                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                        if (view.getId() == R.id.inn) {
                                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                            TextView dateTextView = (TextView) view;
                                            if (tadl_id.toString().equals("India")){
                                                dateTextView.setText(insert1_cc);
                                            }else {
                                                dateTextView.setText(insert1_cc);
                                            }
                                            return true;
                                        }
                                        return false;
                                    }
                                });
                                listView.setAdapter(adapter);

//                                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                                // the XML defined views which the data will be bound to
//                                //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                                //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);

                                adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                    public Cursor runQuery(CharSequence constraint) {
                                        return fetchCountriesByName_free(constraint.toString());
                                    }
                                });
                            } else {
                                cardlist.setVisibility(View.INVISIBLE);
                                saleslist.setVisibility(View.VISIBLE);
                                creditlist.setVisibility(View.INVISIBLE);

                                final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                                Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                                // The desired columns to be bound
                                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);
                                adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                    @Override
                                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                        if (view.getId() == R.id.inn) {
                                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                            TextView dateTextView = (TextView) view;
                                            if (tadl_id.toString().equals("India")){
                                                dateTextView.setText(insert1_cc);
                                            }else {
                                                dateTextView.setText(insert1_cc);
                                            }
                                            return true;
                                        }
                                        return false;
                                    }
                                });
                                listView.setAdapter(adapter);

//                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                        // the XML defined views which the data will be bound to
//                        //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                        //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);

                                adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                    public Cursor runQuery(CharSequence constraint) {
                                        return fetchCountriesByName_free(constraint.toString());
                                    }
                                });
//                                cardlist.setVisibility(View.INVISIBLE);
//                                saleslist.setVisibility(View.VISIBLE);
//                                creditlist.setVisibility(View.INVISIBLE);
////                                cardlist.setVisibility(View.INVISIBLE);
////                                saleslist.setVisibility(View.INVISIBLE);
////                                creditlist.setVisibility(View.VISIBLE);
////                            listView1 = (ListView) findViewById(R.id.listView12);
//
//                                final String selectQuery = "SELECT * FROM Customerdetails WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' AND credit != ''";
//
//                                Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
//                                // The desired columns to be bound
//                                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan"};
//                                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales};
//                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                                listView.setAdapter(adapter);
////                                final String[] fromFieldNames = {"date1", "time1", "billnumber", "rupees", "credit"};
////                                // the XML defined views which the data will be bound to
////                                //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
////                                final int[] toViewsID = {R.id.date, R.id.time, R.id.billno, R.id.sales, R.id.credit};
////                                //Log.e("Checamos que hay id", String.valueOf(R.id.name));
////                                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_creditsales, cursor1, fromFieldNames, toViewsID, 0);
////                                listView.setAdapter(adapter);
//
//                                adapter.setFilterQueryProvider(new FilterQueryProvider() {
//                                    public Cursor runQuery(CharSequence constraint) {
//                                        return fetchCountriesByName_credit(constraint.toString());
//                                    }
//                                });
                            }
                        }
                    }
                }
            }
        });


        ImageButton action_print = (ImageButton) findViewById(R.id.action_print);
        action_print.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (adapter.isEmpty()){
                    //MenuItem bedMenuItem = menu.findItem(R.id.action_export);
                    //bedMenuItem.setVisible(false);
                    Toast.makeText(Cash_Card_Credit_Sales2.this, getString(R.string.no_report_to_export), Toast.LENGTH_SHORT).show();
                }else {
                    Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
                    if (connnet.moveToFirst()) {
                        ipnameget = connnet.getString(1);
                        portget = connnet.getString(2);
                        statusnet = connnet.getString(3);
                    }

                    Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
                    if (connnet_counter.moveToFirst()) {
                        ipnameget_counter = connnet_counter.getString(1);
                        portget_counter = connnet_counter.getString(2);
                        statusnet_counter = connnet_counter.getString(3);
                    }
                    connnet_counter.close();

                    Cursor conn = db1.rawQuery("SELECT * FROM BTConn", null);
                    if (conn.moveToFirst()) {
                        nameget = conn.getString(1);
                        addget = conn.getString(2);
                        statussusb = conn.getString(3);
                    }
                    if (statusnet.toString().equals("ok") || statusnet_counter.toString().equals("ok") || statussusb.toString().equals("ok")) {

                        final String Text = getlisting.getSelectedItem().toString();


                        if (Text.equals("UPI QR")) {
                            printbillcopy_minireceipt_cash();
                        }
                        //dialog.dismiss();


                    }else {
                        final Dialog dialogconn = new Dialog(Cash_Card_Credit_Sales2.this, R.style.notitle);
                        dialogconn.setContentView(R.layout.dialog_printer_conn_error_orderlist);

                        Button conti = (Button) dialogconn.findViewById(R.id.ok);
                        conti.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View v) {
                                //Toast.makeText(getActivity(), "checkprinterconncash11", Toast.LENGTH_SHORT).show();
                                dialogconn.dismiss();
                            }
                        });

                        dialogconn.show();
                    }
                }
            }
        });

        ImageButton action_export = (ImageButton) findViewById(R.id.action_export);
        action_export.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (adapter.isEmpty()){
                    //MenuItem bedMenuItem = menu.findItem(R.id.action_export);
                    //bedMenuItem.setVisible(false);
                    Toast.makeText(Cash_Card_Credit_Sales2.this, getString(R.string.no_report_to_export), Toast.LENGTH_SHORT).show();
                }else {
                    //MenuItem bedMenuItem = menu.findItem(R.id.action_export);
                    //bedMenuItem.setVisible(true);
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "yes", Toast.LENGTH_SHORT).show();
                    sdff2 = new SimpleDateFormat("ddMMMyy");
                    currentDateandTimee1 = sdff2.format(new Date());

                    Date dt = new Date();
                    sdff1 = new SimpleDateFormat("hhmmssaa");
                    timee1 = sdff1.format(dt);

                    ExportDatabaseCSVTask task=new ExportDatabaseCSVTask();
                    task.execute();
                }
            }
        });


        ImageButton action_exportmail = (ImageButton) findViewById(R.id.action_exportmail);
        action_exportmail.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View v) {
                if (adapter.isEmpty()) {
                    //MenuItem bedMenuItem = menu.findItem(R.id.action_export);
                    //bedMenuItem.setVisible(false);
                    Toast.makeText(Cash_Card_Credit_Sales2.this, getString(R.string.no_report_to_mail), Toast.LENGTH_SHORT).show();
                }else {

                    sdff2 = new SimpleDateFormat("ddMMMyy");
                    currentDateandTimee1 = sdff2.format(new Date());

                    Date dt1 = new Date();
                    sdff1 = new SimpleDateFormat("hhmmssaa");
                    timee1 = sdff1.format(dt1);


                    Cursor cursor = db1.rawQuery("SELECT * FROM Companydetailss", null);
                    if (cursor.moveToFirst()) {
                        companynameis = cursor.getString(1);
                    }else {
                        companynameis = "";
                    }


                    Cursor ccursore = db1.rawQuery("SELECT * FROM Email_setup", null);
                    if (ccursore.moveToFirst()) {
                        Cursor ccursoree = db1.rawQuery("SELECT * FROM Email_recipient", null);
                        if (ccursoree.moveToFirst()) {

                            ExportDatabaseCSVTask task=new ExportDatabaseCSVTask();
                            task.execute();

                        }
                    }


                    Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
                    if (count.moveToFirst()) {
                        int leveliss = count.getInt(0);
                        totalbillis = String.valueOf(leveliss);
                    }

                    if (totalbillis.toString().equals("0")){
                        avgsales_r.setText("0");
                    }else {
                        Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                        if (cursor11.moveToFirst()) {
                            level = cursor11.getInt(0);
                            String total = String.valueOf(level);

                            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(totalbillis));
                            avgsales_r.setText(avgbill);
                        }


                    }

                    Cursor one = db.rawQuery("SELECT MAX(total) FROM userdata ", null);
                    if (one.moveToFirst()) {
                        int one11 = one.getInt(0);
                        one = db.rawQuery("SELECT * FROM userdata WHERE total = '" + one11 + "' ", null);
                        if (one.moveToFirst()) {
                            oone1 = one.getString(1);
                            ppone = one.getString(1);
                            mmax = one.getString(2);

                            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                            if (cursor11.moveToFirst()) {
                                level = cursor11.getInt(0);
                                String total = String.valueOf(level);

                                float perc = (Float.parseFloat(mmax) / Float.parseFloat(total)) * 100;
                                ppercen = String.format("%.1f", perc);
                            }
                        }
                    }

                    one = db.rawQuery("SELECT MAX(total) FROM itemdata ", null);
                    String one1 = "";
                    if (one.moveToFirst()) {
                        int one11 = one.getInt(0);
                        one = db.rawQuery("SELECT * FROM itemdata WHERE total = '" + one11 + "' ", null);
                        if (one.moveToFirst()) {
                            one1 = one.getString(1);
                            String pone = one.getString(1);
                            max = one.getString(2);
//                            topitemone.setText(one1);

                            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                            if (cursor11.moveToFirst()) {
                                level = cursor11.getInt(0);
                                String total = String.valueOf(level);
                                float perc = Float.parseFloat(max) * 100 / Float.parseFloat(total);
                                String percen = String.format("%.1f", perc);

//                                topitem1percent.setText(percen);
//                                topitem1percent.append("%");
                            }

                        } else {
//                            topitemone.setText("NA");
//                            topitem1percent.setText(getString(R.string._0Per));
                        }
                    }

                    TextView topitem1percent = new TextView(Cash_Card_Credit_Sales2.this);
                    Cursor ones = db.rawQuery("SELECT MAX(sales) FROM Itemwiseorderlistitems ", null);
                    if (ones.moveToFirst()) {
                        int one11 = ones.getInt(0);
                        ones = db.rawQuery("SELECT * FROM Itemwiseorderlistitems WHERE sales = '" + one11 + "' ", null);
                        if (ones.moveToFirst()) {
                            String onqe1 = ones.getString(2);
                            String pone = ones.getString(4);
                            topitem1percent.setText(pone);
                        }
                    }

                    TextView topuser1percent = new TextView(Cash_Card_Credit_Sales2.this);
                    Cursor oone = db.rawQuery("SELECT MAX(sales) FROM Userwiseorderlistitems ", null);
                    if (oone.moveToFirst()) {
                        int one11 = oone.getInt(0);
                        oone = db.rawQuery("SELECT * FROM Userwiseorderlistitems WHERE sales = '" + one11 + "' ", null);
                        if (oone.moveToFirst()) {
                            String oneee1 = oone.getString(1);
                            String pone = oone.getString(3);
//                            topuserone.setText(oneee1);
                            topuser1percent.setText(pone);
                        }
                    }

                    Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                    if (cursor11.moveToFirst()) {
                        level = cursor11.getInt(0);
                        String total = String.valueOf(level);
                        totalsales_r.setText(total);
                    }
//                Toast.makeText(getActivity(), " sum is "+total, Toast.LENGTH_SHORT).show();

                    Cursor discountcashcard = db.rawQuery("SELECT SUM(Discount_rupees) FROM Discountdetails WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                    if (discountcashcard.moveToFirst()) {
                        int level1 = discountcashcard.getInt(0);
                        total11 = String.valueOf(level1);
                    }

                    Cursor cashcardcash= db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND paymentmethod = '  Upiqr' ", null);
                    if (cashcardcash.moveToFirst()) {
                        int level111 = cashcardcash.getInt(0);
                        total111 = String.valueOf(level111);
                    }

                    Cursor cashcardcard= db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND paymentmethod = '  Mobikwik' ", null);
                    if (cashcardcard.moveToFirst()) {
                        int level111card = cashcardcard.getInt(0);
                        total111card = String.valueOf(level111card);
                    }

                    Cursor dinein = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Dine-in' ", null);
                    if (dinein.moveToFirst()){
                        dineinsales = dinein.getInt(0);
                        dineinsalesstr = String.valueOf(dineinsales);
                    }

                    Cursor takeaway = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Takeaway' ", null);
                    if (takeaway.moveToFirst()){
                        takeawaysales = takeaway.getInt(0);
                        takeawaysalesstr = String.valueOf(takeawaysales);
                    }

                    Cursor homedelivery = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Home delivery' ", null);
                    if (homedelivery.moveToFirst()){
                        homedeliverysales = homedelivery.getInt(0);
                        homedeliverysalesstr = String.valueOf(homedeliverysales);
                    }

                    TextView textView = new TextView(Cash_Card_Credit_Sales2.this);
                    textView.setText(R.string.underline);

                    float value22 = Float.parseFloat(total11) * 100 / Float.parseFloat(total);
                    String ruppercent22 = String.format("%.1f", value22);


                    float value1 = Float.parseFloat(total111) * 100 / Float.parseFloat(total);
                    String ruppercent1 = String.format("%.1f", value1);
                    //cashcardcashsalespercent.setText(String.valueOf(ruppercent1));

                    float value2 = Float.parseFloat(total111card) * 100 / Float.parseFloat(total);
                    //String ruppercent = String.format("%.1f", value);
                    String ruppercent2 = String.format("%.1f", value2);
                    //cashcardcardsalespercent.setText(String.valueOf(ruppercent2));

                    float value = Float.parseFloat(dineinsalesstr) * 100 / Float.parseFloat(total);
                    String ruppercent = String.format("%.1f", value);

                    float value11 = Float.parseFloat(takeawaysalesstr) * 100 / Float.parseFloat(total);
                    String ruppercent11 = String.format("%.1f", value11);

                    float value21 = Float.parseFloat(homedeliverysalesstr) * 100 / Float.parseFloat(total);
                    String ruppercent21 = String.format("%.1f", value21);

                    //float perc = Float.parseFloat(max) * 100 / Float.parseFloat(totalis);
                    //String percen = String.format("%.1f", perc);

                    String url = "www.intuitionsoftwares.com";

                    String msg = getString(R.string.action_general)+ "(" + editText11.getText().toString() + "," + editText_from_day_visible.getText().toString()+" to " + editText22.getText().toString() +","+editText_to_day_visible.getText().toString()+ ")\n\n" + textView.getText().toString() + " (Detailed report attached)" +
                            "\n\nTotal sales: "+insert1_rs+" " + totalsales_r.getText().toString() + "\n\nCash sales: "+insert1_rs+" " + total111 + "(" + ruppercent1 + "%)\n\nCard sales: "+insert1_rs+" " + total111card + "(" + ruppercent2 + "%)\n\n" +
                            "Dine-in sales: "+insert1_rs+" " + dineinsalesstr + "(" + ruppercent + "%)\n\nTake-away sales: "+insert1_rs+" " + takeawaysalesstr + "(" + ruppercent11 + "%)\n\n" +
                            "Home-delivery sales: "+insert1_rs+" " + homedeliverysalesstr + "(" + ruppercent21 + "%)\n\nNo. of bills: " + totalbillis + "\n\n" +
                            "Avg. sales/bill: "+insert1_rs+" " + avgsales_r.getText().toString() + "\n\nTop selling product:\n" + one1 + " - "+insert1_rs+" " + max + "(" + topitem1percent.getText().toString() + ")\n\nTop seller:\n" + oone1 + " - "+insert1_rs+" " + mmax + "(" + topuser1percent.getText().toString() + ")\n\n" +
                            "Discounts: "+insert1_rs+" " + total11 + "(" + ruppercent22 + "%)\n\nRefunds: "+insert1_rs+" " + refundedstr + "(" + rupper1 + "%)\n\n" +
                            "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
                            "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
                            "Powered by: " + Uri.parse(url);


                    Cursor cursore = db1.rawQuery("SELECT * FROM Email_setup", null);
                    if (cursore.moveToFirst()){
                        Cursor cursoree = db1.rawQuery("SELECT * FROM Email_recipient", null);
                        if (cursoree.moveToFirst()){
                            //both are there
                            Cursor cursoor = db1.rawQuery("SELECT * FROM Email_setup", null);
                            if (cursoor.moveToFirst()) {
                                String un = cursoor.getString(1);
                                String pwd = cursoor.getString(2);
                                String em_ca = cursoor.getString(3);
                                if (em_ca.toString().equals("Gmail")) {
                                    getResultsFromApi();
                                    new MakeRequestTask(mCredential).execute();
                                    new MakeRequestTask2(mCredential).execute();
                                }else {
                                    if (em_ca.toString().equals("Yahoo")){
//                                        Toast.makeText(getActivity(), "yahoo "+un, Toast.LENGTH_LONG).show();
                                        Cursor cursor1 = db1.rawQuery("SELECT * FROM Email_recipient", null);
                                        if (cursor1.moveToFirst()) {
                                            do {
                                                String unn = cursor1.getString(3);
                                                String toEmails = unn;
                                                toEmailList = Arrays.asList(toEmails
                                                        .split("\\s*,\\s*"));
                                                new SendMailTask_Yahoo_attachment_GenOrderlist(Cash_Card_Credit_Sales2.this).execute(un,
                                                        pwd, toEmailList, companynameis, msg, currentDateandTimee1, timee1);
                                                new SendMailTask_Yahoo_attachment_GenOrderlist1(Cash_Card_Credit_Sales2.this).execute(un,
                                                        pwd, toEmailList, companynameis, msg, currentDateandTimee1, timee1);
                                            } while (cursor1.moveToNext());
                                        }


                                    }else {
                                        if (em_ca.toString().equals("Hotmail")){
//                                            Toast.makeText(getActivity(), "Hotmail and Outlook "+un, Toast.LENGTH_LONG).show();
                                            Cursor cursor1 = db1.rawQuery("SELECT * FROM Email_recipient", null);
                                            if (cursor1.moveToFirst()) {
                                                do {
                                                    String unn = cursor1.getString(3);
                                                    String toEmails = unn;
                                                    toEmailList = Arrays.asList(toEmails
                                                            .split("\\s*,\\s*"));
                                                    new SendMailTask_Hotmail_Outlook_attachment_GenOrderlist(Cash_Card_Credit_Sales2.this).execute(un,
                                                            pwd, toEmailList, companynameis, msg, currentDateandTimee1, timee1);
                                                    new SendMailTask_Hotmail_Outlook_attachment_GenOrderlist1(Cash_Card_Credit_Sales2.this).execute(un,
                                                            pwd, toEmailList, companynameis, msg, currentDateandTimee1, timee1);
                                                } while (cursor1.moveToNext());
                                            }
                                        }else {
                                            if (em_ca.toString().equals("Office365")) {
//                                                Toast.makeText(getActivity(), "office 365 " + un, Toast.LENGTH_LONG).show();
                                                Cursor cursor1 = db1.rawQuery("SELECT * FROM Email_recipient", null);
                                                if (cursor1.moveToFirst()) {
                                                    do {
                                                        String unn = cursor1.getString(3);
                                                        String toEmails = unn;
                                                        toEmailList = Arrays.asList(toEmails
                                                                .split("\\s*,\\s*"));
                                                        new SendMailTask_Office365_attachment_GenOrderlist(Cash_Card_Credit_Sales2.this).execute(un,
                                                                pwd, toEmailList, companynameis, msg, currentDateandTimee1, timee1);
                                                        new SendMailTask_Office365_attachment_GenOrderlist1(Cash_Card_Credit_Sales2.this).execute(un,
                                                                pwd, toEmailList, companynameis, msg, currentDateandTimee1, timee1);
                                                    } while (cursor1.moveToNext());
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }else {
                            //only recipient not there
                            final Dialog dialoge = new Dialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);
                            dialoge.setContentView(R.layout.email_prerequisites);
                            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
                            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialoge.show();

                            ImageButton btncancel = (ImageButton) dialoge.findViewById(R.id.btncancel);
                            btncancel.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    dialoge.dismiss();
                                }
                            });

                            ImageView recipient_notset = (ImageView) dialoge.findViewById(R.id.recipient_notset);
                            ImageView recipient_set = (ImageView) dialoge.findViewById(R.id.recipient_set);

                            ImageView sender_notset = (ImageView) dialoge.findViewById(R.id.sender_notset);
                            ImageView sender_set = (ImageView) dialoge.findViewById(R.id.sender_set);

                            recipient_notset.setVisibility(View.VISIBLE);

                            sender_set.setVisibility(View.VISIBLE);

                            Button gotosettings = (Button) dialoge.findViewById(R.id.gotosettings);
                            gotosettings.setVisibility(View.GONE);
                            gotosettings.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup_Recipients.class);
                                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                    startActivity(intent);
//                                                                getActivity().finish();
                                    dialoge.dismiss();
                                }
                            });

                            Button gotosettings1 = (Button) dialoge.findViewById(R.id.gotosettings1);
                            gotosettings1.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup_Recipients.class);
                                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                    startActivity(intent);
//                                                                getActivity().finish();
                                    dialoge.dismiss();
                                }
                            });


                        }
                    }else {
                        Cursor cursoree = db1.rawQuery("SELECT * FROM Email_recipient", null);
                        if (cursoree.moveToFirst()){
                            //only sender not there
                            final Dialog dialoge = new Dialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);
                            dialoge.setContentView(R.layout.email_prerequisites);
                            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
                            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialoge.show();

                            ImageButton btncancel = (ImageButton) dialoge.findViewById(R.id.btncancel);
                            btncancel.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    dialoge.dismiss();
                                }
                            });

                            ImageView recipient_notset = (ImageView) dialoge.findViewById(R.id.recipient_notset);
                            ImageView recipient_set = (ImageView) dialoge.findViewById(R.id.recipient_set);

                            ImageView sender_notset = (ImageView) dialoge.findViewById(R.id.sender_notset);
                            ImageView sender_set = (ImageView) dialoge.findViewById(R.id.sender_set);

                            sender_notset.setVisibility(View.VISIBLE);

                            recipient_set.setVisibility(View.VISIBLE);

                            Button gotosettings = (Button) dialoge.findViewById(R.id.gotosettings);
                            gotosettings.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup.class);
                                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                    startActivity(intent);
//                                                                getActivity().finish();
                                    dialoge.dismiss();
                                }
                            });

                            Button gotosettings1 = (Button) dialoge.findViewById(R.id.gotosettings1);
                            gotosettings1.setVisibility(View.GONE);
                            gotosettings1.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup.class);
                                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                    startActivity(intent);
//                                                                getActivity().finish();
                                    dialoge.dismiss();
                                }
                            });

                        }else {
                            //both recipient and sender not there
                            final Dialog dialoge = new Dialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);
                            dialoge.setContentView(R.layout.email_prerequisites);
                            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
                            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialoge.show();

                            ImageButton btncancel = (ImageButton) dialoge.findViewById(R.id.btncancel);
                            btncancel.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    dialoge.dismiss();
                                }
                            });

                            ImageView recipient_notset = (ImageView) dialoge.findViewById(R.id.recipient_notset);
                            ImageView recipient_set = (ImageView) dialoge.findViewById(R.id.recipient_set);

                            ImageView sender_notset = (ImageView) dialoge.findViewById(R.id.sender_notset);
                            ImageView sender_set = (ImageView) dialoge.findViewById(R.id.sender_set);

                            recipient_notset.setVisibility(View.VISIBLE);
                            sender_notset.setVisibility(View.VISIBLE);

                            Button gotosettings = (Button) dialoge.findViewById(R.id.gotosettings);
                            gotosettings.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup.class);
                                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                    startActivity(intent);
//                                                                getActivity().finish();
                                    dialoge.dismiss();
                                }
                            });

                            Button gotosettings1 = (Button) dialoge.findViewById(R.id.gotosettings1);
                            gotosettings1.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View v) {
                                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup_Recipients.class);
                                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                    startActivity(intent);
//                                                                getActivity().finish();
                                    dialoge.dismiss();
                                }
                            });

                        }
                    }

                }
            }
        });

    }


    private class ExportDatabaseCSVTask extends AsyncTask<String, Void, Boolean> {
        private final ProgressDialog dialog = new ProgressDialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);

        @Override
        protected void onPreExecute() {

            this.dialog.setMessage(getString(R.string.setmessage13));
            this.dialog.show();

        }
        protected Boolean doInBackground(final String... args){

            File dbFile = getDatabasePath("mydb_Salesdata");
            //Log.v(TAG, "Db path is: "+dbFile);  //get the path of db

//            File exportDir = new File(Environment.getExternalStorageDirectory(), "/IVEPOS_reports/IVEPOS_Billwise_items_report");
//            if (!exportDir.exists()) {
//                exportDir.mkdirs();
//            }
//
//            File exportDir1 = new File(Environment.getExternalStorageDirectory(), "/IVEPOS_reports/IVEPOS_sales_report");
//            if (!exportDir1.exists()) {
//                exportDir1.mkdirs();
//            }

            File exportDir = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS), "/IVEPOS_reports/IVEPOS_Billwise_items_report");
            if (!exportDir.exists()) {
                exportDir.mkdirs();
            }

            File exportDir1 = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS), "/IVEPOS_reports/IVEPOS_sales_report");
            if (!exportDir1.exists()) {
                exportDir1.mkdirs();
            }

            file = new File(exportDir, "IvePOS_Billwise_items_report"+currentDateandTimee1+"_"+timee1+".csv");
            file1 = new File(exportDir1, "IvePOS_sales_report"+currentDateandTimee1+"_"+timee1+".csv");
            try {

                file.createNewFile();
                CSVWriter csvWrite = new CSVWriter(new FileWriter(file));

                // this is the Column of the table and same for Header of CSV file
                String arrStr1[] ={"Date", "Time", "User", "Bill count", "Bill no.", "Type", "Mode", "Table", "Itemname", "Qty.", "Individualprice", "Total price"};
                csvWrite.writeNext(arrStr1);

                db = openOrCreateDatabase("mydb_Salesdata",
                        Context.MODE_PRIVATE, null);
                Cursor curCSV = db.rawQuery("SELECT * FROM Generalorderlistascdesc1",null);
                //csvWrite.writeNext(curCSV.getColumnNames());

                while(curCSV.moveToNext())  {
                    String arrStr[] ={curCSV.getString(1), curCSV.getString(2), curCSV.getString(3), curCSV.getString(18), curCSV.getString(4), curCSV.getString(9),
                            curCSV.getString(8), curCSV.getString(12), curCSV.getString(10), curCSV.getString(11), curCSV.getString(13), curCSV.getString(17)};
//	                curCSV.getString(2),curCSV.getString(3),curCSV.getString(4),
                    csvWrite.writeNext(arrStr);

                }

                csvWrite.close();

                file1.createNewFile();
                CSVWriter csvWrite1 = new CSVWriter(new FileWriter(file1));

                // this is the Column of the table and same for Header of CSV file
                String arrStr11[] ={"Date", "Time", "User", "Bill count", "Bill no.", "Type", "Mode", "Table", "Subtotal", "Tax", "Discount", "Total"};
                csvWrite1.writeNext(arrStr11);

                db = openOrCreateDatabase("mydb_Salesdata",
                        Context.MODE_PRIVATE, null);
                Cursor curCSVv = db.rawQuery("SELECT * FROM Billnumber",null);
                //csvWrite.writeNext(curCSV.getColumnNames());

                if (curCSVv.moveToFirst())  {
                    do {
                        String billnos = curCSVv.getString(1);
                        Cursor curCSV1 = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno = '"+billnos+"'",null);
                        if (curCSV1.moveToFirst()){
                            String arrStr[] ={curCSV1.getString(1), curCSV1.getString(2), curCSVv.getString(3), curCSVv.getString(11), curCSVv.getString(1), curCSVv.getString(6),
                                    curCSVv.getString(5), curCSV1.getString(12), curCSVv.getString(7), curCSVv.getString(8), curCSV1.getString(7), curCSVv.getString(2)};
//	                curCSV.getString(2),curCSV.getString(3),curCSV.getString(4),
                            csvWrite1.writeNext(arrStr);
                        }
                        curCSV1.close();
                    }while (curCSVv.moveToNext());

                }
                curCSVv.close();
                csvWrite1.close();

                return true;

            }
            catch (IOException e){
                Log.e("MainActivity", e.getMessage(), e);
                return false;

            }

        }

        @Override
        protected void onPostExecute(final Boolean success)	{

            if (this.dialog.isShowing()){
                this.dialog.dismiss();
            }
            if (success){
                Toast.makeText(Cash_Card_Credit_Sales2.this, getString(R.string.export_successful), Toast.LENGTH_SHORT).show();
            }
            else {
                Toast.makeText(Cash_Card_Credit_Sales2.this, getString(R.string.export_failed), Toast.LENGTH_SHORT).show();
            }
        }
    }


    class DownloadMusicfromInternet extends AsyncTask<String, Void, Integer> {

        private ProgressDialog dialog = new ProgressDialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);


        @Override
        protected Integer doInBackground(String... params) {

            db.execSQL("delete from Cusotmer_activity_temp_top3");

            Cursor cursor8 = db.rawQuery("Select * from Customerdetails WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <= '" + editText2_filter.getText().toString() + "' GROUP BY phoneno", null);
            if (cursor8.moveToFirst()) {
                do {
                    String id = cursor8.getString(0);
                    String phon = cursor8.getString(2);
                    String name = cursor8.getString(1);
                    String email = cursor8.getString(3);
                    String addr = cursor8.getString(4);

                    ContentValues contentValues = new ContentValues();

                    contentValues.put("_id", id);
                    contentValues.put("name", name);
                    contentValues.put("phone_no", phon);
                    contentValues.put("email", email);
                    contentValues.put("addr", addr);

                    Cursor cursor2 = db.rawQuery("Select SUM(total_amount) from Customerdetails WHERE phoneno = '" + phon + "' AND datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <= '" + editText2_filter.getText().toString() + "' ", null);
                    if (cursor2.moveToFirst()) {
                        float dsirsq = cursor2.getFloat(0);
                        String rop = String.format("%.1f", dsirsq);

                        contentValues.put("total_amount", rop);
                    }
                    cursor2.close();

                    Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (sales_t.moveToFirst()) {
                        dsirsq1 = sales_t.getFloat(0);
                    }
                    sales_t.close();

                    Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (credit_t.moveToFirst()) {
                        dsirsq2 = credit_t.getFloat(0);
                    }
                    credit_t.close();

                    Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (deposi_t.moveToFirst()) {
                        dsirsq3 = deposi_t.getFloat(0);
                    }
                    deposi_t.close();

                    Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (cashout_t.moveToFirst()) {
                        dsirsq4 = cashout_t.getFloat(0);
                    }
                    cashout_t.close();
                    final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3);
                    String rop1 = String.format("%.1f", cal_sale);

                    contentValues.put("balance", rop1);

                    Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (set21w.moveToFirst()) {
                        dis_val = set21w.getString(29);
                        dis_status = set21w.getString(27);
                        dis_ty = set21w.getString(30);
                    }

                    TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv6.setText(dis_ty);

                    if (tv6.getText().toString().equals("") || tv6.getText().toString().equals("off")) {

                    } else {
                        //save value
                        contentValues.put("discount_value", dis_val);
                        contentValues.put("discount_type", dis_ty);

                    }

                    Cursor rating_cursor = db.rawQuery("SELECT SUM(percentage) FROM Cust_feedback WHERE cust_phoneno = '" + phon + "'", null);
                    if (rating_cursor.moveToFirst()) {
                        float dsirsq = rating_cursor.getFloat(0);
                        ropq = String.format("%.1f", dsirsq);

//                        float div = dsirsq/Float.parseFloat(total1);//check
                    }
                    rating_cursor.close();

                    Cursor rating_cursor1 = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '" + phon + "'", null);
                    int coun = rating_cursor1.getCount();

                    if (ropq.toString().equals("") || coun == 0) {

                    } else {
                        float divw = Float.parseFloat(ropq) / coun;
                        String rope = String.format("%.1f", divw);
                        contentValues.put("approval_rate", rope);
                    }
                    rating_cursor1.close();

                    db.insert("Cusotmer_activity_temp_top3", null, contentValues);

                } while (cursor8.moveToNext());
            }


            db.execSQL("delete from Cusotmer_activity_temp");

            Cursor cursor6 = db.rawQuery("Select * from Customerdetails GROUP BY phoneno ", null);
            if (cursor6.moveToFirst()) {
                do {
                    String id = cursor6.getString(0);
                    String phon = cursor6.getString(2);
                    String name = cursor6.getString(1);
                    String email = cursor6.getString(3);
                    String addr = cursor6.getString(4);

                    ContentValues contentValues = new ContentValues();

                    contentValues.put("_id", id);
                    contentValues.put("name", name);
                    contentValues.put("phone_no", phon);
                    contentValues.put("email", email);
                    contentValues.put("addr", addr);

                    Cursor cursor2 = db.rawQuery("Select SUM(total_amount) from Customerdetails WHERE phoneno = '" + phon + "' ", null);
                    if (cursor2.moveToFirst()) {
                        float dsirsq = cursor2.getFloat(0);
                        String rop = String.format("%.1f", dsirsq);

                        contentValues.put("total_amount", rop);
                    }
                    cursor2.close();

                    Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (sales_t.moveToFirst()) {
                        dsirsq1 = sales_t.getFloat(0);
                    }
                    sales_t.close();

                    Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (credit_t.moveToFirst()) {
                        dsirsq2 = credit_t.getFloat(0);
                    }
                    credit_t.close();

                    Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (deposi_t.moveToFirst()) {
                        dsirsq3 = deposi_t.getFloat(0);
                    }
                    deposi_t.close();

                    Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (cashout_t.moveToFirst()) {
                        dsirsq4 = cashout_t.getFloat(0);
                    }
                    cashout_t.close();
                    final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3);
                    String rop1 = String.format("%.1f", cal_sale);

                    contentValues.put("balance", rop1);

                    Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + phon + "'", null);
                    if (set21w.moveToFirst()) {
                        dis_val = set21w.getString(29);
                        dis_status = set21w.getString(27);
                        dis_ty = set21w.getString(30);
                    }

                    TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv6.setText(dis_ty);

                    if (tv6.getText().toString().equals("") || tv6.getText().toString().equals("off")) {

                    } else {
                        //save value
                        contentValues.put("discount_value", dis_val);
                        contentValues.put("discount_type", dis_ty);

                    }

                    Cursor rating_cursor = db.rawQuery("SELECT SUM(percentage) FROM Cust_feedback WHERE cust_phoneno = '" + phon + "'", null);
                    if (rating_cursor.moveToFirst()) {
                        float dsirsq = rating_cursor.getFloat(0);
                        ropq = String.format("%.1f", dsirsq);

//                        float div = dsirsq/Float.parseFloat(total1);//check
                    }
                    rating_cursor.close();

                    Cursor rating_cursor1 = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '" + phon + "'", null);
                    int coun = rating_cursor1.getCount();

                    if (ropq.toString().equals("") || coun == 0) {

                    } else {
                        float divw = Float.parseFloat(ropq) / coun;
                        String rope = String.format("%.1f", divw);
                        contentValues.put("approval_rate", rope);
                    }
                    rating_cursor1.close();

                    db.insert("Cusotmer_activity_temp", null, contentValues);

                } while (cursor6.moveToNext());
            }


            Cursor cursor5 = db.rawQuery("Select DISTINCT * from All_Sales WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <= '" + editText2_filter.getText().toString() + "' GROUP BY itemname ", null);//replace to cursor = dbHelper.fetchAllHotels();
            db.execSQL("delete from Itemwiseorderlistitems");
            if (cursor5.moveToFirst()) {
                do {

                    Itemtype = cursor5.getString(5);

                    if (Itemtype.toString().equals(getString(R.string.action_item))) {

                        itemtotal = cursor5.getString(1);

//                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                            row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT,
//                                    TableRow.LayoutParams.MATCH_PARENT, 1.0f));
//                            row.setGravity(Gravity.CENTER_VERTICAL);

                        db1 = Cash_Card_Credit_Sales2.this.openOrCreateDatabase("mydb_Appdata", Context.MODE_PRIVATE, null);
                        Cursor modcursor1 = db1.rawQuery("Select * from Items WHERE itemname = '" + itemtotal + "' ", null);
                        if (modcursor1.moveToFirst()) {

                            do {

                                id5 = modcursor1.getString(0);
                                final TextView tv0 = new TextView(Cash_Card_Credit_Sales2.this);
//                                tv0.setLayoutParams(new TableRow.LayoutParams(90, ViewGroup.LayoutParams.MATCH_PARENT));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
//                                tv0.setGravity(Gravity.CENTER);
//                                tv0.setTextSize(15);
//                                tv0.setTypeface(null, Typeface.NORMAL);
//                                tv0.setPadding(5, 0, 0, 0);
//                                tv0.setBackgroundResource(R.drawable.cell_shape);
                                //text = cursor.getString(1);
                                tv0.setText(id5);
                                //row.addView(tv0);

                                id5 = modcursor1.getString(0);
                                final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                tv.setLayoutParams(new TableRow.LayoutParams(180, ViewGroup.LayoutParams.MATCH_PARENT));
//                                //tv.setBackgroundResource(R.drawable.cell_shape);
//                                tv.setGravity(Gravity.CENTER);
//                                tv.setTextSize(15);
//                                tv.setTypeface(null, Typeface.NORMAL);
//                                tv.setPadding(5, 0, 0, 0);
//                                tv.setBackgroundResource(R.drawable.cell_shape);
                                //text = cursor.getString(1);
                                tv.setText(id5);
                                //row.addView(tv);
                            } while (modcursor1.moveToNext());
                        }
                        modcursor1.close();

                        final TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(260, ViewGroup.LayoutParams.MATCH_PARENT));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tv1.setGravity(Gravity.CENTER);
//                        tv1.setTextSize(15);
//                        tv1.setTypeface(null, Typeface.NORMAL);
//                        tv1.setPadding(5, 0, 0, 0);
//                        tv1.setBackgroundResource(R.drawable.cell_shape);
                        //text = cursor.getString(1);
                        tv1.setText(itemtotal);
                        //row.addView(tv1);

                        Cursor modcursor = db.rawQuery("Select SUM(total) from All_Sales WHERE itemname = '" + itemtotal + "' AND datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <= '" + editText2_filter.getText().toString() + "' GROUP BY itemname ", null);
                        if (modcursor.moveToFirst()) {

                            do {
                                level = modcursor.getInt(0);
                                total1 = String.valueOf(level);
                                final TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                                tv2.setLayoutParams(new TableRow.LayoutParams(150, ViewGroup.LayoutParams.MATCH_PARENT));
//                                //tv.setBackgroundResource(R.drawable.cell_shape);
//                                tv2.setGravity(Gravity.CENTER);
//                                tv2.setTextSize(15);
//                                tv2.setTypeface(null, Typeface.NORMAL);
//                                tv2.setPadding(5, 0, 0, 0);
//                                tv2.setBackgroundResource(R.drawable.cell_shape);
                                //text = cursor.getString(1);
                                tv2.setText(total1);
                                //row.addView(tv2);
                            } while (modcursor.moveToNext());
                        }
                        modcursor.close();

                        Cursor modcursorsor = db.rawQuery("Select SUM(quantity) from All_Sales WHERE itemname = '" + itemtotal + "' AND datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <= '" + editText2_filter.getText().toString() + "' GROUP BY itemname ", null);
                        if (modcursorsor.moveToFirst()) {

                            do {
                                level = modcursorsor.getInt(0);
                                total1quan = String.valueOf(level);
                                final TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                                tv2.setLayoutParams(new TableRow.LayoutParams(150, ViewGroup.LayoutParams.MATCH_PARENT));
//                                //tv.setBackgroundResource(R.drawable.cell_shape);
//                                tv2.setGravity(Gravity.CENTER);
//                                tv2.setTextSize(15);
//                                tv2.setTypeface(null, Typeface.NORMAL);
//                                tv2.setPadding(5, 0, 0, 0);
//                                tv2.setBackgroundResource(R.drawable.cell_shape);
                                //text = cursor.getString(1);
                                tv2.setText(total1quan);
                                //row.addView(tv2);
                            } while (modcursorsor.moveToNext());
                        }
                        modcursorsor.close();


                        Cursor cursorr11 = db.rawQuery("SELECT SUM(subtotal) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <= '" + editText2_filter.getText().toString() + "' ", null);
                        if (cursorr11.moveToFirst()) {
                            level = cursorr11.getInt(0);
                            total = String.valueOf(level);
                        }
                        cursorr11.close();

                        float perc = Float.parseFloat(total1) * 100 / Float.parseFloat(total);
                        String percen = String.format("%.2f", perc);

                        final TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(170, ViewGroup.LayoutParams.MATCH_PARENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv3.setGravity(Gravity.CENTER);
                        tv3.setTextSize(15);
                        tv3.setTypeface(null, Typeface.NORMAL);
                        tv3.setPadding(5, 0, 0, 0);
                        tv3.setBackgroundResource(R.drawable.cell_shape);
                        //text = cursor.getString(1);
                        tv3.setText(percen);
                        //row.addView(tv3);

                        ContentValues contentValues = new ContentValues();
                        contentValues.put("itemno", String.valueOf(id5));
                        contentValues.put("itemname", itemtotal);
                        contentValues.put("sales", total1);
                        contentValues.put("salespercentage", percen);
                        contentValues.put("itemtotalquan", total1quan);
                        db.insert("Itemwiseorderlistitems", null, contentValues);
                    }
                } while (cursor5.moveToNext());
            }


            final String Text = getlisting.getSelectedItem().toString();

            //dialog.dismiss();
//            if (Text.equals("Ascending") || Text.equals("Descending")) {
            Cursor cursor = db.rawQuery("Select DISTINCT * from All_Sales WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <= '" + editText2_filter.getText().toString() + "' GROUP BY bill_no ", null);//replace to cursor = dbHelper.fetchAllHotels();
            db.execSQL("delete from Generalorderlistascdesc1");
            if (cursor.moveToFirst()) {
                do {

                    billno = cursor.getString(11);

                    Cursor modcursor = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + billno + "' AND datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
                    if (modcursor.moveToFirst()) {
                        //level = modcursor.getString(2);
                        total1 = modcursor.getString(2);
                        //final TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                        tv2.setLayoutParams(new TableRow.LayoutParams(150, ViewGroup.LayoutParams.MATCH_PARENT));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tv2.setGravity(Gravity.CENTER);
//                        tv2.setTextSize(15);
//                        tv2.setTypeface(null, Typeface.NORMAL);
//                        tv2.setPadding(5, 0, 0, 0);
//                        tv2.setBackgroundResource(R.drawable.cell_shape);
//                        //text = cursor.getString(1);
//                        tv2.setText(total1);
                        //row.addView(tv2);

                    }
                    modcursor.close();

                    Cursor dis = db.rawQuery("Select * from Discountdetails WHERE billno = '" + billno + "' ", null);
                    if (dis.moveToFirst()) {
                        discount = dis.getString(7);
                    } else {
                        discount = "0";
                    }
                    dis.close();

                    Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + billno + "' ", null);
                    if (billtype.moveToFirst()) {
                        strpaymentmethod = billtype.getString(5);
                        strbilltype = billtype.getString(6);
                        bill_coun = billtype.getString(11);
                    }
                    billtype.close();

                    Cursor cardno = db.rawQuery("Select * from Cardnumber WHERE billnumber = '" + billno + "' ", null);
                    if (cardno.moveToFirst()) {
                        cardnum = cardno.getString(1);
                    } else {
                        cardnum = "";
                    }
                    cardno.close();


                    Cursor itemmnn = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billno + "' ", null);
                    if (itemmnn.moveToFirst()) {

                        do {
                            date = itemmnn.getString(25);
                            date11 = itemmnn.getString(13);
                            date111 = itemmnn.getString(26);

                            time = itemmnn.getString(12);

                            user = itemmnn.getString(45);

                            iittnn = itemmnn.getString(1);
                            iittnnquan = itemmnn.getString(2);
                            iittnntable = itemmnn.getString(15);
                            iittnnindprice = itemmnn.getString(3);
                            iittnnindtotalprice = itemmnn.getString(4);
                            iittnninddate = itemmnn.getString(33);
                            String add_sec = itemmnn.getString(12);

                            if (iittnninddate.toString().contains(":")) {
                                iittnninddate = iittnninddate.replace(":", "");
                            }

                            if (add_sec.toString().contains(":")) {
                                add_sec = add_sec.replace(":", "");
                            }

                            add_sec = add_sec.substring(4, 6);


                            ContentValues contentValues = new ContentValues();
                            contentValues.put("date", date);
                            contentValues.put("time", time);
                            contentValues.put("user", user);
                            contentValues.put("billno", billno);
                            contentValues.put("sales", total1);
                            contentValues.put("discountamount", discount);
                            contentValues.put("paymentmethod", strpaymentmethod);
                            contentValues.put("billtype", strbilltype);
                            contentValues.put("itemname", iittnn);
                            contentValues.put("quan", iittnnquan);
                            contentValues.put("tableid", iittnntable);
                            contentValues.put("individualprice", iittnnindprice);
                            contentValues.put("individualtotal", iittnnindtotalprice);
                            contentValues.put("billcount", bill_coun);
                            contentValues.put("date1", date11);
                            contentValues.put("datetimee", iittnninddate + "" + add_sec);
                            contentValues.put("cardnumber", cardnum);
                            db.insert("Generalorderlistascdesc1", null, contentValues);
                        } while (itemmnn.moveToNext());


                    }
                    itemmnn.close();
                } while (cursor.moveToNext());
            }
            cursor.close();
//            }


            Cursor user1 = db.rawQuery("SELECT * FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' GROUP BY user", null);
            db.execSQL("delete from userdata");
            if (user1.moveToFirst()){
                do {
                    String username = user1.getString(3);
                    Cursor maxi = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND user = '"+username+"'", null);
                    if (maxi.moveToFirst()){
                        do {
                            int mum = maxi.getInt(0);
                            String mumstr = String.valueOf(mum);
//                                Toast.makeText(getActivity(), "user is"+username+"total is "+mumstr, Toast.LENGTH_SHORT).show();
                            ContentValues contentValues = new ContentValues();
                            contentValues.put("username", username);
                            contentValues.put("total", mumstr);
                            db.insert("userdata", null, contentValues);

                        }while (maxi.moveToNext());
                    }
                }while (user1.moveToNext());
            }

            user1 = db.rawQuery("SELECT * FROM All_Sales WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' GROUP BY itemname", null);
            db.execSQL("delete from itemdata");
            if (user1.moveToFirst()){
                do {
                    String itemname = user1.getString(1);
                    Cursor maxi = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND itemname = '"+itemname+"'", null);
                    if (maxi.moveToFirst()){
                        do {
                            int mum = maxi.getInt(0);
                            String mumstr = String.valueOf(mum);

                            ContentValues contentValues = new ContentValues();
                            contentValues.put("itemname", itemname);
                            contentValues.put("total", mumstr);
                            db.insert("itemdata", null, contentValues);

                        }while (maxi.moveToNext());
                    }
                }while (user1.moveToNext());
            }



            return null;
        }

        // Show Progress bar before downloading Music
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            // Shows Progress Bar Dialog and then call doInBackground method
            //showDialog(progress_bar_type);

            dialog.setMessage("Loading");
            dialog.setCanceledOnTouchOutside(false);
            dialog.setCancelable(false);
//            dialog.setOnKeyListener(new DialogInterface.OnKeyListener() {
//                @Override
//                public boolean onKey(DialogInterface dialog, int keyCode, KeyEvent event) {
//                    if (keyCode == KeyEvent.KEYCODE_BACK) {
//                        //dialog.dismiss();
//                        //row.setBackgroundResource(0);
//                        return true;
//                    }
//                    return false;
//                }
//            });
            dialog.show();
        }


        // Once Music File is downloaded
        @Override
        protected void onPostExecute(Integer file_url) {
            dialog.dismiss();

            final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
            if (cursor_country1.moveToFirst()){
                str_country = cursor_country1.getString(1);
            }

            final String Text = getlisting.getSelectedItem().toString();

            //dialog.dismiss();
            if (Text.equals("All")) {
//                final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 GROUP By billno ORDER BY datetimee DESC";
                final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                // The desired columns to be bound
                final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "sales"};
                // the XML defined views which the data will be bound to
                //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
                final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                //Log.e("Checamos que hay id", String.valueOf(R.id.name));
                adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                listView.setAdapter(adapter);
                adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                    @Override
                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                        if (view.getId() == R.id.inn) {
                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                            TextView dateTextView = (TextView) view;
                            if (tadl_id.toString().equals("India")){
                                dateTextView.setText(insert1_cc);
                            }else {
                                dateTextView.setText(insert1_cc);
                            }
                            return true;
                        }
                        return false;
                    }
                });
                listView.setAdapter(adapter);

                adapter.setFilterQueryProvider(new FilterQueryProvider() {
                    public Cursor runQuery(CharSequence constraint) {
                        return fetchCountriesByName(constraint.toString());
                    }
                });
            }else {
                if (Text.equals("UPI QR")) {
                    final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' GROUP By billno ORDER BY datetimee DESC";

                    Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                    // The desired columns to be bound
                    final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                    final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                    adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                    listView.setAdapter(adapter);
                    adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                        @Override
                        public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                            if (view.getId() == R.id.inn) {
                                final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                TextView dateTextView = (TextView) view;
                                if (tadl_id.toString().equals("India")){
                                    dateTextView.setText(insert1_cc);
                                }else {
                                    dateTextView.setText(insert1_cc);
                                }
                                return true;
                            }
                            return false;
                        }
                    });
                    listView.setAdapter(adapter);

                    adapter.setFilterQueryProvider(new FilterQueryProvider() {
                        public Cursor runQuery(CharSequence constraint) {
                            return fetchCountriesByName_cash(constraint.toString());
                        }
                    });
                }else {
                    if (Text.equals("Mobikwik")) {
//                            listView1 = (ListView) findViewById(R.id.listView12);

                        final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Mobikwik' GROUP By billno ORDER BY datetimee DESC";

                        Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                        // The desired columns to be bound
                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);
                        adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                            @Override
                            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                if (view.getId() == R.id.inn) {
                                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                    TextView dateTextView = (TextView) view;
                                    if (tadl_id.toString().equals("India")){
                                        dateTextView.setText(insert1_cc);
                                    }else {
                                        dateTextView.setText(insert1_cc);
                                    }
                                    return true;
                                }
                                return false;
                            }
                        });
                        listView.setAdapter(adapter);

//                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                        // the XML defined views which the data will be bound to
//                        //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                        //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);

                        adapter.setFilterQueryProvider(new FilterQueryProvider() {
                            public Cursor runQuery(CharSequence constraint) {
                                return fetchCountriesByName_card(constraint.toString());
                            }
                        });
                    }else {
                        if (Text.equals("Freecharge")) {
                            cardlist.setVisibility(View.INVISIBLE); //0000
                            saleslist.setVisibility(View.VISIBLE);
                            creditlist.setVisibility(View.INVISIBLE);
//                            listView1 = (ListView) findViewById(R.id.listView12);

                            final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                            Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                            // The desired columns to be bound
                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);
                            adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                @Override
                                public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                    if (view.getId() == R.id.inn) {
                                        final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                        TextView dateTextView = (TextView) view;
                                        if (tadl_id.toString().equals("India")){
                                            dateTextView.setText(insert1_cc);
                                        }else {
                                            dateTextView.setText(insert1_cc);
                                        }
                                        return true;
                                    }
                                    return false;
                                }
                            });
                            listView.setAdapter(adapter);

//                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                            // the XML defined views which the data will be bound to
//                            //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                            //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);

                            adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                public Cursor runQuery(CharSequence constraint) {
                                    return fetchCountriesByName_free(constraint.toString());
                                }
                            });
                        } else {
                            cardlist.setVisibility(View.INVISIBLE);
                            saleslist.setVisibility(View.VISIBLE);
                            creditlist.setVisibility(View.INVISIBLE);

                            final String selectQuery = "SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC";

                            Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
                            // The desired columns to be bound
                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan", "quan"};
                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales, R.id.inn};
                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);
                            adapter.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                @Override
                                public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                    if (view.getId() == R.id.inn) {
                                        final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                        TextView dateTextView = (TextView) view;
                                        if (tadl_id.toString().equals("India")){
                                            dateTextView.setText(insert1_cc);
                                        }else {
                                            dateTextView.setText(insert1_cc);
                                        }
                                        return true;
                                    }
                                    return false;
                                }
                            });
                            listView.setAdapter(adapter);

//                        final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "cardnumber", "sales", "itemname", "quan"};
//                        // the XML defined views which the data will be bound to
//                        //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
//                        final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.cardno, R.id.sales};
//                        //Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                        adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_cardsales, cursor1, fromFieldNames, toViewsID, 0);
//                        listView.setAdapter(adapter);

                            adapter.setFilterQueryProvider(new FilterQueryProvider() {
                                public Cursor runQuery(CharSequence constraint) {
                                    return fetchCountriesByName_free(constraint.toString());
                                }
                            });
//                            cardlist.setVisibility(View.INVISIBLE);
//                            saleslist.setVisibility(View.INVISIBLE);
//                            creditlist.setVisibility(View.VISIBLE);
////                            listView1 = (ListView) findViewById(R.id.listView12);
//
//                            final String selectQuery = "SELECT * FROM Customerdetails WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' AND credit != ''";
//
//                            Cursor cursor1 = db.rawQuery(selectQuery, null);//replace to cursor = dbHelper.fetchAllHotels();
//                            // The desired columns to be bound
//                            final String[] fromFieldNames = {"date", "time", "user", "billcount", "billno", "sales", "itemname", "quan"};
//                            final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billcount, R.id.billno, R.id.sales};
//                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise, cursor1, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(adapter);
////                            final String[] fromFieldNames = {"date1", "time1", "billnumber", "rupees", "credit"};
////                            // the XML defined views which the data will be bound to
////                            //final int[] toViewsID = {R.id.date, R.id.time, R.id.user, R.id.billno, R.id.sales, R.id.billdetails, R.id.itemqqau};
////                            final int[] toViewsID = {R.id.date, R.id.time, R.id.billno, R.id.sales, R.id.credit};
////                            //Log.e("Checamos que hay id", String.valueOf(R.id.name));
////                            adapter = new SimpleCursorAdapter(Cash_Card_Credit_Sales2.this, R.layout.general_wise_creditsales, cursor1, fromFieldNames, toViewsID, 0);
////                            listView.setAdapter(adapter);
//
//                            adapter.setFilterQueryProvider(new FilterQueryProvider() {
//                                public Cursor runQuery(CharSequence constraint) {
//                                    return fetchCountriesByName_credit(constraint.toString());
//                                }
//                            });
                        }
                    }
                }
            }

            search.addTextChangedListener(new TextWatcher() {

                public void afterTextChanged(Editable s) {
                }

                public void beforeTextChanged(CharSequence s, int start,
                                              int count, int after) {
                }

                public void onTextChanged(CharSequence s, int start,
                                          int before, int count) {
                    adapter.getFilter().filter(s.toString());
                }
            });


        }

    }

    public Cursor fetchCountriesByName_cash(String inputtext) throws SQLException {
//        SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Card' GROUP By billno ORDER BY datetimee DESC
        Cursor mCursor = null;
        if (inputtext == null  ||  inputtext.length () == 0)  {
            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.query("Generalorderlistascdesc1", new String[] {"_id", "date", "time", "user", "billcount", "billno", "sales"},
//                    null, null, null, null, null);

        }
        else {
            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno LIKE '%" + inputtext + "%' AND paymentmethod = '  Upiqr' GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno LIKE '%" + inputtext + "%' GROUP BY billno ORDER BY datetimee DESC", null);
//            mCursor = db.query(true, "Generalorderlistascdesc1", new String[] {"date", "time", "user", "billcount", "billno", "sales"},
//                    "billno" + " like" + " '%" + inputtext + "%'", null,
//                    null, null, null, null);
        }
        if (mCursor != null) {
            mCursor.moveToFirst();
        }

        return mCursor;
    }

    public Cursor fetchCountriesByName_free(String inputtext) throws SQLException {
        Cursor mCursor = null;
        if (inputtext == null  ||  inputtext.length () == 0)  {
            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC", null);
        }
        else {
            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno LIKE '%" + inputtext + "%' AND paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC", null);
        }
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }

    public Cursor fetchCountriesByName_card(String inputtext) throws SQLException {
//        SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Card' GROUP By billno ORDER BY datetimee DESC
        Cursor mCursor = null;
        if (inputtext == null  ||  inputtext.length () == 0)  {
            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Mobikwik' GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.query("Generalorderlistascdesc1", new String[] {"_id", "date", "time", "user", "billcount", "billno", "sales"},
//                    null, null, null, null, null);

        }
        else {
            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno LIKE '%" + inputtext + "%' AND paymentmethod = '  Mobikwik' GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno LIKE '%" + inputtext + "%' GROUP BY billno ORDER BY datetimee DESC", null);
//            mCursor = db.query(true, "Generalorderlistascdesc1", new String[] {"date", "time", "user", "billcount", "billno", "sales"},
//                    "billno" + " like" + " '%" + inputtext + "%'", null,
//                    null, null, null, null);
        }
        if (mCursor != null) {
            mCursor.moveToFirst();
        }

        return mCursor;
    }

//    public Cursor fetchCountriesByName(String inputtext) throws SQLException {
////        Toast.makeText(Cash_Card_Credit_Sales2.this, "11 "+inputtext, Toast.LENGTH_SHORT).show();
//
//        Cursor mCursor = null;
//        if (inputtext == null  ||  inputtext.length () == 0)  {
////            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC", null);
////            mCursor = db.query("Generalorderlistascdesc1", new String[] {"_id", "date", "time", "user", "billcount", "billno", "sales"},
////                    null, null, null, null, null);
//
//        }
//        else {
//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno LIKE '%" + inputtext + "%' AND paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP BY billno ORDER BY datetimee DESC", null);
////            mCursor = db.query(true, "Generalorderlistascdesc1", new String[] {"date", "time", "user", "billcount", "billno", "sales"},
////                    "billno" + " like" + " '%" + inputtext + "%'", null,
////                    null, null, null, null);
//        }
//        if (mCursor != null) {
//            mCursor.moveToFirst();
//        }
//        return mCursor;
//    }


    public Cursor fetchCountriesByName(String inputtext) throws SQLException {
//        Toast.makeText(Cash_Card_Credit_Sales2.this, "11 "+inputtext, Toast.LENGTH_SHORT).show();

        Cursor mCursor = null;
        if (inputtext == null  ||  inputtext.length () == 0)  {
            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE (paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge') GROUP By billno ORDER BY datetimee DESC", null);

//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 GROUP By billno ORDER BY datetimee DESC", null);
//            mCursor = db.query("Generalorderlistascdesc1", new String[] {"_id", "date", "time", "user", "billcount", "billno", "sales"},
//                    null, null, null, null, null);

        }
        else {

//            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Cash' OR paymentmethod = '  Card' OR paymentmethod = '  Credit' AND billno LIKE '%\" + inputtext + \"%' GROUP BY billno ORDER BY datetimee DESC", null);

            mCursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE billno LIKE '%" + inputtext + "%' AND (paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge') GROUP BY billno ORDER BY datetimee DESC", null);
//            mCursor = db.query(true, "Generalorderlistascdesc1", new String[] {"date", "time", "user", "billcount", "billno", "sales"},
//                    "billno" + " like" + " '%" + inputtext + "%'", null,
//                    null, null, null, null);
        }
        if (mCursor != null) {
            mCursor.moveToFirst();
        }
        return mCursor;
    }


    public void email(Dialog dialog) {

        sdff2 = new SimpleDateFormat("ddMMMyy");
        currentDateandTimee1 = sdff2.format(new Date());

        Date dt1 = new Date();
        sdff1 = new SimpleDateFormat("hhmmssaa");
        timee1 = sdff1.format(dt1);

        imageViewPicture = (ImageView)dialog.findViewById(R.id.imageViewPicture);
        //imageViewPicture.setOnClickListener(this);
        //getimagee = (Button)findViewById(R.id.imageViewPicture1);
//        rbPaperWidth2 = (RadioButton) dialog.findViewById(R.id.radioButton2Inch);
//        rbPaperWidth3 = (RadioButton) dialog.findViewById(R.id.radioButton3Inch);
//        rbPaperWidth4 = (RadioButton) dialog.findViewById(R.id.radioButton4Inch);
        final RelativeLayout billaa = (RelativeLayout) dialog.findViewById(R.id.billa);

        billaa.setVisibility(View.VISIBLE);

        LinearLayout include = (LinearLayout)dialog.findViewById(R.id.include);
        final LinearLayout imageview = (LinearLayout)dialog.findViewById(R.id.imageview);

        mView = dialog.findViewById(R.id.f_view);


        db1 =   Cash_Card_Credit_Sales2.this.openOrCreateDatabase("mydb_Appdata", Context.MODE_PRIVATE, null);
        db =   Cash_Card_Credit_Sales2.this.openOrCreateDatabase("mydb_Salesdata", Context.MODE_PRIVATE, null);


        SimpleDateFormat normal = new SimpleDateFormat("dd MMM yy");
        final String normal1 = normal.format(new Date());

        Date dt = new Date();
        SimpleDateFormat sdf1 = new SimpleDateFormat("hh:mm:ss aa");
        final String time1 = sdf1.format(dt);


        Date dtt = new Date();
        SimpleDateFormat sdf1t = new SimpleDateFormat("yyyyMMddkk:mm:ss");
        String time24 = sdf1t.format(dtt);


        TableLayout tableLayoutt = (TableLayout) mView.findViewById(R.id.lytpedidooo);
        tableLayoutt.removeAllViews();


        TextView bilnumb = (TextView)mView.findViewById(R.id.billnumb);
        bilnumb.setText(String.valueOf(billnumb));

        TextView billid_value = (TextView)mView.findViewById(R.id.billid_value);
        billid_value.setText(String.valueOf(bill_coun));

        TextView datees = (TextView)mView.findViewById(R.id.date);
        datees.setText(datee);
        TextView timees = (TextView)mView.findViewById(R.id.time);
        timees.setText(timee);

        LinearLayout custadd = (LinearLayout)mView.findViewById(R.id.address);
        TextView custname = (TextView)mView.findViewById(R.id.cust_name);
        TextView custaddr = (TextView)mView.findViewById(R.id.cust_address);
        TextView custph = (TextView)mView.findViewById(R.id.cust_phno);
        TextView custema = (TextView)mView.findViewById(R.id.cust_emailid);

        LinearLayout comaddlogo = (LinearLayout)mView.findViewById(R.id.complogo);
        LinearLayout foott = (LinearLayout)mView.findViewById(R.id.foottt);

        TextView subtotoalam = (TextView)mView.findViewById(R.id.subtotal);
        TextView discpercent = (TextView)mView.findViewById(R.id.dispercent);
        TextView discval = (TextView)mView.findViewById(R.id.discount);
        TextView savingsval = (TextView)mView.findViewById(R.id.disc_savings);
        TextView taxvalue = (TextView)mView.findViewById(R.id.tax);
        TextView roundedoffvalue = (TextView)mView.findViewById(R.id.roundedoff);
        TextView total = (TextView)mView.findViewById(R.id.totalold);

        TextView compname = (TextView)mView.findViewById(R.id.compname);
        TextView compadd1 = (TextView)mView.findViewById(R.id.address1);
        TextView compadd2 = (TextView)mView.findViewById(R.id.address2);
        TextView compadd3 = (TextView)mView.findViewById(R.id.address3);
        TextView compphnoo = (TextView)mView.findViewById(R.id.phoneno);
        TextView compemail = (TextView)mView.findViewById(R.id.emailid);
        TextView compwebsite = (TextView)mView.findViewById(R.id.website);
        TextView comptaxlicen = (TextView)mView.findViewById(R.id.taxlineone);

        TextView tableidd = (TextView)mView.findViewById(R.id.tableid);
        TextView paymenttypee = (TextView)mView.findViewById(R.id.paymentmethod);
        TextView billtypee = (TextView)mView.findViewById(R.id.billtype);

        TextView foo = (TextView)mView.findViewById(R.id.footer);

        Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
        if (caddress.moveToFirst()){
            String nam = caddress.getString(1);
            String addr = caddress.getString(4);
            String phon = caddress.getString(2);
            String emai = caddress.getString(3);

            custadd.setVisibility(View.VISIBLE);
            if (nam.toString().length()>0){
                custname.setText(nam);
            }else {
                custname.setVisibility(View.GONE);
            }
            if (addr.toString().length()>0){
                custaddr.setText(addr);
            }else {
                custaddr.setVisibility(View.GONE);
            }
            if (phon.toString().length()>0){
                custph.setText(phon);
            }else {
                custph.setVisibility(View.GONE);
            }
            if (emai.toString().length()>0){
                custema.setText(emai);
            }else {
                custema.setVisibility(View.GONE);
            }


        }else {
            custadd.setVisibility(View.GONE);
        }

        db1 = Cash_Card_Credit_Sales2.this.openOrCreateDatabase("mydb_Appdata", Context.MODE_PRIVATE, null);
        Cursor compdetails = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (compdetails.moveToFirst()){
            compna = compdetails.getString(1);
            String add1 = compdetails.getString(14);
            String add2 = compdetails.getString(17);
            String add3 = compdetails.getString(18);
            String phonenum = compdetails.getString(2);
            String email = compdetails.getString(15);
            String web = compdetails.getString(16);
            String taxone = compdetails.getString(10);
            String footer = compdetails.getString(12);

            comaddlogo.setVisibility(View.VISIBLE);


            TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(compna);
            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(add1);
            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(add2);
            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(add3);
            TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(phonenum);
            TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(email);
            TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(web);
            TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(taxone);
            TextView tv8 = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(footer);

            if (!tv.getText().toString().equals("")) {
                compname.setText(compna);
            } else {
                compname.setVisibility(View.GONE);
            }
            if (!tv1.getText().toString().equals("")) {
                compadd1.setText(add1);
            } else {
                compadd1.setVisibility(View.GONE);

            }
            if (!tv2.getText().toString().equals("")) {
                compadd2.setText(add2);
            } else {
                compadd2.setVisibility(View.GONE);

            }
            if (!tv3.getText().toString().equals("")) {
                compadd3.setText(add3);
            } else {
                compadd3.setVisibility(View.GONE);

            }
            if (!tv4.getText().toString().equals("")) {
                compphnoo.setText(phonenum);
            } else {
                compphnoo.setVisibility(View.GONE);

            }
            if (!tv5.getText().toString().equals("")) {
                compemail.setText(email);
            } else {
                compemail.setVisibility(View.GONE);

            }
            if (!tv6.getText().toString().equals("")) {
                compwebsite.setText(web);
            } else {
                compwebsite.setVisibility(View.GONE);

            }
            if (!tv7.getText().toString().equals("")) {
                comptaxlicen.setText(taxone);
            } else {
                comptaxlicen.setVisibility(View.GONE);

            }
            if (!tv8.getText().toString().equals("")) {
                foott.setVisibility(View.VISIBLE);
                foo.setText(footer);
            } else {
                foott.setVisibility(View.GONE);
                foo.setVisibility(View.GONE);
            }


        }else {
            comaddlogo.setVisibility(View.GONE);
        }

        ImageView imageButton = (ImageView)mView.findViewById(R.id.viewImagee);
        String[] col={"companylogo"};
        Cursor c=db1.query("Logo", col, null, null, null, null, null);

        if(c.moveToFirst()){
            do{
                img=c.getBlob(c.getColumnIndex("companylogo"));
                final Bitmap b1= BitmapFactory.decodeByteArray(img, 0, img.length);
                imageButton.setImageBitmap(b1);
            }while(c.moveToNext());
        }else {
            imageButton.setVisibility(View.GONE);
        }



        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor3.moveToFirst()){
            sub = cursor3.getString(7);
            subtotoalam.setText(sub);
        }

        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '"+billnumb+"'", null);
        if (cursor4.moveToFirst()){
            String taxpe = cursor4.getString(5);
            discpercent.setText(taxpe);
        }

        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '"+billnumb+"'", null);
        if (cursor5.moveToFirst()){
            String dsirs = cursor5.getString(7);
            float dsirsq = Float.parseFloat(dsirs);
            String rop = String.format("%.2f", dsirsq);
            discval.setText(rop);
        }

        Cursor cursor51 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE bill_no = '"+billnumb+"' AND disc_thereornot = 'yes'", null);
        if (cursor51.moveToFirst()){
            float dsirsq = cursor51.getFloat(0);
            String rop = String.format("%.2f", dsirsq);
            savingsval.setText(rop);
        }

        Cursor cursor6 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
        if (cursor6.moveToFirst()){
            String sub = cursor6.getString(8);
            if (sub.equals("")){
                taxvalue.setText("0.0");
            }else {
                float vv = Float.parseFloat(sub);
                taxvalue.setText(String.format("%.2f", vv));
            }

        }

        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
        if (cursor7.moveToFirst()){
            String sub = cursor7.getString(9);
            roundedoffvalue.setText(sub);
        }

        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
        if (cursor8.moveToFirst()){
            String sub = cursor8.getString(2);
            total.setText(sub);

            String paymenttype = cursor8.getString(5);
            String billtype = cursor8.getString(6);

            paymenttypee.setText(paymenttype);
            billtypee.setText(billtype);
        }

        Cursor ccursor9 = db.rawQuery("Select * from All_Sales WHERE bill_no = '"+billnumb+"'", null);
        if (ccursor9.moveToFirst()){
            String tabid = ccursor9.getString(15);
            //tableidd.setText(tabid);

            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '"+tabid+"'", null);
            if (vbnm.moveToFirst()){
                assa1 = vbnm.getString(1);
                assa2 = vbnm.getString(2);
            }
            TextView cx = new TextView(Cash_Card_Credit_Sales2.this);
            cx.setText(assa1);
            if (cx.getText().toString().equals("")){
                tableidd.setText(assa2);
            }else {
                tableidd.setText(assa1);
            }

        }

        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursorr.moveToFirst()) {

            do {

                String nbg = ccursorr.getString(0);
                String name = ccursorr.getString(1);
                String value = ccursorr.getString(2);
                String pq = ccursorr.getString(5);
                String itna = ccursorr.getString(2);
                String pricee = ccursorr.getString(3);
                String tototot = ccursorr.getString(4);

                final String newid = ccursorr.getString(20);
                int padding_in_px;

                int padding_in_dp = 38;  // 34 dps
                final float scale1 = getResources().getDisplayMetrics().density;
                padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                if (pq.equals("Item")){
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));



                    final TableRow row1 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                    final TableRow row2 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));

                    //TableLayout.LayoutParams tableLayoutParams = new TableLayout.LayoutParams();
                    final TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
                    final TableLayout tableLayout_disc = new TableLayout(Cash_Card_Credit_Sales2.this);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    //tv.setTextSize(18);
                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv.setPadding(0, 0, 0, 0);
                    //text = ccursorr.getString(1);
                    tv.setText(value);
                    row.addView(tv);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv1.setTextSize(15);
                    //tv.setPadding(0, 0, 0, 0);
                    //text = ccursorr.getString(1);
                    tv1.setText(name);
                    String value1 = tv1.getText().toString();
                    row.addView(tv1);

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    //lp = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 4.5f);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tv2.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv2.append(value + "% " + name);
                    tv2.setText(pricee);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(R.color.black);
                    row.addView(tv2);

//                                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                                            //lp1 = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 1.5f);
//                                            textView1.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                                                    android.widget.TableRow.LayoutParams.WRAP_CONTENT, 1.5f));
//                                            //tv.setBackgroundResource(R.drawable.cell_shape);
//                                            textView1.setGravity(Gravity.RIGHT | Gravity.CENTER_VERTICAL);
//                                            textView1.setText(insert1_cc);
//                                            //textView1.setBackgroundResource(R.drawable.rs_border);
//                                            textView1.setPadding(0, 0, 5, 0);
//                                            //textView1.setTextColor(R.color.black);
//                                            textView1.setTextSize(14);
//                                            row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                    //tv3.setPadding(5, 0, 0, 0);
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tv2.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv2.setPadding(0, 0, 1, 0);
                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv3.setText(tototot);
                    //tv3.setTextColor(R.color.black);
                    //row.addView(tv3);



                    String value2 = tv3.getText().toString();

                    //tableLayoutt.addView(row);

                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                    if (modcursor.moveToFirst()){
                        do {

                            final String modiname = modcursor.getString(1);
                            final String modiquan = modcursor.getString(2);
                            String modiprice = modcursor.getString(3);
                            String moditotal = modcursor.getString(4);
                            final String modiid = modcursor.getString(0);

                            final TableRow tableRow11 = new TableRow(Cash_Card_Credit_Sales2.this);
                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                            final TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                            tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv.setGravity(Gravity.CENTER);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText("");
                            tableRow11.addView(tvv);

                            TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv4.setText(modiname);
                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv4);

                            TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv2.setPadding(0, 0, 1, 0);
                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv5.setText(modiprice);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv5);

                            TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv6.setText("");
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv6);


                            final TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv3.setPadding(0,0,10,0);
                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                            //row.addView(tv3);

                            row.removeView(tv8);

                            Cursor cursor41 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '"+billnumb+"'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                            if (cursor41.moveToFirst()){
                                float sub2a = cursor41.getFloat(0);
                                String sub2a1 = String.format("%.2f", sub2a);
                                ss = Float.parseFloat(sub2a1)+Float.parseFloat(tototot);
                                ss1 = String.valueOf(ss);
                                //Toast.makeText(Cash_Card_Credit_Sales2.this, "4 "+ss1, Toast.LENGTH_SHORT).show();
                            }

                            tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String numberr = tv.getText().toString();
                            float newmulr = Float.parseFloat(numberr);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(ss1);
                            row.addView(tv8);


                            tableLayout1.addView(tableRow11);
                        }while(modcursor.moveToNext());

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()){
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if(disc_there.toString().equals("no")){

                                }else {
                                    ///Toast.makeText(Cash_Card_Credit_Sales2.this, "aaa " +disc_vv, Toast.LENGTH_SHORT).show();

                                    final TableRow row_disc = new TableRow(Cash_Card_Credit_Sales2.this);
                                    row_disc.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
                                    //row_disc.setPadding(padding_in_px, padding_in_px1, padding_in_px, padding_in_px1);

                                    TextView textView2 = new TextView(Cash_Card_Credit_Sales2.this);
                                    textView2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 3.44f));
                                    textView2.setText("");
                                    row_disc.addView(textView2);

                                    disc_tv = new TextView(Cash_Card_Credit_Sales2.this);
                                    disc_tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.60f));
                                    disc_tv.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    disc_tv.setText("-" + disc_cursor.getString(31));
                                    disc_tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                    disc_tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                    row_disc.addView(disc_tv);

                                    tableLayout_disc.addView(row_disc);
                                }
                            }while(disc_cursor.moveToNext());
                        }

                    }
                    else {
                        tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        //tv3.setPadding(0, 0, 10, 0);
                        tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                        final String number = tv.getText().toString();
                        float newmul = Float.parseFloat(number);
                        //final float in = Float.parseFloat(cursor.getString(4));
                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                        //newmul = Integer.parseInt(multiply);
                        tv8.setText(String.valueOf(multiply));
                        row.addView(tv8);

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()){
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if(disc_there.toString().equals("no")){

                                }else {
                                    ///Toast.makeText(Cash_Card_Credit_Sales2.this, "aaa " +disc_vv, Toast.LENGTH_SHORT).show();

                                    final TableRow row_disc = new TableRow(Cash_Card_Credit_Sales2.this);
                                    row_disc.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
                                    //row_disc.setPadding(padding_in_px, padding_in_px1, padding_in_px, padding_in_px1);

                                    TextView textView2 = new TextView(Cash_Card_Credit_Sales2.this);
                                    textView2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 3.44f));
                                    textView2.setText("");
                                    row_disc.addView(textView2);

                                    disc_tv = new TextView(Cash_Card_Credit_Sales2.this);
                                    disc_tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.60f));
                                    disc_tv.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    disc_tv.setText("-" + disc_cursor.getString(31));
                                    disc_tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                    disc_tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                    row_disc.addView(disc_tv);

                                    tableLayout_disc.addView(row_disc);
                                }
                            }while(disc_cursor.moveToNext());
                        }
                    }

                    tableLayoutt.addView(row);

                    tableLayoutt.addView(tableLayout1);

                    tableLayoutt.addView(tableLayout_disc);

                }



            } while (ccursorr.moveToNext());
        }

        TableLayout tableLayout1 = (TableLayout) mView.findViewById(R.id.lytpedidoo);
        tableLayout1.removeAllViews();


        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor.moveToFirst()) {

            do {

                String name = ccursor.getString(10);
                String value = ccursor.getString(9);
                String pq = ccursor.getString(50);
                String itna = ccursor.getString(1);

                TextView name_1 = new TextView(Cash_Card_Credit_Sales2.this);
                name_1.setText(name);

                TextView value_1 = new TextView(Cash_Card_Credit_Sales2.this);
                value_1.setText(value);

                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None") ||
                        value_1.getText().toString().equals("")) {
//                if (value.toString().equals("0") || name.toString().equals("NONE") || name.toString().equals("None") || value.toString().equals("0.0")){

                }else {

//                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format("%.2f", vbn);
                    tv1.setText(value);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @@ " + bvn + "%" + "(" + itna + ")");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    float mul = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    float tota = mul;
                    String tota1 = String.format("%.2f", tota);
                    //tv3.setPadding(0,0,10,0);
                    tv3.setText(String.valueOf(tota1));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }


            } while (ccursor.moveToNext());
        }


        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor2.moveToFirst()) {

            do {

                String name = ccursor2.getString(35);
                String value = ccursor2.getString(36);
                String pq = ccursor2.getString(50);
                String itna = ccursor2.getString(1);

                TextView name_1 = new TextView(Cash_Card_Credit_Sales2.this);
                name_1.setText(name);

                TextView value_1 = new TextView(Cash_Card_Credit_Sales2.this);
                value_1.setText(value);

                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None") ||
                        value_1.getText().toString().equals("")) {
//                if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")){

                }else {

//                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setText(value);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @@ " + bvn + "%" + "(" + itna + ")");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                    float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    //tv3.setPadding(0,0,10,0);
                    tv3.setText(String.valueOf(tota1));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }


            } while (ccursor2.moveToNext());
        }
        ccursor2.close();


        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor3.moveToFirst()) {

            do {

                String name = ccursor3.getString(37);
                String value = ccursor3.getString(38);
                String pq = ccursor3.getString(50);
                String itna = ccursor3.getString(1);

                TextView name_1 = new TextView(Cash_Card_Credit_Sales2.this);
                name_1.setText(name);

                TextView value_1 = new TextView(Cash_Card_Credit_Sales2.this);
                value_1.setText(value);

                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None") ||
                        value_1.getText().toString().equals("")) {
//                if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")){

                }else {

//                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setText(value);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @@ " + bvn + "%" + "(" + itna + ")");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                    float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    //tv3.setPadding(0,0,10,0);
                    tv3.setText(String.valueOf(tota1));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }


            } while (ccursor3.moveToNext());
        }
        ccursor3.close();


        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor4.moveToFirst()) {

            do {

                String name = ccursor4.getString(39);
                String value = ccursor4.getString(40);
                String pq = ccursor4.getString(50);
                String itna = ccursor4.getString(1);

                TextView name_1 = new TextView(Cash_Card_Credit_Sales2.this);
                name_1.setText(name);

                TextView value_1 = new TextView(Cash_Card_Credit_Sales2.this);
                value_1.setText(value);

                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None") ||
                        value_1.getText().toString().equals("")) {
//                if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")){

                }else {

//                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setText(value);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @@ " + bvn + "%" + "(" + itna + ")");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                    float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    //tv3.setPadding(0,0,10,0);
                    tv3.setText(String.valueOf(tota1));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }


            } while (ccursor4.moveToNext());
        }
        ccursor4.close();

        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '"+billnumb+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor5.moveToFirst()) {

            do {

                String name = ccursor5.getString(41);
                String value = ccursor5.getString(42);
                String pq = ccursor5.getString(50);
                String itna = ccursor5.getString(1);

                TextView name_1 = new TextView(Cash_Card_Credit_Sales2.this);
                name_1.setText(name);

                TextView value_1 = new TextView(Cash_Card_Credit_Sales2.this);
                value_1.setText(value);

                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None") ||
                        value_1.getText().toString().equals("")) {
//                if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")){

                }else {

//                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setText(value);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @@ " + bvn + "%" + "(" + itna + ")");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                    float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    //tv3.setPadding(0,0,10,0);
                    tv3.setText(String.valueOf(tota1));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }


            } while (ccursor5.moveToNext());
        }
        ccursor5.close();


        String phon = "0";

        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
        if (caddress1.moveToFirst()) {
            phon = caddress1.getString(2);
        }

        TextView tvvs = new TextView(Cash_Card_Credit_Sales2.this);
        tvvs.setText(phon);


        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
        if (us_name1.moveToLast()){
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id there", Toast.LENGTH_LONG).show();
            String na53 = us_name1.getString(53);
            String na38 = us_name1.getString(38);
            String na39 = us_name1.getString(39);
            String na40 = us_name1.getString(40);
            String na41 = us_name1.getString(41);
            String na42 = us_name1.getString(42);
            String na43 = us_name1.getString(43);
            String na44 = us_name1.getString(44);
            String na45 = us_name1.getString(45);
            String na46 = us_name1.getString(46);
            String na47 = us_name1.getString(47);
            String na48 = us_name1.getString(48);
            String na49 = us_name1.getString(49);
            String na50 = us_name1.getString(50);
            String na51 = us_name1.getString(51);
            String na52 = us_name1.getString(52);
            String na38_value = us_name1.getString(54);
            String na39_value = us_name1.getString(55);
            String na40_value = us_name1.getString(56);
            String na41_value = us_name1.getString(57);
            String na42_value = us_name1.getString(58);
            String na43_value = us_name1.getString(59);
            String na44_value = us_name1.getString(60);
            String na45_value = us_name1.getString(61);
            String na46_value = us_name1.getString(62);
            String na47_value = us_name1.getString(63);
            String na48_value = us_name1.getString(64);
            String na49_value = us_name1.getString(65);
            String na50_value = us_name1.getString(66);
            String na51_value = us_name1.getString(67);
            String na52_value = us_name1.getString(68);

            String proc = us_name1.getString(69);

            TextView hid = new TextView(Cash_Card_Credit_Sales2.this);
            hid.setText(proc);

            if (hid.getText().toString().equals("off")){
                Cursor cursorr = null;
                if (billtypee.getText().toString().equals("  Dine-in") || billtypee.getText().toString().equals("  General") || billtypee.getText().toString().equals("  Others")){
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (billtypee.getText().toString().equals("  Takeaway") || billtypee.getText().toString().equals("  Main")){
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (billtypee.getText().toString().equals("  Home delivery")){
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.MONOSPACE);
//                                row.addView(tv);

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format("%.2f", vbn);
                        tv1.setText(value);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                        float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
                        float tota = mul;
                        String tota1 = String.format("%.2f", tota);
                        tv3.setText(String.valueOf(tota1));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);


                    } while (cursorr.moveToNext());
                }
            }else {

                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                    int i1 = 0;
                    if (i2 == 38) {
                        i1 = 54;
                    }
                    if (i2 == 39) {
                        i1 = 55;
                    }
                    if (i2 == 40) {
                        i1 = 56;
                    }
                    if (i2 == 41) {
                        i1 = 57;
                    }
                    if (i2 == 42) {
                        i1 = 58;
                    }
                    if (i2 == 43) {
                        i1 = 59;
                    }
                    if (i2 == 44) {
                        i1 = 60;
                    }
                    if (i2 == 45) {
                        i1 = 61;
                    }
                    if (i2 == 46) {
                        i1 = 62;
                    }
                    if (i2 == 47) {
                        i1 = 63;
                    }
                    if (i2 == 48) {
                        i1 = 64;
                    }
                    if (i2 == 49) {
                        i1 = 65;
                    }
                    if (i2 == 50) {
                        i1 = 66;
                    }
                    if (i2 == 51) {
                        i1 = 67;
                    }
                    if (i2 == 52) {
                        i1 = 68;
                    }


                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv.setGravity(Gravity.START);
                    tv.setTextSize(15);
                    //text = cursor.getString(1);
//                String v = na;

                    tv.setText(us_name1.getString(i2));


                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    //text = cursor.getString(1);
                    tv1.setText(us_name1.getString(i1));
                    String value1 = "0";
                    if (tv1.getText().toString().equals("")) {

                    } else {
                        value1 = tv1.getText().toString();
                    }


                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                    tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                    TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
                    float tota = mul;
                    String tota1 = String.format("%.2f", tota);
                    tv33.setText(String.valueOf(tota));
                    tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv33);

                    String value2 = tv33.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                    } else {
                        tableLayout1.addView(row);
                    }

                }
            }

        }else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id not there", Toast.LENGTH_LONG).show();
            Cursor cursorr = null;
            if (billtypee.getText().toString().equals("  Dine-in") || billtypee.getText().toString().equals("  General") || billtypee.getText().toString().equals("  Others")){
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (billtypee.getText().toString().equals("  Takeaway") || billtypee.getText().toString().equals("  Main")){
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (billtypee.getText().toString().equals("  Home delivery")){
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
            if (cursorr.moveToFirst()) {

                do {

                    String name = cursorr.getString(1);
                    String value = cursorr.getString(2);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.MONOSPACE);
//                                row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format("%.2f", vbn);
                    tv1.setText(value);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                    //tv2.setLayoutParams(lp);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @ " + bvn + "%");
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    //tv3.setPadding(0,0,10,0);
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
                    float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
                    float tota = mul;
                    String tota1 = String.format("%.2f", tota);
                    tv3.setText(String.valueOf(tota1));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);


                } while (cursorr.moveToNext());
            }
        }

//        ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
//        if (ccursor.moveToFirst()) {
//
//            do {
//
//                String name = ccursor.getString(1);
//                String value = ccursor.getString(2);
//
//                final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
//                        TableRow.LayoutParams.WRAP_CONTENT));
//                row.setGravity(Gravity.CENTER);
//
//                TableRow.LayoutParams lp, lp1, lp2;
//
////                                final TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
////                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                tv.setTextSize(16);
////                                tv.setTypeface(Typeface.MONOSPACE);
////                                row.addView(tv);
//
//                TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
//                tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                //tv.setBackgroundResource(R.drawable.cell_shape);
//                tvv.setGravity(Gravity.START);
//                tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                tvv.setText(name);
//
//                TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
//                tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                tv1.setGravity(Gravity.START);
//                tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                float vbn = Float.parseFloat(value);
//                String bvn = String.format("%.2f", vbn);
//                tv1.setText(value);
//                tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                String value1 = tv1.getText().toString();
//
//                TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
//                //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
//                //tv2.setLayoutParams(lp);
//                tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
//                tv2.append(name + " @ " + bvn + "%");
//                tv2.setPadding(0, 0, 20, 0);
//                tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                row.addView(tv2);
//
//                TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                row.addView(textView1);
//
//                TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
////                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
////                tv3.setLayoutParams(lp2);
//                tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                //tv3.setPadding(0,0,10,0);
//                tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                tv3.setGravity(Gravity.END|Gravity.CENTER_VERTICAL);
//                float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                float tota = mul;
//                String tota1 = String.format("%.2f", tota);
//                tv3.setText(String.valueOf(tota1));
//                //row.addView(tv3);
//
//
//                tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                String value2 = tv3.getText().toString();
//                row.addView(tv3);
//
//                tableLayout1.addView(row);
//
//
//            } while (ccursor.moveToNext());
//        }


        mView.setDrawingCacheEnabled(true);
        mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
                View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
        mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
        mView.buildDrawingCache(true);
        include.setVisibility(View.INVISIBLE);
        imageview.setVisibility(View.INVISIBLE);

        imageview.setVisibility(View.INVISIBLE);
        Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
        mView.setDrawingCacheEnabled(false);
        ByteArrayOutputStream bytes = new ByteArrayOutputStream();
        b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);

        imageViewPicture.setImageBitmap(b);

        Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
                .getBitmap();

        Drawable d = new BitmapDrawable(getResources(), mBitmap);


//        File exportDir = new File(Environment.getExternalStorageDirectory(), "/IVEPOS_bills");
//        if (!exportDir.exists()) {
//            exportDir.mkdirs();
//        }
        File exportDir = new File(Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS), "/IVEPOS_bills");
        if (!exportDir.exists()) {
            exportDir.mkdirs();
        }


        file = new File(exportDir, "IvePOS_bill_"+currentDateandTimee1+"_"+timee1+".jpeg");

        try {
            FileOutputStream ostream = new FileOutputStream(file);
            mBitmap.compress(Bitmap.CompressFormat.PNG, 10, ostream);
            ostream.close();
        }
        catch (Exception e){
            e.printStackTrace();
        }

//        String query = null;
//        try {
//            query = URLEncoder.encode("apples oranges", "utf-8");
//        } catch (UnsupportedEncodingException e) {
//            e.printStackTrace();
//        }

        TextView textView = new TextView(Cash_Card_Credit_Sales2.this);
        textView.setText(R.string.my_url);
        String url = "www.intuitionsoftwares.com";

        String reqUrl = "http://google.com";
        Uri.Builder builder = Uri.parse(reqUrl).buildUpon();
        builder.appendQueryParameter("mesg", "Value for mesg");
        String finalUri = builder.build().toString();

//        final String msg = "Bill from "+compna+"\n\nDear Customer, \n\nYou can view the bill in the attachment for "+"Rs. "+total.getText().toString()+".\n\nWe appreciate your business and hope to see you again soon. \n"+compna+"\n\n\n" +
//                "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
//                "Powered by: "+ Uri.parse(url);


        //keep html code


        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcom.moveToFirst()) {
            do {
                strcompanyname = getcom.getString(1);
                straddress1 = getcom.getString(14);
                stremailid = getcom.getString(15);
            } while (getcom.moveToNext());
        }else {
            strcompanyname = "";
            stremailid = "";
        }

        String name_mail = "";
        Cursor em = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
        if (em.moveToFirst()){
            name_mail = em.getString(1);
        }

        String date_mail = "", time_mail = "";
        Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"'", null);
        if (cursor9.moveToFirst()){
            date_mail = cursor9.getString(25);
            time_mail = cursor9.getString(12);
        }


//            String msg = "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
//                    "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
//                    "Powered by: " + Uri.parse(url);

        String sub = "";
        Cursor cursor81 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
        if (cursor81.moveToFirst()){
            sub = cursor81.getString(2);
        }

//        final String msg =
//                "<Html>" +
//                        "<Body>" +
//                        "<div>" +
//                        " <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
//                        "<tbody>" +
//                        "<tr>" +
//                        "<td width=\"100%\" valign=\"top\" bgcolor=\"#f8f8f8\">" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1;margin-top:50px\">" +
//                        "<tbody>" +
//                        "<tr>" +
//                        "<td width=\"460\" >" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
//                        "<tbody>" +
//                        "<tr>" +
//                        "<td height=\"30\">" +
//                        "</td>" +
//                        "</tr>" +
//                        "</tbody>" +
//                        "</table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
//                        "<tbody>" +
//                        "<tr>" +
//                        "<td width=\"40\">" +
//                        "</td>" +
//                        "<td width=\"460\" style=\"font-size:16px;color:#00929f;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
////                        "<img src=\"http://www.intuitionsoftwares.com/resources/intuition_logo_header_with_text_240.png\" width=\"200\" style=\"margin:0 0 20px 0;width:200px\">" +
////                        "<img src="+logo+" width=\"200\" style=\"margin:0 0 20px 0;width:200px\">" +
//                        "<p><h1>"+strcompanyname+"</h1></p>" +
//
//                        "</td>" +
//                        "<td width=\"40\">" +
//                        "</td>" +
//                        "</tr>" +
//                        "<tr>" +
//                        "<td width=\"40\">" +
//                        "</td>" +
//                        "<td width=\"460\" style=\"font-size:16px;color:#b8b9c1;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
//                        "<span style=\"text-decoration:none;color:#2f2f36;font-weight:bold;font-size:32px;line-height:32px\">Bill "+billnumb+"</span><br>" +
//                        "</td>" +
//                        "<td width=\"40\"></td>" +
//                        "</tr>" +
//                        "<tr>" +
//                        "<td width=\"40\"></td>" +
//                        "<td width=\"460\" style=\"font-size:16px;color:#a0a0a5;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">for Customer <br> from <b>"+strcompanyname+"</b><br>" +
//                        " </td>" +
//                        "<td width=\"40\">" +
//                        "</td>" +
//                        "</tr>" +
//                        "<tr></tr>" +
//                        "<tr><td width=\"40\"></td>" +
//                        "<td width=\"512\" height=\"30\">" +
//                        "</td> <td width=\"40\"></td></tr></tbody></table></td>" +
//                        "</tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" bgcolor=\"#ffffff\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
//                        "<tbody><tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
//                        "<tr><td width=\"460\" height=\"5\" bgcolor=\"#ffffff\"></td></tr>" +
//                        "<tr><td width=\"460\" height=\"1\" bgcolor=\"#e1e1e1\"></td></tr>" +
//                        "<tr><td width=\"460\" height=\"10\" bgcolor=\"#ffffff\"></td></tr></tbody></table></td></tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\"><tbody>" +
//                        "<tr> <td width=\"460\">" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td height=\"20\"></td></tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
//                        "<td width=\"40\"></td><td width=\"510\" style=\"font-size:14px;color:#444;font-weight:normal;text-align:left;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">Hi "+name_mail+",<br>Your Bill amount is Rs."+sub.toString()+" <br><br>We appreciate your Business and hope to see you again soon,<br>Intuition Systems <br>" +
//                        //Correct(tic) symbol
//                        "<p align=\"center\"> <img src=\"https://http://www.intuitionsoftwares.com/resources/ic_tick_gradientgreen_48dp.png\" width=\"60\" height=\"60\"></p>" +
//
//                        "<p style=\"font-size:18px;border-top:1px solid #e1e1e1;border-bottom:1px solid #e1e1e1;padding:10px 0;background:#fefefe;text-align:center;margin:5px 0\">Paid: <span style=\"white-space:nowrap;font-weight:bold;font-size:18px\">Rs. "+sub.toString()+" </span>" +
//                        "</p><br></td><td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
//                        "<tbody>" +
//                        "<tr><td width=\"\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
//                        "<td width=\"40\"></td>" +
//                        "<td width=\"510\" style=\"font-size:14px;color:#a0a0a5;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
//                        "<div></div>" +
//                        "<p style=\"margin-top:3px;color:#444\">Dated: <span style=\"white-space:nowrap;font-weight:bold;font-size:14px\">"+date_mail+",</span> "+time_mail+" </p>" +
//                        "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td><td width=\"512\" height=\"10\"></td>" +
//                        "<td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
//                        "<tbody><tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td width=\"460\" height=\"10\"></td></tr></tbody></table></td></tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#f9f9f9\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1\"><tbody>" +
//                        "<tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
//                        "<tr><td height=\"10\" ></td></tr></tbody></table><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
//                        "<tbody><tr><td width=\"40\"></td><td width=\"460\" style=\"font-size:16px;color:#b8b9c1;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
//                        "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td>" +
//                        "<td width=\"460\" style=\"font-size:14px;color:#959599;font-weight:normal;font-family:Helvetica,Arial,sans-serif;line-height:20px;text-align:center\">" +
//                        "<p>Disclaimer: This information may be confidential and is intended only for the recipient.</p>" +
//                        "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td><td width=\"512\" height=\"10\"></td><td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
//                        "<table width=\"462\" bgcolor=\"#f0f0f0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1\">" +
//                        "<tbody> <tr> <td width=\"462\" height=\"10\"></td></tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
//                        "<tbody> <tr> <td width=\"460\" bgcolor=\"#f0f0f0\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
//                        "<tbody> <tr> <td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
//                        "<tr><td width=\"30\"></td><td width=\"530\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" ><tbody><tr>" +
//                        "<td height=\"0\" align=\"center\" style=\"font-size:14px;color:#b8b9c1;font-weight:normal;font-family:Helvetica,Arial,sans-serif;line-height:24px\">" +
//                        "<p><a style=\"text-decoration:none;color:#959599\" target=\"_blank\">If you think this mail is not for you, please delete and contact<a href=\"mailto:"+stremailid+"\" style=\"text-decoration:none;color:#008f9b;font-weight:bold\" target=\"_blank\">\n" +
//                        ""+stremailid+"</a> </a></td>" +
//                        "</tr></tbody></table><table width=\"140\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"left\">" +
//                        "<tbody><tr><td width=\"140\"></td></tr></tbody></table></td><td width=\"30\"></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
//                        "<td width=\"460\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-bottom:1px solid #e1e1e1;border-radius:0 0 10px 10px;background:#f0f0f0\">" +
//                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td height=\"14\"></td></tr></tbody></table></td></tr></tbody></table><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
//                        "<tbody><tr><td height=\"20\"></td></tr><tr>" +
//                        "<td style=\"text-align:center\"><a href=\"http://www.intuitionsoftwares.com/\" target=\"_blank\" ><img src=\"https://http://www.intuitionsoftwares.com/resources/Powered%20by%20Intuition.png\" alt=\"Powered by Intuition\" border=\"0\" style=\"text-align:center;min-width:65px\"></a></td></tr>" +
//                        "<tr>" +
//                        "<td height=\"40\" style=\"line-height:1px\"></td></tr></tbody></table></td></tr></tbody></table><div><div>" +
//                        "</div></div><span></span><img width=\"1px\" height=\"1px\" alt=\"\" src=\"https://ci6.googleusercontent.com/proxy/v_Shs6iOLq12vwu0Xt6qngxx4kneWRfK5sqTLGcXNVHFoKVZ7lS25nHt7H1Jm2usy7rNYKDLkgiPnf-6WwR9Yr0RCUdQGIUR6UAzInSh4IrJBqQk62YtXVDscuCYMCes1p7ddQyWrPxBcb46UqOG8GZUToV8KTB0InbN_nhjjaBySA-Eqsgb7FQUv71BB8c9vjZIesQTibEyktzooZmRj0q-8JfvlIrF5j5PjutWDHROpXD5l5f1J8DthU5s3aqJVnp_My3uDAuVgualRg=s0-d-e1-ft#http://email.mg.waveapps.com/o/eJwNzDEOwyAMAMDXlA1kU8Aw8BjXBAUpgYoQ9fvNdtOVTFUSW9WyBSQIQOgfWYNgIZlIFPHl4DtH0SyytOz90IBqz4SONw8hfAQ9hhgLvD2nJLE4TraqmblzL4afoPV1t9VGv0ZdP57bZWScf2cRJRo\" ><div></div><div></div></div>" +
//                        "</Body>" +
//                        "</Html>";

        final String msg =
                "<Html>" +
                        "<Body>" +
                        "<div>" +
                        " <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                        "<tbody>" +
                        "<tr>" +
                        "<td width=\"100%\" valign=\"top\" bgcolor=\"#f8f8f8\">" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1;margin-top:50px\">" +
                        "<tbody>" +
                        "<tr>" +
                        "<td width=\"460\" >" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                        "<tbody>" +
                        "<tr>" +
                        "<td height=\"30\">" +
                        "</td>" +
                        "</tr>" +
                        "</tbody>" +
                        "</table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                        "<tbody>" +
                        "<tr>" +
                        "<td width=\"40\">" +
                        "</td>" +
                        "<td width=\"460\" style=\"font-size:16px;color:#00929f;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
//                        "<img src=\"http://www.intuitionsoftwares.com/resources/intuition_logo_header_with_text_240.png\" width=\"200\" style=\"margin:0 0 20px 0;width:200px\">" +
//                        "<img src="+logo+" width=\"200\" style=\"margin:0 0 20px 0;width:200px\">" +
                        "<p><h1>"+strcompanyname+"</h1></p>" +

                        "</td>" +
                        "<td width=\"40\">" +
                        "</td>" +
                        "</tr>" +
                        "<tr>" +
                        "<td width=\"40\">" +
                        "</td>" +
                        "<td width=\"460\" style=\"font-size:16px;color:#b8b9c1;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
                        "<span style=\"text-decoration:none;color:#2f2f36;font-weight:bold;font-size:32px;line-height:32px\">Bill "+billnumb+"</span><br>" +
                        "</td>" +
                        "<td width=\"40\"></td>" +
                        "</tr>" +
                        "<tr>" +
                        "<td width=\"40\"></td>" +
                        "<td width=\"460\" style=\"font-size:16px;color:#a0a0a5;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">for Customer <br> from <b>"+strcompanyname+"</b><br>" +
                        " </td>" +
                        "<td width=\"40\">" +
                        "</td>" +
                        "</tr>" +
                        "<tr></tr>" +
                        "<tr><td width=\"40\"></td>" +
                        "<td width=\"512\" height=\"30\">" +
                        "</td> <td width=\"40\"></td></tr></tbody></table></td>" +
                        "</tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" bgcolor=\"#ffffff\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                        "<tbody><tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
                        "<tr><td width=\"460\" height=\"5\" bgcolor=\"#ffffff\"></td></tr>" +
                        "<tr><td width=\"460\" height=\"1\" bgcolor=\"#e1e1e1\"></td></tr>" +
                        "<tr><td width=\"460\" height=\"10\" bgcolor=\"#ffffff\"></td></tr></tbody></table></td></tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\"><tbody>" +
                        "<tr> <td width=\"460\">" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td height=\"20\"></td></tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
                        "<td width=\"40\"></td><td width=\"510\" style=\"font-size:14px;color:#444;font-weight:normal;text-align:left;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">Hi "+name_mail+",<br>Your Bill amount is "+insert1_rs+""+sub.toString()+" <br><br>We appreciate your Business and hope to see you again soon,<br>"+strcompanyname+" <br>" +
                        //Correct(tic) symbol
                        "<p align=\"center\"> <img src=\"https://static.wixstatic.com/media/ff8d82_453b1bed7c174e398e9fc333af3692bf~mv2.png\" width=\"60\" height=\"60\"></p>" +

                        "<p style=\"font-size:18px;border-top:1px solid #e1e1e1;border-bottom:1px solid #e1e1e1;padding:10px 0;background:#fefefe;text-align:center;margin:5px 0\">Paid: <span style=\"white-space:nowrap;font-weight:bold;font-size:18px\">"+insert1_rs+" "+sub.toString()+" </span>" +
                        "</p><br></td><td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                        "<tbody>" +
                        "<tr><td width=\"\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
                        "<td width=\"40\"></td>" +
                        "<td width=\"510\" style=\"font-size:14px;color:#a0a0a5;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
                        "<div></div>" +
                        "<p style=\"margin-top:3px;color:#444\">Dated: <span style=\"white-space:nowrap;font-weight:bold;font-size:14px\">"+date_mail+",</span> "+time_mail+" </p>" +
                        "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td><td width=\"512\" height=\"10\"></td>" +
                        "<td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                        "<tbody><tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td width=\"460\" height=\"10\"></td></tr></tbody></table></td></tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#f9f9f9\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1\"><tbody>" +
                        "<tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
                        "<tr><td height=\"10\" ></td></tr></tbody></table><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                        "<tbody><tr><td width=\"40\"></td><td width=\"460\" style=\"font-size:16px;color:#b8b9c1;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
                        "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td>" +
                        "<td width=\"460\" style=\"font-size:14px;color:#959599;font-weight:normal;font-family:Helvetica,Arial,sans-serif;line-height:20px;text-align:center\">" +
                        "<p>Disclaimer: This information may be confidential and is intended only for the recipient.</p>" +
                        "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td><td width=\"512\" height=\"10\"></td><td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
                        "<table width=\"462\" bgcolor=\"#f0f0f0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1\">" +
                        "<tbody> <tr> <td width=\"462\" height=\"10\"></td></tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                        "<tbody> <tr> <td width=\"460\" bgcolor=\"#f0f0f0\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                        "<tbody> <tr> <td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
                        "<tr><td width=\"30\"></td><td width=\"530\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" ><tbody><tr>" +
                        "<td height=\"0\" align=\"center\" style=\"font-size:14px;color:#b8b9c1;font-weight:normal;font-family:Helvetica,Arial,sans-serif;line-height:24px\">" +
                        "<p><a style=\"text-decoration:none;color:#959599\" target=\"_blank\">If you think this mail is not for you, please delete and contact<a href=\"mailto:"+stremailid+"\" style=\"text-decoration:none;color:#008f9b;font-weight:bold\" target=\"_blank\">\n" +
                        ""+stremailid+"</a> </a></td>" +
                        "</tr></tbody></table><table width=\"140\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"left\">" +
                        "<tbody><tr><td width=\"140\"></td></tr></tbody></table></td><td width=\"30\"></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
                        "<td width=\"460\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-bottom:1px solid #e1e1e1;border-radius:0 0 10px 10px;background:#f0f0f0\">" +
                        "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td height=\"14\"></td></tr></tbody></table></td></tr></tbody></table><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                        "<tbody><tr><td height=\"20\"></td></tr><tr>" +
                        "<td style=\"text-align:center\"><a href=\"http://www.intuitionsoftwares.com/\" target=\"_blank\" ><img src=\"www.intuitionsoftwares.com/resources/Powered%20by%20Intuition.png\" alt=\"Powered by Intuition\" border=\"0\" style=\"text-align:center;min-width:65px\"></a></td></tr>" +
                        "<tr>" +
                        "<td height=\"40\" style=\"line-height:1px\"></td></tr></tbody></table></td></tr></tbody></table><div><div>" +
                        "</div></div><span></span><div></div><div></div></div>" +
                        "</Body>" +
                        "</Html>";



        Uri u1  =   null;
        u1  =   Uri.fromFile(file);

//                Intent emailIntent = new Intent(android.content.Intent.ACTION_SEND);
//                emailIntent.setType("image/jpeg");
//                emailIntent.putExtra(Intent.EXTRA_EMAIL, u1);
//                startActivity(Intent.createChooser(emailIntent, "Send mail..."));

        billaa.setVisibility(View.GONE);

//        Intent emailIntent = new Intent(Intent.ACTION_SENDTO);
//        emailIntent.setData(Uri.parse("mailto:"));
//        emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, compna);
//        emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, msg);
//
////                emailIntent.setType("image/jpeg");
////                emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL, new String[]{to});
////                emailIntent.putExtra(android.content.Intent.EXTRA_SUBJECT, subj);
////                emailIntent.putExtra(android.content.Intent.EXTRA_TEXT, msg);
//        emailIntent.putExtra(Intent.EXTRA_STREAM, u1);
//        startActivity(Intent.createChooser(emailIntent, "Send mail..."));

//        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
//        Cursor em = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
//        if (em.moveToFirst()){
//            String em1 = em.getString(3);
//            email_id_send = new EditText(Cash_Card_Credit_Sales2.this);
//            email_id_send.setText(em1);
//            getResultsFromApi();
//            new MakeRequestTask_bill(mCredential).execute();
////            Toast.makeText(Cash_Card_Credit_Sales2.this, "email is "+em1, Toast.LENGTH_LONG).show();
//        }else {
////            Toast.makeText(Cash_Card_Credit_Sales2.this, "show dialog", Toast.LENGTH_LONG).show();
//
//            final Dialog dialogenteremail = new Dialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);
//            dialogenteremail.setContentView(R.layout.dialog_payment_enter_email);
//            dialogenteremail.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
//            dialogenteremail.setCanceledOnTouchOutside(false);
//            dialogenteremail.show();
//
//            ImageView btncancel = (ImageView) dialogenteremail.findViewById(R.id.btncancel);
//            btncancel.setOnClickListener(new View.OnClickListener() {
//                @Override
//                public void onClick(View v) {
//                    dialogenteremail.dismiss();
//                }
//            });
//
//            final TextInputLayout email_id_send_layout = (TextInputLayout) dialogenteremail.findViewById(R.id.email_id_send_layout);
//
//            email_id_send = (EditText) dialogenteremail.findViewById(R.id.email_id_send);
//
//            email_id_send.addTextChangedListener(new TextWatcher() {
//                @Override
//                public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {
//
//                }
//
//                @Override
//                public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
//                    email_id_send_layout.setError(null);
//                }
//
//                @Override
//                public void afterTextChanged(Editable editable) {
//
//                }
//            });
//
//            ImageView closetext = (ImageView) dialogenteremail.findViewById(R.id.closetext);
//            closetext.setOnClickListener(new View.OnClickListener() {
//                @Override
//                public void onClick(View v) {
//                    if (email_id_send.getText().toString().trim().matches(emailPattern))
//                    {
//                        getResultsFromApi();
//                        new MakeRequestTask_bill(mCredential).execute();
//                        dialogenteremail.dismiss();
//                    }
//                    else
//                    {
//                        email_id_send_layout.setError("Invalid email address");
//                    }
//
//                }
//            });
//        }

        Cursor getcommm = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcommm.moveToFirst()) {
            strcompanyname = getcommm.getString(1);
        }else {
            strcompanyname = "";
        }

        Cursor cursore = db1.rawQuery("SELECT * FROM Email_setup", null);
        if (cursore.moveToFirst()){
            final String un = cursore.getString(1);
            final String pwd = cursore.getString(2);
            final String client = cursore.getString(3);
            Cursor eem = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
            if (eem.moveToFirst()){
                email_id_send = new EditText(Cash_Card_Credit_Sales2.this);
                String em1 = eem.getString(3);
                if (client.toString().equals("Gmail")) {
                    email_id_send.setText(em1);
                    getResultsFromApi();
                    new MakeRequestTask_bill(mCredential).execute();
                }else {
                    if (client.toString().equals("Yahoo")){
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "yahoo "+un, Toast.LENGTH_LONG).show();

                        String toEmails = em1;
                        List toEmailList = Arrays.asList(toEmails
                                .split("\\s*,\\s*"));
                        new SendMailTask_Yahoo_homebill(Cash_Card_Credit_Sales2.this).execute(un,
                                pwd, toEmailList, strcompanyname, msg, currentDateandTimee1, timee1);



                    }else {
                        if (client.toString().equals("Hotmail")){
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "Hotmail and Outlook "+un, Toast.LENGTH_LONG).show();

                            String toEmails = em1;
                            List toEmailList = Arrays.asList(toEmails
                                    .split("\\s*,\\s*"));
                            new SendMailTask_Hotmail_Outlook_homebill(Cash_Card_Credit_Sales2.this).execute(un,
                                    pwd, toEmailList, strcompanyname, msg, currentDateandTimee1, timee1);

                        }else {
                            if (client.toString().equals("Office365")) {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "office 365 " + un, Toast.LENGTH_LONG).show();

                                String toEmails = em1;
                                List toEmailList = Arrays.asList(toEmails
                                        .split("\\s*,\\s*"));
                                new SendMailTask_Office365_homebill(Cash_Card_Credit_Sales2.this).execute(un,
                                        pwd, toEmailList, strcompanyname, msg, currentDateandTimee1, timee1);

                            }
                        }
                    }
                }
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "email is "+em1, Toast.LENGTH_LONG).show();
            }else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "show dialog", Toast.LENGTH_LONG).show();

                final Dialog dialogenteremail = new Dialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);
                dialogenteremail.setContentView(R.layout.dialog_payment_enter_email);
                dialogenteremail.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                dialogenteremail.setCanceledOnTouchOutside(false);
                dialogenteremail.show();

                ImageView btncancel = (ImageView) dialogenteremail.findViewById(R.id.btncancel);
                btncancel.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        dialogenteremail.dismiss();
                    }
                });

                final TextInputLayout email_id_send_layout = (TextInputLayout) dialogenteremail.findViewById(R.id.email_id_send_layout);

                email_id_send = (EditText) dialogenteremail.findViewById(R.id.email_id_send);

                email_id_send.addTextChangedListener(new TextWatcher() {
                    @Override
                    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                    }

                    @Override
                    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                        email_id_send_layout.setError(null);
                    }

                    @Override
                    public void afterTextChanged(Editable editable) {

                    }
                });

                ImageView closetext = (ImageView) dialogenteremail.findViewById(R.id.closetext);
                closetext.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View v) {
                        if (email_id_send.getText().toString().trim().matches(emailPattern)) {
                            if (client.toString().equals("Gmail")) {
//                                email_id_send.setText(em1);
//                                getResultsFromApi();
//                                new MakeRequestTask(mCredential).execute();
                                getResultsFromApi();
                                new MakeRequestTask_bill(mCredential).execute();
                            }else {
                                if (client.toString().equals("Yahoo")){
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "yahoo "+un, Toast.LENGTH_LONG).show();

                                    String toEmails = email_id_send.getText().toString();
                                    List toEmailList = Arrays.asList(toEmails
                                            .split("\\s*,\\s*"));
                                    new SendMailTask_Yahoo_homebill(Cash_Card_Credit_Sales2.this).execute(un,
                                            pwd, toEmailList, strcompanyname, msg, currentDateandTimee1, timee1);



                                }else {
                                    if (client.toString().equals("Hotmail")){
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "Hotmail and Outlook "+un, Toast.LENGTH_LONG).show();

                                        String toEmails = email_id_send.getText().toString();
                                        List toEmailList = Arrays.asList(toEmails
                                                .split("\\s*,\\s*"));
                                        new SendMailTask_Hotmail_Outlook_homebill(Cash_Card_Credit_Sales2.this).execute(un,
                                                pwd, toEmailList, strcompanyname, msg, currentDateandTimee1, timee1);

                                    }else {
                                        if (client.toString().equals("Office365")) {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "office 365 " + un, Toast.LENGTH_LONG).show();

                                            String toEmails = email_id_send.getText().toString();
                                            List toEmailList = Arrays.asList(toEmails
                                                    .split("\\s*,\\s*"));
                                            new SendMailTask_Office365_homebill(Cash_Card_Credit_Sales2.this).execute(un,
                                                    pwd, toEmailList, strcompanyname, msg, currentDateandTimee1, timee1);

                                        }
                                    }
                                }
                            }
                            dialogenteremail.dismiss();
                        }
                        else {
                            email_id_send_layout.setError("Invalid email address");
                        }

                    }
                });
            }

        }else {
            //only sender not there recipient not required
            final Dialog dialoge = new Dialog(Cash_Card_Credit_Sales2.this, R.style.timepicker_date_dialog);
            dialoge.setContentView(R.layout.email_prerequisites);
            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
            dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
            dialoge.show();

            ImageButton btncancel = (ImageButton) dialoge.findViewById(R.id.btncancel);
            btncancel.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {
                    dialoge.dismiss();
                }
            });

            ImageView recipient_notset = (ImageView) dialoge.findViewById(R.id.recipient_notset);
            ImageView recipient_set = (ImageView) dialoge.findViewById(R.id.recipient_set);

            ImageView sender_notset = (ImageView) dialoge.findViewById(R.id.sender_notset);
            ImageView sender_set = (ImageView) dialoge.findViewById(R.id.sender_set);

            LinearLayout recipient_layout = (LinearLayout) dialoge.findViewById(R.id.recipient_layout);
            recipient_layout.setVisibility(View.GONE);

            sender_notset.setVisibility(View.VISIBLE);

            recipient_set.setVisibility(View.VISIBLE);

            Button gotosettings = (Button) dialoge.findViewById(R.id.gotosettings);
            gotosettings.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {
                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup.class);
                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                    startActivity(intent);
//                                                                Cash_Card_Credit_Sales2.this.finish();
                    dialoge.dismiss();
                }
            });

            Button gotosettings1 = (Button) dialoge.findViewById(R.id.gotosettings1);
            gotosettings1.setVisibility(View.GONE);
            gotosettings1.setOnClickListener(new View.OnClickListener() {
                @Override
                public void onClick(View v) {
                    Intent intent = new Intent(Cash_Card_Credit_Sales2.this, EmailSetup.class);
                    intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                    startActivity(intent);
//                                                                Cash_Card_Credit_Sales2.this.finish();
                    dialoge.dismiss();
                }
            });
        }

    }

    void showGooglePlayServicesAvailabilityErrorDialog(
            final int connectionStatusCode) {
        GoogleApiAvailability apiAvailability = GoogleApiAvailability.getInstance();
        Dialog dialog = apiAvailability.getErrorDialog(
                Cash_Card_Credit_Sales2.this,
                connectionStatusCode,
                REQUEST_GOOGLE_PLAY_SERVICES);
        dialog.show();
    }

    private void getResultsFromApi() {

        Cursor cursorr = db1.rawQuery("SELECT * FROM Email_setup", null);
        if (cursorr.moveToFirst()) {
            String unn = cursorr.getString(1);
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "a4 " + unn, Toast.LENGTH_SHORT).show();

            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
            tvv.setText(unn);

            if (tvv.getText().toString().equals("")) {

            }else {
                mCredential.setSelectedAccountName(tvv.getText().toString());
            }
        }

        if (! isGooglePlayServicesAvailable()) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "1", Toast.LENGTH_SHORT).show();
            acquireGooglePlayServices();
        } else if (mCredential.getSelectedAccountName() == null) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "2", Toast.LENGTH_SHORT).show();
//            chooseAccount();
        } else if (! isDeviceOnline()) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "3", Toast.LENGTH_SHORT).show();
//            mOutputText.setText("No network connection available.");
        } else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "4", Toast.LENGTH_SHORT).show();
            new MakeRequestTask1(mCredential).execute();
        }
    }

    /**
     * Checks whether the device currently has a network connection.
     * @return true if the device has a network connection, false otherwise.
     */
    private boolean isDeviceOnline() {
        ConnectivityManager connMgr =
                (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo networkInfo = connMgr.getActiveNetworkInfo();
        return (networkInfo != null && networkInfo.isConnected());
    }

    /**
     * Check that Google Play services APK is installed and up to date.
     * @return true if Google Play Services is available and up to
     *     date on this device; false otherwise.
     */
    private boolean isGooglePlayServicesAvailable() {
        GoogleApiAvailability apiAvailability =
                GoogleApiAvailability.getInstance();
        final int connectionStatusCode =
                apiAvailability.isGooglePlayServicesAvailable(Cash_Card_Credit_Sales2.this);
        return connectionStatusCode == ConnectionResult.SUCCESS;
    }

    /**
     * Attempt to resolve a missing, out-of-date, invalid or disabled Google
     * Play Services installation via a user dialog, if possible.
     */
    private void acquireGooglePlayServices() {
        GoogleApiAvailability apiAvailability =
                GoogleApiAvailability.getInstance();
        final int connectionStatusCode =
                apiAvailability.isGooglePlayServicesAvailable(Cash_Card_Credit_Sales2.this);
        if (apiAvailability.isUserResolvableError(connectionStatusCode)) {
            showGooglePlayServicesAvailabilityErrorDialog(connectionStatusCode);
        }
    }


    /**
     * Attempts to set the account used with the API credentials. If an account
     * name was previously saved it will use that one; otherwise an account
     * picker dialog will be shown to the user. Note that the setting the
     * account to use with the credentials object requires the app to have the
     * GET_ACCOUNTS permission, which is requested here if it is not already
     * present. The AfterPermissionGranted annotation indicates that this
     * function will be rerun automatically whenever the GET_ACCOUNTS permission
     * is granted.
     */
    @AfterPermissionGranted(REQUEST_PERMISSION_GET_ACCOUNTS)
    private void chooseAccount() {
//        Toast.makeText(Cash_Card_Credit_Sales2.this, "s1", Toast.LENGTH_SHORT).show();
        if (EasyPermissions.hasPermissions(
                Cash_Card_Credit_Sales2.this, android.Manifest.permission.GET_ACCOUNTS)) {
            String accountName = Cash_Card_Credit_Sales2.this.getPreferences(Context.MODE_PRIVATE)
                    .getString(PREF_ACCOUNT_NAME, null);
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "s2", Toast.LENGTH_SHORT).show();
//            if (accountName != null) {
//                mCredential.setSelectedAccountName(accountName);
//                Toast.makeText(Cash_Card_Credit_Sales2.this, "s3", Toast.LENGTH_SHORT).show();
//                getResultsFromApi();
//            } else {
            // Start a dialog from which the user can choose an account
            startActivityForResult(
                    mCredential.newChooseAccountIntent(),
                    REQUEST_ACCOUNT_PICKER);
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "s4", Toast.LENGTH_SHORT).show();
//            }
        } else {
            // Request the GET_ACCOUNTS permission via a user dialog
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "s5", Toast.LENGTH_SHORT).show();
            EasyPermissions.requestPermissions(
                    this,
                    "This app needs to access your Google account (via Contacts).",
                    REQUEST_PERMISSION_GET_ACCOUNTS,
                    android.Manifest.permission.GET_ACCOUNTS);
        }
    }

    private class MakeRequestTask1 extends AsyncTask<Void, Void, List<String>> {
        private Gmail mService = null;
        private Exception mLastError = null;

        MakeRequestTask1(GoogleAccountCredential credential) {
            HttpTransport transport = AndroidHttp.newCompatibleTransport();
            JsonFactory jsonFactory = JacksonFactory.getDefaultInstance();

            System.out.println("labels mservice11 " + mService);

            mService = new Gmail.Builder(
                    transport, jsonFactory, credential)
                    .setApplicationName("Gmail API Android Quickstart")
                    .build();
            Log.d("labels credential", String.valueOf(credential));

            System.out.println("labels mservice " + mService);
        }

        /**
         * Background task to call Gmail API.
         * @param params no parameters needed for this task.
         */
        @Override
        protected List<String> doInBackground(Void... params) {
            Log.d("hiiiiii11", "error");

            try {
                Log.d("hiiiiii111", "error");
                return getDataFromApi();
            } catch (Exception e) {
                mLastError = e;
                cancel(true);
                Log.d("hiiiiii1111", "error");
                return null;
            }
        }

        /**
         * Fetch a list of Gmail labels attached to the specified account.
         * @return List of Strings labels.
         * @throws IOException
         */
        private List<String> getDataFromApi() throws IOException {
            // Get the labels in the user's account.
            String user = "me";
            List<String> labels = new ArrayList<String>();
            ListLabelsResponse listResponse =
                    mService.users().labels().list(user).execute();
            System.out.println("ListLabelsResponse " + listResponse);
            for (Label label : listResponse.getLabels()) {
                labels.add(label.getName());

//                Log.d("labels", String.valueOf(labels));//will be displaying all the folders one by one by looping

//                System.out.println("user ID " + labels.add(label.getName()));
            }
            return labels;
        }


        @Override
        protected void onPreExecute() {
//            mOutputText.setText("");
            mProgress.show();
        }

        @Override
        protected void onPostExecute(List<String> output) {
//            System.out.println("labelsss " + output);//will be displaying details and folders in mail like inbox, sent, outbox, junk, etc
            mProgress.hide();
            if (output == null || output.size() == 0) {
//                mOutputText.setText("No results returned.");
            } else {
                output.add(0, "Data retrieved using the Gmail API:");
//                mOutputText.setText(TextUtils.join("\n", output));
            }
        }

        @Override
        protected void onCancelled() {
            mProgress.hide();
            if (mLastError != null) {
                if (mLastError instanceof GooglePlayServicesAvailabilityIOException) {
                    showGooglePlayServicesAvailabilityErrorDialog(
                            ((GooglePlayServicesAvailabilityIOException) mLastError)
                                    .getConnectionStatusCode());
                } else if (mLastError instanceof UserRecoverableAuthIOException) {
                    startActivityForResult(
                            ((UserRecoverableAuthIOException) mLastError).getIntent(),
                            EmailSetup_Google.REQUEST_AUTHORIZATION);
                } else {
//                    mOutputText.setText("The following error occurred:\n"
//                            + mLastError.getMessage());
                }
            } else {
//                mOutputText.setText("Request cancelled.");
            }
        }
    }

    private class MakeRequestTask_bill extends AsyncTask<Void, Void, String> {
        private Gmail mService = null;
        private Exception mLastError = null;
//        private View view = sendFabButton;

        public MakeRequestTask_bill(GoogleAccountCredential credential) {
            HttpTransport transport = AndroidHttp.newCompatibleTransport();
            JsonFactory jsonFactory = JacksonFactory.getDefaultInstance();
            mService = new Gmail.Builder(
                    transport, jsonFactory, credential)
                    .setApplicationName(getResources().getString(R.string.app_name))
                    .build();
        }

        @Override
        protected String doInBackground(Void... params) {
            try {
                return getDataFromApi();
            } catch (Exception e) {
                mLastError = e;
                cancel(true);
                return null;
            }
        }

        private String getDataFromApi() throws IOException {
            // getting Values for to Address, from Address, Subject and Body

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    stremailid = getcom.getString(15);
                } while (getcom.moveToNext());
            }else {
                strcompanyname = "";
                stremailid = "";
            }

            String name_mail = "";
            Cursor em = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '"+billnumb+"'", null);
            if (em.moveToFirst()){
                name_mail = em.getString(1);
            }

            String date_mail = "", time_mail = "";
            Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '"+billnumb+"'", null);
            if (cursor9.moveToFirst()){
                date_mail = cursor9.getString(25);
                time_mail = cursor9.getString(12);
            }

            String url = "www.intuitionsoftwares.com";

//            String msg = "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
//                    "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
//                    "Powered by: " + Uri.parse(url);

            String sub = "";
            Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '"+billnumb+"'", null);
            if (cursor8.moveToFirst()){
                sub = cursor8.getString(2);
            }


            final String msg =
                    "<Html>" +
                            "<Body>" +
                            "<div>" +
                            " <table width=\"100%\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                            "<tbody>" +
                            "<tr>" +
                            "<td width=\"100%\" valign=\"top\" bgcolor=\"#f8f8f8\">" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1;margin-top:50px\">" +
                            "<tbody>" +
                            "<tr>" +
                            "<td width=\"460\" >" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                            "<tbody>" +
                            "<tr>" +
                            "<td height=\"30\">" +
                            "</td>" +
                            "</tr>" +
                            "</tbody>" +
                            "</table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                            "<tbody>" +
                            "<tr>" +
                            "<td width=\"40\">" +
                            "</td>" +
                            "<td width=\"460\" style=\"font-size:16px;color:#00929f;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
//                        "<img src=\"http://www.intuitionsoftwares.com/resources/intuition_logo_header_with_text_240.png\" width=\"200\" style=\"margin:0 0 20px 0;width:200px\">" +
//                        "<img src="+logo+" width=\"200\" style=\"margin:0 0 20px 0;width:200px\">" +
                            "<p><h1>"+strcompanyname+"</h1></p>" +

                            "</td>" +
                            "<td width=\"40\">" +
                            "</td>" +
                            "</tr>" +
                            "<tr>" +
                            "<td width=\"40\">" +
                            "</td>" +
                            "<td width=\"460\" style=\"font-size:16px;color:#b8b9c1;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
                            "<span style=\"text-decoration:none;color:#2f2f36;font-weight:bold;font-size:32px;line-height:32px\">Bill "+billnumb+"</span><br>" +
                            "</td>" +
                            "<td width=\"40\"></td>" +
                            "</tr>" +
                            "<tr>" +
                            "<td width=\"40\"></td>" +
                            "<td width=\"460\" style=\"font-size:16px;color:#a0a0a5;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">for Customer <br> from <b>"+strcompanyname+"</b><br>" +
                            " </td>" +
                            "<td width=\"40\">" +
                            "</td>" +
                            "</tr>" +
                            "<tr></tr>" +
                            "<tr><td width=\"40\"></td>" +
                            "<td width=\"512\" height=\"30\">" +
                            "</td> <td width=\"40\"></td></tr></tbody></table></td>" +
                            "</tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" bgcolor=\"#ffffff\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                            "<tbody><tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
                            "<tr><td width=\"460\" height=\"5\" bgcolor=\"#ffffff\"></td></tr>" +
                            "<tr><td width=\"460\" height=\"1\" bgcolor=\"#e1e1e1\"></td></tr>" +
                            "<tr><td width=\"460\" height=\"10\" bgcolor=\"#ffffff\"></td></tr></tbody></table></td></tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\"><tbody>" +
                            "<tr> <td width=\"460\">" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td height=\"20\"></td></tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
                            "<td width=\"40\"></td><td width=\"510\" style=\"font-size:14px;color:#444;font-weight:normal;text-align:left;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">Hi "+name_mail+",<br>Your Bill amount is "+insert1_rs+""+sub.toString()+" <br><br>We appreciate your Business and hope to see you again soon,<br>"+strcompanyname+" <br>" +
                            //Correct(tic) symbol
                            "<p align=\"center\"> <img src=\"https://static.wixstatic.com/media/ff8d82_453b1bed7c174e398e9fc333af3692bf~mv2.png\" width=\"60\" height=\"60\"></p>" +

                            "<p style=\"font-size:18px;border-top:1px solid #e1e1e1;border-bottom:1px solid #e1e1e1;padding:10px 0;background:#fefefe;text-align:center;margin:5px 0\">Paid: <span style=\"white-space:nowrap;font-weight:bold;font-size:18px\">"+insert1_rs+" "+sub.toString()+" </span>" +
                            "</p><br></td><td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                            "<tbody>" +
                            "<tr><td width=\"\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
                            "<td width=\"40\"></td>" +
                            "<td width=\"510\" style=\"font-size:14px;color:#a0a0a5;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
                            "<div></div>" +
                            "<p style=\"margin-top:3px;color:#444\">Dated: <span style=\"white-space:nowrap;font-weight:bold;font-size:14px\">"+date_mail+",</span> "+time_mail+" </p>" +
                            "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td><td width=\"512\" height=\"10\"></td>" +
                            "<td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#ffffff\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                            "<tbody><tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td width=\"460\" height=\"10\"></td></tr></tbody></table></td></tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" bgcolor=\"#f9f9f9\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1\"><tbody>" +
                            "<tr><td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
                            "<tr><td height=\"10\" ></td></tr></tbody></table><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                            "<tbody><tr><td width=\"40\"></td><td width=\"460\" style=\"font-size:16px;color:#b8b9c1;font-weight:normal;text-align:center;font-family:Helvetica,Arial,sans-serif;line-height:24px;vertical-align:top\">" +
                            "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td>" +
                            "<td width=\"460\" style=\"font-size:14px;color:#959599;font-weight:normal;font-family:Helvetica,Arial,sans-serif;line-height:20px;text-align:center\">" +
                            "<p>Disclaimer: This information may be confidential and is intended only for the recipient.</p>" +
                            "</td><td width=\"40\"></td></tr><tr><td width=\"40\"></td><td width=\"512\" height=\"10\"></td><td width=\"40\"></td></tr></tbody></table></td></tr></tbody></table>" +
                            "<table width=\"462\" bgcolor=\"#f0f0f0\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-top:1px solid #e1e1e1\">" +
                            "<tbody> <tr> <td width=\"462\" height=\"10\"></td></tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1\">" +
                            "<tbody> <tr> <td width=\"460\" bgcolor=\"#f0f0f0\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                            "<tbody> <tr> <td width=\"460\"><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody>" +
                            "<tr><td width=\"30\"></td><td width=\"530\"><table border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\" ><tbody><tr>" +
                            "<td height=\"0\" align=\"center\" style=\"font-size:14px;color:#b8b9c1;font-weight:normal;font-family:Helvetica,Arial,sans-serif;line-height:24px\">" +
                            "<p><a style=\"text-decoration:none;color:#959599\" target=\"_blank\">If you think this mail is not for you, please delete and contact<a href=\"mailto:"+stremailid+"\" style=\"text-decoration:none;color:#008f9b;font-weight:bold\" target=\"_blank\">\n" +
                            ""+stremailid+"</a> </a></td>" +
                            "</tr></tbody></table><table width=\"140\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"left\">" +
                            "<tbody><tr><td width=\"140\"></td></tr></tbody></table></td><td width=\"30\"></td></tr></tbody></table></td></tr></tbody></table></td></tr></tbody></table>" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr>" +
                            "<td width=\"460\" style=\"border-left:1px solid #e1e1e1;border-right:1px solid #e1e1e1;border-bottom:1px solid #e1e1e1;border-radius:0 0 10px 10px;background:#f0f0f0\">" +
                            "<table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\"><tbody><tr><td height=\"14\"></td></tr></tbody></table></td></tr></tbody></table><table width=\"460\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" align=\"center\">" +
                            "<tbody><tr><td height=\"20\"></td></tr><tr>" +
                            "<td style=\"text-align:center\"><a href=\"http://www.intuitionsoftwares.com/\" target=\"_blank\" ><img src=\"www.intuitionsoftwares.com/resources/Powered%20by%20Intuition.png\" alt=\"Powered by Intuition\" border=\"0\" style=\"text-align:center;min-width:65px\"></a></td></tr>" +
                            "<tr>" +
                            "<td height=\"40\" style=\"line-height:1px\"></td></tr></tbody></table></td></tr></tbody></table><div><div>" +
                            "</div></div><span></span><div></div><div></div></div>" +
                            "</Body>" +
                            "</Html>";


//            Cursor cursor1 = db.rawQuery("SELECT * FROM Email_recipient", null);
//            if (cursor1.moveToFirst()) {
//                do {
//                    String unn = cursor1.getString(3);
            TextView edtToAddress = new TextView(Cash_Card_Credit_Sales2.this);
            edtToAddress.setText(email_id_send.getText().toString());

            TextView edtSubject = new TextView(Cash_Card_Credit_Sales2.this);
            edtSubject.setText(strcompanyname);

            TextView edtMessage = new TextView(Cash_Card_Credit_Sales2.this);
            edtMessage.setText(msg);

            String user = "me";
            String to = Utils.getString(edtToAddress);
            String from = mCredential.getSelectedAccountName();
            Log.v("sender email", from);
            String subject = Utils.getString(edtSubject);
            String body = Utils.getString(edtMessage);
            MimeMessage mimeMessage;
            response = "";
            try {

//                        File exportDir = new File(Environment.getExternalStorageDirectory(), "/IVEPOS_reports/IVEPOS_customer_list");
//                        if (!exportDir.exists()) {
//                            exportDir.mkdirs();
//                        }
//
//                        file = new File(exportDir, "IvePOS_customer_list" + currentDateandTimee1 + "_" + timee1 + ".csv");

//                        File exportDir1 = new File(Environment.getExternalStorageDirectory(), "/Download");
//                String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_Bills/IvePOS_bill_"+currentDateandTimee1+"_"+timee1+".jpeg";
                String filename = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)+"/IVEPOS_Bills/IvePOS_bill_"+currentDateandTimee1+"_"+timee1+".jpeg";
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_sales_report/IvePOS_sales_report"+currentDateandTimee1+"_"+timee1+".csv";
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_product_report/IvePOS_product_report"+currentDateandTimee1+"_"+timee1+".csv";
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_customer_list/IvePOS_customer_list"+currentDateandTimee1+"_"+timee1+".csv";

//                String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_sales_report/IvePOS_sales_report"+"12May17"+"_"+"013048PM"+".csv";
//                String path = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_backup/";


                File f = new File(filename);
//
                mimeMessage = createEmailWithAttachment(to, from, subject, body, f);



//                        mimeMessage = createEmail(to, from, subject, body);
                response = sendMessage(mService, user, mimeMessage);
            } catch (MessagingException e) {
                e.printStackTrace();
            }

//                } while (cursor1.moveToNext());
//            }
            return response;
        }

        // Method to send email
        private String sendMessage(Gmail service,
                                   String userId,
                                   MimeMessage email)
                throws MessagingException, IOException {
            com.google.api.services.gmail.model.Message message = createMessageWithEmail(email);
            // GMail's official method to send email with oauth2.0
            message = service.users().messages().send(userId, message).execute();

            System.out.println("user ID " + userId);

            System.out.println("Message id: " + message.getId());
            System.out.println(message.toPrettyString());
            return message.getId();
        }

        public MimeMessage createEmailWithAttachment(String to,
                                                     String from,
                                                     String subject,
                                                     String bodyText,
                                                     File file)
                throws MessagingException, IOException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);

            email.setFrom(new InternetAddress(from));
            email.addRecipient(javax.mail.Message.RecipientType.TO,
                    new InternetAddress(to));
            email.setSubject(subject);

            MimeBodyPart mimeBodyPart = new MimeBodyPart();
            mimeBodyPart.setContent(bodyText, "text/html");

            Multipart multipart = new MimeMultipart();
            multipart.addBodyPart(mimeBodyPart);

            mimeBodyPart = new MimeBodyPart();
            DataSource source = new FileDataSource(file);

            mimeBodyPart.setDataHandler(new DataHandler(source));
            mimeBodyPart.setFileName(file.getName());

            multipart.addBodyPart(mimeBodyPart);
            email.setContent(multipart);

            return email;
        }

        // Method to create email Params
        private MimeMessage createEmail(String to,
                                        String from,
                                        String subject,
                                        String bodyText) throws MessagingException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);
            InternetAddress tAddress = new InternetAddress(to);
            InternetAddress fAddress = new InternetAddress(from);


            System.out.println("From  " + from);
            System.out.println("To  " + to);


            email.setFrom(fAddress);
            email.addRecipient(javax.mail.Message.RecipientType.TO, tAddress);
            email.setSubject(subject);
            email.setText(bodyText);
            return email;
        }

        private com.google.api.services.gmail.model.Message createMessageWithEmail(MimeMessage email)
                throws MessagingException, IOException {
            ByteArrayOutputStream bytes = new ByteArrayOutputStream();
            email.writeTo(bytes);
            String encodedEmail = Base64.encodeBase64URLSafeString(bytes.toByteArray());
            com.google.api.services.gmail.model.Message message = new com.google.api.services.gmail.model.Message();
            message.setRaw(encodedEmail);
            return message;
        }

        @Override
        protected void onPreExecute() {
            mProgress.show();
        }

        @Override
        protected void onPostExecute(String output) {
            Log.d("post execute", "error");
            mProgress.hide();
            if (output == null || output.length() == 0) {
                Toast.makeText(Cash_Card_Credit_Sales2.this, "not success", Toast.LENGTH_SHORT).show();
//                showMessage(view, "No results returned.");
            } else {
                Toast.makeText(Cash_Card_Credit_Sales2.this, "success", Toast.LENGTH_SHORT).show();
//                showMessage(view, output);
            }
        }

        @Override
        protected void onCancelled() {
            mProgress.hide();
            if (mLastError != null) {
//                Log.v("Errors3", mLastError.getMessage());
                if (mLastError instanceof GooglePlayServicesAvailabilityIOException) {
//                    Log.v("Errors1", mLastError.getMessage());
                    showGooglePlayServicesAvailabilityErrorDialog(
                            ((GooglePlayServicesAvailabilityIOException) mLastError)
                                    .getConnectionStatusCode());
                } else if (mLastError instanceof UserRecoverableAuthIOException) {
//                    Log.v("Errors2", mLastError.getMessage());
                    startActivityForResult(
                            ((UserRecoverableAuthIOException) mLastError).getIntent(),
                            Utils.REQUEST_AUTHORIZATION);
                } else {
//                    showMessage(view, "The following error occurred:\n" + mLastError.getMessage());
//                    Log.v("Errors", mLastError.getMessage());
                }
            } else {
//                showMessage(view, "Request Cancelled.");
            }
        }
    }

    public static void printByteData(byte[] buf) {
        BT_Write(buf);
        BT_Write(new byte[]{10});
    }

    public void printByteData_wifi(byte[] buf) {
        wifiSocket.WIFI_Write(buf);
        wifiSocket.WIFI_Write(new byte[]{10});
    }

    public void printByteData_wifi_counter(byte[] buf) {
        wifiSocket2.WIFI_Write(buf);
        wifiSocket2.WIFI_Write(new byte[]{10});
    }

    public  byte[] neoprintbillcopy1(Dialog dialog) {


        Typeface tf = Typeface.SERIF;
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ReceiptBitmap receiptBitmap = new ReceiptBitmap().getInstance();
        int cont=5;
        Cursor cursor34 = db.rawQuery("Select count(*) from All_Sales WHERE bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (cursor34.moveToFirst()) {
            cont=cursor34.getInt(0);

        }
        Log.e("count:",cont+"");
        cursor34.close();
        receiptBitmap.init(700+(cont*50));
        receiptBitmap.setTextSize(25);
        receiptBitmap.setTypeface(Typeface.create(tf, Typeface.NORMAL));


        charlength = 10;
        charlength1 = 20;
        charlength2 = 30;
        quanlentha = 5;

        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcom.moveToFirst()) {
            strcompanyname = getcom.getString(1);
            strbillone = getcom.getString(12);
        }
        getcom.close();

        tvkot.setText(strcompanyname);
        if (tvkot.getText().toString().equals("")) {

        } else {
            // Print.StartPrinting(strcompanyname ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
            receiptBitmap.drawCenterText(strcompanyname);
        }

        receiptBitmap.drawCenterText("Bill copy");


        String str_line="----------------------";
        receiptBitmap.drawLeftText(str_line);



        //   Print.StartPrinting(NAme111+"   "+tablen,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        receiptBitmap.drawLeftText("Bill id."+bill_coun);
        receiptBitmap.drawLeftText("Bill no." + billnumb);

        Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor10.moveToFirst()) {
            billtypea = cursor10.getString(5);
            paymmethoda = cursor10.getString(6);
        }
        cursor10.close();

        TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
        ttv.setText(billtypea);

        TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
        ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

        if (ttv.getText().toString().equals("  Cash")) {
            billtypeaa = "Cash"; //0
        }
        if (ttv.getText().toString().equals("  Card")) {
            billtypeaa = "Card"; //0
        }
        if (ttv.getText().toString().equals("  Paytm")) {
            billtypeaa = "Paytm"; //0
        }
        if (ttv.getText().toString().equals("  Mobikwik")) {
            billtypeaa = "Mobikwik"; //0
        }
        if (ttv.getText().toString().equals("  Freecharge")) {
            billtypeaa = "Freecharge"; //0
        }
        if (ttv.getText().toString().equals("  Pay Later")) {
            billtypeaa = "Pay Later"; //0
        }
        if (ttv.getText().toString().equals("  Cheque")) {
            billtypeaa = "Cheque"; //0
        }
        if (ttv.getText().toString().equals("  Sodexo")) {
            billtypeaa = "Sodexo"; //0
        }
        if (ttv.getText().toString().equals("  Zeta")) {
            billtypeaa = "Zeta"; //0
        }
        if (ttv.getText().toString().equals("  Ticket")) {
            billtypeaa = "Ticket"; //0
        }
        if (ttv.getText().toString().equals("  Upiqr")) {
            billtypeaa = "Upiqr"; //0
        }

        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals("  General") || ttv1.getText().toString().equals("  Others")) {
            paymmethodaa = "Dine-in";
            //billtypee.setText("Dine-in");
        } else {
            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                paymmethodaa = "Takeaway";
                //billtypee.setText("Takeaway");
            } else {
                paymmethodaa = "Home delivery";
                //billtypee.setText("Home delivery");
            }
        }

        Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (date.moveToFirst()) {
            datee = date.getString(25);
            timee = date.getString(12);
        }
        date.close();


        receiptBitmap.drawLeftText(paymmethodaa+"   "+datee);

        Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (cursor9.moveToFirst()) {
            tableida = cursor9.getString(15);
            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
            if (vbnm.moveToFirst()) {
                assa1 = vbnm.getString(1);
                assa2 = vbnm.getString(2);
            }
            vbnm.close();
            TextView cx = new TextView(Cash_Card_Credit_Sales2.this);
            cx.setText(assa1);

            if (cx.getText().toString().equals("")) {
                tableidaa = "Tab" + assa2;
            } else {
                tableidaa = "Tab" + assa1;
            }

        }
        cursor9.close();

        receiptBitmap.drawLeftText(tableidaa+"   "+timee);

        Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (cursor9_1.moveToFirst()) {
            u_name = cursor9_1.getString(45);
        }
        cursor9_1.close();

        TextView tv_u_name = new TextView(Cash_Card_Credit_Sales2.this);
        tv_u_name.setText(u_name);

        receiptBitmap.drawLeftText("Counter person  : "+u_name);

        receiptBitmap.drawLeftText(str_line);

        Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
        if (caddress.moveToFirst()) {
            String nam = caddress.getString(1);
            String addr = caddress.getString(4);
            String phon = caddress.getString(2);
            String emai = caddress.getString(3);

            if (nam.length() > 0 || addr.length() > 0 ||
                    phon.length() > 0 || emai.length() > 0) {

                receiptBitmap.drawLeftText("Customer:");

            } else {

            }

            if (nam.length() > 0) {
                receiptBitmap.drawLeftText(nam);
            } else {

            }

            if (addr.length() > 0) {
                receiptBitmap.drawLeftText(addr);
            } else {

            }

            if (phon.length() > 0) {
                String cust_ph = "Ph. " + phon;
                receiptBitmap.drawLeftText(cust_ph);
            } else {

            }

            if (emai.length() > 0) {
                receiptBitmap.drawLeftText(emai);
            } else {

            }

            receiptBitmap.drawLeftText(str_line);

        }
        caddress.close();

        receiptBitmap.drawLeftText("Qty"+"  "+"Item"+"  "+"Price"+"  "+"Amount");
        receiptBitmap.drawLeftText(str_line);



        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursorr.moveToFirst()) {

            do {

                String nbg = ccursorr.getString(0);
                String name = ccursorr.getString(1);
                String value = ccursorr.getString(2);
                String pq = ccursorr.getString(5);
                String itna = ccursorr.getString(2);
                String pricee = ccursorr.getString(3);
                String tototot = ccursorr.getString(4);

                final String newid = ccursorr.getString(20);
                int padding_in_px;

                int padding_in_dp = 30;  // 34 dps
                final float scale1 = getResources().getDisplayMetrics().density;
                padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                if (pq.equals("Item")) {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                    final TableRow row1 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                    final TableRow row2 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));

                    final TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv.setText(value);
                    row.addView(tv);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(name);
                    String value1 = tv1.getText().toString();
                    row.addView(tv1);

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setText(pricee);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(0, padding_in_px, 1.2f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv3.setText(tototot);

                    String value2 = tv3.getText().toString();

                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                    if (modcursor.moveToFirst()) {

                        Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnumb + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                        if (cursor4.moveToFirst()) {
                            float sub2a = cursor4.getFloat(0);
                            String sub2a1 = String.valueOf(sub2a);
                            ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot);
                            ss1 = String.valueOf(ss);
                        }
                        cursor4.close();

                        if (name.length() > charlength) {
                            int print1 = 0;
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "1", Toast.LENGTH_SHORT).show();

                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "2", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0){
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "3", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0){
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText("      "+string2);
                                    print1 = 1;
                                }

                            }

                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "4", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0){
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2+"      "+string3);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "5", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if(print1 == 0){
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText("      "+string2+"      "+string3);
                                    print1 = 1;
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    receiptBitmap.drawLeftText("HSN "+hsn);
                                }
                            }

                        } else {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "6", Toast.LENGTH_SHORT).show();
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "7", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);

                                receiptBitmap.drawLeftText(string1quan+"  "+name+"  "+pricee+"  "+ss1);
                                receiptBitmap.drawLeftText(string2quan);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            } else {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "8", Toast.LENGTH_SHORT).show();
                                receiptBitmap.drawLeftText(value+"  "+name+"  "+pricee+"  "+ss1);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            }

                        }

                        do {

                            final String modiname = modcursor.getString(1);
                            final String modiquan = modcursor.getString(2);
                            String modiprice = modcursor.getString(3);
                            String moditotal = modcursor.getString(4);
                            final String modiid = modcursor.getString(0);

                            float modprice1 = Float.parseFloat(modiprice);
                            String modpricestr = String.valueOf(modprice1);

                            if (modiname.length() > charlength) {
                                if (modiname.length() > charlength) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength);

                                    receiptBitmap.drawLeftText(""+"  "+">"+string1+"  "+modpricestr);
                                    receiptBitmap.drawLeftText("    "+string2);

                                }
                                if (modiname.length() > charlength1) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength, charlength1);
                                    String string3 = modiname.substring(charlength1);

                                    receiptBitmap.drawLeftText(""+"  "+">"+string1+"  "+modpricestr);
                                    receiptBitmap.drawLeftText("    "+string2+"    "+string3);

                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            } else {

                                receiptBitmap.drawLeftText(""+"  "+">"+modiname+"  "+modpricestr);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            }

                            final TableRow tableRow11 = new TableRow(Cash_Card_Credit_Sales2.this);
                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            final TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                            tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv.setGravity(Gravity.CENTER);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText("");
                            tableRow11.addView(tvv);

                            TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv4.setText(modiname);
                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv4);

                            TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv2.setPadding(0, 0, 1, 0);
                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv5.setText(modiprice);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv5);

                            TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv6.setText("");
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv6);


                            final TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv3.setPadding(0,0,10,0);
                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                            //row.addView(tv3);

                            row.removeView(tv8);


                            tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String numberr = tv.getText().toString();
                            float newmulr = Float.parseFloat(numberr);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(ss));
                            row.addView(tv8);


                            tableLayout1.addView(tableRow11);
                        } while (modcursor.moveToNext());

                        //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    receiptBitmap.drawLeftText(""+"  "+""+"  "+""+"  "+"("+"-"+total_disc_print_q+")");

                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();

                    } else {

                        if (name.length() > charlength) {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "10", Toast.LENGTH_SHORT).show();
                            int print1 = 0;
                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "12", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText("      "+string2);
                                    print1 = 1;
                                }

                            }
////////////////////////////////////////////////
                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "13", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2);
                                    receiptBitmap.drawLeftText("      "+string3);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "14", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText("      "+string2);
                                    receiptBitmap.drawLeftText("      "+string3);
                                    print1 = 1;
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    receiptBitmap.drawLeftText("HSN "+hsn);
                                }
                            }

                        } else {
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "15", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);

                                receiptBitmap.drawLeftText(string1quan+"  "+name+"  "+pricee+"  "+tototot);
                                receiptBitmap.drawLeftText(string2quan);

                            } else {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "16", Toast.LENGTH_SHORT).show();
                                receiptBitmap.drawLeftText(value+"  "+name+"  "+pricee+"  "+tototot);
                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    receiptBitmap.drawLeftText("HSN "+hsn);
                                }
                            }


                        }

                        tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        //tv3.setPadding(0, 0, 10, 0);
                        tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                        final String number = tv.getText().toString();
                        float newmul = Float.parseFloat(number);
                        //final float in = Float.parseFloat(cursor.getString(4));
                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                        //newmul = Integer.parseInt(multiply);
                        tv8.setText(String.valueOf(multiply));
                        row.addView(tv8);

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    receiptBitmap.drawLeftText(""+"  "+""+"  "+""+"  "+"("+"-"+total_disc_print_q+")");
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();
                    }
                    modcursor.close();
                }


            } while (ccursorr.moveToNext());
        }
        ccursorr.close();



        receiptBitmap.drawLeftText(str_line);


////////////////////////////////////sub total
        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor3.moveToFirst()) {
            sub = cursor3.getString(7);
        }
        cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
        float to = Float.parseFloat(sub);
        String tot = String.valueOf(to);

        receiptBitmap.drawLeftText("Sub total"+"                       "+tot);

/////////////////////////tax




///////////////////////////////// discount

        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
        if (cursor4.moveToFirst()) {
            taxpe = cursor4.getString(5);
        } else {
            taxpe = "0";
        }
        cursor4.close();

        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
        if (cursor5.moveToFirst()) {
            dsirs = cursor5.getString(7);
        } else {
            dsirs = "0";
        }
        cursor5.close();

        String alldiscinperc1 = "Discount(" + taxpe + "%)";
        receiptBitmap.drawLeftText(alldiscinperc1+"                       "+dsirs);

        float newe;
//////////////////////////////////////////////

        Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnumb + "'", null);
        if (cursor113.moveToFirst()) {
            float level = cursor113.getFloat(0);
            total = String.valueOf(level);
            float total1 = Float.parseFloat(total);
            total_disc_print_q = String.format(Locale.US,"%.2f", total1);

            receiptBitmap.drawLeftText("Savings"+"                       "+total_disc_print_q);

            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor.moveToFirst()){
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {

                    receiptBitmap.drawLeftText("Loyalty(" + t_total_points + ")"+"                       "+v_tq);

                }
            }



        }
        cursor113.close();

//////////////////////////////////////Rounded off

        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor7.moveToFirst()) {
            subro = cursor7.getString(9);
        }
        cursor7.close();

        receiptBitmap.drawLeftText("Rounded"+"                       "+subro);

        receiptBitmap.drawLeftText(str_line);

//////////////Total main

        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor8.moveToFirst()) {
            alltotal1 = cursor8.getString(2);
        }
        cursor8.close();

        float all = Float.parseFloat(alltotal1);
        String newf = String.valueOf(all);

        receiptBitmap.drawLeftText("Total"+"                       "+"Rs "+newf);

        receiptBitmap.drawLeftText(str_line);

        ///////////ttax
        TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
        tableLayout1.removeAllViews();

        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor.moveToFirst()) {

            do {
                String name = ccursor.getString(10);
                String value = ccursor.getString(9);
                String pq = ccursor.getString(50);
                String itna = ccursor.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor.moveToNext());
        }
        ccursor.close();

        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor2.moveToFirst()) {

            do {
                String name = ccursor2.getString(35);
                String value = ccursor2.getString(36);
                String pq = ccursor2.getString(50);
                String itna = ccursor2.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor2.moveToNext());
        }
        ccursor2.close();

        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor3.moveToFirst()) {

            do {
                String name = ccursor3.getString(37);
                String value = ccursor3.getString(38);
                String pq = ccursor3.getString(50);
                String itna = ccursor3.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor3.moveToNext());
        }
        ccursor3.close();

        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor4.moveToFirst()) {

            do {
                String name = ccursor4.getString(39);
                String value = ccursor4.getString(40);
                String pq = ccursor4.getString(50);
                String itna = ccursor4.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor4.moveToNext());
        }
        ccursor4.close();

        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor5.moveToFirst()) {

            do {
                String name = ccursor5.getString(41);
                String value = ccursor5.getString(42);
                String pq = ccursor5.getString(50);
                String itna = ccursor5.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor5.moveToNext());
        }
        ccursor5.close();


        ArrayList<String> groupList = new ArrayList<String>();

        float sum_p = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(BeveragesMenuFragment.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

            if (groupList.contains(mTextView.getText().toString())) {

            }else {
                sum_p = 0;
                for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                    TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                    mTextView1 = (TextView) mRow1.getChildAt(0);
                    mTextView2 = (TextView) mRow1.getChildAt(2);
                    if (groupList.contains(mTextView.getText().toString())) {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    } else {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            groupList.add(mTextView.getText().toString());
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    }
                }
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                String mod1 = mTextView.getText().toString() + "---" + String.format("%.2f", sum_p);

                receiptBitmap.drawLeftText(mod1);

                String match = "@";
                int position = mTextView.getText().toString().indexOf(match);
                String mod2 = mTextView.getText().toString().substring(0, position);//keep toastmessage
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+mod2, Toast.LENGTH_LONG).show();
                Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor6.moveToFirst()) {
                    String hsn = ccursor6.getString(34);

                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                    hsn_hsn.setText(hsn);

                    if (hsn_hsn.getText().toString().equals("")) {
                    } else {
                        receiptBitmap.drawLeftText("HSN " + hsn);
                    }
                }

            }
        }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format(Locale.US,"%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
////                        float tota = mul;
//                        String tota1 = String.format(Locale.US,"%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                        } else {
//                            if (statusnets.equals("ok")) {
//                                wifiSocket.WIFI_Write(left);    //
//                                wifiSocket.WIFI_Write(normal);
//                                wifiSocket.WIFI_Write(mod1);
//                                wifiSocket.WIFI_Write(HT);    //
//                                wifiSocket.WIFI_Write(LF);    //
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }
//            ccursor.close();


        String phon = "0";
        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
        if (caddress1.moveToFirst()) {
            phon = caddress1.getString(2);
        }
        caddress1.close();

        TextView tvvs = new TextView(Cash_Card_Credit_Sales2.this);
        tvvs.setText(phon);

        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
        if (us_name1.moveToLast()) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id there", Toast.LENGTH_LONG).show();
            String na53 = us_name1.getString(53);
            String na38 = us_name1.getString(38);
            String na39 = us_name1.getString(39);
            String na40 = us_name1.getString(40);
            String na41 = us_name1.getString(41);
            String na42 = us_name1.getString(42);
            String na43 = us_name1.getString(43);
            String na44 = us_name1.getString(44);
            String na45 = us_name1.getString(45);
            String na46 = us_name1.getString(46);
            String na47 = us_name1.getString(47);
            String na48 = us_name1.getString(48);
            String na49 = us_name1.getString(49);
            String na50 = us_name1.getString(50);
            String na51 = us_name1.getString(51);
            String na52 = us_name1.getString(52);
            String na38_value = us_name1.getString(54);
            String na39_value = us_name1.getString(55);
            String na40_value = us_name1.getString(56);
            String na41_value = us_name1.getString(57);
            String na42_value = us_name1.getString(58);
            String na43_value = us_name1.getString(59);
            String na44_value = us_name1.getString(60);
            String na45_value = us_name1.getString(61);
            String na46_value = us_name1.getString(62);
            String na47_value = us_name1.getString(63);
            String na48_value = us_name1.getString(64);
            String na49_value = us_name1.getString(65);
            String na50_value = us_name1.getString(66);
            String na51_value = us_name1.getString(67);
            String na52_value = us_name1.getString(68);

            String proc = us_name1.getString(69);

            TextView hid = new TextView(Cash_Card_Credit_Sales2.this);
            hid.setText(proc);

            if (hid.getText().toString().equals("off")) {
                Cursor cursorr = null;
                if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                            float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        receiptBitmap.drawLeftText(mod1);

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            } else {

                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                    int i1 = 0;
                    if (i2 == 38) {
                        i1 = 54;
                    }
                    if (i2 == 39) {
                        i1 = 55;
                    }
                    if (i2 == 40) {
                        i1 = 56;
                    }
                    if (i2 == 41) {
                        i1 = 57;
                    }
                    if (i2 == 42) {
                        i1 = 58;
                    }
                    if (i2 == 43) {
                        i1 = 59;
                    }
                    if (i2 == 44) {
                        i1 = 60;
                    }
                    if (i2 == 45) {
                        i1 = 61;
                    }
                    if (i2 == 46) {
                        i1 = 62;
                    }
                    if (i2 == 47) {
                        i1 = 63;
                    }
                    if (i2 == 48) {
                        i1 = 64;
                    }
                    if (i2 == 49) {
                        i1 = 65;
                    }
                    if (i2 == 50) {
                        i1 = 66;
                    }
                    if (i2 == 51) {
                        i1 = 67;
                    }
                    if (i2 == 52) {
                        i1 = 68;
                    }


                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(BeveragesMenuFragment.this);;
                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv.setGravity(Gravity.START);
                    tv.setTextSize(15);
                    //text = cursor.getString(1);
//                String v = na;

                    tv.setText(us_name1.getString(i2));


                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    //text = cursor.getString(1);
                    tv1.setText(us_name1.getString(i1));
                    String value1 = "0";
                    if (tv1.getText().toString().equals("")) {

                    } else {
                        value1 = tv1.getText().toString();
                    }


                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);
//                    Toast.makeText(BeveragesMenuFragment.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

//                    Toast.makeText(BeveragesMenuFragment.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                    TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv33.setText(String.valueOf(tota));
                    tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv33);

                    String value2 = tv33.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                    } else {
                        tableLayout1.addView(row);
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                        String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                        receiptBitmap.drawLeftText(mod1);

                    }

                }
            }

        } else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id not there", Toast.LENGTH_LONG).show();
            Cursor cursorr = null;
            if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Home delivery")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
            if (cursorr.moveToFirst()) {

                do {

                    String name = cursorr.getString(1);
                    String value = cursorr.getString(2);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                    //tv2.setLayoutParams(lp);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @ " + bvn + "%");
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    //tv3.setPadding(0,0,10,0);
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);

                    String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                    receiptBitmap.drawLeftText(mod1);

                } while (cursorr.moveToNext());
            }
            cursorr.close();
        }
        us_name1.close();

        float sum = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(2);
            sum = sum
                    + Float.parseFloat(mTextView.getText().toString());
        }


        String newsum = String.format(Locale.US,"%.2f", sum);

        if (sum == 0 || sum == 0.0 || sum == 0.00) {

        } else {
            receiptBitmap.drawLeftText("Tax"+"                       "+newsum);
        }
        ///////////ttax

        receiptBitmap.drawLeftText("       ");

        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            // Print.StartPrinting(strcompanyname ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
            receiptBitmap.drawCenterText(strbillone);
        }

        receiptBitmap.drawLeftText("       ");
        receiptBitmap.drawLeftText("       ");

        Bitmap canvasbitmap = receiptBitmap.getReceiptBitmap();

        if(ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,"getHeight: " + canvasbitmap.getHeight(),true,true);

        if(ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,"getReceiptHeight: " + receiptBitmap.getReceiptHeight(),true,true);

        Bitmap croppedBmp = Bitmap.createBitmap(canvasbitmap, 0, 0, canvasbitmap.getWidth(), canvasbitmap.getHeight());

        byte[] imageCommand = mMSWisepadDeviceController.getPrintData(croppedBmp, 150);

        baos.write(imageCommand, 0, imageCommand.length);

        if(ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,"end of reciept",true,true);

        return baos.toByteArray();

    }

    public void wiseposprintbillcopy1(Dialog dialog) {


        charlength = 10;
        charlength1 = 20;
        charlength2 = 30;
        quanlentha = 5;

//        Toast.makeText(Cash_Card_Credit_Sales2.this, "printbill", Toast.LENGTH_SHORT).show();

        imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
        mView = dialog.findViewById(R.id.f_vieww1);

        ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
        imageViewPicture.getLayoutParams().height = 94;
        imageViewPicture.getLayoutParams().width = 384;
        imageButton.getLayoutParams().height = 94;
        imageButton.getLayoutParams().width = 384;


        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            do {
                byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
                final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);

                imageButton.setImageBitmap(b1);

                mView.setDrawingCacheEnabled(true);
                mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
                        View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
                mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
                mView.buildDrawingCache(true);

                Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
                //mView.setDrawingCacheEnabled(false);
                ByteArrayOutputStream bytes = new ByteArrayOutputStream();
                b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);

                imageViewPicture.setImageBitmap(b);

                Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
                        .getBitmap();

                Print.StartPrintingImage(mBitmap, Align.CENTER);
            } while (c.moveToNext());
        } else {
            imageButton.setVisibility(View.GONE);
        }
        c.close();

        Print.StartPrinting("Bill Copy" , FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);

        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcom.moveToFirst()) {
            do {
                strcompanyname = getcom.getString(1);
                straddress1 = getcom.getString(14);
                straddress2 = getcom.getString(17);
                straddress3 = getcom.getString(18);
                strphone = getcom.getString(9);
                stremailid = getcom.getString(15);
                strwebsite = getcom.getString(16);
                strtaxone = getcom.getString(10);
                strbillone = getcom.getString(12);
            } while (getcom.moveToNext());
        }
        getcom.close();
//        Toast.makeText(getApplicationContext(), "saving4", Toast.LENGTH_LONG).show();
        tvkot.setText(strcompanyname);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(strcompanyname , FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
/////////
        tvkot.setText(straddress1);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(straddress1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
///////////////////////////////
        tvkot.setText(straddress2);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(straddress2 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
////////////////////////////////
        tvkot.setText(straddress3);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(straddress3 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
//////////////////////////
        tvkot.setText(strphone);
        String pp = "Ph. " + strphone;
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(pp ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
////////////////////////////////////
        tvkot.setText(stremailid);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(stremailid ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
////////////////////////////////////////
        tvkot.setText(strwebsite);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(strwebsite ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
///////////////////////////////////////
        tvkot.setText(strtaxone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(strtaxone ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
        Print.StartPrinting("----------------------" ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);

        Print.StartPrinting("Bill id."+bill_coun,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor10.moveToFirst()) {
            billtypea = cursor10.getString(5);
            paymmethoda = cursor10.getString(6);
        }
        cursor10.close();

        TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
        ttv.setText(billtypea);

        TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
        ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

        if (ttv.getText().toString().equals("  Cash")) {
            billtypeaa = "Cash"; //0
        }
        if (ttv.getText().toString().equals("  Card")) {
            billtypeaa = "Card"; //0
        }
        if (ttv.getText().toString().equals("  Paytm")) {
            billtypeaa = "Paytm"; //0
        }
        if (ttv.getText().toString().equals("  Mobikwik")) {
            billtypeaa = "Mobikwik"; //0
        }
        if (ttv.getText().toString().equals("  Freecharge")) {
            billtypeaa = "Freecharge"; //0
        }
        if (ttv.getText().toString().equals("  Pay Later")) {
            billtypeaa = "Pay Later"; //0
        }
        if (ttv.getText().toString().equals("  Cheque")) {
            billtypeaa = "Cheque"; //0
        }
        if (ttv.getText().toString().equals("  Sodexo")) {
            billtypeaa = "Sodexo"; //0
        }
        if (ttv.getText().toString().equals("  Zeta")) {
            billtypeaa = "Zeta"; //0
        }
        if (ttv.getText().toString().equals("  Ticket")) {
            billtypeaa = "Ticket"; //0
        }
        if (ttv.getText().toString().equals("  Upiqr")) {
            billtypeaa = "Upiqr"; //0
        }

        String bill_no = billnumb;



        //  Print.StartPrinting(strtaxone ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        String b="Bill no." + bill_no+""+billtypeaa;
        int length1=b.length();
        int splength=32-length1;
        String input="Bill no." + bill_no;
        for(int i=0;i<splength;i++){
            input=input+" ";
        }
        input=input+billtypeaa;
        Print.StartPrinting(input ,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        // Print.StartPrinting(rr2 ,FontLattice.SIXTEEN, false, Align.RIGHT, true);



        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals("  General") || ttv1.getText().toString().equals("  Others")) {
            paymmethodaa = "Dine-in";
            //billtypee.setText("Dine-in");
        } else {
            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                paymmethodaa = "Takeaway";
                //billtypee.setText("Takeaway");
            } else {
                paymmethodaa = "Home delivery";
                //billtypee.setText("Home delivery");
            }
        }

        Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (date.moveToFirst()) {
            datee = date.getString(25);
            timee = date.getString(12);
        }
        date.close();
        //  Print.StartPrinting(rr1 +"          "+normal1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);


        String b1=paymmethodaa+ datee;
        int length11=b1.length();
        int splength1=32-length11;
        String input1=paymmethodaa;
        for(int i=0;i<splength1;i++){
            input1=input1+" ";
        }
        input1=input1+datee;

        Print.StartPrinting(input1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        //  Print.StartPrinting(normal1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.RIGHT, true);



        Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (cursor9.moveToFirst()) {
            tableida = cursor9.getString(15);
            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
            if (vbnm.moveToFirst()) {
                assa1 = vbnm.getString(1);
                assa2 = vbnm.getString(2);
            }
            vbnm.close();
            TextView cx = new TextView(Cash_Card_Credit_Sales2.this);
            cx.setText(assa1);

            if (cx.getText().toString().equals("")) {
                tableidaa = "Tab" + assa2;
            } else {
                tableidaa = "Tab" + assa1;
            }

        }
        cursor9.close();


        String b2=tableidaa+""+timee;
        int length12=b2.length();
        int splength2=32-length12;
        String input2=tableidaa;
        for(int i=0;i<splength2;i++){
            input2=input2+" ";
        }
        input2=input2+timee;

        Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (cursor9_1.moveToFirst()) {
            u_name = cursor9_1.getString(45);
        }
        cursor9_1.close();

        TextView tv_u_name = new TextView(Cash_Card_Credit_Sales2.this);
        tv_u_name.setText(u_name);

        Print.StartPrinting(input2 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        // Print.StartPrinting( time1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.RIGHT, true);
        Print.StartPrinting("Counter person: "+u_name,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        String str_line = "-----------------------------";
        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);


        TextView custph = new TextView(Cash_Card_Credit_Sales2.this);

        Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
        if (caddress.moveToFirst()) {
            String nam = caddress.getString(1);
            String addr = caddress.getString(4);
            String phon = caddress.getString(2);
            String emai = caddress.getString(3);

            if (nam.length() > 0 || addr.length() > 0 ||
                    phon.length() > 0 || emai.length() > 0) {
                Print.StartPrinting("Customer:",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (nam.length() > 0) {
                Print.StartPrinting(nam,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (addr.length() > 0) {
                Print.StartPrinting(addr,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (phon.length() > 0) {
                String cust_ph = "Ph. " + phon;
                Print.StartPrinting(cust_ph,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (emai.length() > 0) {
                Print.StartPrinting(emai,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
        caddress.close();

        Print.StartPrinting("Qty"+"  "+"Item"+"        "+"Price"+"  "+"Amount",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//           Print.StartPrinting("  "+"Item",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//           Print.StartPrinting("  "+"Price",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//           Print.StartPrinting("  "+"Amount",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);


        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursorr.moveToFirst()) {

            do {

                String nbg = ccursorr.getString(0);
                String name = ccursorr.getString(1);
                String value = ccursorr.getString(2);
                String pq = ccursorr.getString(5);
                String itna = ccursorr.getString(2);
                String pricee = ccursorr.getString(3);
                String tototot = ccursorr.getString(4);

                final String newid = ccursorr.getString(20);
                int padding_in_px;

                int padding_in_dp = 30;  // 34 dps
                final float scale1 = getResources().getDisplayMetrics().density;
                padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                if (pq.equals("Item")) {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                    final TableRow row1 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                    final TableRow row2 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));

                    final TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv.setText(value);
                    row.addView(tv);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(name);
                    String value1 = tv1.getText().toString();
                    row.addView(tv1);

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setText(pricee);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(0, padding_in_px, 1.2f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv3.setText(tototot);

                    String value2 = tv3.getText().toString();

                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                    if (modcursor.moveToFirst()) {

                        Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnumb + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                        if (cursor4.moveToFirst()) {
                            float sub2a = cursor4.getFloat(0);
                            String sub2a1 = String.valueOf(sub2a);
                            ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot);
                            ss1 = String.valueOf(ss);
                        }
                        cursor4.close();

                        if (name.length() > charlength) {
                            int print1 = 0;
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "1", Toast.LENGTH_SHORT).show();

                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "2", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                Print.StartPrinting(string1quan+string1+"    "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                Print.StartPrinting(string2quan+"  "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,false);
//                                    Print.StartPrinting(string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,false);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                print1 = 1;
                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "3", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);
                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+"  "+itemName+"    "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("  "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting("     ",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }

                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "4", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0) {
                                    String itemName=string1;
                                    if(string1.length()<11){
                                        for(int i=0;i<(11-string1.length());i++){
                                            itemName=itemName+"";
                                        }
                                    }

                                    Print.StartPrinting(string1quan+" "+itemName+"   "+pricee+" "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting(string2quan+" "+string2+" "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
                                    print1 = 1;

                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "5", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+" "+itemName+"   "+pricee+" "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting(" "+string2+" "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
                                }
                            }

                        } else {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "6", Toast.LENGTH_SHORT).show();
                            String itemName=name;
                            if(name.length()<11) {
                                for (int i = 0; i < (11 - name.length()); i++) {
                                    itemName = itemName + "";
                                }
                            }
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "7", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);

                                Print.StartPrinting(string1quan+" "+itemName+"    "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                Print.StartPrinting(" "+string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
                                    }
                                }

                            } else {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "8", Toast.LENGTH_SHORT).show();
                                Print.StartPrinting(value+" "+name+"     "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
                                    }
                                }

                            }

                        }

                        do {

                            final String modiname = modcursor.getString(1);
                            final String modiquan = modcursor.getString(2);
                            String modiprice = modcursor.getString(3);
                            String moditotal = modcursor.getString(4);
                            final String modiid = modcursor.getString(0);

                            float modprice1 = Float.parseFloat(modiprice);
                            String modpricestr = String.valueOf(modprice1);

                            if (modiname.length() > charlength) {
                                if (modiname.length() > charlength) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength);
                                    Print.StartPrinting(""+">"+string1+" "+modpricestr+"",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("    "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                                if (modiname.length() > charlength1) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength, charlength1);
                                    String string3 = modiname.substring(charlength1);
                                    Print.StartPrinting(""+">"+string1+" "+modpricestr+"",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("    "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("    "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    }
                                }

                            } else {

                                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
                                Print.StartPrinting(""+">"+modiname+" "+modpricestr+""+"",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    }
                                }

                            }

                            final TableRow tableRow11 = new TableRow(Cash_Card_Credit_Sales2.this);
                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            final TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                            tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv.setGravity(Gravity.CENTER);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText("");
                            tableRow11.addView(tvv);

                            TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv4.setText(modiname);
                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv4);

                            TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv2.setPadding(0, 0, 1, 0);
                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv5.setText(modiprice);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv5);

                            TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv6.setText("");
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv6);


                            final TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv3.setPadding(0,0,10,0);
                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                            //row.addView(tv3);

                            row.removeView(tv8);


                            tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String numberr = tv.getText().toString();
                            float newmulr = Float.parseFloat(numberr);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(ss));
                            row.addView(tv8);


                            tableLayout1.addView(tableRow11);
                        } while (modcursor.moveToNext());

                        //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);
                                    Print.StartPrinting(""+""+""+"("+"-"+total_disc_print_q+")",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();

                    } else {

                        if (name.length() > charlength) {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "10", Toast.LENGTH_SHORT).show();
                            int print1 = 0;
                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);
                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }

                                //  Print.StartPrinting(string2quan+"  "+string2+""+price+"  "+pr1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                if (print1 == 0) {
                                    Print.StartPrinting(string1quan+" "+itemName+" "+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting(" "+string2quan+" "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "12", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("      "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(total,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(pr1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting("      ",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }
////////////////////////////////////////////////
                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "13", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(string1quan+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("  "+string2quan+" "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("      "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "14", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("  "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("      "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                            }

                        } else {
                            String itemName=name;
                            if(name.length()<11){
                                for(int i=0;i<(11-name.length());i++){
                                    itemName=itemName+"";
                                }
                            }
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "15", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                Print.StartPrinting(string1quan+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                Print.StartPrinting("  "+string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                            } else {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "16", Toast.LENGTH_SHORT).show();
                                Print.StartPrinting(value+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                            }


                        }

                        tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        //tv3.setPadding(0, 0, 10, 0);
                        tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                        final String number = tv.getText().toString();
                        float newmul = Float.parseFloat(number);
                        //final float in = Float.parseFloat(cursor.getString(4));
                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                        //newmul = Integer.parseInt(multiply);
                        tv8.setText(String.valueOf(multiply));
                        row.addView(tv8);

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);
                                    Print.StartPrinting(name+""+""+""+"("+"-"+total_disc_print_q+")",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();
                    }
                    modcursor.close();
                }


            } while (ccursorr.moveToNext());
        }
        ccursorr.close();
        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
////////////////////////////////////sub total
        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor3.moveToFirst()) {
            sub = cursor3.getString(7);
        }
        cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
        float to = Float.parseFloat(sub);
        String tot = String.valueOf(to);

        Print.StartPrinting("Sub total"+"              "+tot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
/////////////////////////tax




///////////////////////////////// discount

        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
        if (cursor4.moveToFirst()) {
            taxpe = cursor4.getString(5);
        } else {
            taxpe = "0";
        }
        cursor4.close();

        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
        if (cursor5.moveToFirst()) {
            dsirs = cursor5.getString(7);
        } else {
            dsirs = "0";
        }
        cursor5.close();

        String alldiscinperc1 = "Discount(" + taxpe + "%)";

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
        Print.StartPrinting(alldiscinperc1+"              "+dsirs,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        float newe;
//////////////////////////////////////////////

        Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnumb + "'", null);
        if (cursor113.moveToFirst()) {
            float level = cursor113.getFloat(0);
            total = String.valueOf(level);
            float total1 = Float.parseFloat(total);
            total_disc_print_q = String.format(Locale.US,"%.2f", total1);

            Print.StartPrinting("Savings"+"              "+total_disc_print_q,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);


            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor.moveToFirst()){
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {
                    Print.StartPrinting("Loyalty"+"              "+v_tq,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                }
            }



        }
        cursor113.close();

//////////////////////////////////////Rounded off

        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor7.moveToFirst()) {
            subro = cursor7.getString(9);
        }
        cursor7.close();

        Print.StartPrinting("Rounded"+"              "+subro,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

//////////////Total main

        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor8.moveToFirst()) {
            alltotal1 = cursor8.getString(2);
        }
        cursor8.close();

        float all = Float.parseFloat(alltotal1);
        String newf = String.valueOf(all);

        Print.StartPrinting("Total"+"              "+"Rs "+newf,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        ////////////ttax
        TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
        tableLayout1.removeAllViews();

        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor.moveToFirst()) {

            do {
                String name = ccursor.getString(10);
                String value = ccursor.getString(9);
                String pq = ccursor.getString(50);
                String itna = ccursor.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor.moveToNext());
        }
        ccursor.close();

        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor2.moveToFirst()) {

            do {
                String name = ccursor2.getString(35);
                String value = ccursor2.getString(36);
                String pq = ccursor2.getString(50);
                String itna = ccursor2.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor2.moveToNext());
        }
        ccursor2.close();

        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor3.moveToFirst()) {

            do {
                String name = ccursor3.getString(37);
                String value = ccursor3.getString(38);
                String pq = ccursor3.getString(50);
                String itna = ccursor3.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor3.moveToNext());
        }
        ccursor3.close();

        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor4.moveToFirst()) {

            do {
                String name = ccursor4.getString(39);
                String value = ccursor4.getString(40);
                String pq = ccursor4.getString(50);
                String itna = ccursor4.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor4.moveToNext());
        }
        ccursor4.close();

        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor5.moveToFirst()) {

            do {
                String name = ccursor5.getString(41);
                String value = ccursor5.getString(42);
                String pq = ccursor5.getString(50);
                String itna = ccursor5.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor5.moveToNext());
        }
        ccursor5.close();


        ArrayList<String> groupList = new ArrayList<String>();

        float sum_p = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(BeveragesMenuFragment.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

            if (groupList.contains(mTextView.getText().toString())) {

            }else {
                sum_p = 0;
                for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                    TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                    mTextView1 = (TextView) mRow1.getChildAt(0);
                    mTextView2 = (TextView) mRow1.getChildAt(2);
                    if (groupList.contains(mTextView.getText().toString())) {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    } else {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            groupList.add(mTextView.getText().toString());
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    }
                }
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                String mod1 = mTextView.getText().toString() + "---" + String.format("%.2f", sum_p);

                Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                String match = "@";
                int position = mTextView.getText().toString().indexOf(match);
                String mod2 = mTextView.getText().toString().substring(0, position);//keep toastmessage
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+mod2, Toast.LENGTH_LONG).show();
                Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor6.moveToFirst()) {
                    String hsn = ccursor6.getString(34);

                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                    hsn_hsn.setText(hsn);

                    if (hsn_hsn.getText().toString().equals("")) {
                    } else {
                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                    }
                }

            }
        }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format(Locale.US,"%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
////                        float tota = mul;
//                        String tota1 = String.format(Locale.US,"%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                        } else {
//                            if (statusnets.equals("ok")) {
//                                wifiSocket.WIFI_Write(left);    //
//                                wifiSocket.WIFI_Write(normal);
//                                wifiSocket.WIFI_Write(mod1);
//                                wifiSocket.WIFI_Write(HT);    //
//                                wifiSocket.WIFI_Write(LF);    //
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }
//            ccursor.close();


        String phon = "0";
        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
        if (caddress1.moveToFirst()) {
            phon = caddress1.getString(2);
        }
        caddress1.close();

        TextView tvvs = new TextView(Cash_Card_Credit_Sales2.this);
        tvvs.setText(phon);

        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
        if (us_name1.moveToLast()) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id there", Toast.LENGTH_LONG).show();
            String na53 = us_name1.getString(53);
            String na38 = us_name1.getString(38);
            String na39 = us_name1.getString(39);
            String na40 = us_name1.getString(40);
            String na41 = us_name1.getString(41);
            String na42 = us_name1.getString(42);
            String na43 = us_name1.getString(43);
            String na44 = us_name1.getString(44);
            String na45 = us_name1.getString(45);
            String na46 = us_name1.getString(46);
            String na47 = us_name1.getString(47);
            String na48 = us_name1.getString(48);
            String na49 = us_name1.getString(49);
            String na50 = us_name1.getString(50);
            String na51 = us_name1.getString(51);
            String na52 = us_name1.getString(52);
            String na38_value = us_name1.getString(54);
            String na39_value = us_name1.getString(55);
            String na40_value = us_name1.getString(56);
            String na41_value = us_name1.getString(57);
            String na42_value = us_name1.getString(58);
            String na43_value = us_name1.getString(59);
            String na44_value = us_name1.getString(60);
            String na45_value = us_name1.getString(61);
            String na46_value = us_name1.getString(62);
            String na47_value = us_name1.getString(63);
            String na48_value = us_name1.getString(64);
            String na49_value = us_name1.getString(65);
            String na50_value = us_name1.getString(66);
            String na51_value = us_name1.getString(67);
            String na52_value = us_name1.getString(68);

            String proc = us_name1.getString(69);

            TextView hid = new TextView(Cash_Card_Credit_Sales2.this);
            hid.setText(proc);

            if (hid.getText().toString().equals("off")) {
                Cursor cursorr = null;
                if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                            float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            } else {

                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                    int i1 = 0;
                    if (i2 == 38) {
                        i1 = 54;
                    }
                    if (i2 == 39) {
                        i1 = 55;
                    }
                    if (i2 == 40) {
                        i1 = 56;
                    }
                    if (i2 == 41) {
                        i1 = 57;
                    }
                    if (i2 == 42) {
                        i1 = 58;
                    }
                    if (i2 == 43) {
                        i1 = 59;
                    }
                    if (i2 == 44) {
                        i1 = 60;
                    }
                    if (i2 == 45) {
                        i1 = 61;
                    }
                    if (i2 == 46) {
                        i1 = 62;
                    }
                    if (i2 == 47) {
                        i1 = 63;
                    }
                    if (i2 == 48) {
                        i1 = 64;
                    }
                    if (i2 == 49) {
                        i1 = 65;
                    }
                    if (i2 == 50) {
                        i1 = 66;
                    }
                    if (i2 == 51) {
                        i1 = 67;
                    }
                    if (i2 == 52) {
                        i1 = 68;
                    }


                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(BeveragesMenuFragment.this);;
                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv.setGravity(Gravity.START);
                    tv.setTextSize(15);
                    //text = cursor.getString(1);
//                String v = na;

                    tv.setText(us_name1.getString(i2));


                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    //text = cursor.getString(1);
                    tv1.setText(us_name1.getString(i1));
                    String value1 = "0";
                    if (tv1.getText().toString().equals("")) {

                    } else {
                        value1 = tv1.getText().toString();
                    }


                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);
//                    Toast.makeText(BeveragesMenuFragment.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

//                    Toast.makeText(BeveragesMenuFragment.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                    TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv33.setText(String.valueOf(tota));
                    tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv33);

                    String value2 = tv33.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                    } else {
                        tableLayout1.addView(row);
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                        String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                        Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                    }

                }
            }

        } else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id not there", Toast.LENGTH_LONG).show();
            Cursor cursorr = null;
            if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Home delivery")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
            if (cursorr.moveToFirst()) {

                do {

                    String name = cursorr.getString(1);
                    String value = cursorr.getString(2);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                    //tv2.setLayoutParams(lp);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @ " + bvn + "%");
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    //tv3.setPadding(0,0,10,0);
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);

                    String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                    Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                } while (cursorr.moveToNext());
            }
            cursorr.close();
        }
        us_name1.close();

        float sum = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(2);
            sum = sum
                    + Float.parseFloat(mTextView.getText().toString());
        }


        String newsum = String.format(Locale.US,"%.2f", sum);



        if (sum == 0 || sum == 0.0 || sum == 0.00) {

        } else {
            Print.StartPrinting(getString(R.string.action_tax)+"              "+newsum,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        }
        ////////////ttax

        Print.StartPrinting("",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            // Print.StartPrinting(strcompanyname ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
            Print.StartPrinting(strbillone,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        }
        Print.StartPrinting("",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        Print.StartPrinting("",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        TextEntity textleft = new TextEntity("left",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        textleft.newline = false;

        TextEntity textright = new TextEntity("right",FontLattice.TWENTY_FOUR, mswipe_text, Align.RIGHT, true);
        textright.newline = false;


        //footer();
    }

    public void printbillcopy1(Dialog dialog) {


        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }
        connnet.close();

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }
        connusb.close();

        byte[] LF1 = {0x0d,0x0a};

        allbufline = new byte[][]{
                " ".getBytes(),LF1
        };

        //Toast.makeText(Cash_Card_Credit_Sales2.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};

        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }
        print_ty.close();

        Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if (cc.moveToFirst()) {
            cc.moveToFirst();
            do {
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    if (str_print_ty.toString().equals("Generic") || str_print_ty.toString().equals("Epson/others")) {
                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                        setHT32122 = new byte[]{0x1b, 0x44, 0x24, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x28, 0x00};//4 tabs 3"
                        nPaperWidth = 576;
                        charlength = 22;
                        charlength1 = 46;
                        charlength2 = 69;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "------------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------------".getBytes(), LF
                        };
                    } else {
                        if (str_print_ty.toString().equals("POS")) {
                            setHT32 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT32122 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                            setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x10, 0x14, 0x00};//4 tabs 3"
                            nPaperWidth = 576;
                            charlength = 22;
                            charlength1 = 46;
                            charlength2 = 69;
                            quanlentha = 4;
                            HT1 = new byte[]{0x2F};
                            str_line = "------------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------------".getBytes(), LF

                            };
                        }
                    }
                } else {
                    if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(BeveragesMenuFragment_Dine.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT32122 = new byte[]{0x1b, 0x44, 0x14, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x10, 0x18, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 8;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    } else {
                        if (str_print_ty.toString().equals("Epson/others")) {
//                            Toast.makeText(BeveragesMenuFragment_Dine.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT32122 = new byte[]{0x1b, 0x44, 0x20, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x17, 0x20, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 14;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        } else {
                            if (str_print_ty.toString().equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT32122 = new byte[]{0x1b, 0x44, 0x08, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x06, 0x08, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 9;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 3;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }

                }
            } while (cc.moveToNext());
        }
        cc.close();

        String dd = "";
        TextView qazcvb = new TextView(Cash_Card_Credit_Sales2.this);
        Cursor cvonnusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (cvonnusb.moveToFirst()) {
            addgets = cvonnusb.getString(1);
            namegets = cvonnusb.getString(2);
            statussusbs = cvonnusb.getString(3);
            dd = cvonnusb.getString(4);
        }
        cvonnusb.close();
        qazcvb.setText(dd);
        if (qazcvb.getText().toString().equals("usb") && statussusbs.equals("ok")) {
//            runPrintCouponSequence(dialog);
            print_printbillcopy1(dialog);
        }else {
            imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
            mView = dialog.findViewById(R.id.f_vieww1);


            allbuf1 = new byte[][]{
                    bold, un, "Bill copy".getBytes(), LF

            };
            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(un);    //
                BT_Write("Bill copy");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(un);    //
                    wifiSocket2.WIFI_Write("Bill copy");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(un);    //
                        wifiSocket.WIFI_Write("Bill copy");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
            //LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(116, 95);
            //imageButton.setLayoutParams(layoutParams);
            //imageButton.setLayoutParams(116, 95);

            if (NAME.equals("3 inch")) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "3 inch", Toast.LENGTH_SHORT).show();
                imageViewPicture.getLayoutParams().height = 94;
                imageViewPicture.getLayoutParams().width = 576;
                imageButton.getLayoutParams().height = 94;
                imageButton.getLayoutParams().width = 576;
            } else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "2 inch", Toast.LENGTH_SHORT).show();
                imageViewPicture.getLayoutParams().height = 94;
                imageViewPicture.getLayoutParams().width = 384;
                imageButton.getLayoutParams().height = 94;
                imageButton.getLayoutParams().width = 384;
            }

            String[] col = {"companylogo"};
            Cursor c = db1.query("Logo", col, null, null, null, null, null);
            if (c.moveToFirst()) {
                do {
                    byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
                    final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);

                    imageButton.setImageBitmap(b1);


                    mView.setDrawingCacheEnabled(true);
                    mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
                            View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
                    mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
                    mView.buildDrawingCache(true);

                    Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
                    //mView.setDrawingCacheEnabled(false);
                    ByteArrayOutputStream bytes = new ByteArrayOutputStream();
                    b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);

                    imageViewPicture.setImageBitmap(b);

                    Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
                            .getBitmap();


                    //if (mBitmap != null) {
                    if (statussusbs.equals("ok")) {
                        if (mBitmap != null) {
                            byte[] command = Utils.decodeBitmap(mBitmap);
                            printByteData(command);
                        } else {
                            Log.e("Print Photo error", "the file isn't exists");
                        }
                        Bundle data = new Bundle();
                        //data.putParcelable(Global.OBJECT1, mBitmap);
                        data.putParcelable(Global.PARCE1, mBitmap);
                        data.putInt(Global.INTPARA1, nPaperWidth);
                        data.putInt(Global.INTPARA2, 0);
//                        DrawerService.workThread.handleCmd(
//                                Global.CMD_POS_PRINTBWPICTURE, data);
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            if (mBitmap != null) {
                                byte[] command = Utils.decodeBitmap(mBitmap);
                                printByteData_wifi_counter(command);
                            } else {
                                Log.e("Print Photo error", "the file isn't exists");
                            }
                            Bundle data = new Bundle();
                            data.putParcelable(Global1.PARCE1, mBitmap);
                            data.putInt(Global1.INTPARA1, nPaperWidth);
                            data.putInt(Global1.INTPARA2, 0);
                        }else {
                            if (statusnets.equals("ok")) {
                                if (mBitmap != null) {
                                    byte[] command = Utils.decodeBitmap(mBitmap);
                                    printByteData_wifi(command);
                                } else {
                                    Log.e("Print Photo error", "the file isn't exists");
                                }
                                Bundle data = new Bundle();
                                data.putParcelable(Global1.PARCE1, mBitmap);
                                data.putInt(Global1.INTPARA1, nPaperWidth);
                                data.putInt(Global1.INTPARA2, 0);
                            }
                        }
                    }
                    //}
                } while (c.moveToNext());
            } else {
                imageButton.setVisibility(View.GONE);
            }
            c.close();

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }
            getcom.close();


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(bold);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strcompanyname);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(bold);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strcompanyname);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(bold);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strcompanyname);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(straddress1);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(straddress1);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(straddress1);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(straddress2);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(straddress2);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(straddress2);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(straddress3);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(straddress3);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(straddress3);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(pp);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(pp);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(pp);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(stremailid);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(stremailid);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(stremailid);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(strwebsite);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(strwebsite);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(strwebsite);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(strtaxone);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(strtaxone);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(strtaxone);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }




            Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor10.moveToFirst()) {
                billtypea = cursor10.getString(5);
                paymmethoda = cursor10.getString(6);
            }
            cursor10.close();

            TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
            ttv.setText(billtypea);

            TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
            ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

            if (ttv.getText().toString().equals("  Cash")) {
                billtypeaa = "Cash"; //0
            }
            if (ttv.getText().toString().equals("  Card")) {
                billtypeaa = "Card"; //0
            }
            if (ttv.getText().toString().equals("  Paytm")) {
                billtypeaa = "Paytm"; //0
            }
            if (ttv.getText().toString().equals("  Mobikwik")) {
                billtypeaa = "Mobikwik"; //0
            }
            if (ttv.getText().toString().equals("  Freecharge")) {
                billtypeaa = "Freecharge"; //0
            }
            if (ttv.getText().toString().equals("  Pay Later")) {
                billtypeaa = "Pay Later"; //0
            }
            if (ttv.getText().toString().equals("  Cheque")) {
                billtypeaa = "Cheque"; //0
            }
            if (ttv.getText().toString().equals("  Sodexo")) {
                billtypeaa = "Sodexo"; //0
            }
            if (ttv.getText().toString().equals("  Zeta")) {
                billtypeaa = "Zeta"; //0
            }
            if (ttv.getText().toString().equals("  Ticket")) {
                billtypeaa = "Ticket"; //0
            }
            if (ttv.getText().toString().equals(" Upiqr")) {
                billtypeaa = "upiqr"; //0
            }
            if (ttv.getText().toString().equals("  Upiqr")) {
                billtypeaa = "Upiqr"; //0
            }
            billtypeaa = ttv.getText().toString().replace(" ", "");

            //String bill_no = billnum.getText().toString();
            allbufbillno = new byte[][]{
                    setHT32, un1, billnumb.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            if (str_print_ty.equals("POS")) {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT321);    //
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BT_Write("Bill no." + billnumb);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT321);    //
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write("Bill no." + billnumb);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT321);    //
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write("Bill no." + billnumb);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }else {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT32);    //
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BT_Write("Bill no."+billnumb);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT32);    //
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write("Bill no."+billnumb);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT32);    //
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write("Bill no."+billnumb);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            if (str_print_ty.equals("POS")) {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT321);    //
                    BT_Write(billtypeaa);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT321);
                        wifiSocket2.WIFI_Write(billtypeaa);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT321);    //
                            wifiSocket.WIFI_Write(billtypeaa);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }else {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT32);    //
                    BT_Write(billtypeaa);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT32);    //
                        wifiSocket2.WIFI_Write(billtypeaa);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT32);    //
                            wifiSocket.WIFI_Write(billtypeaa);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals("  General") || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                //billtypee.setText("Dine-in");
                if (account_selection.toString().equals("Dine") || account_selection.toString().equals("Qsr")) {
                    paymmethodaa = "Dine-in";
                }else {
                    paymmethodaa = "General";
                }
            } else {
                if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                    paymmethodaa = "Takeaway";
                    //billtypee.setText("Takeaway");
                } else {
                    paymmethodaa = "Home delivery";
                    //billtypee.setText("Home delivery");
                }
            }

            Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);
            if (date.moveToFirst()) {
                datee = date.getString(25);
                timee = date.getString(12);
            }
            date.close();

            allbuf10 = new byte[][]{
                    setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), datee.getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(paymmethodaa);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  " + datee);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(paymmethodaa);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  " + datee);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(paymmethodaa);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  " + datee);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
            if (cursor9.moveToFirst()) {
                tableida = cursor9.getString(15);
                Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
                if (vbnm.moveToFirst()) {
                    assa1 = vbnm.getString(1);
                    assa2 = vbnm.getString(2);
                }
                vbnm.close();
                TextView cx = new TextView(Cash_Card_Credit_Sales2.this);
                cx.setText(assa1);

                if (cx.getText().toString().equals("")) {
                    tableidaa = "Tab" + assa2;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                } else {
                    tableidaa = "Tab" + assa1;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                }

            }
            cursor9.close();

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(tableidaa);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  " + timee);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(tableidaa);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  " + timee);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(tableidaa);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  " + timee);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
            if (cursor9_1.moveToFirst()) {
                u_name = cursor9_1.getString(45);
            }
            cursor9_1.close();

            TextView tv_u_name = new TextView(Cash_Card_Credit_Sales2.this);
            tv_u_name.setText(u_name);

            if (tv_u_name.getText().toString().equals("")){

            }else {
                allbuf11 = new byte[][]{
                        left, setHT321, "Counter person ".getBytes(), LF
                };
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(left);    //
                    BluetoothPrintDriver.BT_Write(setHT321);    //
                    BT_Write("Counter person: " + tv_u_name.getText().toString());
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write(setHT321);    //
                        wifiSocket2.WIFI_Write("Counter person: " + tv_u_name.getText().toString());
                        wifiSocket2.WIFI_Write(LF);    //
                    } else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write(setHT321);    //
                            wifiSocket.WIFI_Write("Counter person: " + tv_u_name.getText().toString());
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

            Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
            if (caddress.moveToFirst()) {
                String nam = caddress.getString(1);
                String addr = caddress.getString(4);
                String phon = caddress.getString(2);
                String emai = caddress.getString(3);

                if (nam.length() > 0 || addr.length() > 0 ||
                        phon.length() > 0 || emai.length() > 0) {
                    allbufcust = new byte[][]{
                            left, un, "Customer:".getBytes(), LF, un1,
                    };

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(un);    //
                        BT_Write("Customer:");
                        BluetoothPrintDriver.BT_Write(LF);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(un);    //
                            wifiSocket2.WIFI_Write("Customer:");
                            wifiSocket2.WIFI_Write(LF);    //
                            wifiSocket2.WIFI_Write(un1);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(un);    //
                                wifiSocket.WIFI_Write("Customer:");
                                wifiSocket.WIFI_Write(LF);    //
                                wifiSocket.WIFI_Write(un1);    //
                            }
                        }
                    }
                } else {

                }

                if (nam.length() > 0) {
                    allbufcustname = new byte[][]{
                            nam.getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(nam);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(nam);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(nam);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (addr.length() > 0) {
                    allbufcustadd = new byte[][]{
                            addr.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(addr);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(addr);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(addr);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (phon.length() > 0) {
                    String cust_ph = "Ph. " + phon;
                    allbufcustph = new byte[][]{
                            cust_ph.getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(cust_ph);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(cust_ph);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(cust_ph);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (emai.length() > 0) {
                    allbufcustemail = new byte[][]{
                            emai.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(emai);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(emai);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(emai);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(left);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BT_Write(str_line);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(left);	//
                        wifiSocket2.WIFI_Write(un1);	//
                        wifiSocket2.WIFI_Write(str_line);
                        wifiSocket2.WIFI_Write(LF);	//
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(left);	//
                            wifiSocket.WIFI_Write(un1);	//
                            wifiSocket.WIFI_Write(str_line);
                            wifiSocket.WIFI_Write(LF);	//
                        }
                    }
                }
            }
            caddress.close();

            allbufqty = new byte[][]{
                    setHT34, normal, "Qty".getBytes(), HT, "Item".getBytes(), HT, "Price".getBytes(), HT, "Amount".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT34);    //
                BluetoothPrintDriver.BT_Write(normal);    //
                BT_Write("Qty");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Item");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  Price");
                BluetoothPrintDriver.BT_Write(HT1);    //
                BT_Write("  Amount");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT34);    //
                    wifiSocket2.WIFI_Write(normal);    //
                    wifiSocket2.WIFI_Write("Qty");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Item");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  Price");
                    wifiSocket2.WIFI_Write(HT1);    //
                    wifiSocket2.WIFI_Write("  Amount");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT34);    //
                        wifiSocket.WIFI_Write(normal);    //
                        wifiSocket.WIFI_Write("Qty");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Item");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  Price");
                        wifiSocket.WIFI_Write(HT1);    //
                        wifiSocket.WIFI_Write("  Amount");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

            Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursorr.moveToFirst()) {

                do {

                    String nbg = ccursorr.getString(0);
                    String name = ccursorr.getString(1);
                    String value = ccursorr.getString(2);
                    String pq = ccursorr.getString(5);
                    String itna = ccursorr.getString(2);
                    String pricee = ccursorr.getString(3);
                    String tototot = ccursorr.getString(4);
                    String tototot1 = ccursorr.getString(4);

                    if (pricee.length() > 7) {
//                        price = " "+price;
                    }
                    if (pricee.length() == 6) {
                        pricee = " "+pricee;
                    }
                    if (pricee.length() == 5) {
                        pricee = "  "+pricee;
                    }
                    if (pricee.length() == 4) {
                        pricee = "   "+pricee;
                    }
                    if (pricee.length() == 3) {
                        pricee = "    "+pricee;
                    }

                    if (tototot.length() >= 8) {

                    }
                    if (tototot.length() == 7) {
                        tototot = " "+tototot;
                    }
                    if (tototot.length() == 6) {
                        tototot = "  "+tototot;
                    }
                    if (tototot.length() == 5) {
                        tototot = "   "+tototot;
                    }
                    if (tototot.length() == 4) {
                        tototot = "    "+tototot;
                    }
                    if (tototot.length() == 3) {
                        tototot = "     "+tototot;
                    }

                    final String newid = ccursorr.getString(20);
                    int padding_in_px;

                    int padding_in_dp = 30;  // 34 dps
                    final float scale1 = getResources().getDisplayMetrics().density;
                    padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                    if (pq.equals("Item")) {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                        final TableRow row1 = new TableRow(Cash_Card_Credit_Sales2.this);
                        row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                        final TableRow row2 = new TableRow(Cash_Card_Credit_Sales2.this);
                        row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));

                        final TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                        tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv.setText(value);
                        row.addView(tv);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setGravity(Gravity.CENTER_VERTICAL);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(name);
                        String value1 = tv1.getText().toString();
                        row.addView(tv1);

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setText(pricee);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv3.setText(tototot1);

                        String value2 = tv3.getText().toString();

                        Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                        if (modcursor.moveToFirst()) {

                            Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnumb + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                            if (cursor4.moveToFirst()) {
                                float sub2a = cursor4.getFloat(0);
                                String sub2a1 = String.valueOf(sub2a);
                                ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot1);
                                ss1 = String.valueOf(ss);

                                if (ss1.length() >= 8) {

                                }
                                if (ss1.length() == 7) {
                                    ss1 = " "+ss1;
                                }
                                if (ss1.length() == 6) {
                                    ss1 = "  "+ss1;
                                }
                                if (ss1.length() == 5) {
                                    ss1 = "   "+ss1;
                                }
                                if (ss1.length() == 4) {
                                    ss1 = "    "+ss1;
                                }
                                if (ss1.length() == 3) {
                                    ss1 = "     "+ss1;
                                }

                            }
                            cursor4.close();

                            if (name.length() > charlength) {
                                int print1 = 0;
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "1", Toast.LENGTH_SHORT).show();

                                if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "2", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "3", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }

                                if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "4", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "5", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };

                                    if(print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("HSN "+hsn);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("HSN "+hsn);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("HSN "+hsn);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                }

                            } else {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "6", Toast.LENGTH_SHORT).show();
                                if (value.length() > quanlentha) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "7", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(string1quan);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(ss1);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                        BT_Write(string2quan);
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(string1quan);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(ss1);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                            wifiSocket2.WIFI_Write(string2quan);
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(string1quan);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(ss1);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                                wifiSocket.WIFI_Write(string2quan);
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                } else {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "8", Toast.LENGTH_SHORT).show();
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), left, LF,
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(value);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(ss1);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(value);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(ss1);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(value);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(ss1);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                }

                            }

                            do {

                                final String modiname = modcursor.getString(1);
                                final String modiquan = modcursor.getString(2);
                                String modiprice = modcursor.getString(3);
                                String moditotal = modcursor.getString(4);
                                final String modiid = modcursor.getString(0);

                                float modprice1 = Float.parseFloat(modiprice);
                                String modpricestr = String.valueOf(modprice1);

                                if (modiname.length() > charlength) {
                                    if (modiname.length() > charlength) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT1, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(">");
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(modpricestr);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("    ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(">");
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(modpricestr);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("    ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(">");
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(modpricestr);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("    ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                    if (modiname.length() > charlength1) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength, charlength1);
                                        String string3 = modiname.substring(charlength1);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT1, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF, "    ".getBytes(), string3.getBytes(), left, LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(">");
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(modpricestr);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("    ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("    ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(">");
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(modpricestr);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("    ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("    ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(">");
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(modpricestr);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("    ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("    ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                } else {
                                    allbufmodifiers = new byte[][]{
                                            setHT34, normal, "".getBytes(), HT, ">".getBytes(), modiname.getBytes(), HT, modpricestr.getBytes(), HT1, "".getBytes(), left, LF
                                            //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                    };
                                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write("");
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(">");
                                        BT_Write(modiname);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(modpricestr);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write("");
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write("");
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(">");
                                            wifiSocket2.WIFI_Write(modiname);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(modpricestr);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write("");
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write("");
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(">");
                                                wifiSocket.WIFI_Write(modiname);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(modpricestr);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write("");
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                }

                                final TableRow tableRow11 = new TableRow(Cash_Card_Credit_Sales2.this);
                                tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                        TableRow.LayoutParams.MATCH_PARENT,
                                        TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                final TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                                // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                                tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                //tv.setGravity(Gravity.CENTER);
                                tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tvv.setText("");
                                tableRow11.addView(tvv);

                                TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv4.setText(modiname);
                                tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv4.setGravity(Gravity.CENTER_VERTICAL);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv4);

                                TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv2.setPadding(0, 0, 1, 0);
                                tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv5.setText(modiprice);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv5);

                                TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setPadding(5, 0, 0, 0);
                                tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv6.setText("");
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv6);


                                final TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv3.setPadding(0,0,10,0);
                                tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                                final String number = tv.getText().toString();
                                float newmul = Float.parseFloat(number);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                                //row.addView(tv3);

                                row.removeView(tv8);


                                tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                                tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                //tv3.setPadding(0, 0, 10, 0);
                                tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                final String numberr = tv.getText().toString();
                                float newmulr = Float.parseFloat(numberr);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                tv8.setText(String.valueOf(ss));
                                row.addView(tv8);


                                tableLayout1.addView(tableRow11);
                            } while (modcursor.moveToNext());

                            //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.equals("no")) {

                                    } else {

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT1, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("(");
                                            BT_Write("-");
                                            BT_Write(total_disc_print_q);
                                            BT_Write(")");
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("(");
                                                wifiSocket2.WIFI_Write("-");
                                                wifiSocket2.WIFI_Write(total_disc_print_q);
                                                wifiSocket2.WIFI_Write(")");
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("(");
                                                    wifiSocket.WIFI_Write("-");
                                                    wifiSocket.WIFI_Write(total_disc_print_q);
                                                    wifiSocket.WIFI_Write(")");
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }
                            disc_cursor.close();

                        } else {

                            if (name.length() > charlength) {
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "10", Toast.LENGTH_SHORT).show();
                                int print1 = 0;
                                if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "12", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
////////////////////////////////////////////////
                                if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "13", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "14", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("HSN "+hsn);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("HSN "+hsn);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("HSN "+hsn);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                }

                            } else {
                                if (value.length() > quanlentha) {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "15", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(string1quan);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(tototot);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                        BT_Write(string2quan);
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(string1quan);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(tototot);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                            wifiSocket2.WIFI_Write(string2quan);
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(string1quan);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(tototot);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                                wifiSocket.WIFI_Write(string2quan);
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }
                                } else {
//                                    Toast.makeText(Cash_Card_Credit_Sales2.this, "16", Toast.LENGTH_SHORT).show();
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), left, LF,
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(value);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(tototot);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(value);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(tototot);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(value);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(tototot);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("HSN "+hsn);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("HSN "+hsn);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("HSN "+hsn);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                }


                            }

                            tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String pricee1 = ccursorr.getString(3);
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee1));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(multiply));
                            row.addView(tv8);

                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.equals("no")) {

                                    } else {

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT1, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("(");
                                            BT_Write("-");
                                            BT_Write(total_disc_print_q);
                                            BT_Write(")");
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("(");
                                                wifiSocket2.WIFI_Write("-");
                                                wifiSocket2.WIFI_Write(total_disc_print_q);
                                                wifiSocket2.WIFI_Write(")");
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("(");
                                                    wifiSocket.WIFI_Write("-");
                                                    wifiSocket.WIFI_Write(total_disc_print_q);
                                                    wifiSocket.WIFI_Write(")");
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }
                            disc_cursor.close();
                        }
                        modcursor.close();
                    }


                } while (ccursorr.moveToNext());
            }
            ccursorr.close();

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }
////////////////////////////////////sub total
            Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor3.moveToFirst()) {
                sub = cursor3.getString(7);
            }
            cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
            float to = Float.parseFloat(sub);
            String tot = String.format("%.2f", to);

            if (tot.length() >= 11) {

            }
            if (tot.length() == 10) {
                tot = " "+tot;
            }
            if (tot.length() == 9) {
                tot = "  "+tot;
            }
            if (tot.length() == 8) {
                tot = "   "+tot;
            }
            if (tot.length() == 7) {
                tot = "    "+tot;
            }
            if (tot.length() == 6) {
                tot = "     "+tot;
            }
            if (tot.length() == 5) {
                tot = "      "+tot;
            }
            if (tot.length() == 4) {
                tot = "       "+tot;
            }
            allbufsubtot = new byte[][]{
                    setHT3212, left, "Sub total".getBytes(), HT, tot.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT3212);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write("Sub total");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write(tot);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT3212);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write("Sub total");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(tot);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT3212);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write("Sub total");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(tot);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }
/////////////////////////tax




///////////////////////////////// discount

            Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
            if (cursor4.moveToFirst()) {
                taxpe = cursor4.getString(5);
            } else {
                taxpe = "0.00";
            }
            cursor4.close();

            Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
            if (cursor5.moveToFirst()) {
                dsirs = cursor5.getString(7);
            } else {
                dsirs = "0.00";
            }
            cursor5.close();

            String alldiscinperc1 = "Discount(" + taxpe + "%)";
            allbufdisc = new byte[][]{
                    setHT3212, left, alldiscinperc1.getBytes(), HT, dsirs.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            if (dsirs.length() >= 11) {

            }
            if (dsirs.length() == 10) {
                dsirs = " "+dsirs;
            }
            if (dsirs.length() == 9) {
                dsirs = "  "+dsirs;
            }
            if (dsirs.length() == 8) {
                dsirs = "   "+dsirs;
            }
            if (dsirs.length() == 7) {
                dsirs = "    "+dsirs;
            }
            if (dsirs.length() == 6) {
                dsirs = "     "+dsirs;
            }
            if (dsirs.length() == 5) {
                dsirs = "      "+dsirs;
            }
            if (dsirs.length() == 4) {
                dsirs = "       "+dsirs;
            }

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT3212);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(alldiscinperc1);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write(dsirs);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT3212);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(alldiscinperc1);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(dsirs);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT3212);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(alldiscinperc1);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(dsirs);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }
            float newe;
//////////////////////////////////////////////

            Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnumb + "'", null);
            if (cursor113.moveToFirst()) {
                float level = cursor113.getFloat(0);
                total = String.valueOf(level);
                float total1 = Float.parseFloat(total);
                total_disc_print_q = String.format(Locale.US,"%.2f", total1);

                if (total_disc_print_q.length() >= 11) {

                }
                if (total_disc_print_q.length() == 10) {
                    total_disc_print_q = " "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 9) {
                    total_disc_print_q = "  "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 8) {
                    total_disc_print_q = "   "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 7) {
                    total_disc_print_q = "    "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 6) {
                    total_disc_print_q = "     "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 5) {
                    total_disc_print_q = "      "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 4) {
                    total_disc_print_q = "       "+total_disc_print_q;
                }

                allbufrounded = new byte[][]{
                        setHT3212, left, "Savings".getBytes(), HT, total_disc_print_q.getBytes(), LF
                };

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT3212);    //
                    BluetoothPrintDriver.BT_Write(left);    //
                    BT_Write("Savings");
                    BluetoothPrintDriver.BT_Write(HT);    //
                    BT_Write(total_disc_print_q);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT3212);    //
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write("Savings");
                        wifiSocket2.WIFI_Write(HT);    //
                        wifiSocket2.WIFI_Write(total_disc_print_q);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT3212);    //
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write("Savings");
                            wifiSocket.WIFI_Write(HT);    //
                            wifiSocket.WIFI_Write(total_disc_print_q);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }

            }
            cursor113.close();
////////////////////////////////

            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor.moveToFirst()){
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                String v_tq_loy = String.format("%.2f", v_tq);

                if (v_tq_loy.length() >= 11) {

                }
                if (v_tq_loy.length() == 10) {
                    v_tq_loy = " "+v_tq_loy;
                }
                if (v_tq_loy.length() == 9) {
                    v_tq_loy = "  "+v_tq_loy;
                }
                if (v_tq_loy.length() == 8) {
                    v_tq_loy = "   "+v_tq_loy;
                }
                if (v_tq_loy.length() == 7) {
                    v_tq_loy = "    "+v_tq_loy;
                }
                if (v_tq_loy.length() == 6) {
                    v_tq_loy = "     "+v_tq_loy;
                }
                if (v_tq_loy.length() == 5) {
                    v_tq_loy = "      "+v_tq_loy;
                }
                if (v_tq_loy.length() == 4) {
                    v_tq_loy = "       "+v_tq_loy;
                }

                TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {
                    allbufrounded = new byte[][]{
                            setHT3212, left, "Loyalty".getBytes(), HT, v_tq.getBytes(), LF
                    };

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT3212);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write("Loyalty(" + t_total_points + ")");
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(v_tq_loy);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT3212);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write("Loyalty(" + t_total_points + ")");
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(v_tq_loy);
                            wifiSocket2.WIFI_Write(LF);    //
                        } else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT3212);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write("Loyalty(" + t_total_points + ")");
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(v_tq_loy);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                }
            }

//////////////////////////////////////Rounded off

            Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor7.moveToFirst()) {
                subro = cursor7.getString(9);
            }
            cursor7.close();

//            float subro1 = Float.parseFloat(subro);
//            subro = String.format("%.2f", subro1);

            if (subro.length() >= 11) {

            }
            if (subro.length() == 10) {
                subro = " "+subro;
            }
            if (subro.length() == 9) {
                subro = "  "+subro;
            }
            if (subro.length() == 8) {
                subro = "   "+subro;
            }
            if (subro.length() == 7) {
                subro = "    "+subro;
            }
            if (subro.length() == 6) {
                subro = "     "+subro;
            }
            if (subro.length() == 5) {
                subro = "      "+subro;
            }
            if (subro.length() == 4) {
                subro = "       "+subro;
            }

            allbufrounded = new byte[][]{
                    setHT3212, left, "Rounded".getBytes(), HT, subro.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT3212);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write("Rounded");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write(subro);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT3212);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write("Rounded");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(subro);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT3212);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write("Rounded");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(subro);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }
//////////////Total main

            Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor8.moveToFirst()) {
                alltotal1 = cursor8.getString(2);
            }
            cursor8.close();

            float all = Float.parseFloat(alltotal1);
            String newf = String.format("%.2f", all);

            allbufrounded = new byte[][]{
                    setHT32122, left, "Total".getBytes(), HT, "Rs ".getBytes(), newf.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };
            String allt = insert1_rs+""+newf;
            if (allt.length() >= 12) {

            }
            if (allt.length() == 11) {
                allt = " "+allt;
            }
            if (allt.length() == 10) {
                allt = "  "+allt;
            }
            if (allt.length() == 9) {
                allt = "   "+allt;
            }
            if (allt.length() == 8) {
                allt = "    "+allt;
            }
            if (allt.length() == 7) {
                allt = "     "+allt;
            }
            if (allt.length() == 6) {
                allt = "      "+allt;
            }
            if (allt.length() == 5) {
                allt = "       "+allt;
            }
            if (allt.length() == 4) {
                allt = "        "+allt;
            }

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT32122);    //
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write("Total");
                BluetoothPrintDriver.BT_Write(HT);    //
//                BT_Write(insert1_rs);
//                BT_Write(newf);
                BT_Write(allt);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT32122);    //
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write("Total");
                    wifiSocket2.WIFI_Write(HT);    //
//                    wifiSocket2.WIFI_Write(insert1_rs);
//                    wifiSocket2.WIFI_Write(newf);
                    wifiSocket2.WIFI_Write(allt);    //
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT32122);    //
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write("Total");
                        wifiSocket.WIFI_Write(HT);    //
//                        wifiSocket.WIFI_Write(insert1_rs);
//                        wifiSocket.WIFI_Write(newf);
                        wifiSocket.WIFI_Write(allt);    //
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(normal);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(normal);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(normal);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

            /////////////ttax
            TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
            tableLayout1.removeAllViews();

            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor.moveToFirst()) {

                do {
                    String name = ccursor.getString(10);
                    String value = ccursor.getString(9);
                    String pq = ccursor.getString(50);
                    String itna = ccursor.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor.moveToNext());
            }
            ccursor.close();

            Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor2.moveToFirst()) {

                do {
                    String name = ccursor2.getString(35);
                    String value = ccursor2.getString(36);
                    String pq = ccursor2.getString(50);
                    String itna = ccursor2.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor2.moveToNext());
            }
            ccursor2.close();

            Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor3.moveToFirst()) {

                do {
                    String name = ccursor3.getString(37);
                    String value = ccursor3.getString(38);
                    String pq = ccursor3.getString(50);
                    String itna = ccursor3.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor3.moveToNext());
            }
            ccursor3.close();

            Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor4.moveToFirst()) {

                do {
                    String name = ccursor4.getString(39);
                    String value = ccursor4.getString(40);
                    String pq = ccursor4.getString(50);
                    String itna = ccursor4.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor4.moveToNext());
            }
            ccursor4.close();

            Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor5.moveToFirst()) {

                do {
                    String name = ccursor5.getString(41);
                    String value = ccursor5.getString(42);
                    String pq = ccursor5.getString(50);
                    String itna = ccursor5.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor5.moveToNext());
            }
            ccursor5.close();


            ArrayList<String> groupList = new ArrayList<String>();

            float sum_p = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

                if (groupList.contains(mTextView.getText().toString())) {

                }else {
                    sum_p = 0;
                    for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                        TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                        mTextView1 = (TextView) mRow1.getChildAt(0);
                        mTextView2 = (TextView) mRow1.getChildAt(2);
                        if (groupList.contains(mTextView.getText().toString())) {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        } else {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                groupList.add(mTextView.getText().toString());
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        }
                    }
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                    String mod1 = mTextView.getText().toString() + "" + String.format("%.2f", sum_p);
                    String mod12 = mTextView.getText().toString();
                    String sum_p_float = String.format("%.2f", sum_p);

                    if (sum_p_float.length() >= 11) {

                    }
                    if (sum_p_float.length() == 10) {
                        sum_p_float = " "+sum_p_float;
                    }
                    if (sum_p_float.length() == 9) {
                        sum_p_float = "  "+sum_p_float;
                    }
                    if (sum_p_float.length() == 8) {
                        sum_p_float = "   "+sum_p_float;
                    }
                    if (sum_p_float.length() == 7) {
                        sum_p_float = "    "+sum_p_float;
                    }
                    if (sum_p_float.length() == 6) {
                        sum_p_float = "     "+sum_p_float;
                    }
                    if (sum_p_float.length() == 5) {
                        sum_p_float = "      "+sum_p_float;
                    }
                    if (sum_p_float.length() == 4) {
                        sum_p_float = "       "+sum_p_float;
                    }

                    allbuftaxestype1 = new byte[][]{
                            left, normal, mod12.getBytes(), HT, LF
                            //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT3212);    //
                        BT_Write(normal);
                        BT_Write(mod12);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(sum_p_float);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT3212);    //
                            wifiSocket2.WIFI_Write(normal);
                            wifiSocket2.WIFI_Write(mod12);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(sum_p_float);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT3212);    //
                                wifiSocket.WIFI_Write(normal);
                                wifiSocket.WIFI_Write(mod12);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(sum_p_float);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

//                    String match = "@";
//                    int position = mTextView.getText().toString().indexOf(match);
                    String mod2 = mTextView.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+mod2, Toast.LENGTH_LONG).show();
                    Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    if (ccursor6.moveToFirst()) {
                        String hsn = ccursor6.getString(34);

                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                        hsn_hsn.setText(hsn);

                        if (hsn_hsn.getText().toString().equals("")) {
                        } else {
                            allbuftaxestype1 = new byte[][]{
                                    left, normal, hsn.getBytes(), HT, LF
                            };
                            if (statussusbs.equals("ok")) {
                                BluetoothPrintDriver.BT_Write(left);    //
                                BT_Write(normal);
                                BT_Write("HSN "+hsn);
                                BluetoothPrintDriver.BT_Write(HT);    //
                                BluetoothPrintDriver.BT_Write(LF);    //
                            } else {
                                if (statusnets_counter.equals("ok")) {
                                    wifiSocket2.WIFI_Write(left);    //
                                    wifiSocket2.WIFI_Write(normal);
                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                    wifiSocket2.WIFI_Write(HT);    //
                                    wifiSocket2.WIFI_Write(LF);    //
                                }else {
                                    if (statusnets.equals("ok")) {
                                        wifiSocket.WIFI_Write(left);    //
                                        wifiSocket.WIFI_Write(normal);
                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                        wifiSocket.WIFI_Write(HT);    //
                                        wifiSocket.WIFI_Write(LF);    //
                                    }
                                }
                            }
                        }
                    }

                }
            }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format(Locale.US,"%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
////                        float tota = mul;
//                        String tota1 = String.format(Locale.US,"%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                        } else {
//                            if (statusnets.equals("ok")) {
//                                wifiSocket.WIFI_Write(left);    //
//                                wifiSocket.WIFI_Write(normal);
//                                wifiSocket.WIFI_Write(mod1);
//                                wifiSocket.WIFI_Write(HT);    //
//                                wifiSocket.WIFI_Write(LF);    //
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }
//            ccursor.close();


            String phon = "0";
            Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
            if (caddress1.moveToFirst()) {
                phon = caddress1.getString(2);
            }
            caddress1.close();

            TextView tvvs = new TextView(Cash_Card_Credit_Sales2.this);
            tvvs.setText(phon);

            Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
            if (us_name1.moveToLast()) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id there", Toast.LENGTH_LONG).show();
                String na53 = us_name1.getString(53);
                String na38 = us_name1.getString(38);
                String na39 = us_name1.getString(39);
                String na40 = us_name1.getString(40);
                String na41 = us_name1.getString(41);
                String na42 = us_name1.getString(42);
                String na43 = us_name1.getString(43);
                String na44 = us_name1.getString(44);
                String na45 = us_name1.getString(45);
                String na46 = us_name1.getString(46);
                String na47 = us_name1.getString(47);
                String na48 = us_name1.getString(48);
                String na49 = us_name1.getString(49);
                String na50 = us_name1.getString(50);
                String na51 = us_name1.getString(51);
                String na52 = us_name1.getString(52);
                String na38_value = us_name1.getString(54);
                String na39_value = us_name1.getString(55);
                String na40_value = us_name1.getString(56);
                String na41_value = us_name1.getString(57);
                String na42_value = us_name1.getString(58);
                String na43_value = us_name1.getString(59);
                String na44_value = us_name1.getString(60);
                String na45_value = us_name1.getString(61);
                String na46_value = us_name1.getString(62);
                String na47_value = us_name1.getString(63);
                String na48_value = us_name1.getString(64);
                String na49_value = us_name1.getString(65);
                String na50_value = us_name1.getString(66);
                String na51_value = us_name1.getString(67);
                String na52_value = us_name1.getString(68);

                String proc = us_name1.getString(69);

                TextView hid = new TextView(Cash_Card_Credit_Sales2.this);
                hid.setText(proc);

                if (hid.getText().toString().equals("off")) {
                    Cursor cursorr = null;
                    if (paymmethoda.equals("  Dine-in") || paymmethoda.equals(getString(R.string.general)) || paymmethoda.equals("  Others")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.equals("  Home delivery")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                    if (cursorr.moveToFirst()) {

                        do {

                            String name = cursorr.getString(1);
                            String value = cursorr.getString(2);

                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT));
                            row.setGravity(Gravity.CENTER);

                            TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv1.setText(value);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format(Locale.US,"%.2f", vbn);
                            tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                            //tv2.setLayoutParams(lp);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                            tv2.append(name + " @ " + bvn + "%");
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            //tv3.setPadding(0,0,10,0);
                            tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                            float tota = mul;
                            String tota1 = String.format(Locale.US,"%.2f", tota);
                            tv3.setText(String.valueOf(tota));
                            //row.addView(tv3);


                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value2 = tv3.getText().toString();
                            row.addView(tv3);

                            tableLayout1.addView(row);

                            String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                            String mod1_1 = name + "" + String.valueOf(tota1);
                            String mod12 = name;
                            String sum_p_float = String.valueOf(tota1);

                            if (sum_p_float.length() >= 11) {

                            }
                            if (sum_p_float.length() == 10) {
                                sum_p_float = " "+sum_p_float;
                            }
                            if (sum_p_float.length() == 9) {
                                sum_p_float = "  "+sum_p_float;
                            }
                            if (sum_p_float.length() == 8) {
                                sum_p_float = "   "+sum_p_float;
                            }
                            if (sum_p_float.length() == 7) {
                                sum_p_float = "    "+sum_p_float;
                            }
                            if (sum_p_float.length() == 6) {
                                sum_p_float = "     "+sum_p_float;
                            }
                            if (sum_p_float.length() == 5) {
                                sum_p_float = "      "+sum_p_float;
                            }
                            if (sum_p_float.length() == 4) {
                                sum_p_float = "       "+sum_p_float;
                            }

                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                                    //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                            };
                            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                            if (statussusbs.equals("ok")) {
//                                BluetoothPrintDriver.BT_Write(left);    //
//                                BT_Write(normal);
//                                BT_Write(mod1);
//                                BluetoothPrintDriver.BT_Write(HT);    //
//                                BluetoothPrintDriver.BT_Write(LF);    //
                                BluetoothPrintDriver.BT_Write(setHT3212);    //
                                BT_Write(normal);
                                BT_Write(mod12);
                                BluetoothPrintDriver.BT_Write(HT);    //
                                BT_Write(sum_p_float);
                                BluetoothPrintDriver.BT_Write(LF);    //
                            } else {
                                if (statusnets_counter.equals("ok")) {
                                    wifiSocket2.WIFI_Write(setHT3212);    //
                                    wifiSocket2.WIFI_Write(normal);
                                    wifiSocket2.WIFI_Write(mod12);
                                    wifiSocket2.WIFI_Write(HT);    //
                                    wifiSocket2.WIFI_Write(sum_p_float);
                                    wifiSocket2.WIFI_Write(LF);    //
                                }else {
                                    if (statusnets.equals("ok")) {
                                        wifiSocket.WIFI_Write(setHT3212);    //
                                        wifiSocket.WIFI_Write(normal);
                                        wifiSocket.WIFI_Write(mod12);
                                        wifiSocket.WIFI_Write(HT);    //
                                        wifiSocket.WIFI_Write(sum_p_float);
                                        wifiSocket.WIFI_Write(LF);    //
                                    }
                                }
                            }

                        } while (cursorr.moveToNext());
                    }
                    cursorr.close();
                } else {

                    for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                        int i1 = 0;
                        if (i2 == 38) {
                            i1 = 54;
                        }
                        if (i2 == 39) {
                            i1 = 55;
                        }
                        if (i2 == 40) {
                            i1 = 56;
                        }
                        if (i2 == 41) {
                            i1 = 57;
                        }
                        if (i2 == 42) {
                            i1 = 58;
                        }
                        if (i2 == 43) {
                            i1 = 59;
                        }
                        if (i2 == 44) {
                            i1 = 60;
                        }
                        if (i2 == 45) {
                            i1 = 61;
                        }
                        if (i2 == 46) {
                            i1 = 62;
                        }
                        if (i2 == 47) {
                            i1 = 63;
                        }
                        if (i2 == 48) {
                            i1 = 64;
                        }
                        if (i2 == 49) {
                            i1 = 65;
                        }
                        if (i2 == 50) {
                            i1 = 66;
                        }
                        if (i2 == 51) {
                            i1 = 67;
                        }
                        if (i2 == 52) {
                            i1 = 68;
                        }


                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);;
                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv.setGravity(Gravity.START);
                        tv.setTextSize(15);
                        //text = cursor.getString(1);
//                String v = na;

                        tv.setText(us_name1.getString(i2));


                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        //text = cursor.getString(1);
                        tv1.setText(us_name1.getString(i1));
                        String value1 = "0";
                        if (tv1.getText().toString().equals("")) {

                        } else {
                            value1 = tv1.getText().toString();
                        }


                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                        TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                        float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv33.setText(String.valueOf(tota));
                        tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv3.setTextColor(Color.parseColor("#000000"));
                        //row.addView(tv3);


                        tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv33);

                        String value2 = tv33.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                        if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                                || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                        } else {
                            tableLayout1.addView(row);
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                            String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                            String mod1_1 = us_name1.getString(i2) + "" + String.valueOf(tota1);
                            String mod12 = us_name1.getString(i2);
                            String sum_p_float = String.valueOf(tota1);

                            if (sum_p_float.length() >= 11) {

                            }
                            if (sum_p_float.length() == 10) {
                                sum_p_float = " "+sum_p_float;
                            }
                            if (sum_p_float.length() == 9) {
                                sum_p_float = "  "+sum_p_float;
                            }
                            if (sum_p_float.length() == 8) {
                                sum_p_float = "   "+sum_p_float;
                            }
                            if (sum_p_float.length() == 7) {
                                sum_p_float = "    "+sum_p_float;
                            }
                            if (sum_p_float.length() == 6) {
                                sum_p_float = "     "+sum_p_float;
                            }
                            if (sum_p_float.length() == 5) {
                                sum_p_float = "      "+sum_p_float;
                            }
                            if (sum_p_float.length() == 4) {
                                sum_p_float = "       "+sum_p_float;
                            }

                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                            };

                            if (statussusbs.equals("ok")) {
//                                BluetoothPrintDriver.BT_Write(left);    //
//                                BT_Write(normal);
//                                BT_Write(mod1);
//                                BluetoothPrintDriver.BT_Write(HT);    //
//                                BluetoothPrintDriver.BT_Write(LF);    //
                                BluetoothPrintDriver.BT_Write(setHT3212);    //
                                BT_Write(normal);
                                BT_Write(mod12);
                                BluetoothPrintDriver.BT_Write(HT);    //
                                BT_Write(sum_p_float);
                                BluetoothPrintDriver.BT_Write(LF);    //
                            } else {
                                if (statusnets_counter.equals("ok")) {
                                    wifiSocket2.WIFI_Write(setHT3212);    //
                                    wifiSocket2.WIFI_Write(normal);
                                    wifiSocket2.WIFI_Write(mod12);
                                    wifiSocket2.WIFI_Write(HT);    //
                                    wifiSocket2.WIFI_Write(sum_p_float);
                                    wifiSocket2.WIFI_Write(LF);    //
                                }else {
                                    if (statusnets.equals("ok")) {
                                        wifiSocket.WIFI_Write(setHT3212);    //
                                        wifiSocket.WIFI_Write(normal);
                                        wifiSocket.WIFI_Write(mod12);
                                        wifiSocket.WIFI_Write(HT);    //
                                        wifiSocket.WIFI_Write(sum_p_float);
                                        wifiSocket.WIFI_Write(LF);    //
                                    }
                                }
                            }

                        }

                    }
                }

            } else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id not there", Toast.LENGTH_LONG).show();
                Cursor cursorr = null;
                if (paymmethoda.equals("  Dine-in") || paymmethoda.equals(getString(R.string.general)) || paymmethoda.equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                        float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        String mod1_1 = name + "" + String.valueOf(tota1);
                        String mod12 = name;
                        String sum_p_float = String.valueOf(tota1);

                        if (sum_p_float.length() >= 11) {

                        }
                        if (sum_p_float.length() == 10) {
                            sum_p_float = " "+sum_p_float;
                        }
                        if (sum_p_float.length() == 9) {
                            sum_p_float = "  "+sum_p_float;
                        }
                        if (sum_p_float.length() == 8) {
                            sum_p_float = "   "+sum_p_float;
                        }
                        if (sum_p_float.length() == 7) {
                            sum_p_float = "    "+sum_p_float;
                        }
                        if (sum_p_float.length() == 6) {
                            sum_p_float = "     "+sum_p_float;
                        }
                        if (sum_p_float.length() == 5) {
                            sum_p_float = "      "+sum_p_float;
                        }
                        if (sum_p_float.length() == 4) {
                            sum_p_float = "       "+sum_p_float;
                        }

                        allbuftaxestype2 = new byte[][]{
                                left, normal, mod1.getBytes(), HT, LF
                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
                            BluetoothPrintDriver.BT_Write(setHT3212);    //
                            BT_Write(normal);
                            BT_Write(mod12);
                            BluetoothPrintDriver.BT_Write(HT);    //
                            BT_Write(sum_p_float);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.equals("ok")) {
                                wifiSocket2.WIFI_Write(setHT3212);    //
                                wifiSocket2.WIFI_Write(normal);
                                wifiSocket2.WIFI_Write(mod12);
                                wifiSocket2.WIFI_Write(HT);    //
                                wifiSocket2.WIFI_Write(sum_p_float);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.equals("ok")) {
                                    wifiSocket.WIFI_Write(setHT3212);    //
                                    wifiSocket.WIFI_Write(normal);
                                    wifiSocket.WIFI_Write(mod12);
                                    wifiSocket.WIFI_Write(HT);    //
                                    wifiSocket.WIFI_Write(sum_p_float);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            }
            us_name1.close();

            float sum = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(2);
                sum = sum
                        + Float.parseFloat(mTextView.getText().toString());
            }


            String newsum = String.format("%.2f", sum);

            if (newsum.length() >= 11) {

            }
            if (newsum.length() == 10) {
                newsum = " "+newsum;
            }
            if (newsum.length() == 9) {
                newsum = "  "+newsum;
            }
            if (newsum.length() == 8) {
                newsum = "   "+newsum;
            }
            if (newsum.length() == 7) {
                newsum = "    "+newsum;
            }
            if (newsum.length() == 6) {
                newsum = "     "+newsum;
            }
            if (newsum.length() == 5) {
                newsum = "      "+newsum;
            }
            if (newsum.length() == 4) {
                newsum = "       "+newsum;
            }

            if (sum == 0 || sum == 0.0 || sum == 0.00) {

            } else {
                allbuftax = new byte[][]{
                        setHT3212, left, getString(R.string.action_tax).getBytes(), HT, newsum.getBytes(), LF
                };

                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT3212);    //
                    BluetoothPrintDriver.BT_Write(left);    //
                    BT_Write(getString(R.string.action_tax));
                    BluetoothPrintDriver.BT_Write(HT);    //
                    BT_Write(newsum);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT3212);    //
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write(getString(R.string.action_tax));
                        wifiSocket2.WIFI_Write(HT);    //
                        wifiSocket2.WIFI_Write(newsum);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT3212);    //
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write(getString(R.string.action_tax));
                            wifiSocket.WIFI_Write(HT);    //
                            wifiSocket.WIFI_Write(newsum);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }
            /////////////ttax

            tvkot.setText(bill_coun);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, bill_coun.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(left);    //
                    BT_Write("Bill id.");
                    BT_Write(bill_coun);
                    BluetoothPrintDriver.BT_Write(LF);    //
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write("Bill id.");
                        wifiSocket2.WIFI_Write(bill_coun);
                        wifiSocket2.WIFI_Write(LF);    //
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write("Bill id.");
                            wifiSocket.WIFI_Write(bill_coun);
                            wifiSocket.WIFI_Write(LF);    //
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            footer();
        }
    }

    public void footer(){

        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x27, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x08,0x17,0x27,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    allbufline = new byte[][]{
                            left, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    setHT32 = new byte[]{0x1b,0x44,0x19,0x00};//2 tabs 2"
                    setHT321 = new byte[]{0x1b,0x44,0x13,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x15,0x00};//2 tabs 3"
                    setHT33 = new byte[] {0x1b,0x44,0x09,0x19,0x00};//3 tabs 2"
                    setHT34 = new byte[]{0x1b,0x44,0x04,0x12,0x19,0x00};//4 tabs 2"
                    nPaperWidth = 384;
                    allbufline = new byte[][]{
                            left, "--------------------------------".getBytes(), LF

                    };
                }
            }while(cc.moveToNext());
        }


//        allbuf2 = new byte[][]{
//                normal, "Thank you! visit again.".getBytes(), LF, LF
//
//        };
//        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//        if (statussusbs.toString().equals("ok")) {
//            BluetoothPrintDriver.BT_Write(normal);	//
//            BT_Write("Thank you! visit again.");
//            BluetoothPrintDriver.BT_Write(LF);	//
//            BluetoothPrintDriver.BT_Write(LF);	//
//        } else {
//            if (statusnets_counter.toString().equals("ok")) {
//                wifiSocket2.WIFI_Write(normal);	//
//                wifiSocket2.WIFI_Write("Thank you! visit again.");
//                wifiSocket2.WIFI_Write(LF);	//
//                wifiSocket2.WIFI_Write(LF);	//
//            }else {
//                if (statusnets.toString().equals("ok")) {
//                    wifiSocket.WIFI_Write(normal);	//
//                    wifiSocket.WIFI_Write("Thank you! visit again.");
//                    wifiSocket.WIFI_Write(LF);	//
//                    wifiSocket.WIFI_Write(LF);	//
//                }
//            }
//        }

        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")){

        }else {
            allbuf2 = new byte[][]{
                    normal, strbillone.getBytes(), LF

            };
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(normal);	//
                BluetoothPrintDriver.BT_Write(cen);	//
                BT_Write(strbillone);
                BluetoothPrintDriver.BT_Write(LF);	//
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(normal);	//
                    wifiSocket2.WIFI_Write(cen);	//
                    wifiSocket2.WIFI_Write(strbillone);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(normal);	//
                        wifiSocket.WIFI_Write(cen);	//
                        wifiSocket.WIFI_Write(strbillone);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }
        }

        feedcut();

    }

    public void feedcut(){
        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                }
                else {
                    feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                }
            }while(cc.moveToNext());
        }

        byte[][] allbuf = new byte[][]{
                feedcut2
        };
        if (statussusbs.toString().equals("ok")) {
            BluetoothPrintDriver.BT_Write(feedcut2);	//
        }else {
            if (statusnets_counter.toString().equals("ok")) {
                wifiSocket2.WIFI_Write(feedcut2);	//
            }else {
                if (statusnets.toString().equals("ok")) {
                    wifiSocket.WIFI_Write(feedcut2);	//
                }
            }
        }

        if (str_print_ty.equals("POS")) {
            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(feedcut2);	//
            }else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(feedcut2);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(feedcut2);	//
                    }
                }
            }
        }
    }

    public void print_printbillcopy1(Dialog dialog) {

        fmt = new Formatter();

        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }
        connnet.close();

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }
        connusb.close();

        byte[] LF1 = {0x0d,0x0a};

        allbufline = new byte[][]{
                " ".getBytes(),LF1
        };

        //Toast.makeText(Cash_Card_Credit_Sales2.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};

        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }
        print_ty.close();


        imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
        mView = dialog.findViewById(R.id.f_vieww1);

        ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
        //LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(116, 95);
        //imageButton.setLayoutParams(layoutParams);
        //imageButton.setLayoutParams(116, 95);

        if (NAME.equals("3 inch")) {
//            Toast.makeText(Cash_Card_Credit_Sales.this, "3 inch", Toast.LENGTH_SHORT).show();
            imageViewPicture.getLayoutParams().height = 94;
            imageViewPicture.getLayoutParams().width = 576;
            imageButton.getLayoutParams().height = 94;
            imageButton.getLayoutParams().width = 576;
        } else {
//            Toast.makeText(Cash_Card_Credit_Sales.this, "2 inch", Toast.LENGTH_SHORT).show();
            imageViewPicture.getLayoutParams().height = 94;
            imageViewPicture.getLayoutParams().width = 384;
            imageButton.getLayoutParams().height = 94;
            imageButton.getLayoutParams().width = 384;
        }

        int image_there = 0;
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            do {
                byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
                final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);

                imageButton.setImageBitmap(b1);


                mView.setDrawingCacheEnabled(true);
                mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
                        View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
                mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
                mView.buildDrawingCache(true);

                Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
                //mView.setDrawingCacheEnabled(false);
                ByteArrayOutputStream bytes = new ByteArrayOutputStream();
                b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);

                imageViewPicture.setImageBitmap(b);

                Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
                        .getBitmap();


                //if (mBitmap != null) {
                image_there = 1;
                command = Utils.decodeBitmap(mBitmap);
                //}
            } while (c.moveToNext());
        } else {
            imageButton.setVisibility(View.GONE);
        }
        c.close();

        fmt.format("Bill copy"+"\n");

//        ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
        //LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(116, 95);
        //imageButton.setLayoutParams(layoutParams);
        //imageButton.setLayoutParams(116, 95);

//        if (NAME.equals("3 inch")) {
////            Toast.makeText(Cash_Card_Credit_Sales.this, "3 inch", Toast.LENGTH_SHORT).show();
//            imageViewPicture.getLayoutParams().height = 94;
//            imageViewPicture.getLayoutParams().width = 576;
//            imageButton.getLayoutParams().height = 94;
//            imageButton.getLayoutParams().width = 576;
//        } else {
////            Toast.makeText(Cash_Card_Credit_Sales.this, "2 inch", Toast.LENGTH_SHORT).show();
//            imageViewPicture.getLayoutParams().height = 94;
//            imageViewPicture.getLayoutParams().width = 384;
//            imageButton.getLayoutParams().height = 94;
//            imageButton.getLayoutParams().width = 384;
//        }

//        String[] col = {"companylogo"};
//        Cursor c = db1.query("Logo", col, null, null, null, null, null);

//        if (c.moveToFirst()) {
//            do {
//                byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
//                final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);
//
//                imageButton.setImageBitmap(b1);
//
//
//                mView.setDrawingCacheEnabled(true);
//                mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
//                        View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
//                mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
//                mView.buildDrawingCache(true);
//
//                Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
//                //mView.setDrawingCacheEnabled(false);
//                ByteArrayOutputStream bytes = new ByteArrayOutputStream();
//                b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);
//
//                imageViewPicture.setImageBitmap(b);
//
//                Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
//                        .getBitmap();
//
//
//                //if (mBitmap != null) {
//                if (statussusbs.equals("ok")) {
//                    if (mBitmap != null) {
//                        byte[] command = Utils.decodeBitmap(mBitmap);
//                        printByteData(command);
//                    } else {
//                        Log.e("Print Photo error", "the file isn't exists");
//                    }
//                    Bundle data = new Bundle();
//                    //data.putParcelable(Global.OBJECT1, mBitmap);
//                    data.putParcelable(Global.PARCE1, mBitmap);
//                    data.putInt(Global.INTPARA1, nPaperWidth);
//                    data.putInt(Global.INTPARA2, 0);
////                        DrawerService.workThread.handleCmd(
////                                Global.CMD_POS_PRINTBWPICTURE, data);
//                } else {
//                    if (statusnets_counter.equals("ok")) {
//                        if (mBitmap != null) {
//                            byte[] command = Utils.decodeBitmap(mBitmap);
//                            printByteData_wifi_counter(command);
//                        } else {
//                            Log.e("Print Photo error", "the file isn't exists");
//                        }
//                        Bundle data = new Bundle();
//                        data.putParcelable(Global1.PARCE1, mBitmap);
//                        data.putInt(Global1.INTPARA1, nPaperWidth);
//                        data.putInt(Global1.INTPARA2, 0);
//                    }else {
//                        if (statusnets.equals("ok")) {
//                            if (mBitmap != null) {
//                                byte[] command = Utils.decodeBitmap(mBitmap);
//                                printByteData_wifi(command);
//                            } else {
//                                Log.e("Print Photo error", "the file isn't exists");
//                            }
//                            Bundle data = new Bundle();
//                            data.putParcelable(Global1.PARCE1, mBitmap);
//                            data.putInt(Global1.INTPARA1, nPaperWidth);
//                            data.putInt(Global1.INTPARA2, 0);
//                        }
//                    }
//                }
//                //}
//            } while (c.moveToNext());
//        } else {
//            imageButton.setVisibility(View.GONE);
//        }
//        c.close();

        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcom.moveToFirst()) {
            do {
                strcompanyname = getcom.getString(1);
                straddress1 = getcom.getString(14);
                straddress2 = getcom.getString(17);
                straddress3 = getcom.getString(18);
                strphone = getcom.getString(2);
                stremailid = getcom.getString(15);
                strwebsite = getcom.getString(16);
                strtaxone = getcom.getString(10);
                strbillone = getcom.getString(12);
            } while (getcom.moveToNext());
        }
        getcom.close();


        tvkot.setText(strcompanyname);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strcompanyname+"\n");
        }

/////////
        tvkot.setText(straddress1);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(straddress1+"\n");
        }


        tvkot.setText(straddress2);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(straddress2+"\n");
        }


        tvkot.setText(strphone);
        String pp = "Ph. " + strphone;
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strphone+"\n");
        }


        tvkot.setText(stremailid);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(stremailid+"\n");
        }


        tvkot.setText(strwebsite);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strwebsite+"\n");
        }


        tvkot.setText(strtaxone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strtaxone+"\n");
        }

        fmt.format("------------------------------------------------", " ");


        Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor10.moveToFirst()) {
            billtypea = cursor10.getString(5);
            paymmethoda = cursor10.getString(6);
        }
        cursor10.close();

        TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
        ttv.setText(billtypea);

        TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
        ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

        if (ttv.getText().toString().equals("  Cash")) {
            billtypeaa = "Cash"; //0
        }
        if (ttv.getText().toString().equals("  Card")) {
            billtypeaa = "Card"; //0
        }
        if (ttv.getText().toString().equals("  Paytm")) {
            billtypeaa = "Paytm"; //0
        }
        if (ttv.getText().toString().equals("  Mobikwik")) {
            billtypeaa = "Mobikwik"; //0
        }
        if (ttv.getText().toString().equals("  Freecharge")) {
            billtypeaa = "Freecharge"; //0
        }
        if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
            billtypeaa = getString(R.string.pay_later_nospace); //0
        }
        if (ttv.getText().toString().equals("  Cheque")) {
            billtypeaa = "Cheque"; //0
        }
        if (ttv.getText().toString().equals("  Sodexo")) {
            billtypeaa = "Sodexo"; //0
        }
        if (ttv.getText().toString().equals("  Zeta")) {
            billtypeaa = "Zeta"; //0
        }
        if (ttv.getText().toString().equals("  Ticket")) {
            billtypeaa = "Ticket"; //0
        }
        if (ttv.getText().toString().equals(" Upiqr")) {
            billtypeaa = "upiqr"; //0
        }
        if (ttv.getText().toString().equals("  Upiqr")) {
            billtypeaa = "Upiqr"; //0
        }
        billtypeaa = ttv.getText().toString().replace(" ", "");

        //String bill_no = billnum.getText().toString();

//        fmt.format("%-34s %13s\n", "Bill no." + billnumb, "");
        fmt.format("Bill no." + billnumb+"\n");

//        fmt.format("%-34s %13s\n", billtypeaa, "");
        fmt.format(billtypeaa+"\n");

        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
            //billtypee.setText("Dine-in");
            if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                paymmethodaa = "Dine-in";
            }else {
                paymmethodaa = getString(R.string.pref_header_general);
            }
        } else {
            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                paymmethodaa = "Takeaway";
                //billtypee.setText("Takeaway");
            } else {
                paymmethodaa = "Home delivery";
                //billtypee.setText("Home delivery");
            }
        }

        Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (date.moveToFirst()) {
            datee = date.getString(25);
            timee = date.getString(12);
        }
        date.close();

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
        fmt.format("%-34s %13s\n", paymmethodaa, datee);

        Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (cursor9.moveToFirst()) {
            tableida = cursor9.getString(15);
            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
            if (vbnm.moveToFirst()) {
                assa1 = vbnm.getString(1);
                assa2 = vbnm.getString(2);
            }
            vbnm.close();
            TextView cx = new TextView(Cash_Card_Credit_Sales2.this);
            cx.setText(assa1);

            if (cx.getText().toString().equals("")) {
                tableidaa = "Tab" + assa2;
            } else {
                tableidaa = "Tab" + assa1;
            }

        }
        cursor9.close();

        fmt.format("%-34s %13s\n", tableidaa, timee);

        Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
        if (cursor9_1.moveToFirst()) {
            u_name = cursor9_1.getString(45);
        }
        cursor9_1.close();

        TextView tv_u_name = new TextView(Cash_Card_Credit_Sales2.this);
        tv_u_name.setText(u_name);

        if (tv_u_name.getText().toString().equals("")){

        }else {
            fmt.format("Counter person: " + tv_u_name.getText().toString()+"\n");
        }

        fmt.format("------------------------------------------------", " ");

        Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
        if (caddress.moveToFirst()) {
            String nam = caddress.getString(1);
            String addr = caddress.getString(4);
            String phon = caddress.getString(2);
            String emai = caddress.getString(3);

            if (nam.length() > 0 || addr.length() > 0 ||
                    phon.length() > 0 || emai.length() > 0) {
                fmt.format("Customer:"+"\n");
            } else {

            }

            if (nam.length() > 0) {
                fmt.format(nam+"\n");
            } else {

            }

            if (addr.length() > 0) {
                fmt.format(addr+"\n");
            } else {

            }

            if (phon.length() > 0) {
                String cust_ph = "Ph. " + phon;
                fmt.format(cust_ph+"\n");
            } else {

            }

            if (emai.length() > 0) {
                fmt.format(emai+"\n");
            } else {

            }

            fmt.format("------------------------------------------------", " ");
        }
        caddress.close();

        fmt.format("%-5s %-25s %7s %7s\n", "Qty", "Item", "Price", "Amount");

        fmt.format("------------------------------------------------", " ");

        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursorr.moveToFirst()) {

            do {

                String nbg = ccursorr.getString(0);
                String name = ccursorr.getString(1);
                String value = ccursorr.getString(2);
                String pq = ccursorr.getString(5);
                String itna = ccursorr.getString(2);
                String pricee = ccursorr.getString(3);
                String tototot = ccursorr.getString(4);
                String tototot1 = ccursorr.getString(4);

//                if (pricee.length() > 7) {
////                        price = " "+price;
//                }
//                if (pricee.length() == 6) {
//                    pricee = " "+pricee;
//                }
//                if (pricee.length() == 5) {
//                    pricee = "  "+pricee;
//                }
//                if (pricee.length() == 4) {
//                    pricee = "   "+pricee;
//                }
//                if (pricee.length() == 3) {
//                    pricee = "    "+pricee;
//                }
//
//                if (tototot.length() >= 8) {
//
//                }
//                if (tototot.length() == 7) {
//                    tototot = " "+tototot;
//                }
//                if (tototot.length() == 6) {
//                    tototot = "  "+tototot;
//                }
//                if (tototot.length() == 5) {
//                    tototot = "   "+tototot;
//                }
//                if (tototot.length() == 4) {
//                    tototot = "    "+tototot;
//                }
//                if (tototot.length() == 3) {
//                    tototot = "     "+tototot;
//                }

                final String newid = ccursorr.getString(20);
                int padding_in_px;

                int padding_in_dp = 30;  // 34 dps
                final float scale1 = getResources().getDisplayMetrics().density;
                padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                if (pq.equals(getString(R.string.action_item))) {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                    final TableRow row1 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                    final TableRow row2 = new TableRow(Cash_Card_Credit_Sales2.this);
                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));

                    final TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv.setText(value);
                    row.addView(tv);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(name);
                    String value1 = tv1.getText().toString();
                    row.addView(tv1);

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setText(pricee);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv3.setText(tototot1);

                    String value2 = tv3.getText().toString();

                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                    if (modcursor.moveToFirst()) {

                        Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnumb + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                        if (cursor4.moveToFirst()) {
                            float sub2a = cursor4.getFloat(0);
                            String sub2a1 = String.valueOf(sub2a);
                            ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot1);
                            ss1 = String.valueOf(ss);

//                            if (ss1.length() >= 8) {
//
//                            }
//                            if (ss1.length() == 7) {
//                                ss1 = " "+ss1;
//                            }
//                            if (ss1.length() == 6) {
//                                ss1 = "  "+ss1;
//                            }
//                            if (ss1.length() == 5) {
//                                ss1 = "   "+ss1;
//                            }
//                            if (ss1.length() == 4) {
//                                ss1 = "    "+ss1;
//                            }
//                            if (ss1.length() == 3) {
//                                ss1 = "     "+ss1;
//                            }

                        }
                        cursor4.close();

                        String[][] items_array = {{value, name, pricee, ss1}};

                        for (int i = 0; i < items_array.length; i++) {
                            List<String> item_split_qty = new ArrayList<>();
                            List<String> item_split_item = new ArrayList<>();
                            List<String> item_split_price = new ArrayList<>();
                            List<String> item_split_amount = new ArrayList<>();

                            for (int j = 0; j < items_array[i][0].length(); j += 5) {
                                item_split_qty.add(items_array[i][0].substring(j, Math.min(items_array[i][0].length(), j + 5)));
                            }
                            for (int j = 0; j < items_array[i][1].length(); j += 25) {
                                item_split_item.add(items_array[i][1].substring(j, Math.min(items_array[i][1].length(), j + 25)));
                            }
                            for (int j = 0; j < items_array[i][2].length(); j += 7) {
                                item_split_price.add(items_array[i][2].substring(j, Math.min(items_array[i][2].length(), j + 7)));
                            }
                            for (int j = 0; j < items_array[i][3].length(); j += 7) {
                                item_split_amount.add(items_array[i][3].substring(j, Math.min(items_array[i][3].length(), j + 7)));
                            }

                            Log.d("DATA_QTY", String.valueOf(item_split_qty));
                            Log.d("DATA_ITEM", String.valueOf(item_split_item));
                            Log.d("DATA_PRICE", String.valueOf(item_split_price));
                            Log.d("DATA_Amount", String.valueOf(item_split_amount));

                            List<Integer> maxListValue = new ArrayList<>();
                            maxListValue.add(item_split_qty.size());
                            maxListValue.add(item_split_item.size());
                            maxListValue.add(item_split_price.size());
                            maxListValue.add(item_split_amount.size());

                            int maxValue = maxListValue.get(0);

                            for (int x = 1; x < maxListValue.size(); x++) {
                                if (maxValue < maxListValue.get(x)) {
                                    maxValue = maxListValue.get(x);
                                }
                            }

                            Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                            for (int k = 0; k < maxValue; k++) {

                                String qty,item,price_new,amount = "";

                                boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                boolean item_check = (k >= 0) && (k < item_split_item.size());
                                boolean price_check = (k >= 0) && (k < item_split_price.size());
                                boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                if(qty_check == true){
                                    qty = item_split_qty.get(k);
                                }
                                else {
                                    qty = " ";
                                }
                                if(item_check == true){
                                    item = item_split_item.get(k);
                                }
                                else {
                                    item = " ";
                                }
                                if(price_check == true){
                                    price_new = item_split_price.get(k);
                                }
                                else {
                                    price_new = " ";
                                }
                                if(amount_check == true){
                                    amount = item_split_amount.get(k);
                                }
                                else {
                                    amount = " ";
                                }

                                fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                            }
                            item_split_qty.removeAll(item_split_qty);
                            item_split_item.removeAll(item_split_item);
                            item_split_price.removeAll(item_split_price);
                            item_split_amount.removeAll(item_split_amount);

                        }

                        do {

                            final String modiname = modcursor.getString(1);
                            final String modiquan = modcursor.getString(2);
                            String modiprice = modcursor.getString(3);
                            String moditotal = modcursor.getString(4);
                            final String modiid = modcursor.getString(0);

                            float modprice1 = Float.parseFloat(modiprice);
                            String modpricestr = String.valueOf(modprice1);

                            String[][] items_array1 = {{"", ">", modiname, modpricestr}};

                            for (int i = 0; i < items_array1.length; i++) {
                                List<String> item_split_qty = new ArrayList<>();
                                List<String> item_split_item = new ArrayList<>();
                                List<String> item_split_price = new ArrayList<>();
                                List<String> item_split_amount = new ArrayList<>();

                                for (int j = 0; j < items_array1[i][0].length(); j += 5) {
                                    item_split_qty.add(items_array1[i][0].substring(j, Math.min(items_array1[i][0].length(), j + 5)));
                                }
                                for (int j = 0; j < items_array1[i][1].length(); j += 25) {
                                    item_split_item.add(items_array1[i][1].substring(j, Math.min(items_array1[i][1].length(), j + 25)));
                                }
                                for (int j = 0; j < items_array1[i][2].length(); j += 7) {
                                    item_split_price.add(items_array1[i][2].substring(j, Math.min(items_array1[i][2].length(), j + 7)));
                                }
                                for (int j = 0; j < items_array1[i][3].length(); j += 7) {
                                    item_split_amount.add(items_array1[i][3].substring(j, Math.min(items_array1[i][3].length(), j + 7)));
                                }

                                Log.d("DATA_QTY", String.valueOf(item_split_qty));
                                Log.d("DATA_ITEM", String.valueOf(item_split_item));
                                Log.d("DATA_PRICE", String.valueOf(item_split_price));
                                Log.d("DATA_Amount", String.valueOf(item_split_amount));

                                List<Integer> maxListValue = new ArrayList<>();
                                maxListValue.add(item_split_qty.size());
                                maxListValue.add(item_split_item.size());
                                maxListValue.add(item_split_price.size());
                                maxListValue.add(item_split_amount.size());

                                int maxValue = maxListValue.get(0);

                                for (int x = 1; x < maxListValue.size(); x++) {
                                    if (maxValue < maxListValue.get(x)) {
                                        maxValue = maxListValue.get(x);
                                    }
                                }

                                Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                                for (int k = 0; k < maxValue; k++) {

                                    String qty,item,price_new,amount = "";

                                    boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                    boolean item_check = (k >= 0) && (k < item_split_item.size());
                                    boolean price_check = (k >= 0) && (k < item_split_price.size());
                                    boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                    if(qty_check == true){
                                        qty = item_split_qty.get(k);
                                    }
                                    else {
                                        qty = " ";
                                    }
                                    if(item_check == true){
                                        item = item_split_item.get(k);
                                    }
                                    else {
                                        item = " ";
                                    }
                                    if(price_check == true){
                                        price_new = item_split_price.get(k);
                                    }
                                    else {
                                        price_new = " ";
                                    }
                                    if(amount_check == true){
                                        amount = item_split_amount.get(k);
                                    }
                                    else {
                                        amount = " ";
                                    }

                                    fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                                }
                                item_split_qty.removeAll(item_split_qty);
                                item_split_item.removeAll(item_split_item);
                                item_split_price.removeAll(item_split_price);
                                item_split_amount.removeAll(item_split_amount);

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    fmt.format("HSN "+hsn, " ");
                                }
                            }

                            final TableRow tableRow11 = new TableRow(Cash_Card_Credit_Sales2.this);
                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            final TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                            tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv.setGravity(Gravity.CENTER);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText("");
                            tableRow11.addView(tvv);

                            TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv4.setText(modiname);
                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv4);

                            TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv2.setPadding(0, 0, 1, 0);
                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv5.setText(modiprice);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv5);

                            TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv6.setText("");
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv6);


                            final TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv3.setPadding(0,0,10,0);
                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                            //row.addView(tv3);

                            row.removeView(tv8);


                            tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String numberr = tv.getText().toString();
                            float newmulr = Float.parseFloat(numberr);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(ss));
                            row.addView(tv8);


                            tableLayout1.addView(tableRow11);
                        } while (modcursor.moveToNext());

                        //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals(getString(R.string.no))) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    String[][] items_array1 = {{"", "", "", "("+"-"+total_disc_print_q+")"}};

                                    for (int i = 0; i < items_array1.length; i++) {
                                        List<String> item_split_qty = new ArrayList<>();
                                        List<String> item_split_item = new ArrayList<>();
                                        List<String> item_split_price = new ArrayList<>();
                                        List<String> item_split_amount = new ArrayList<>();

                                        for (int j = 0; j < items_array1[i][0].length(); j += 5) {
                                            item_split_qty.add(items_array1[i][0].substring(j, Math.min(items_array1[i][0].length(), j + 5)));
                                        }
                                        for (int j = 0; j < items_array1[i][1].length(); j += 25) {
                                            item_split_item.add(items_array1[i][1].substring(j, Math.min(items_array1[i][1].length(), j + 25)));
                                        }
                                        for (int j = 0; j < items_array1[i][2].length(); j += 7) {
                                            item_split_price.add(items_array1[i][2].substring(j, Math.min(items_array1[i][2].length(), j + 7)));
                                        }
                                        for (int j = 0; j < items_array1[i][3].length(); j += 7) {
                                            item_split_amount.add(items_array1[i][3].substring(j, Math.min(items_array1[i][3].length(), j + 7)));
                                        }

                                        Log.d("DATA_QTY", String.valueOf(item_split_qty));
                                        Log.d("DATA_ITEM", String.valueOf(item_split_item));
                                        Log.d("DATA_PRICE", String.valueOf(item_split_price));
                                        Log.d("DATA_Amount", String.valueOf(item_split_amount));

                                        List<Integer> maxListValue = new ArrayList<>();
                                        maxListValue.add(item_split_qty.size());
                                        maxListValue.add(item_split_item.size());
                                        maxListValue.add(item_split_price.size());
                                        maxListValue.add(item_split_amount.size());

                                        int maxValue = maxListValue.get(0);

                                        for (int x = 1; x < maxListValue.size(); x++) {
                                            if (maxValue < maxListValue.get(x)) {
                                                maxValue = maxListValue.get(x);
                                            }
                                        }

                                        Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                                        for (int k = 0; k < maxValue; k++) {

                                            String qty,item,price_new,amount = "";

                                            boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                            boolean item_check = (k >= 0) && (k < item_split_item.size());
                                            boolean price_check = (k >= 0) && (k < item_split_price.size());
                                            boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                            if(qty_check == true){
                                                qty = item_split_qty.get(k);
                                            }
                                            else {
                                                qty = " ";
                                            }
                                            if(item_check == true){
                                                item = item_split_item.get(k);
                                            }
                                            else {
                                                item = " ";
                                            }
                                            if(price_check == true){
                                                price_new = item_split_price.get(k);
                                            }
                                            else {
                                                price_new = " ";
                                            }
                                            if(amount_check == true){
                                                amount = item_split_amount.get(k);
                                            }
                                            else {
                                                amount = " ";
                                            }

                                            fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                                        }
                                        item_split_qty.removeAll(item_split_qty);
                                        item_split_item.removeAll(item_split_item);
                                        item_split_price.removeAll(item_split_price);
                                        item_split_amount.removeAll(item_split_amount);

                                    }
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();

                    } else {

                        String[][] items_array = {{value, name, pricee, tototot}};

                        for (int i = 0; i < items_array.length; i++) {
                            List<String> item_split_qty = new ArrayList<>();
                            List<String> item_split_item = new ArrayList<>();
                            List<String> item_split_price = new ArrayList<>();
                            List<String> item_split_amount = new ArrayList<>();

                            for (int j = 0; j < items_array[i][0].length(); j += 5) {
                                item_split_qty.add(items_array[i][0].substring(j, Math.min(items_array[i][0].length(), j + 5)));
                            }
                            for (int j = 0; j < items_array[i][1].length(); j += 25) {
                                item_split_item.add(items_array[i][1].substring(j, Math.min(items_array[i][1].length(), j + 25)));
                            }
                            for (int j = 0; j < items_array[i][2].length(); j += 7) {
                                item_split_price.add(items_array[i][2].substring(j, Math.min(items_array[i][2].length(), j + 7)));
                            }
                            for (int j = 0; j < items_array[i][3].length(); j += 7) {
                                item_split_amount.add(items_array[i][3].substring(j, Math.min(items_array[i][3].length(), j + 7)));
                            }

                            Log.d("DATA_QTY", String.valueOf(item_split_qty));
                            Log.d("DATA_ITEM", String.valueOf(item_split_item));
                            Log.d("DATA_PRICE", String.valueOf(item_split_price));
                            Log.d("DATA_Amount", String.valueOf(item_split_amount));

                            List<Integer> maxListValue = new ArrayList<>();
                            maxListValue.add(item_split_qty.size());
                            maxListValue.add(item_split_item.size());
                            maxListValue.add(item_split_price.size());
                            maxListValue.add(item_split_amount.size());

                            int maxValue = maxListValue.get(0);

                            for (int x = 1; x < maxListValue.size(); x++) {
                                if (maxValue < maxListValue.get(x)) {
                                    maxValue = maxListValue.get(x);
                                }
                            }

                            Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                            for (int k = 0; k < maxValue; k++) {

                                String qty,item,price_new,amount = "";

                                boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                boolean item_check = (k >= 0) && (k < item_split_item.size());
                                boolean price_check = (k >= 0) && (k < item_split_price.size());
                                boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                if(qty_check == true){
                                    qty = item_split_qty.get(k);
                                }
                                else {
                                    qty = " ";
                                }
                                if(item_check == true){
                                    item = item_split_item.get(k);
                                }
                                else {
                                    item = " ";
                                }
                                if(price_check == true){
                                    price_new = item_split_price.get(k);
                                }
                                else {
                                    price_new = " ";
                                }
                                if(amount_check == true){
                                    amount = item_split_amount.get(k);
                                }
                                else {
                                    amount = " ";
                                }

                                fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                            }
                            item_split_qty.removeAll(item_split_qty);
                            item_split_item.removeAll(item_split_item);
                            item_split_price.removeAll(item_split_price);
                            item_split_amount.removeAll(item_split_amount);

                        }

                        Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor.moveToFirst()) {
                            String hsn = ccursor.getString(34);

                            TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                            hsn_hsn.setText(hsn);

                            if (hsn_hsn.getText().toString().equals("")) {
                            } else {
                                fmt.format("%-48s\n", "HSN " + hsn);
                            }
                        }

                        tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        //tv3.setPadding(0, 0, 10, 0);
                        tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                        final String number = tv.getText().toString();
                        float newmul = Float.parseFloat(number);
                        //final float in = Float.parseFloat(cursor.getString(4));
                        String pricee1 = ccursorr.getString(3);
                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee1));
                        //newmul = Integer.parseInt(multiply);
                        tv8.setText(String.valueOf(multiply));
                        row.addView(tv8);

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals(getString(R.string.no))) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    String[][] items_array1 = {{"", "", "", "("+"-"+total_disc_print_q+")"}};

                                    for (int i = 0; i < items_array1.length; i++) {
                                        List<String> item_split_qty = new ArrayList<>();
                                        List<String> item_split_item = new ArrayList<>();
                                        List<String> item_split_price = new ArrayList<>();
                                        List<String> item_split_amount = new ArrayList<>();

                                        for (int j = 0; j < items_array1[i][0].length(); j += 5) {
                                            item_split_qty.add(items_array1[i][0].substring(j, Math.min(items_array1[i][0].length(), j + 5)));
                                        }
                                        for (int j = 0; j < items_array1[i][1].length(); j += 25) {
                                            item_split_item.add(items_array1[i][1].substring(j, Math.min(items_array1[i][1].length(), j + 25)));
                                        }
                                        for (int j = 0; j < items_array1[i][2].length(); j += 7) {
                                            item_split_price.add(items_array1[i][2].substring(j, Math.min(items_array1[i][2].length(), j + 7)));
                                        }
                                        for (int j = 0; j < items_array1[i][3].length(); j += 7) {
                                            item_split_amount.add(items_array1[i][3].substring(j, Math.min(items_array1[i][3].length(), j + 7)));
                                        }

                                        Log.d("DATA_QTY", String.valueOf(item_split_qty));
                                        Log.d("DATA_ITEM", String.valueOf(item_split_item));
                                        Log.d("DATA_PRICE", String.valueOf(item_split_price));
                                        Log.d("DATA_Amount", String.valueOf(item_split_amount));

                                        List<Integer> maxListValue = new ArrayList<>();
                                        maxListValue.add(item_split_qty.size());
                                        maxListValue.add(item_split_item.size());
                                        maxListValue.add(item_split_price.size());
                                        maxListValue.add(item_split_amount.size());

                                        int maxValue = maxListValue.get(0);

                                        for (int x = 1; x < maxListValue.size(); x++) {
                                            if (maxValue < maxListValue.get(x)) {
                                                maxValue = maxListValue.get(x);
                                            }
                                        }

                                        Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                                        for (int k = 0; k < maxValue; k++) {

                                            String qty,item,price_new,amount = "";

                                            boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                            boolean item_check = (k >= 0) && (k < item_split_item.size());
                                            boolean price_check = (k >= 0) && (k < item_split_price.size());
                                            boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                            if(qty_check == true){
                                                qty = item_split_qty.get(k);
                                            }
                                            else {
                                                qty = " ";
                                            }
                                            if(item_check == true){
                                                item = item_split_item.get(k);
                                            }
                                            else {
                                                item = " ";
                                            }
                                            if(price_check == true){
                                                price_new = item_split_price.get(k);
                                            }
                                            else {
                                                price_new = " ";
                                            }
                                            if(amount_check == true){
                                                amount = item_split_amount.get(k);
                                            }
                                            else {
                                                amount = " ";
                                            }

                                            fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                                        }
                                        item_split_qty.removeAll(item_split_qty);
                                        item_split_item.removeAll(item_split_item);
                                        item_split_price.removeAll(item_split_price);
                                        item_split_amount.removeAll(item_split_amount);

                                    }
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();
                    }
                    modcursor.close();
                }


            } while (ccursorr.moveToNext());
        }
        ccursorr.close();

        fmt.format("------------------------------------------------", " ");

////////////////////////////////////sub total
        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor3.moveToFirst()) {
            sub = cursor3.getString(7);
        }
        cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
        float to = Float.parseFloat(sub);
        String tot = String.format("%.2f", to);

//        if (tot.length() >= 11) {
//
//        }
//        if (tot.length() == 10) {
//            tot = " "+tot;
//        }
//        if (tot.length() == 9) {
//            tot = "  "+tot;
//        }
//        if (tot.length() == 8) {
//            tot = "   "+tot;
//        }
//        if (tot.length() == 7) {
//            tot = "    "+tot;
//        }
//        if (tot.length() == 6) {
//            tot = "     "+tot;
//        }
//        if (tot.length() == 5) {
//            tot = "      "+tot;
//        }
//        if (tot.length() == 4) {
//            tot = "       "+tot;
//        }

        fmt.format("%-38s %9s\n", "Sub total", tot);

/////////////////////////tax




///////////////////////////////// discount

        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
        if (cursor4.moveToFirst()) {
            taxpe = cursor4.getString(5);
        } else {
            taxpe = "0.00";
        }
        cursor4.close();

        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
        if (cursor5.moveToFirst()) {
            dsirs = cursor5.getString(7);
        } else {
            dsirs = "0.00";
        }
        cursor5.close();

        String alldiscinperc1 = "Discount(" + taxpe + "%)";

//        if (dsirs.length() >= 11) {
//
//        }
//        if (dsirs.length() == 10) {
//            dsirs = " "+dsirs;
//        }
//        if (dsirs.length() == 9) {
//            dsirs = "  "+dsirs;
//        }
//        if (dsirs.length() == 8) {
//            dsirs = "   "+dsirs;
//        }
//        if (dsirs.length() == 7) {
//            dsirs = "    "+dsirs;
//        }
//        if (dsirs.length() == 6) {
//            dsirs = "     "+dsirs;
//        }
//        if (dsirs.length() == 5) {
//            dsirs = "      "+dsirs;
//        }
//        if (dsirs.length() == 4) {
//            dsirs = "       "+dsirs;
//        }
        fmt.format("%-38s %9s\n", alldiscinperc1, dsirs);
        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

        float newe;
//////////////////////////////////////////////

        Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnumb + "'", null);
        if (cursor113.moveToFirst()) {
            float level = cursor113.getFloat(0);
            total = String.valueOf(level);
            float total1 = Float.parseFloat(total);
            total_disc_print_q = String.format(Locale.US,"%.2f", total1);

//            if (total_disc_print_q.length() >= 11) {
//
//            }
//            if (total_disc_print_q.length() == 10) {
//                total_disc_print_q = " "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 9) {
//                total_disc_print_q = "  "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 8) {
//                total_disc_print_q = "   "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 7) {
//                total_disc_print_q = "    "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 6) {
//                total_disc_print_q = "     "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 5) {
//                total_disc_print_q = "      "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 4) {
//                total_disc_print_q = "       "+total_disc_print_q;
//            }

            fmt.format("%-38s %9s\n", "Savings", total_disc_print_q);

        }
        cursor113.close();
////////////////////////////////

        Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor.moveToFirst()){
            String t_total_points = cursor.getString(16);
            String v_tq = cursor.getString(17);

            String v_tq_loy = String.format("%.2f", v_tq);

//            if (v_tq_loy.length() >= 11) {
//
//            }
//            if (v_tq_loy.length() == 10) {
//                v_tq_loy = " "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 9) {
//                v_tq_loy = "  "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 8) {
//                v_tq_loy = "   "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 7) {
//                v_tq_loy = "    "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 6) {
//                v_tq_loy = "     "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 5) {
//                v_tq_loy = "      "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 4) {
//                v_tq_loy = "       "+v_tq_loy;
//            }

            TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
            tv.setText(t_total_points);

            if (tv.getText().toString().equals("")){

            }else {

                fmt.format("%-38s %9s\n", "Loyalty(" + t_total_points + ")", v_tq_loy);

            }
        }

//////////////////////////////////////Rounded off

        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor7.moveToFirst()) {
            subro = cursor7.getString(9);
        }
        cursor7.close();

//            float subro1 = Float.parseFloat(subro);
//            subro = String.format("%.2f", subro1);

//        if (subro.length() >= 11) {
//
//        }
//        if (subro.length() == 10) {
//            subro = " "+subro;
//        }
//        if (subro.length() == 9) {
//            subro = "  "+subro;
//        }
//        if (subro.length() == 8) {
//            subro = "   "+subro;
//        }
//        if (subro.length() == 7) {
//            subro = "    "+subro;
//        }
//        if (subro.length() == 6) {
//            subro = "     "+subro;
//        }
//        if (subro.length() == 5) {
//            subro = "      "+subro;
//        }
//        if (subro.length() == 4) {
//            subro = "       "+subro;
//        }

        fmt.format("%-38s %9s\n", "Rounded", subro);

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

        fmt.format("------------------------------------------------", " ");
//////////////Total main

        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
        if (cursor8.moveToFirst()) {
            alltotal1 = cursor8.getString(2);
        }
        cursor8.close();

        float all = Float.parseFloat(alltotal1);
        String newf = String.format("%.2f", all);

        String allt = insert1_rs+""+newf;
//        if (allt.length() >= 12) {
//
//        }
//        if (allt.length() == 11) {
//            allt = " "+allt;
//        }
//        if (allt.length() == 10) {
//            allt = "  "+allt;
//        }
//        if (allt.length() == 9) {
//            allt = "   "+allt;
//        }
//        if (allt.length() == 8) {
//            allt = "    "+allt;
//        }
//        if (allt.length() == 7) {
//            allt = "     "+allt;
//        }
//        if (allt.length() == 6) {
//            allt = "      "+allt;
//        }
//        if (allt.length() == 5) {
//            allt = "       "+allt;
//        }
//        if (allt.length() == 4) {
//            allt = "        "+allt;
//        }

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

        fmt.format("%-34s %13s\n", "Total", allt);

        fmt.format("------------------------------------------------", " ");
        fmt.format("\n", " ");

        ////////////ttax
        TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
        tableLayout1.removeAllViews();

        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor.moveToFirst()) {

            do {
                String name = ccursor.getString(10);
                String value = ccursor.getString(9);
                String pq = ccursor.getString(50);
                String itna = ccursor.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor.moveToNext());
        }
        ccursor.close();

        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor2.moveToFirst()) {

            do {
                String name = ccursor2.getString(35);
                String value = ccursor2.getString(36);
                String pq = ccursor2.getString(50);
                String itna = ccursor2.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor2.moveToNext());
        }
        ccursor2.close();

        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor3.moveToFirst()) {

            do {
                String name = ccursor3.getString(37);
                String value = ccursor3.getString(38);
                String pq = ccursor3.getString(50);
                String itna = ccursor3.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor3.moveToNext());
        }
        ccursor3.close();

        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor4.moveToFirst()) {

            do {
                String name = ccursor4.getString(39);
                String value = ccursor4.getString(40);
                String pq = ccursor4.getString(50);
                String itna = ccursor4.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor4.moveToNext());
        }
        ccursor4.close();

        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor5.moveToFirst()) {

            do {
                String name = ccursor5.getString(41);
                String value = ccursor5.getString(42);
                String pq = ccursor5.getString(50);
                String itna = ccursor5.getString(1);

                TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                v.setText(value);

                TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor5.moveToNext());
        }
        ccursor5.close();


        ArrayList<String> groupList = new ArrayList<String>();

        float sum_p = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

            if (groupList.contains(mTextView.getText().toString())) {

            }else {
                sum_p = 0;
                for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                    TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                    mTextView1 = (TextView) mRow1.getChildAt(0);
                    mTextView2 = (TextView) mRow1.getChildAt(2);
                    if (groupList.contains(mTextView.getText().toString())) {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    } else {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            groupList.add(mTextView.getText().toString());
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    }
                }
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                String mod1 = mTextView.getText().toString() + "" + String.format("%.2f", sum_p);
                String mod12 = mTextView.getText().toString();
                String sum_p_float = String.format("%.2f", sum_p);

//                if (sum_p_float.length() >= 11) {
//
//                }
//                if (sum_p_float.length() == 10) {
//                    sum_p_float = " "+sum_p_float;
//                }
//                if (sum_p_float.length() == 9) {
//                    sum_p_float = "  "+sum_p_float;
//                }
//                if (sum_p_float.length() == 8) {
//                    sum_p_float = "   "+sum_p_float;
//                }
//                if (sum_p_float.length() == 7) {
//                    sum_p_float = "    "+sum_p_float;
//                }
//                if (sum_p_float.length() == 6) {
//                    sum_p_float = "     "+sum_p_float;
//                }
//                if (sum_p_float.length() == 5) {
//                    sum_p_float = "      "+sum_p_float;
//                }
//                if (sum_p_float.length() == 4) {
//                    sum_p_float = "       "+sum_p_float;
//                }

                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                fmt.format("%-38s %9s\n", mod12, sum_p_float);

//                    String match = "@";
//                    int position = mTextView.getText().toString().indexOf(match);
                String mod2 = mTextView.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+mod2, Toast.LENGTH_LONG).show();
                Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor6.moveToFirst()) {
                    String hsn = ccursor6.getString(34);

                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                    hsn_hsn.setText(hsn);

                    if (hsn_hsn.getText().toString().equals("")) {
                    } else {
                        fmt.format("%-48s\n", "HSN " + hsn);
                    }
                }

            }
        }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format(Locale.US,"%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
////                        float tota = mul;
//                        String tota1 = String.format(Locale.US,"%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                        } else {
//                            if (statusnets.equals("ok")) {
//                                wifiSocket.WIFI_Write(left);    //
//                                wifiSocket.WIFI_Write(normal);
//                                wifiSocket.WIFI_Write(mod1);
//                                wifiSocket.WIFI_Write(HT);    //
//                                wifiSocket.WIFI_Write(LF);    //
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }
//            ccursor.close();


        String phon = "0";
        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
        if (caddress1.moveToFirst()) {
            phon = caddress1.getString(2);
        }
        caddress1.close();

        TextView tvvs = new TextView(Cash_Card_Credit_Sales2.this);
        tvvs.setText(phon);

        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
        if (us_name1.moveToLast()) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id there", Toast.LENGTH_LONG).show();
            String na53 = us_name1.getString(53);
            String na38 = us_name1.getString(38);
            String na39 = us_name1.getString(39);
            String na40 = us_name1.getString(40);
            String na41 = us_name1.getString(41);
            String na42 = us_name1.getString(42);
            String na43 = us_name1.getString(43);
            String na44 = us_name1.getString(44);
            String na45 = us_name1.getString(45);
            String na46 = us_name1.getString(46);
            String na47 = us_name1.getString(47);
            String na48 = us_name1.getString(48);
            String na49 = us_name1.getString(49);
            String na50 = us_name1.getString(50);
            String na51 = us_name1.getString(51);
            String na52 = us_name1.getString(52);
            String na38_value = us_name1.getString(54);
            String na39_value = us_name1.getString(55);
            String na40_value = us_name1.getString(56);
            String na41_value = us_name1.getString(57);
            String na42_value = us_name1.getString(58);
            String na43_value = us_name1.getString(59);
            String na44_value = us_name1.getString(60);
            String na45_value = us_name1.getString(61);
            String na46_value = us_name1.getString(62);
            String na47_value = us_name1.getString(63);
            String na48_value = us_name1.getString(64);
            String na49_value = us_name1.getString(65);
            String na50_value = us_name1.getString(66);
            String na51_value = us_name1.getString(67);
            String na52_value = us_name1.getString(68);

            String proc = us_name1.getString(69);

            TextView hid = new TextView(Cash_Card_Credit_Sales2.this);
            hid.setText(proc);

            if (hid.getText().toString().equals("off")) {
                Cursor cursorr = null;
                if (paymmethoda.equals("  Dine-in") || paymmethoda.equals(getString(R.string.general)) || paymmethoda.equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                            float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        String mod1_1 = name + "" + String.valueOf(tota1);
                        String mod12 = name;
                        String sum_p_float = String.valueOf(tota1);

//                        if (sum_p_float.length() >= 11) {
//
//                        }
//                        if (sum_p_float.length() == 10) {
//                            sum_p_float = " "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 9) {
//                            sum_p_float = "  "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 8) {
//                            sum_p_float = "   "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 7) {
//                            sum_p_float = "    "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 6) {
//                            sum_p_float = "     "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 5) {
//                            sum_p_float = "      "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 4) {
//                            sum_p_float = "       "+sum_p_float;
//                        }

                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        fmt.format("%-38s %9s\n", mod12, sum_p_float);

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            } else {

                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                    int i1 = 0;
                    if (i2 == 38) {
                        i1 = 54;
                    }
                    if (i2 == 39) {
                        i1 = 55;
                    }
                    if (i2 == 40) {
                        i1 = 56;
                    }
                    if (i2 == 41) {
                        i1 = 57;
                    }
                    if (i2 == 42) {
                        i1 = 58;
                    }
                    if (i2 == 43) {
                        i1 = 59;
                    }
                    if (i2 == 44) {
                        i1 = 60;
                    }
                    if (i2 == 45) {
                        i1 = 61;
                    }
                    if (i2 == 46) {
                        i1 = 62;
                    }
                    if (i2 == 47) {
                        i1 = 63;
                    }
                    if (i2 == 48) {
                        i1 = 64;
                    }
                    if (i2 == 49) {
                        i1 = 65;
                    }
                    if (i2 == 50) {
                        i1 = 66;
                    }
                    if (i2 == 51) {
                        i1 = 67;
                    }
                    if (i2 == 52) {
                        i1 = 68;
                    }


                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);;
                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv.setGravity(Gravity.START);
                    tv.setTextSize(15);
                    //text = cursor.getString(1);
//                String v = na;

                    tv.setText(us_name1.getString(i2));


                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    //text = cursor.getString(1);
                    tv1.setText(us_name1.getString(i1));
                    String value1 = "0";
                    if (tv1.getText().toString().equals("")) {

                    } else {
                        value1 = tv1.getText().toString();
                    }


                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                    TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv33.setText(String.valueOf(tota));
                    tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv33);

                    String value2 = tv33.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                    } else {
                        tableLayout1.addView(row);
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                        String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                        String mod1_1 = us_name1.getString(i2) + "" + String.valueOf(tota1);
                        String mod12 = us_name1.getString(i2);
                        String sum_p_float = String.valueOf(tota1);

//                        if (sum_p_float.length() >= 11) {
//
//                        }
//                        if (sum_p_float.length() == 10) {
//                            sum_p_float = " "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 9) {
//                            sum_p_float = "  "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 8) {
//                            sum_p_float = "   "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 7) {
//                            sum_p_float = "    "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 6) {
//                            sum_p_float = "     "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 5) {
//                            sum_p_float = "      "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 4) {
//                            sum_p_float = "       "+sum_p_float;
//                        }

                        fmt.format("%-38s %9s\n", mod12, sum_p_float);

                    }

                }
            }

        } else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id not there", Toast.LENGTH_LONG).show();
            Cursor cursorr = null;
            if (paymmethoda.equals("  Dine-in") || paymmethoda.equals(getString(R.string.general)) || paymmethoda.equals("  Others")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Home delivery")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
            if (cursorr.moveToFirst()) {

                do {

                    String name = cursorr.getString(1);
                    String value = cursorr.getString(2);

                    final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                    TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                    //tv2.setLayoutParams(lp);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @ " + bvn + "%");
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    //tv3.setPadding(0,0,10,0);
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);

                    String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                    String mod1_1 = name + "" + String.valueOf(tota1);
                    String mod12 = name;
                    String sum_p_float = String.valueOf(tota1);

//                    if (sum_p_float.length() >= 11) {
//
//                    }
//                    if (sum_p_float.length() == 10) {
//                        sum_p_float = " "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 9) {
//                        sum_p_float = "  "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 8) {
//                        sum_p_float = "   "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 7) {
//                        sum_p_float = "    "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 6) {
//                        sum_p_float = "     "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 5) {
//                        sum_p_float = "      "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 4) {
//                        sum_p_float = "       "+sum_p_float;
//                    }

                    fmt.format("%-38s %9s\n", mod12, sum_p_float);

                } while (cursorr.moveToNext());
            }
            cursorr.close();
        }
        us_name1.close();

        float sum = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(2);
            sum = sum
                    + Float.parseFloat(mTextView.getText().toString());
        }


        String newsum = String.format("%.2f", sum);

//        if (newsum.length() >= 11) {
//
//        }
//        if (newsum.length() == 10) {
//            newsum = " "+newsum;
//        }
//        if (newsum.length() == 9) {
//            newsum = "  "+newsum;
//        }
//        if (newsum.length() == 8) {
//            newsum = "   "+newsum;
//        }
//        if (newsum.length() == 7) {
//            newsum = "    "+newsum;
//        }
//        if (newsum.length() == 6) {
//            newsum = "     "+newsum;
//        }
//        if (newsum.length() == 5) {
//            newsum = "      "+newsum;
//        }
//        if (newsum.length() == 4) {
//            newsum = "       "+newsum;
//        }

        if (sum == 0 || sum == 0.0 || sum == 0.00) {

        } else {
            fmt.format("%-38s %9s\n", "Tax", newsum);
        }
        ////////////ttax

        tvkot.setText(bill_coun);
        if (tvkot.getText().toString().equals("")) {

        } else {
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
            fmt.format("Bill id."+bill_coun);
        }


        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")){

        }else {
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
            fmt.format(strbillone);
        }

        fmt.format("\n", " ");

        testBytes = fmt.toString().getBytes();

        //Getting current device count to check if the printer is attached or not
        mUsbManager = (UsbManager) getSystemService(this.USB_SERVICE);
        mDeviceList = mUsbManager.getDeviceList();

        if (mDeviceList.size() > 0) {

            mDeviceIterator = mDeviceList.values().iterator();
            String usbDevice = "";
            while (mDeviceIterator.hasNext()) {
                UsbDevice usbDevice1 = mDeviceIterator.next();
                mDevice = usbDevice1;
            }

            mInterface = mDevice.getInterface(0);
            mEndPoint = mInterface.getEndpoint(1);// 0 IN and  1 OUT to printer.
            mConnection = mUsbManager.openDevice(mDevice);


            if (mInterface == null) {
                Toast.makeText(this, "INTERFACE IS NULL", Toast.LENGTH_SHORT).show();
            } else if (mConnection == null) {
                Toast.makeText(this, "CONNECTION IS NULL", Toast.LENGTH_SHORT).show();
            } else if (forceCLaim == null) {
                Toast.makeText(this, "FORCE CLAIM IS NULL", Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(this, "Prepare print... ", Toast.LENGTH_SHORT).show();
                int finalImage_there = image_there;
                Thread thread = new Thread(new Runnable() {
                    @RequiresApi(api = Build.VERSION_CODES.KITKAT)
                    @Override
                    public void run() {
                        Log.e("u", "Printing.. ");
                        UsbInterface intf = mDevice.getInterface(0);
                        UsbEndpoint endpoint = intf.getEndpoint(0);
                        UsbDeviceConnection conn = mUsbManager.openDevice(mDevice);
                        conn.claimInterface(intf, true);

                        byte[] center = new byte[]{0x1b, 0x61, 0x00};
                        byte[] cut_paper = {0x1D, 0x56, 0x41, 0x10};

//                        try {
//                            Bitmap bmp = BitmapFactory.decodeResource(getResources(),
//                                    R.drawable.titto);
//                            if(bmp!=null){
//                                command = Utils.decodeBitmap(bmp);
//
//                            }else{
//                                Log.e("Print Photo error", "the file isn't exists");
//                            }
//                        } catch (Exception e) {
//                            e.printStackTrace();
//                            Log.e("PrintTools", "the file isn't exists");
//                        }

                        conn.bulkTransfer(endpoint,center,center.length,0);
                        if (finalImage_there == 1) {
                            conn.bulkTransfer(endpoint, command, command.length, 0);
                        }
                        conn.bulkTransfer(endpoint, testBytes, testBytes.length, 0);
                        conn.bulkTransfer(endpoint, cut_paper, cut_paper.length, 0);
                    }
                });
                thread.run();
            }
        } else {
            Toast.makeText(this, "No Printer Attached ", Toast.LENGTH_SHORT).show();
        }

    }


    private android.app.TimePickerDialog.OnTimeSetListener timePickerListener_open = new android.app.TimePickerDialog.OnTimeSetListener() {


        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minutes) {
            // TODO Auto-generated method stub
            hour = hourOfDay;
            minute = minutes;

            updateTime_open(hour, minute);

            Calendar calNow = Calendar.getInstance();
            Calendar calSet = (Calendar) calNow.clone();

            calSet.set(Calendar.HOUR_OF_DAY, hourOfDay);
            calSet.set(Calendar.MINUTE, minutes);
            calSet.set(Calendar.SECOND, 0);
            calSet.set(Calendar.MILLISECOND, 0);


            String hour1 = "";
            if (hour < 10)
                hour1 = "0" + hour;
            else
                hour1 = String.valueOf(hour);

            String minutes1 = "";
            if (minute < 10)
                minutes1 = "0" + minute;
            else
                minutes1 = String.valueOf(minute);

            editText_from_day_hide.setText(hour1 + "" + minutes1);


        }
    };

    private android.app.TimePickerDialog.OnTimeSetListener timePickerListener_close = new android.app.TimePickerDialog.OnTimeSetListener() {


        @Override
        public void onTimeSet(TimePicker view, int hourOfDay, int minutes) {
            // TODO Auto-generated method stub
            hour = hourOfDay;
            minute = minutes;

            updateTime_close(hour, minute);

            Calendar calNow = Calendar.getInstance();
            Calendar calSet = (Calendar) calNow.clone();

            calSet.set(Calendar.HOUR_OF_DAY, hourOfDay);
            calSet.set(Calendar.MINUTE, minutes);
            calSet.set(Calendar.SECOND, 0);
            calSet.set(Calendar.MILLISECOND, 0);

            String hour1 = "";
            if (hour < 10)
                hour1 = "0" + hour;
            else
                hour1 = String.valueOf(hour);

            String minutes1 = "";
            if (minute < 10)
                minutes1 = "0" + minute;
            else
                minutes1 = String.valueOf(minute);

            editText_to_day_hide.setText(hour1 + "" + minutes1);
        }
    };

    private void updateTime_open(int hours, int mins) {

        String timeSet = "";
        if (hours > 12) {
            hours -= 12;
            timeSet = "PM";
        } else if (hours == 0) {
            hours += 12;
            timeSet = "AM";
        } else if (hours == 12)
            timeSet = "PM";
        else
            timeSet = "AM";


        String minutes = "";
        if (mins < 10)
            minutes = "0" + mins;
        else
            minutes = String.valueOf(mins);

        // Append in a StringBuilder
        String aTime = new StringBuilder().append(hours).append(':')
                .append(minutes).append(" ").append(timeSet).toString();

        editText_from_day_visible.setText(aTime);
    }

    private void updateTime_close(int hours, int mins) {

        String timeSet = "";
        if (hours > 12) {
            hours -= 12;
            timeSet = "PM";
        } else if (hours == 0) {
            hours += 12;
            timeSet = "AM";
        } else if (hours == 12)
            timeSet = "PM";
        else
            timeSet = "AM";


        String minutes = "";
        if (mins < 10)
            minutes = "0" + mins;
        else
            minutes = String.valueOf(mins);

        // Append in a StringBuilder
        String aTime = new StringBuilder().append(hours).append(':')
                .append(minutes).append(" ").append(timeSet).toString();

        editText_to_day_visible.setText(aTime);
    }

    private class MakeRequestTask extends AsyncTask<Void, Void, String> {
        private Gmail mService = null;
        private Exception mLastError = null;
//        private View view = sendFabButton;

        public MakeRequestTask(GoogleAccountCredential credential) {
            HttpTransport transport = AndroidHttp.newCompatibleTransport();
            JsonFactory jsonFactory = JacksonFactory.getDefaultInstance();
            mService = new Gmail.Builder(
                    transport, jsonFactory, credential)
                    .setApplicationName(getResources().getString(R.string.app_name))
                    .build();
        }

        @Override
        protected String doInBackground(Void... params) {
            try {
                return getDataFromApi();
            } catch (Exception e) {
                mLastError = e;
                cancel(true);
                return null;
            }
        }

        private String getDataFromApi() throws IOException {
            // getting Values for to Address, from Address, Subject and Body

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                } while (getcom.moveToNext());
            }

            String url = "www.intuitionsoftwares.com";

//            String msg = "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
//                    "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
//                    "Powered by: " + Uri.parse(url);

            TextView textView = new TextView(Cash_Card_Credit_Sales2.this);
            textView.setText(R.string.underline);


            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                int leveliss = count.getInt(0);
                totalbillis = String.valueOf(leveliss);
            }

            if (totalbillis.toString().equals("0")){
                avgsales_r.setText("0");
            }else {
                Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                if (cursor11.moveToFirst()) {
                    level = cursor11.getInt(0);
                    String total = String.valueOf(level);

                    String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(totalbillis));
                    avgsales_r.setText(avgbill);
                }


            }

            Cursor one = db.rawQuery("SELECT MAX(total) FROM userdata ", null);
            if (one.moveToFirst()) {
                int one11 = one.getInt(0);
                one = db.rawQuery("SELECT * FROM userdata WHERE total = '" + one11 + "' ", null);
                if (one.moveToFirst()) {
                    oone1 = one.getString(1);
                    ppone = one.getString(1);
                    mmax = one.getString(2);

                    Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                    if (cursor11.moveToFirst()) {
                        level = cursor11.getInt(0);
                        String total = String.valueOf(level);

                        float perc = (Float.parseFloat(mmax) / Float.parseFloat(total)) * 100;
                        ppercen = String.format("%.1f", perc);
                    }
                }
            }

            one = db.rawQuery("SELECT MAX(total) FROM itemdata ", null);
            String one1 = "";
            if (one.moveToFirst()) {
                int one11 = one.getInt(0);
                one = db.rawQuery("SELECT * FROM itemdata WHERE total = '" + one11 + "' ", null);
                if (one.moveToFirst()) {
                    one1 = one.getString(1);
                    String pone = one.getString(1);
                    max = one.getString(2);
//                            topitemone.setText(one1);

                    Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                    if (cursor11.moveToFirst()) {
                        level = cursor11.getInt(0);
                        String total = String.valueOf(level);
                        float perc = Float.parseFloat(max) * 100 / Float.parseFloat(total);
                        String percen = String.format("%.1f", perc);

//                                topitem1percent.setText(percen);
//                                topitem1percent.append("%");
                    }

                } else {
//                            topitemone.setText("NA");
//                            topitem1percent.setText(getString(R.string._0Per));
                }
            }

            TextView topitem1percent = new TextView(Cash_Card_Credit_Sales2.this);
            Cursor ones = db.rawQuery("SELECT MAX(sales) FROM Itemwiseorderlistitems ", null);
            if (ones.moveToFirst()) {
                int one11 = ones.getInt(0);
                ones = db.rawQuery("SELECT * FROM Itemwiseorderlistitems WHERE sales = '" + one11 + "' ", null);
                if (ones.moveToFirst()) {
                    String onqe1 = ones.getString(2);
                    String pone = ones.getString(4);
                    topitem1percent.setText(pone);
                }
            }

            TextView topuser1percent = new TextView(Cash_Card_Credit_Sales2.this);
            Cursor oone = db.rawQuery("SELECT MAX(sales) FROM Userwiseorderlistitems ", null);
            if (oone.moveToFirst()) {
                int one11 = oone.getInt(0);
                oone = db.rawQuery("SELECT * FROM Userwiseorderlistitems WHERE sales = '" + one11 + "' ", null);
                if (oone.moveToFirst()) {
                    String oneee1 = oone.getString(1);
                    String pone = oone.getString(3);
//                            topuserone.setText(oneee1);
                    topuser1percent.setText(pone);
                }
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                String total = String.valueOf(level);
                totalsales_r.setText(total);
            }
//                Toast.makeText(getActivity(), " sum is "+total, Toast.LENGTH_SHORT).show();

            Cursor discountcashcard = db.rawQuery("SELECT SUM(Discount_rupees) FROM Discountdetails WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
            if (discountcashcard.moveToFirst()) {
                int level1 = discountcashcard.getInt(0);
                total11 = String.valueOf(level1);
            }

            Cursor cashcardcash= db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND paymentmethod = '  Upiqr' ", null);
            if (cashcardcash.moveToFirst()) {
                int level111 = cashcardcash.getInt(0);
                total111 = String.valueOf(level111);
            }

            Cursor cashcardcard= db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND paymentmethod = '  Mobikwik' ", null);
            if (cashcardcard.moveToFirst()) {
                int level111card = cashcardcard.getInt(0);
                total111card = String.valueOf(level111card);
            }

            Cursor dinein = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Dine-in' ", null);
            if (dinein.moveToFirst()){
                dineinsales = dinein.getInt(0);
                dineinsalesstr = String.valueOf(dineinsales);
            }

            Cursor takeaway = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Takeaway' ", null);
            if (takeaway.moveToFirst()){
                takeawaysales = takeaway.getInt(0);
                takeawaysalesstr = String.valueOf(takeawaysales);
            }

            Cursor homedelivery = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Home delivery' ", null);
            if (homedelivery.moveToFirst()){
                homedeliverysales = homedelivery.getInt(0);
                homedeliverysalesstr = String.valueOf(homedeliverysales);
            }

            float value22 = Float.parseFloat(total11) * 100 / Float.parseFloat(total);
            String ruppercent22 = String.format("%.1f", value22);


            float value1 = Float.parseFloat(total111) * 100 / Float.parseFloat(total);
            String ruppercent1 = String.format("%.1f", value1);
            //cashcardcashsalespercent.setText(String.valueOf(ruppercent1));

            float value2 = Float.parseFloat(total111card) * 100 / Float.parseFloat(total);
            //String ruppercent = String.format("%.1f", value);
            String ruppercent2 = String.format("%.1f", value2);
            //cashcardcardsalespercent.setText(String.valueOf(ruppercent2));

            float value = Float.parseFloat(dineinsalesstr) * 100 / Float.parseFloat(total);
            String ruppercent = String.format("%.1f", value);

            float value11 = Float.parseFloat(takeawaysalesstr) * 100 / Float.parseFloat(total);
            String ruppercent11 = String.format("%.1f", value11);

            float value21 = Float.parseFloat(homedeliverysalesstr) * 100 / Float.parseFloat(total);
            String ruppercent21 = String.format("%.1f", value21);

            String msg = getString(R.string.action_general)+ "(" + editText11.getText().toString() + "," + editText_from_day_visible.getText().toString()+" to " + editText22.getText().toString() +","+editText_to_day_visible.getText().toString()+ ")\n\n" + textView.getText().toString() + " (Detailed report attached)" +
                    "\n\nTotal sales: "+insert1_rs+" " + totalsales_r.getText().toString() + "\n\nCash sales: "+insert1_rs+" " + total111 + "(" + ruppercent1 + "%)\n\nCard sales: "+insert1_rs+" " + total111card + "(" + ruppercent2 + "%)\n\n" +
                    "Dine-in sales: "+insert1_rs+" " + dineinsalesstr + "(" + ruppercent + "%)\n\nTake-away sales: "+insert1_rs+" " + takeawaysalesstr + "(" + ruppercent11 + "%)\n\n" +
                    "Home-delivery sales: "+insert1_rs+" " + homedeliverysalesstr + "(" + ruppercent21 + "%)\n\nNo. of bills: " + totalbillis + "\n\n" +
                    "Avg. sales/bill: "+insert1_rs+" " + avgsales_r.getText().toString() + "\n\nTop selling product:\n" + one1 + " - "+insert1_rs+" " + max + "(" + topitem1percent.getText().toString() + ")\n\nTop seller:\n" + oone1 + " - "+insert1_rs+" " + mmax + "(" + topuser1percent.getText().toString() + ")\n\n" +
                    "Discounts: "+insert1_rs+" " + total11 + "(" + ruppercent22 + "%)\n\nRefunds: "+insert1_rs+" " + refundedstr + "(" + rupper1 + "%)\n\n" +
                    "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
                    "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
                    "Powered by: " + Uri.parse(url);

            Cursor cursor1 = db1.rawQuery("SELECT * FROM Email_recipient", null);
            if (cursor1.moveToFirst()) {
                do {
                    String unn = cursor1.getString(3);
                    TextView edtToAddress = new TextView(Cash_Card_Credit_Sales2.this);
                    edtToAddress.setText(unn);

                    TextView edtSubject = new TextView(Cash_Card_Credit_Sales2.this);
                    edtSubject.setText(strcompanyname);

                    TextView edtMessage = new TextView(Cash_Card_Credit_Sales2.this);
                    edtMessage.setText(msg);

                    String user = "me";
                    String to = Utils.getString(edtToAddress);
                    String from = mCredential.getSelectedAccountName();
                    Log.v("sender email", from);
                    String subject = Utils.getString(edtSubject);
                    String body = Utils.getString(edtMessage);
                    MimeMessage mimeMessage;
                    response = "";
                    try {

//                        File exportDir = new File(Environment.getExternalStorageDirectory(), "/IVEPOS_reports/IVEPOS_customer_list");
//                        if (!exportDir.exists()) {
//                            exportDir.mkdirs();
//                        }
//
//                        file = new File(exportDir, "IvePOS_customer_list" + currentDateandTimee1 + "_" + timee1 + ".csv");

//                        File exportDir1 = new File(Environment.getExternalStorageDirectory(), "/Download");
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_sales_report/IvePOS_sales_report"+currentDateandTimee1+"_"+timee1+".csv";
                        String filename = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)+"/IVEPOS_reports/IVEPOS_sales_report/IvePOS_sales_report"+currentDateandTimee1+"_"+timee1+".csv";
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_product_report/IvePOS_product_report"+currentDateandTimee1+"_"+timee1+".csv";
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_customer_list/IvePOS_customer_list"+currentDateandTimee1+"_"+timee1+".csv";

//                String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_sales_report/IvePOS_sales_report"+"12May17"+"_"+"013048PM"+".csv";
//                String path = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_backup/";


                        File f = new File(filename);
//
                        mimeMessage = createEmailWithAttachment(to, from, subject, body, f);



//                        mimeMessage = createEmail(to, from, subject, body);
                        response = sendMessage(mService, user, mimeMessage);
                    } catch (MessagingException e) {
                        e.printStackTrace();
                    }

                } while (cursor1.moveToNext());
            }
            return response;
        }

        // Method to send email
        private String sendMessage(Gmail service,
                                   String userId,
                                   MimeMessage email)
                throws MessagingException, IOException {
            com.google.api.services.gmail.model.Message message = createMessageWithEmail(email);
            // GMail's official method to send email with oauth2.0
            message = service.users().messages().send(userId, message).execute();

            System.out.println("user ID " + userId);

            System.out.println("Message id: " + message.getId());
            System.out.println(message.toPrettyString());
            return message.getId();
        }

        public MimeMessage createEmailWithAttachment(String to,
                                                     String from,
                                                     String subject,
                                                     String bodyText,
                                                     File file)
                throws MessagingException, IOException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);

            email.setFrom(new InternetAddress(from));
            email.addRecipient(javax.mail.Message.RecipientType.TO,
                    new InternetAddress(to));
            email.setSubject(subject);

            MimeBodyPart mimeBodyPart = new MimeBodyPart();
            mimeBodyPart.setContent(bodyText, "text/plain");

            Multipart multipart = new MimeMultipart();
            multipart.addBodyPart(mimeBodyPart);

            mimeBodyPart = new MimeBodyPart();
            DataSource source = new FileDataSource(file);

            mimeBodyPart.setDataHandler(new DataHandler(source));
            mimeBodyPart.setFileName(file.getName());

            multipart.addBodyPart(mimeBodyPart);
            email.setContent(multipart);

            return email;
        }

        // Method to create email Params
        private MimeMessage createEmail(String to,
                                        String from,
                                        String subject,
                                        String bodyText) throws MessagingException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);
            InternetAddress tAddress = new InternetAddress(to);
            InternetAddress fAddress = new InternetAddress(from);


            System.out.println("From  " + from);
            System.out.println("To  " + to);


            email.setFrom(fAddress);
            email.addRecipient(javax.mail.Message.RecipientType.TO, tAddress);
            email.setSubject(subject);
            email.setText(bodyText);
            return email;
        }

        private com.google.api.services.gmail.model.Message createMessageWithEmail(MimeMessage email)
                throws MessagingException, IOException {
            ByteArrayOutputStream bytes = new ByteArrayOutputStream();
            email.writeTo(bytes);
            String encodedEmail = Base64.encodeBase64URLSafeString(bytes.toByteArray());
            com.google.api.services.gmail.model.Message message = new com.google.api.services.gmail.model.Message();
            message.setRaw(encodedEmail);
            return message;
        }

        @Override
        protected void onPreExecute() {
            mProgress.show();
        }

        @Override
        protected void onPostExecute(String output) {
            Log.d("post execute", "error");
            mProgress.hide();
            if (output == null || output.length() == 0) {
                Toast.makeText(Cash_Card_Credit_Sales2.this, "not success", Toast.LENGTH_SHORT).show();
//                showMessage(view, "No results returned.");
            } else {
                Toast.makeText(Cash_Card_Credit_Sales2.this, "success", Toast.LENGTH_SHORT).show();
//                showMessage(view, output);
            }
        }

        @Override
        protected void onCancelled() {
            mProgress.hide();
            if (mLastError != null) {
//                Log.v("Errors3", mLastError.getMessage());
                if (mLastError instanceof GooglePlayServicesAvailabilityIOException) {
//                    Log.v("Errors1", mLastError.getMessage());
                    showGooglePlayServicesAvailabilityErrorDialog(
                            ((GooglePlayServicesAvailabilityIOException) mLastError)
                                    .getConnectionStatusCode());
                } else if (mLastError instanceof UserRecoverableAuthIOException) {
//                    Log.v("Errors2", mLastError.getMessage());
                    startActivityForResult(
                            ((UserRecoverableAuthIOException) mLastError).getIntent(),
                            Utils.REQUEST_AUTHORIZATION);
                } else {
//                    showMessage(view, "The following error occurred:\n" + mLastError.getMessage());
//                    Log.v("Errors", mLastError.getMessage());
                }
            } else {
//                showMessage(view, "Request Cancelled.");
            }
        }
    }


    private class MakeRequestTask2 extends AsyncTask<Void, Void, String> {
        private Gmail mService = null;
        private Exception mLastError = null;
//        private View view = sendFabButton;

        public MakeRequestTask2(GoogleAccountCredential credential) {
            HttpTransport transport = AndroidHttp.newCompatibleTransport();
            JsonFactory jsonFactory = JacksonFactory.getDefaultInstance();
            mService = new Gmail.Builder(
                    transport, jsonFactory, credential)
                    .setApplicationName(getResources().getString(R.string.app_name))
                    .build();
        }

        @Override
        protected String doInBackground(Void... params) {
            try {
                return getDataFromApi();
            } catch (Exception e) {
                mLastError = e;
                cancel(true);
                return null;
            }
        }

        private String getDataFromApi() throws IOException {
            // getting Values for to Address, from Address, Subject and Body

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                } while (getcom.moveToNext());
            }

            String url = "www.intuitionsoftwares.com";

//            String msg = "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
//                    "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
//                    "Powered by: " + Uri.parse(url);

            TextView textView = new TextView(Cash_Card_Credit_Sales2.this);
            textView.setText(R.string.underline);

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                int leveliss = count.getInt(0);
                totalbillis = String.valueOf(leveliss);
            }

            if (totalbillis.toString().equals("0")){
                avgsales_r.setText("0");
            }else {
                Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                if (cursor11.moveToFirst()) {
                    level = cursor11.getInt(0);
                    String total = String.valueOf(level);

                    String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(totalbillis));
                    avgsales_r.setText(avgbill);
                }


            }

            Cursor one = db.rawQuery("SELECT MAX(total) FROM userdata ", null);
            if (one.moveToFirst()) {
                int one11 = one.getInt(0);
                one = db.rawQuery("SELECT * FROM userdata WHERE total = '" + one11 + "' ", null);
                if (one.moveToFirst()) {
                    oone1 = one.getString(1);
                    ppone = one.getString(1);
                    mmax = one.getString(2);

                    Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                    if (cursor11.moveToFirst()) {
                        level = cursor11.getInt(0);
                        String total = String.valueOf(level);

                        float perc = (Float.parseFloat(mmax) / Float.parseFloat(total)) * 100;
                        ppercen = String.format("%.1f", perc);
                    }
                }
            }

            one = db.rawQuery("SELECT MAX(total) FROM itemdata ", null);
            String one1 = "";
            if (one.moveToFirst()) {
                int one11 = one.getInt(0);
                one = db.rawQuery("SELECT * FROM itemdata WHERE total = '" + one11 + "' ", null);
                if (one.moveToFirst()) {
                    one1 = one.getString(1);
                    String pone = one.getString(1);
                    max = one.getString(2);
//                            topitemone.setText(one1);

                    Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
                    if (cursor11.moveToFirst()) {
                        level = cursor11.getInt(0);
                        String total = String.valueOf(level);
                        float perc = Float.parseFloat(max) * 100 / Float.parseFloat(total);
                        String percen = String.format("%.1f", perc);

//                                topitem1percent.setText(percen);
//                                topitem1percent.append("%");
                    }

                } else {
//                            topitemone.setText("NA");
//                            topitem1percent.setText(getString(R.string._0Per));
                }
            }

            TextView topitem1percent = new TextView(Cash_Card_Credit_Sales2.this);
            Cursor ones = db.rawQuery("SELECT MAX(sales) FROM Itemwiseorderlistitems ", null);
            if (ones.moveToFirst()) {
                int one11 = ones.getInt(0);
                ones = db.rawQuery("SELECT * FROM Itemwiseorderlistitems WHERE sales = '" + one11 + "' ", null);
                if (ones.moveToFirst()) {
                    String onqe1 = ones.getString(2);
                    String pone = ones.getString(4);
                    topitem1percent.setText(pone);
                }
            }

            TextView topuser1percent = new TextView(Cash_Card_Credit_Sales2.this);
            Cursor oone = db.rawQuery("SELECT MAX(sales) FROM Userwiseorderlistitems ", null);
            if (oone.moveToFirst()) {
                int one11 = oone.getInt(0);
                oone = db.rawQuery("SELECT * FROM Userwiseorderlistitems WHERE sales = '" + one11 + "' ", null);
                if (oone.moveToFirst()) {
                    String oneee1 = oone.getString(1);
                    String pone = oone.getString(3);
//                            topuserone.setText(oneee1);
                    topuser1percent.setText(pone);
                }
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                String total = String.valueOf(level);
                totalsales_r.setText(total);
            }
//                Toast.makeText(getActivity(), " sum is "+total, Toast.LENGTH_SHORT).show();

            Cursor discountcashcard = db.rawQuery("SELECT SUM(Discount_rupees) FROM Discountdetails WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' ", null);
            if (discountcashcard.moveToFirst()) {
                int level1 = discountcashcard.getInt(0);
                total11 = String.valueOf(level1);
            }

            Cursor cashcardcash= db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND paymentmethod = '  Upiqr' ", null);
            if (cashcardcash.moveToFirst()) {
                int level111 = cashcardcash.getInt(0);
                total111 = String.valueOf(level111);
            }

            Cursor cashcardcard= db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND paymentmethod = '  Mobikwik' ", null);
            if (cashcardcard.moveToFirst()) {
                int level111card = cashcardcard.getInt(0);
                total111card = String.valueOf(level111card);
            }

            Cursor dinein = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Dine-in' ", null);
            if (dinein.moveToFirst()){
                dineinsales = dinein.getInt(0);
                dineinsalesstr = String.valueOf(dineinsales);
            }

            Cursor takeaway = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Takeaway' ", null);
            if (takeaway.moveToFirst()){
                takeawaysales = takeaway.getInt(0);
                takeawaysalesstr = String.valueOf(takeawaysales);
            }

            Cursor homedelivery = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '"+editText1_filter.getText().toString()+"' AND datetimee_new <='"+editText2_filter.getText().toString()+"' AND billtype = '  Home delivery' ", null);
            if (homedelivery.moveToFirst()){
                homedeliverysales = homedelivery.getInt(0);
                homedeliverysalesstr = String.valueOf(homedeliverysales);
            }

            float value22 = Float.parseFloat(total11) * 100 / Float.parseFloat(total);
            String ruppercent22 = String.format("%.1f", value22);


            float value1 = Float.parseFloat(total111) * 100 / Float.parseFloat(total);
            String ruppercent1 = String.format("%.1f", value1);
            //cashcardcashsalespercent.setText(String.valueOf(ruppercent1));

            float value2 = Float.parseFloat(total111card) * 100 / Float.parseFloat(total);
            //String ruppercent = String.format("%.1f", value);
            String ruppercent2 = String.format("%.1f", value2);
            //cashcardcardsalespercent.setText(String.valueOf(ruppercent2));

            float value = Float.parseFloat(dineinsalesstr) * 100 / Float.parseFloat(total);
            String ruppercent = String.format("%.1f", value);

            float value11 = Float.parseFloat(takeawaysalesstr) * 100 / Float.parseFloat(total);
            String ruppercent11 = String.format("%.1f", value11);

            float value21 = Float.parseFloat(homedeliverysalesstr) * 100 / Float.parseFloat(total);
            String ruppercent21 = String.format("%.1f", value21);

            String msg = getString(R.string.action_general)+ "(" + editText11.getText().toString() + "," + editText_from_day_visible.getText().toString()+" to " + editText22.getText().toString() +","+editText_to_day_visible.getText().toString()+ ")\n\n" + textView.getText().toString() + " (Detailed report attached)" +
                    "\n\nTotal sales: "+insert1_rs+" " + totalsales_r.getText().toString() + "\n\nCash sales: "+insert1_rs+" " + total111 + "(" + ruppercent1 + "%)\n\nCard sales: "+insert1_rs+" " + total111card + "(" + ruppercent2 + "%)\n\n" +
                    "Dine-in sales: "+insert1_rs+" " + dineinsalesstr + "(" + ruppercent + "%)\n\nTake-away sales: "+insert1_rs+" " + takeawaysalesstr + "(" + ruppercent11 + "%)\n\n" +
                    "Home-delivery sales: "+insert1_rs+" " + homedeliverysalesstr + "(" + ruppercent21 + "%)\n\nNo. of bills: " + totalbillis + "\n\n" +
                    "Avg. sales/bill: "+insert1_rs+" " + avgsales_r.getText().toString() + "\n\nTop selling product:\n" + one1 + " - "+insert1_rs+" " + max + "(" + topitem1percent.getText().toString() + ")\n\nTop seller:\n" + oone1 + " - "+insert1_rs+" " + mmax + "(" + topuser1percent.getText().toString() + ")\n\n" +
                    "Discounts: "+insert1_rs+" " + total11 + "(" + ruppercent22 + "%)\n\nRefunds: "+insert1_rs+" " + refundedstr + "(" + rupper1 + "%)\n\n" +
                    "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
                    "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
                    "Powered by: " + Uri.parse(url);

            Cursor cursor1 = db1.rawQuery("SELECT * FROM Email_recipient", null);
            if (cursor1.moveToFirst()) {
                do {
                    String unn = cursor1.getString(3);
                    TextView edtToAddress = new TextView(Cash_Card_Credit_Sales2.this);
                    edtToAddress.setText(unn);

                    TextView edtSubject = new TextView(Cash_Card_Credit_Sales2.this);
                    edtSubject.setText(strcompanyname);

                    TextView edtMessage = new TextView(Cash_Card_Credit_Sales2.this);
                    edtMessage.setText(msg);

                    String user = "me";
                    String to = Utils.getString(edtToAddress);
                    String from = mCredential.getSelectedAccountName();
                    Log.v("sender email", from);
                    String subject = Utils.getString(edtSubject);
                    String body = Utils.getString(edtMessage);
                    MimeMessage mimeMessage;
                    response = "";
                    try {

//                        File exportDir = new File(Environment.getExternalStorageDirectory(), "/IVEPOS_reports/IVEPOS_customer_list");
//                        if (!exportDir.exists()) {
//                            exportDir.mkdirs();
//                        }
//
//                        file = new File(exportDir, "IvePOS_customer_list" + currentDateandTimee1 + "_" + timee1 + ".csv");

//                        File exportDir1 = new File(Environment.getExternalStorageDirectory(), "/Download");
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_Billwise_items_report/IvePOS_Billwise_items_report"+currentDateandTimee1+"_"+timee1+".csv";
                        String filename = Environment.getExternalStoragePublicDirectory(Environment.DIRECTORY_DOWNLOADS)+"/IVEPOS_reports/IVEPOS_Billwise_items_report/IvePOS_Billwise_items_report"+currentDateandTimee1+"_"+timee1+".csv";
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_product_report/IvePOS_product_report"+currentDateandTimee1+"_"+timee1+".csv";
//                        String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_customer_list/IvePOS_customer_list"+currentDateandTimee1+"_"+timee1+".csv";

//                String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_sales_report/IvePOS_sales_report"+"12May17"+"_"+"013048PM"+".csv";
//                String path = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_backup/";


                        File f = new File(filename);
//
                        mimeMessage = createEmailWithAttachment(to, from, subject, body, f);



//                        mimeMessage = createEmail(to, from, subject, body);
                        response = sendMessage(mService, user, mimeMessage);
                    } catch (MessagingException e) {
                        e.printStackTrace();
                    }

                } while (cursor1.moveToNext());
            }
            return response;
        }

        // Method to send email
        private String sendMessage(Gmail service,
                                   String userId,
                                   MimeMessage email)
                throws MessagingException, IOException {
            com.google.api.services.gmail.model.Message message = createMessageWithEmail(email);
            // GMail's official method to send email with oauth2.0
            message = service.users().messages().send(userId, message).execute();

            System.out.println("user ID " + userId);

            System.out.println("Message id: " + message.getId());
            System.out.println(message.toPrettyString());
            return message.getId();
        }

        public MimeMessage createEmailWithAttachment(String to,
                                                     String from,
                                                     String subject,
                                                     String bodyText,
                                                     File file)
                throws MessagingException, IOException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);

            email.setFrom(new InternetAddress(from));
            email.addRecipient(javax.mail.Message.RecipientType.TO,
                    new InternetAddress(to));
            email.setSubject(subject);

            MimeBodyPart mimeBodyPart = new MimeBodyPart();
            mimeBodyPart.setContent(bodyText, "text/plain");

            Multipart multipart = new MimeMultipart();
            multipart.addBodyPart(mimeBodyPart);

            mimeBodyPart = new MimeBodyPart();
            DataSource source = new FileDataSource(file);

            mimeBodyPart.setDataHandler(new DataHandler(source));
            mimeBodyPart.setFileName(file.getName());

            multipart.addBodyPart(mimeBodyPart);
            email.setContent(multipart);

            return email;
        }

        // Method to create email Params
        private MimeMessage createEmail(String to,
                                        String from,
                                        String subject,
                                        String bodyText) throws MessagingException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);
            InternetAddress tAddress = new InternetAddress(to);
            InternetAddress fAddress = new InternetAddress(from);


            System.out.println("From  " + from);
            System.out.println("To  " + to);


            email.setFrom(fAddress);
            email.addRecipient(javax.mail.Message.RecipientType.TO, tAddress);
            email.setSubject(subject);
            email.setText(bodyText);
            return email;
        }

        private com.google.api.services.gmail.model.Message createMessageWithEmail(MimeMessage email)
                throws MessagingException, IOException {
            ByteArrayOutputStream bytes = new ByteArrayOutputStream();
            email.writeTo(bytes);
            String encodedEmail = Base64.encodeBase64URLSafeString(bytes.toByteArray());
            com.google.api.services.gmail.model.Message message = new com.google.api.services.gmail.model.Message();
            message.setRaw(encodedEmail);
            return message;
        }

        @Override
        protected void onPreExecute() {
            mProgress.show();
        }

        @Override
        protected void onPostExecute(String output) {
            Log.d("post execute", "error");
            mProgress.hide();
            if (output == null || output.length() == 0) {
                Toast.makeText(Cash_Card_Credit_Sales2.this, "not success", Toast.LENGTH_SHORT).show();
//                showMessage(view, "No results returned.");
            } else {
                Toast.makeText(Cash_Card_Credit_Sales2.this, "success", Toast.LENGTH_SHORT).show();
//                showMessage(view, output);
            }
        }

        @Override
        protected void onCancelled() {
            mProgress.hide();
            if (mLastError != null) {
//                Log.v("Errors3", mLastError.getMessage());
                if (mLastError instanceof GooglePlayServicesAvailabilityIOException) {
//                    Log.v("Errors1", mLastError.getMessage());
                    showGooglePlayServicesAvailabilityErrorDialog(
                            ((GooglePlayServicesAvailabilityIOException) mLastError)
                                    .getConnectionStatusCode());
                } else if (mLastError instanceof UserRecoverableAuthIOException) {
//                    Log.v("Errors2", mLastError.getMessage());
                    startActivityForResult(
                            ((UserRecoverableAuthIOException) mLastError).getIntent(),
                            Utils.REQUEST_AUTHORIZATION);
                } else {
//                    showMessage(view, "The following error occurred:\n" + mLastError.getMessage());
//                    Log.v("Errors", mLastError.getMessage());
                }
            } else {
//                showMessage(view, "Request Cancelled.");
            }
        }
    }


    public void printbillcopy_minireceipt_all(){
        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }

        //Toast.makeText(Cash_Card_Credit_Sales2.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    if (str_print_ty.toString().equals("Generic") || str_print_ty.toString().equals("Epson/others")) {
                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                        setHT321 = new byte[]{0x1b, 0x44, 0x18, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x29, 0x00};//4 tabs 3"
                        nPaperWidth = 576;
                        charlength = 23;
                        charlength1 = 46;
                        charlength2 = 69;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "------------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("POS")) {
                            setHT32 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                            setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x10, 0x15, 0x00};//4 tabs 3"
                            nPaperWidth = 576;
                            charlength = 23;
                            charlength1 = 46;
                            charlength2 = 69;
                            quanlentha = 4;
                            HT1 = new byte[]{0x2F};
                            str_line = "------------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------------".getBytes(), LF

                            };
                        }
                    }
                }
                else {
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("Epson/others")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 16;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        }else {
                            if (str_print_ty.toString().equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x08, 0x09, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 11;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 4;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }
                }
            }while(cc.moveToNext());
        }

        String dd = "";
        TextView qazcvb = new TextView(Cash_Card_Credit_Sales2.this);
        Cursor cvonnusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (cvonnusb.moveToFirst()) {
            addgets = cvonnusb.getString(1);
            namegets = cvonnusb.getString(2);
            statussusbs = cvonnusb.getString(3);
            dd = cvonnusb.getString(4);
        }
        qazcvb.setText(dd);
        if (qazcvb.getText().toString().equals("usb") && statussusbs.toString().equals("ok")) {
            runPrintCouponSequence_minireceipt_all();
        }else {
            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(un);    //
                BT_Write("Sales Overview");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(un);    //
                    wifiSocket2.WIFI_Write("Sales Overview");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(un);    //
                        wifiSocket.WIFI_Write("Sales Overview");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(bold);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strcompanyname);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(bold);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strcompanyname);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(bold);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strcompanyname);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress1);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress1);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress1);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress2);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress2);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress2);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress3);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress3);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress3);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(pp);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(pp);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(pp);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(stremailid);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(stremailid);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(stremailid);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strwebsite);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strwebsite);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strwebsite);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strtaxone);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strtaxone);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strtaxone);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText11.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText22.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText11.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText22.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText11.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText22.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText_from_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText_to_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText_from_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText_to_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText_from_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText_to_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(getString(R.string.Sales));
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write("No. of bills");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(getString(R.string.Sales));
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write("No. of bills");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(getString(R.string.Sales));
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write("No. of bills");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(insert1_rs);
                BT_Write(total);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write(noofbills.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(insert1_rs);
                    wifiSocket2.WIFI_Write(total);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write(noofbills.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(insert1_rs);
                        wifiSocket.WIFI_Write(total);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write(noofbills.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            final String Text = getlisting.getSelectedItem().toString();

            int i = 1;
            if (Text.equals("All")) {
                Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC", null);

//                Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 GROUP By billno", null);
                if (cursor.moveToFirst()) {
                    do {
                        String bill_no = cursor.getString(4);
                        String billtypea = cursor.getString(8);
                        String paymmethoda = cursor.getString(9);
                        String date = cursor.getString(1);
                        String time = cursor.getString(2);
                        String am = cursor.getString(6);


                        TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                        ttv.setText(billtypea);

                        TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        ttv1.setText(paymmethoda);




                        if (ttv.getText().toString().equals("  Cash")) {
                            billtypeaa = "Cash"; //0
                        }
                        if (ttv.getText().toString().equals("  Card")) {
                            billtypeaa = "Card"; //0
                        }
                        if (ttv.getText().toString().equals("  Paytm")) {
                            billtypeaa = "Paytm"; //0
                        }
                        if (ttv.getText().toString().equals("  Mobikwik")) {
                            billtypeaa = "Mobikwik"; //0
                        }
                        if (ttv.getText().toString().equals("  Freecharge")) {
                            billtypeaa = "Freecharge"; //0
                        }
                        if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                            billtypeaa = getString(R.string.pay_later_nospace); //0
                        }
                        if (ttv.getText().toString().equals("  Cheque")) {
                            billtypeaa = "Cheque"; //0
                        }
                        if (ttv.getText().toString().equals("  Sodexo")) {
                            billtypeaa = "Sodexo"; //0
                        }
                        if (ttv.getText().toString().equals("  Zeta")) {
                            billtypeaa = "Zeta"; //0
                        }
                        if (ttv.getText().toString().equals("  Ticket")) {
                            billtypeaa = "Ticket"; //0
                        }
                        if (ttv.getText().toString().equals(" Upiqr")) {
                            billtypeaa = "upiqr"; //0
                        }
                        if (ttv.getText().toString().equals("  Upiqr")) {
                            billtypeaa = "Upiqr"; //0
                        }
                        billtypeaa = ttv.getText().toString().replace(" ", "");


                        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                            //billtypee.setText("Dine-in");
                            if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                                paymmethodaa = "Dine-in";
                            }else {
                                paymmethodaa = getString(R.string.pref_header_general);
                            }
                        } else {
                            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                                paymmethodaa = "Takeaway";
                                //billtypee.setText("Takeaway");
                            } else {
                                paymmethodaa = "Home delivery";
                                //billtypee.setText("Home delivery");
                            }
                        }

                        allbuf2 = new byte[][]{
                                normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.toString().equals("ok")) {
                            BluetoothPrintDriver.BT_Write(normal);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write("Bill(" + String.valueOf(i) + ")");
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.toString().equals("ok")) {
                                wifiSocket2.WIFI_Write(normal);    //
                                wifiSocket2.WIFI_Write(un1);    //
                                wifiSocket2.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.toString().equals("ok")) {
                                    wifiSocket.WIFI_Write(normal);    //
                                    wifiSocket.WIFI_Write(un1);    //
                                    wifiSocket.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }


                        Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                        if (billtype.moveToFirst()) {
                            String bill_coun = billtype.getString(11);

                            if (statussusbs.equals("ok")) {
                                BluetoothPrintDriver.BT_Write(normal);    //
                                BluetoothPrintDriver.BT_Write(un1);    //
                                BT_Write("Bill id."+bill_coun);
                                BluetoothPrintDriver.BT_Write(LF);    //
                            } else {
                                if (statusnets_counter.equals("ok")) {
                                    wifiSocket2.WIFI_Write(normal);    //
                                    wifiSocket2.WIFI_Write(un1);    //
                                    wifiSocket2.WIFI_Write("Bill id."+bill_coun);
                                    wifiSocket2.WIFI_Write(LF);    //
                                }else {
                                    if (statusnets.equals("ok")) {
                                        wifiSocket.WIFI_Write(normal);    //
                                        wifiSocket.WIFI_Write(un1);    //
                                        wifiSocket.WIFI_Write("Bill id."+bill_coun);
                                        wifiSocket.WIFI_Write(LF);    //
                                    }
                                }
                            }
                        }
                        billtype.close();
                        

                        allbufbillno = new byte[][]{
                                setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                        };


                        if (statussusbs.toString().equals("ok")) {
                            BluetoothPrintDriver.BT_Write(setHT321);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write("Bill no." + bill_no);
                            BluetoothPrintDriver.BT_Write(HT);    //
                            BT_Write("   ");
                            BT_Write(billtypeaa);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.toString().equals("ok")) {
                                wifiSocket2.WIFI_Write(setHT321);    //
                                wifiSocket2.WIFI_Write(un1);    //
                                wifiSocket2.WIFI_Write("Bill no." + bill_no);
                                wifiSocket2.WIFI_Write(HT);    //
                                wifiSocket2.WIFI_Write("   ");
                                wifiSocket2.WIFI_Write(billtypeaa);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.toString().equals("ok")) {
                                    wifiSocket.WIFI_Write(setHT321);    //
                                    wifiSocket.WIFI_Write(un1);    //
                                    wifiSocket.WIFI_Write("Bill no." + bill_no);
                                    wifiSocket.WIFI_Write(HT);    //
                                    wifiSocket.WIFI_Write("   ");
                                    wifiSocket.WIFI_Write(billtypeaa);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }

                        allbuf10 = new byte[][]{
                                setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                                //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.toString().equals("ok")) {
                            BluetoothPrintDriver.BT_Write(setHT321);    //
                            BluetoothPrintDriver.BT_Write(left);    //
                            BT_Write(paymmethodaa);
                            BluetoothPrintDriver.BT_Write(HT);    //
                            BT_Write("  ");
                            BT_Write(date);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.toString().equals("ok")) {
                                wifiSocket2.WIFI_Write(setHT321);    //
                                wifiSocket2.WIFI_Write(left);    //
                                wifiSocket2.WIFI_Write(paymmethodaa);
                                wifiSocket2.WIFI_Write(HT);    //
                                wifiSocket2.WIFI_Write("  ");
                                wifiSocket2.WIFI_Write(date);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.toString().equals("ok")) {
                                    wifiSocket.WIFI_Write(setHT321);    //
                                    wifiSocket.WIFI_Write(left);    //
                                    wifiSocket.WIFI_Write(paymmethodaa);
                                    wifiSocket.WIFI_Write(HT);    //
                                    wifiSocket.WIFI_Write("  ");
                                    wifiSocket.WIFI_Write(date);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }

                        allbuftime = new byte[][]{
                                setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                        };


                        if (statussusbs.toString().equals("ok")) {
                            BluetoothPrintDriver.BT_Write(setHT321);    //
                            BluetoothPrintDriver.BT_Write(left);    //
                            BT_Write(insert1_rs);
                            BT_Write(am);
                            BluetoothPrintDriver.BT_Write(HT);    //
                            BT_Write("  ");
                            BT_Write(time);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.toString().equals("ok")) {
                                wifiSocket2.WIFI_Write(setHT321);    //
                                wifiSocket2.WIFI_Write(left);    //
                                wifiSocket2.WIFI_Write(insert1_rs);
                                wifiSocket2.WIFI_Write(am);
                                wifiSocket2.WIFI_Write(HT);    //
                                wifiSocket2.WIFI_Write("  ");
                                wifiSocket2.WIFI_Write(time);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.toString().equals("ok")) {
                                    wifiSocket.WIFI_Write(setHT321);    //
                                    wifiSocket.WIFI_Write(left);    //
                                    wifiSocket.WIFI_Write(insert1_rs);
                                    wifiSocket.WIFI_Write(am);
                                    wifiSocket.WIFI_Write(HT);    //
                                    wifiSocket.WIFI_Write("  ");
                                    wifiSocket.WIFI_Write(time);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }

                        if (statussusbs.toString().equals("ok")) {
                            BluetoothPrintDriver.BT_Write(left);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write(str_line);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.toString().equals("ok")) {
                                wifiSocket2.WIFI_Write(left);	//
                                wifiSocket2.WIFI_Write(un1);	//
                                wifiSocket2.WIFI_Write(str_line);
                                wifiSocket2.WIFI_Write(LF);	//
                            }else {
                                if (statusnets.toString().equals("ok")) {
                                    wifiSocket.WIFI_Write(left);	//
                                    wifiSocket.WIFI_Write(un1);	//
                                    wifiSocket.WIFI_Write(str_line);
                                    wifiSocket.WIFI_Write(LF);	//
                                }
                            }
                        }

                        i++;

                    } while (cursor.moveToNext());
                }
            }


            feedcut();
        }


    }

    public void printbillcopy_minireceipt_cash(){
        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }

        //Toast.makeText(Cash_Card_Credit_Sales2.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    if (str_print_ty.toString().equals("Generic") || str_print_ty.toString().equals("Epson/others")) {
                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                        setHT321 = new byte[]{0x1b, 0x44, 0x18, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x29, 0x00};//4 tabs 3"
                        nPaperWidth = 576;
                        charlength = 23;
                        charlength1 = 46;
                        charlength2 = 69;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "------------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("POS")) {
                            setHT32 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                            setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x10, 0x15, 0x00};//4 tabs 3"
                            nPaperWidth = 576;
                            charlength = 23;
                            charlength1 = 46;
                            charlength2 = 69;
                            quanlentha = 4;
                            HT1 = new byte[]{0x2F};
                            str_line = "------------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------------".getBytes(), LF

                            };
                        }
                    }
                }
                else {
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("Epson/others")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 16;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        }else {
                            if (str_print_ty.toString().equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x08, 0x09, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 11;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 4;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }
                }
            }while(cc.moveToNext());
        }


        String dd = "";
        TextView qazcvb = new TextView(Cash_Card_Credit_Sales2.this);
        Cursor cvonnusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (cvonnusb.moveToFirst()) {
            addgets = cvonnusb.getString(1);
            namegets = cvonnusb.getString(2);
            statussusbs = cvonnusb.getString(3);
            dd = cvonnusb.getString(4);
        }
        qazcvb.setText(dd);
        if (qazcvb.getText().toString().equals("usb") && statussusbs.toString().equals("ok")) {
            runPrintCouponSequence_minireceipt_cash();
        }else {
            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(un);    //
                BT_Write("Sales Overview");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(un);    //
                    wifiSocket2.WIFI_Write("Sales Overview");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(un);    //
                        wifiSocket.WIFI_Write("Sales Overview");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(bold);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strcompanyname);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(bold);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strcompanyname);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(bold);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strcompanyname);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress1);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress1);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress1);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress2);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress2);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress2);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress3);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress3);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress3);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(pp);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(pp);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(pp);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(stremailid);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(stremailid);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(stremailid);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strwebsite);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strwebsite);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strwebsite);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strtaxone);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strtaxone);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strtaxone);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText11.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText22.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText11.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText22.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText11.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText22.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText_from_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText_to_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText_from_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText_to_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText_from_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText_to_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(getString(R.string.Sales));
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write("No. of bills");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(getString(R.string.Sales));
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write("No. of bills");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(getString(R.string.Sales));
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write("No. of bills");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(insert1_rs+"" + total);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write(noofbills.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(insert1_rs+"" + total);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write(noofbills.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(insert1_rs+"" + total);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write(noofbills.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            int i = 1;
            Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' GROUP By billno", null);
            if (cursor.moveToFirst()) {
                do {
                    String bill_no = cursor.getString(4);
                    String billtypea = cursor.getString(8);
                    String paymmethoda = cursor.getString(9);
                    String date = cursor.getString(1);
                    String time = cursor.getString(2);
                    String am = cursor.getString(6);

                    TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv.setText(billtypea);

                    TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv1.setText(paymmethoda);



                    if (ttv.getText().toString().equals("  Cash")) {
                        billtypeaa = "Cash"; //0
                    }
                    if (ttv.getText().toString().equals("  Card")) {
                        billtypeaa = "Card"; //0
                    }
                    if (ttv.getText().toString().equals("  Paytm")) {
                        billtypeaa = "Paytm"; //0
                    }
                    if (ttv.getText().toString().equals("  Mobikwik")) {
                        billtypeaa = "Mobikwik"; //0
                    }
                    if (ttv.getText().toString().equals("  Freecharge")) {
                        billtypeaa = "Freecharge"; //0
                    }
                    if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                        billtypeaa = getString(R.string.pay_later_nospace); //0
                    }
                    if (ttv.getText().toString().equals("  Cheque")) {
                        billtypeaa = "Cheque"; //0
                    }
                    if (ttv.getText().toString().equals("  Sodexo")) {
                        billtypeaa = "Sodexo"; //0
                    }
                    if (ttv.getText().toString().equals("  Zeta")) {
                        billtypeaa = "Zeta"; //0
                    }
                    if (ttv.getText().toString().equals("  Ticket")) {
                        billtypeaa = "Ticket"; //0
                    }
                    if (ttv.getText().toString().equals(" Upiqr")) {
                        billtypeaa = "upiqr"; //0
                    }
                    if (ttv.getText().toString().equals("  Upiqr")) {
                        billtypeaa = "Upiqr"; //0
                    }
                    billtypeaa = ttv.getText().toString().replace(" ", "");


                    if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                        //billtypee.setText("Dine-in");
                        if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                            paymmethodaa = "Dine-in";
                        }else {
                            paymmethodaa = getString(R.string.pref_header_general);
                        }
                    } else {
                        if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                            paymmethodaa = "Takeaway";
                            //billtypee.setText("Takeaway");
                        } else {
                            paymmethodaa = "Home delivery";
                            //billtypee.setText("Home delivery");
                        }
                    }

                    allbuf2 = new byte[][]{
                            normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write("Bill(" + String.valueOf(i) + ")");
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(un1);    //
                            wifiSocket2.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(un1);    //
                                wifiSocket.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                    if (billtype.moveToFirst()) {
                        String bill_coun = billtype.getString(11);

                        if (statussusbs.equals("ok")) {
                            BluetoothPrintDriver.BT_Write(normal);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write("Bill id."+bill_coun);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.equals("ok")) {
                                wifiSocket2.WIFI_Write(normal);    //
                                wifiSocket2.WIFI_Write(un1);    //
                                wifiSocket2.WIFI_Write("Bill id."+bill_coun);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.equals("ok")) {
                                    wifiSocket.WIFI_Write(normal);    //
                                    wifiSocket.WIFI_Write(un1);    //
                                    wifiSocket.WIFI_Write("Bill id."+bill_coun);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }
                    }
                    billtype.close();


                    allbufbillno = new byte[][]{
                            setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };


                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write("Bill no." + bill_no);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("   ");
                        BT_Write(billtypeaa);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(un1);    //
                            wifiSocket2.WIFI_Write("Bill no." + bill_no);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("   ");
                            wifiSocket2.WIFI_Write(billtypeaa);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(un1);    //
                                wifiSocket.WIFI_Write("Bill no." + bill_no);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("   ");
                                wifiSocket.WIFI_Write(billtypeaa);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    allbuf10 = new byte[][]{
                            setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                            //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write(paymmethodaa);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("  ");
                        BT_Write(date);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(paymmethodaa);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("  ");
                            wifiSocket2.WIFI_Write(date);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(paymmethodaa);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("  ");
                                wifiSocket.WIFI_Write(date);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    allbuftime = new byte[][]{
                            setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                    };


                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write(insert1_rs);
                        BT_Write(am);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("  ");
                        BT_Write(time);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(insert1_rs);
                            wifiSocket2.WIFI_Write(am);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("  ");
                            wifiSocket2.WIFI_Write(time);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(insert1_rs);
                                wifiSocket.WIFI_Write(am);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("  ");
                                wifiSocket.WIFI_Write(time);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write(str_line);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(left);	//
                            wifiSocket2.WIFI_Write(un1);	//
                            wifiSocket2.WIFI_Write(str_line);
                            wifiSocket2.WIFI_Write(LF);	//
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(left);	//
                                wifiSocket.WIFI_Write(un1);	//
                                wifiSocket.WIFI_Write(str_line);
                                wifiSocket.WIFI_Write(LF);	//
                            }
                        }
                    }
                    i++;

                } while (cursor.moveToNext());
            }


            feedcut();
        }


    }

    public void printbillcopy_minireceipt_card(){
        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }

        //Toast.makeText(Cash_Card_Credit_Sales2.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    if (str_print_ty.toString().equals("Generic") || str_print_ty.toString().equals("Epson/others")) {
                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                        setHT321 = new byte[]{0x1b, 0x44, 0x18, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x29, 0x00};//4 tabs 3"
                        nPaperWidth = 576;
                        charlength = 23;
                        charlength1 = 46;
                        charlength2 = 69;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "------------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("POS")) {
                            setHT32 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                            setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x10, 0x15, 0x00};//4 tabs 3"
                            nPaperWidth = 576;
                            charlength = 23;
                            charlength1 = 46;
                            charlength2 = 69;
                            quanlentha = 4;
                            HT1 = new byte[]{0x2F};
                            str_line = "------------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------------".getBytes(), LF

                            };
                        }
                    }
                }
                else {
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("Epson/others")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 16;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        }else {
                            if (str_print_ty.toString().equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x08, 0x09, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 11;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 4;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }
                }
            }while(cc.moveToNext());
        }

        String dd = "";
        TextView qazcvb = new TextView(Cash_Card_Credit_Sales2.this);
        Cursor cvonnusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (cvonnusb.moveToFirst()) {
            addgets = cvonnusb.getString(1);
            namegets = cvonnusb.getString(2);
            statussusbs = cvonnusb.getString(3);
            dd = cvonnusb.getString(4);
        }
        qazcvb.setText(dd);
        if (qazcvb.getText().toString().equals("usb") && statussusbs.toString().equals("ok")) {
            runPrintCouponSequence_minireceipt_card();
        }else {
            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(un);    //
                BT_Write("Sales Overview");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(un);    //
                    wifiSocket2.WIFI_Write("Sales Overview");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(un);    //
                        wifiSocket.WIFI_Write("Sales Overview");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(bold);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strcompanyname);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(bold);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strcompanyname);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(bold);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strcompanyname);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress1);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress1);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress1);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress2);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress2);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress2);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress3);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress3);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress3);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(pp);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(pp);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(pp);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(stremailid);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(stremailid);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(stremailid);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strwebsite);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strwebsite);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strwebsite);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strtaxone);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strtaxone);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strtaxone);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText11.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText22.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText11.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText22.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText11.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText22.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText_from_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText_to_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText_from_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText_to_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText_from_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText_to_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(getString(R.string.Sales));
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write("No. of bills");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(getString(R.string.Sales));
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write("No. of bills");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(getString(R.string.Sales));
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write("No. of bills");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(insert1_rs+"" + total);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write(noofbills.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(insert1_rs+"" + total);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write(noofbills.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(insert1_rs+"" + total);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write(noofbills.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            int i = 1;
            Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Mobikwik' GROUP By billno", null);
            if (cursor.moveToFirst()) {
                do {
                    String bill_no = cursor.getString(4);
                    String billtypea = cursor.getString(8);
                    String paymmethoda = cursor.getString(9);
                    String date = cursor.getString(1);
                    String time = cursor.getString(2);
                    String am = cursor.getString(6);

                    TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv.setText(billtypea);

                    TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv1.setText(paymmethoda);



                    if (ttv.getText().toString().equals("  Cash")) {
                        billtypeaa = "Cash"; //0
                    }
                    if (ttv.getText().toString().equals("  Card")) {
                        billtypeaa = "Card"; //0
                    }
                    if (ttv.getText().toString().equals("  Paytm")) {
                        billtypeaa = "Paytm"; //0
                    }
                    if (ttv.getText().toString().equals("  Mobikwik")) {
                        billtypeaa = "Mobikwik"; //0
                    }
                    if (ttv.getText().toString().equals("  Freecharge")) {
                        billtypeaa = "Freecharge"; //0
                    }
                    if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                        billtypeaa = getString(R.string.pay_later_nospace); //0
                    }
                    if (ttv.getText().toString().equals("  Cheque")) {
                        billtypeaa = "Cheque"; //0
                    }
                    if (ttv.getText().toString().equals("  Sodexo")) {
                        billtypeaa = "Sodexo"; //0
                    }
                    if (ttv.getText().toString().equals("  Zeta")) {
                        billtypeaa = "Zeta"; //0
                    }
                    if (ttv.getText().toString().equals("  Ticket")) {
                        billtypeaa = "Ticket"; //0
                    }
                    if (ttv.getText().toString().equals(" Upiqr")) {
                        billtypeaa = "upiqr"; //0
                    }
                    if (ttv.getText().toString().equals("  Upiqr")) {
                        billtypeaa = "Upiqr"; //0
                    }
                    billtypeaa = ttv.getText().toString().replace(" ", "");


                    if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                        //billtypee.setText("Dine-in");
                        if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                            paymmethodaa = "Dine-in";
                        }else {
                            paymmethodaa = getString(R.string.pref_header_general);
                        }
                    } else {
                        if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                            paymmethodaa = "Takeaway";
                            //billtypee.setText("Takeaway");
                        } else {
                            paymmethodaa = "Home delivery";
                            //billtypee.setText("Home delivery");
                        }
                    }

                    allbuf2 = new byte[][]{
                            normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write("Bill(" + String.valueOf(i) + ")");
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(un1);    //
                            wifiSocket2.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(un1);    //
                                wifiSocket.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }


                    Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                    if (billtype.moveToFirst()) {
                        String bill_coun = billtype.getString(11);

                        if (statussusbs.equals("ok")) {
                            BluetoothPrintDriver.BT_Write(normal);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write("Bill id."+bill_coun);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.equals("ok")) {
                                wifiSocket2.WIFI_Write(normal);    //
                                wifiSocket2.WIFI_Write(un1);    //
                                wifiSocket2.WIFI_Write("Bill id."+bill_coun);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.equals("ok")) {
                                    wifiSocket.WIFI_Write(normal);    //
                                    wifiSocket.WIFI_Write(un1);    //
                                    wifiSocket.WIFI_Write("Bill id."+bill_coun);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }
                    }
                    billtype.close();


                    allbufbillno = new byte[][]{
                            setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };


                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write("Bill no." + bill_no);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("   ");
                        BT_Write(billtypeaa);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(un1);    //
                            wifiSocket2.WIFI_Write("Bill no." + bill_no);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("   ");
                            wifiSocket2.WIFI_Write(billtypeaa);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(un1);    //
                                wifiSocket.WIFI_Write("Bill no." + bill_no);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("   ");
                                wifiSocket.WIFI_Write(billtypeaa);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    allbuf10 = new byte[][]{
                            setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                            //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write(paymmethodaa);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("  ");
                        BT_Write(date);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(paymmethodaa);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("  ");
                            wifiSocket2.WIFI_Write(date);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(paymmethodaa);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("  ");
                                wifiSocket.WIFI_Write(date);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    allbuftime = new byte[][]{
                            setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                    };


                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write(insert1_rs+"" + am);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("  ");
                        BT_Write(time);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(insert1_rs+"" + am);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("  ");
                            wifiSocket2.WIFI_Write(time);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(insert1_rs+"" + am);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("  ");
                                wifiSocket.WIFI_Write(time);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write(str_line);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(left);	//
                            wifiSocket2.WIFI_Write(un1);	//
                            wifiSocket2.WIFI_Write(str_line);
                            wifiSocket2.WIFI_Write(LF);	//
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(left);	//
                                wifiSocket.WIFI_Write(un1);	//
                                wifiSocket.WIFI_Write(str_line);
                                wifiSocket.WIFI_Write(LF);	//
                            }
                        }
                    }

                    i++;

                } while (cursor.moveToNext());
            }


            feedcut();
        }


    }

    public void printbillcopy_minireceipt_credit(){
        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }

        //Toast.makeText(Cash_Card_Credit_Sales2.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    if (str_print_ty.toString().equals("Generic") || str_print_ty.toString().equals("Epson/others")) {
                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                        setHT321 = new byte[]{0x1b, 0x44, 0x18, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x29, 0x00};//4 tabs 3"
                        nPaperWidth = 576;
                        charlength = 23;
                        charlength1 = 46;
                        charlength2 = 69;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "------------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("POS")) {
                            setHT32 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                            setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x10, 0x15, 0x00};//4 tabs 3"
                            nPaperWidth = 576;
                            charlength = 23;
                            charlength1 = 46;
                            charlength2 = 69;
                            quanlentha = 4;
                            HT1 = new byte[]{0x2F};
                            str_line = "------------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------------".getBytes(), LF

                            };
                        }
                    }
                }
                else {
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.toString().equals("Epson/others")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 16;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        }else {
                            if (str_print_ty.toString().equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x08, 0x09, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 11;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 4;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }
                }
            }while(cc.moveToNext());
        }

        String dd = "";
        TextView qazcvb = new TextView(Cash_Card_Credit_Sales2.this);
        Cursor cvonnusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (cvonnusb.moveToFirst()) {
            addgets = cvonnusb.getString(1);
            namegets = cvonnusb.getString(2);
            statussusbs = cvonnusb.getString(3);
            dd = cvonnusb.getString(4);
        }
        qazcvb.setText(dd);
        if (qazcvb.getText().toString().equals("usb") && statussusbs.toString().equals("ok")) {
            runPrintCouponSequence_minireceipt_credit();
        }else {
            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(un);    //
                BT_Write("Sales Overview");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(un);    //
                    wifiSocket2.WIFI_Write("Sales Overview");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(un);    //
                        wifiSocket.WIFI_Write("Sales Overview");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(bold);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strcompanyname);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(bold);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strcompanyname);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(bold);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strcompanyname);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress1);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress1);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress1);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress2);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress2);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress2);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress3);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress3);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress3);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(pp);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(pp);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(pp);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(stremailid);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(stremailid);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(stremailid);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strwebsite);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strwebsite);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strwebsite);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strtaxone);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.toString().equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strtaxone);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.toString().equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strtaxone);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText11.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText22.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText11.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText22.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText11.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText22.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(editText_from_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  ");
                BT_Write(editText_to_day_visible.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(editText_from_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  ");
                    wifiSocket2.WIFI_Write(editText_to_day_visible.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(editText_from_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  ");
                        wifiSocket.WIFI_Write(editText_to_day_visible.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(getString(R.string.Sales));
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write("No. of bills");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(getString(R.string.Sales));
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write("No. of bills");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(getString(R.string.Sales));
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write("No. of bills");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(insert1_rs+"" + total);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("| ");
                BT_Write(noofbills.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(insert1_rs+"" + total);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("| ");
                    wifiSocket2.WIFI_Write(noofbills.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(insert1_rs+"" + total);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("| ");
                        wifiSocket.WIFI_Write(noofbills.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

            int i = 1;

            Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno", null);
            if (cursor.moveToFirst()) {
                do {
                    String bill_no = cursor.getString(4);
                    String billtypea = cursor.getString(8);
                    String paymmethoda = cursor.getString(9);
                    String date = cursor.getString(1);
                    String time = cursor.getString(2);
                    String am = cursor.getString(6);

                    TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv.setText(billtypea);

                    TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv1.setText(paymmethoda);



                    if (ttv.getText().toString().equals("  Cash")) {
                        billtypeaa = "Cash"; //0
                    }
                    if (ttv.getText().toString().equals("  Card")) {
                        billtypeaa = "Card"; //0
                    }
                    if (ttv.getText().toString().equals("  Paytm")) {
                        billtypeaa = "Paytm"; //0
                    }
                    if (ttv.getText().toString().equals("  Mobikwik")) {
                        billtypeaa = "Mobikwik"; //0
                    }
                    if (ttv.getText().toString().equals("  Freecharge")) {
                        billtypeaa = "Freecharge"; //0
                    }
                    if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                        billtypeaa = getString(R.string.pay_later_nospace); //0
                    }
                    if (ttv.getText().toString().equals("  Cheque")) {
                        billtypeaa = "Cheque"; //0
                    }
                    if (ttv.getText().toString().equals("  Sodexo")) {
                        billtypeaa = "Sodexo"; //0
                    }
                    if (ttv.getText().toString().equals("  Zeta")) {
                        billtypeaa = "Zeta"; //0
                    }
                    if (ttv.getText().toString().equals("  Ticket")) {
                        billtypeaa = "Ticket"; //0
                    }
                    if (ttv.getText().toString().equals(" Upiqr")) {
                        billtypeaa = "upiqr"; //0
                    }
                    if (ttv.getText().toString().equals("  Upiqr")) {
                        billtypeaa = "Upiqr"; //0
                    }
                    billtypeaa = ttv.getText().toString().replace(" ", "");


                    if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                        //billtypee.setText("Dine-in");
                        if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                            paymmethodaa = "Dine-in";
                        }else {
                            paymmethodaa = getString(R.string.pref_header_general);
                        }
                    } else {
                        if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                            paymmethodaa = "Takeaway";
                            //billtypee.setText("Takeaway");
                        } else {
                            paymmethodaa = "Home delivery";
                            //billtypee.setText("Home delivery");
                        }
                    }


                    allbuf2 = new byte[][]{
                            normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write("Bill(" + String.valueOf(i) + ")");
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(un1);    //
                            wifiSocket2.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(un1);    //
                                wifiSocket.WIFI_Write("Bill(" + String.valueOf(i) + ")");
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }


                    Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                    if (billtype.moveToFirst()) {
                        String bill_coun = billtype.getString(11);

                        if (statussusbs.equals("ok")) {
                            BluetoothPrintDriver.BT_Write(normal);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write("Bill id."+bill_coun);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.equals("ok")) {
                                wifiSocket2.WIFI_Write(normal);    //
                                wifiSocket2.WIFI_Write(un1);    //
                                wifiSocket2.WIFI_Write("Bill id."+bill_coun);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.equals("ok")) {
                                    wifiSocket.WIFI_Write(normal);    //
                                    wifiSocket.WIFI_Write(un1);    //
                                    wifiSocket.WIFI_Write("Bill id."+bill_coun);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }
                    }
                    billtype.close();


                    allbufbillno = new byte[][]{
                            setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };


                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write("Bill no." + bill_no);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("   ");
                        BT_Write(billtypeaa);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(un1);    //
                            wifiSocket2.WIFI_Write("Bill no." + bill_no);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("   ");
                            wifiSocket2.WIFI_Write(billtypeaa);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(un1);    //
                                wifiSocket.WIFI_Write("Bill no." + bill_no);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("   ");
                                wifiSocket.WIFI_Write(billtypeaa);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    allbuf10 = new byte[][]{
                            setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                            //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write(paymmethodaa);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("  ");
                        BT_Write(date);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(paymmethodaa);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("  ");
                            wifiSocket2.WIFI_Write(date);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(paymmethodaa);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("  ");
                                wifiSocket.WIFI_Write(date);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    allbuftime = new byte[][]{
                            setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                    };


                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT321);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write(insert1_rs+"" + am);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write("  ");
                        BT_Write(time);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT321);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(insert1_rs+"" + am);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write("  ");
                            wifiSocket2.WIFI_Write(time);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(setHT321);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(insert1_rs+"" + am);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write("  ");
                                wifiSocket.WIFI_Write(time);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    if (statussusbs.toString().equals("ok")) {
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write(str_line);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.toString().equals("ok")) {
                            wifiSocket2.WIFI_Write(left);	//
                            wifiSocket2.WIFI_Write(un1);	//
                            wifiSocket2.WIFI_Write(str_line);
                            wifiSocket2.WIFI_Write(LF);	//
                        }else {
                            if (statusnets.toString().equals("ok")) {
                                wifiSocket.WIFI_Write(left);	//
                                wifiSocket.WIFI_Write(un1);	//
                                wifiSocket.WIFI_Write(str_line);
                                wifiSocket.WIFI_Write(LF);	//
                            }
                        }
                    }

                    i++;
                } while (cursor.moveToNext());
            }


            feedcut();
        }


    }


    private boolean runPrintCouponSequence(Dialog dialog) {
        if (!initializeObject()) {
            return false;
        }

        if (!createCouponData(dialog)) {
            finalizeObject();
            return false;
        }

        if (!printData()) {
            finalizeObject();
            return false;
        }

        return true;
    }

    private boolean runPrintCouponSequence_minireceipt_all() {
        if (!initializeObject()) {
            return false;
        }

        if (!createCouponData_minireceipt_all()) {
            finalizeObject();
            return false;
        }

        if (!printData()) {
            finalizeObject();
            return false;
        }

        return true;
    }

    private boolean runPrintCouponSequence_minireceipt_cash() {
        if (!initializeObject()) {
            return false;
        }

        if (!createCouponData_minireceipt_cash()) {
            finalizeObject();
            return false;
        }

        if (!printData()) {
            finalizeObject();
            return false;
        }

        return true;
    }

    private boolean runPrintCouponSequence_minireceipt_card() {
        if (!initializeObject()) {
            return false;
        }

        if (!createCouponData_minireceipt_card()) {
            finalizeObject();
            return false;
        }

        if (!printData()) {
            finalizeObject();
            return false;
        }

        return true;
    }

    private boolean runPrintCouponSequence_minireceipt_credit() {
        if (!initializeObject()) {
            return false;
        }

        if (!createCouponData_minireceipt_credit()) {
            finalizeObject();
            return false;
        }

        if (!printData()) {
            finalizeObject();
            return false;
        }

        return true;
    }

    private boolean initializeObject() {
        try {
            mPrinter = new Printer(((SpnModelsItem) mSpnSeries.getSelectedItem()).getModelConstant(),
                    ((SpnModelsItem) mSpnLang.getSelectedItem()).getModelConstant(),
                    mContext);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here3", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "Printer", mContext);
            return false;
        }

        mPrinter.setReceiveEventListener(this);

        return true;
    }

    private void finalizeObject() {
        if (mPrinter == null) {
            return;
        }

        mPrinter.clearCommandBuffer();

        mPrinter.setReceiveEventListener(null);

        mPrinter = null;
    }

    @Override
    public void onPtrReceive(final Printer printerObj, final int code, final PrinterStatusInfo status, final String printJobId) {
        runOnUiThread(new Runnable() {
            @Override
            public synchronized void run() {
                ShowMsg.showResult(code, makeErrorMessage(status), mContext);

                dispPrinterWarnings(status);

//                updateButtonState(true);

                new Thread(new Runnable() {
                    @Override
                    public void run() {
                        disconnectPrinter();
                    }
                }).start();
            }
        });
    }

    private String makeErrorMessage(PrinterStatusInfo status) {
        String msg = "";

        if (status.getOnline() == Printer.FALSE) {
            msg += getString(R.string.handlingmsg_err_offline);
        }
        if (status.getConnection() == Printer.FALSE) {
            msg += getString(R.string.handlingmsg_err_no_response);
        }
        if (status.getCoverOpen() == Printer.TRUE) {
            msg += getString(R.string.handlingmsg_err_cover_open);
        }
        if (status.getPaper() == Printer.PAPER_EMPTY) {
            msg += getString(R.string.handlingmsg_err_receipt_end);
        }
        if (status.getPaperFeed() == Printer.TRUE || status.getPanelSwitch() == Printer.SWITCH_ON) {
            msg += getString(R.string.handlingmsg_err_paper_feed);
        }
        if (status.getErrorStatus() == Printer.MECHANICAL_ERR || status.getErrorStatus() == Printer.AUTOCUTTER_ERR) {
            msg += getString(R.string.handlingmsg_err_autocutter);
            msg += getString(R.string.handlingmsg_err_need_recover);
        }
        if (status.getErrorStatus() == Printer.UNRECOVER_ERR) {
            msg += getString(R.string.handlingmsg_err_unrecover);
        }
        if (status.getErrorStatus() == Printer.AUTORECOVER_ERR) {
            if (status.getAutoRecoverError() == Printer.HEAD_OVERHEAT) {
                msg += getString(R.string.handlingmsg_err_overheat);
                msg += getString(R.string.handlingmsg_err_head);
            }
            if (status.getAutoRecoverError() == Printer.MOTOR_OVERHEAT) {
                msg += getString(R.string.handlingmsg_err_overheat);
                msg += getString(R.string.handlingmsg_err_motor);
            }
            if (status.getAutoRecoverError() == Printer.BATTERY_OVERHEAT) {
                msg += getString(R.string.handlingmsg_err_overheat);
                msg += getString(R.string.handlingmsg_err_battery);
            }
            if (status.getAutoRecoverError() == Printer.WRONG_PAPER) {
                msg += getString(R.string.handlingmsg_err_wrong_paper);
            }
        }
        if (status.getBatteryLevel() == Printer.BATTERY_LEVEL_0) {
            msg += getString(R.string.handlingmsg_err_battery_real_end);
        }

        return msg;
    }

    private void dispPrinterWarnings(PrinterStatusInfo status) {
//        EditText edtWarnings = (EditText) findViewById(R.id.edtWarnings);
        String warningsMsg = "";

        if (status == null) {
            return;
        }

        if (status.getPaper() == Printer.PAPER_NEAR_END) {
            warningsMsg += getString(R.string.handlingmsg_warn_receipt_near_end);
        }

        if (status.getBatteryLevel() == Printer.BATTERY_LEVEL_1) {
            warningsMsg += getString(R.string.handlingmsg_warn_battery_near_end);
        }

//        edtWarnings.setText(warningsMsg);
    }

    private void disconnectPrinter() {
        if (mPrinter == null) {
            return;
        }

        try {
            mPrinter.endTransaction();
        } catch (final Exception e) {
            runOnUiThread(new Runnable() {
                @Override
                public synchronized void run() {
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "Here6", Toast.LENGTH_SHORT).show();
                    ShowMsg.showException(e, "endTransaction", mContext);
                }
            });
        }

        try {
            mPrinter.disconnect();
        } catch (final Exception e) {
            runOnUiThread(new Runnable() {
                @Override
                public synchronized void run() {
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "Here7", Toast.LENGTH_SHORT).show();
                    ShowMsg.showException(e, "disconnect", mContext);
                }
            });
        }

        finalizeObject();
    }

    private boolean printData() {
        if (mPrinter == null) {
            return false;
        }

        if (!connectPrinter()) {
            return false;
        }

        PrinterStatusInfo status = mPrinter.getStatus();

        dispPrinterWarnings(status);

        if (!isPrintable(status)) {
            ShowMsg.showMsg(makeErrorMessage(status), mContext);
            try {
                mPrinter.disconnect();
            } catch (Exception ex) {
//                Toast.makeText(Cash_Card_Credit_Sales2.this, "Here9", Toast.LENGTH_SHORT).show();
                // Do nothing
            }
            return false;
        }

        try {
            mPrinter.sendData(Printer.PARAM_DEFAULT);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here10", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "sendData", mContext);
            try {
                mPrinter.disconnect();
            } catch (Exception ex) {
//                Toast.makeText(Cash_Card_Credit_Sales2.this, "Here11", Toast.LENGTH_SHORT).show();
                // Do nothing
            }
            return false;
        }

        return true;
    }

    private boolean isPrintable(PrinterStatusInfo status) {
        if (status == null) {
            return false;
        }

        if (status.getConnection() == Printer.FALSE) {
            return false;
        } else if (status.getOnline() == Printer.FALSE) {
            return false;
        } else {
            ;//print available
        }

        return true;
    }

    private boolean connectPrinter() {
        boolean isBeginTransaction = false;

        if (mPrinter == null) {
            return false;
        }

        try {
            mPrinter.connect(mEditTarget.getText().toString(), Printer.PARAM_DEFAULT);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here4", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "connect", mContext);
            return false;
        }

        try {
            mPrinter.beginTransaction();
            isBeginTransaction = true;
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here12", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "beginTransaction", mContext);
        }

        if (isBeginTransaction == false) {
            try {
                mPrinter.disconnect();
            } catch (Epos2Exception e) {
//                Toast.makeText(Cash_Card_Credit_Sales2.this, "Here5", Toast.LENGTH_SHORT).show();
                // Do nothing
                return false;
            }
        }

        return true;
    }

    private boolean createCouponData(Dialog dialog) {

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x25,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x06,0x20,0x29,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    charlength = 23;
                    charlength1 = 46;
                    charlength2 = 69;
                    quanlentha = 5;
                    str_line = "------------------------------------------------";
                    allbufline = new byte[][]{
                            left,un1, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
                    if (print_ty.moveToFirst()){
                        str_print_ty = print_ty.getString(1);
                    }
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 16;
                        charlength1 = 32;
                        charlength2 = 48;
                        quanlentha = 5;
                        str_line = "------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------".getBytes(), LF
                        };
                    }
                }
            }while(cc.moveToNext());
        }

//        Cursor getprint_type = db1.rawQuery("SELECT * FROM Printer_text_size", null);
//        if (getprint_type.moveToFirst()) {
//            String type = getprint_type.getString(1);
//
//            Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
//
//            if (cc.moveToFirst()) {
//                cc.moveToFirst();
//                do {
//                    NAME = cc.getString(1);
//                    if (NAME.equals("3 inch")) {
//                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
//                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
//                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
//                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
//                        setHT34 = new byte[]{0x1b, 0x44, 0x08, 0x20, 0x29, 0x00};//4 tabs 3"
//                        setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 3"
//                        feedcut2 = new byte[]{0x1b, 0x64, 0x05, 0x1d, 0x56, 0x00};
//                        nPaperWidth = 576;
//                        charlength = 41;
//                        str_line = "------------------------------------------------";
//                        allbufline = new byte[][]{
//                                left, un1, "------------------------------------------------".getBytes(), LF
//
//                        };
//                    } else {
//
//                        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
//                        if (print_ty.moveToFirst()){
//                            str_print_ty = print_ty.getString(1);
//                        }
//                        if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x04, 0x12, 0x19, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 25;
//                            str_line = "--------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "--------------------------------".getBytes(), LF
//                            };
//                        }else {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 28;
//                            str_line = "------------------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "------------------------------------------".getBytes(), LF
//                            };
//                        }
//                    }
//                } while (cc.moveToNext());
//            }
//
//        }

//        final int barcodeWidth = 2;
//        final int barcodeHeight = 64;
        final int pageAreaHeight = 384;
        final int pageAreaWidth = 384;
//        final int fontAHeight = 24;
//        final int fontAWidth = 12;
//        final int barcodeWidthPos = 110;
//        final int barcodeHeightPos = 70;

        ArrayList<byte[]> list = new ArrayList<byte[]>();
        String method = "";
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
            yourBitmap = BitmapFactory.decodeByteArray(img, 0, img.length);
        }

//        String method = "";
//        Bitmap coffeeData = BitmapFactory.decodeResource(getResources(), R.drawable.coffee);
//        Bitmap wmarkData = BitmapFactory.decodeResource(getResources(), R.drawable.wmark);

        if (mPrinter == null) {
            return false;
        }
        try{
//            method = "addPageBegin";
//            mPrinter.addPageBegin();

            method = "addPageArea";
            mPrinter.addPageArea(0, 0, nPaperWidth, pageAreaHeight);

            method = "addPageDirection";
            mPrinter.addPageDirection(Printer.DIRECTION_TOP_TO_BOTTOM);

            method = "addFeedLine";
            mPrinter.addFeedLine(1);
            method = "addPagePosition";
            mPrinter.addPagePosition(0, nPaperWidth);

//            // RECEIPT BODY//

            mPrinter.addCommand(LF);

//            method = "addPagePosition";
//            mPrinter.addPagePosition(0, wmarkData.getHeight());
//            mPrinter.addPagePosition(0, logoData.getScaledHeight(0));

//            method = "addImage";
//            mPrinter.addImage(wmarkData, 0, 0, wmarkData.getWidth(), wmarkData.getHeight(),
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
//Free coffee text

//            method = "addTextSize";
//            mPrinter.addTextSize(3, 3);
//            method = "addTextStyle";
//            mPrinter.addTextStyle(Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.TRUE, Printer.PARAM_DEFAULT);
//            method = "addTextSmooth";
//            mPrinter.addTextSmooth(Printer.TRUE);
//            method = "addText";
//            mPrinter.addText("FREE Coffee\n");

            Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
            if (connnet.moveToFirst()) {
                ipnamegets = connnet.getString(1);
                portgets = connnet.getString(2);
                statusnets = connnet.getString(3);
            }

            Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
            if (connnet_counter.moveToFirst()) {
                ipnamegets_counter = connnet_counter.getString(1);
                portgets_counter = connnet_counter.getString(2);
                statusnets_counter = connnet_counter.getString(3);
            }
            connnet_counter.close();

            Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
            if (connusb.moveToFirst()) {
                addgets = connusb.getString(1);
                namegets = connusb.getString(2);
                statussusbs = connusb.getString(3);
            }


            imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
            mView = dialog.findViewById(R.id.f_vieww1);




            allbuf1 = new byte[][]{
                    bold, un, "Bill copy".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(bold);
                mPrinter.addCommand(un);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Bill copy");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            if (c.moveToFirst()) {
                method = "addImage";

                if (NAME.equals("3 inch")) {
                    logoData = Bitmap.createScaledBitmap(yourBitmap, 576, 94, true);
                    mPrinter.addImage(logoData, 0, 0, logoData.getWidth(), logoData.getHeight(),
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
                } else {
                    logoData = Bitmap.createScaledBitmap(yourBitmap, 384, 94, true);
                    mPrinter.addImage(logoData, 0, 0, logoData.getWidth(), logoData.getHeight(),
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
                }
            }


//            ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
//            //LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(116, 95);
//            //imageButton.setLayoutParams(layoutParams);
//            //imageButton.setLayoutParams(116, 95);
//
//            if (NAME.equals("3 inch")) {
////            Toast.makeText(Cash_Card_Credit_Sales2.this, "3 inch", Toast.LENGTH_SHORT).show();
//                imageViewPicture.getLayoutParams().height = 94;
//                imageViewPicture.getLayoutParams().width = 576;
//                imageButton.getLayoutParams().height = 94;
//                imageButton.getLayoutParams().width = 576;
//            } else {
////            Toast.makeText(Cash_Card_Credit_Sales2.this, "2 inch", Toast.LENGTH_SHORT).show();
//                imageViewPicture.getLayoutParams().height = 94;
//                imageViewPicture.getLayoutParams().width = 384;
//                imageButton.getLayoutParams().height = 94;
//                imageButton.getLayoutParams().width = 384;
//            }

//            String[] col = {"companylogo"};
//            Cursor c = db1.query("Logo", col, null, null, null, null, null);
//            if (c.moveToFirst()) {
//                do {
//                    byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
//                    final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);
//
//                    imageButton.setImageBitmap(b1);
//
//
//                    mView.setDrawingCacheEnabled(true);
//                    mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
//                            View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
//                    mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
//                    mView.buildDrawingCache(true);
//
//                    Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
//                    //mView.setDrawingCacheEnabled(false);
//                    ByteArrayOutputStream bytes = new ByteArrayOutputStream();
//                    b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);
//
//                    imageViewPicture.setImageBitmap(b);
//
//                    Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
//                            .getBitmap();
//
//
//                    //if (mBitmap != null) {
//                    if (statussusbs.toString().equals("ok")) {
//                        if (mBitmap != null) {
//                            byte[] command = Utils.decodeBitmap(mBitmap);
//                            printByteData(command);
//                        } else {
//                            Log.e("Print Photo error", "the file isn't exists");
//                        }
//                        Bundle data = new Bundle();
//                        //data.putParcelable(Global.OBJECT1, mBitmap);
//                        data.putParcelable(Global.PARCE1, mBitmap);
//                        data.putInt(Global.INTPARA1, nPaperWidth);
//                        data.putInt(Global.INTPARA2, 0);
//                        DrawerService.workThread.handleCmd(
//                                Global.CMD_POS_PRINTBWPICTURE, data);
//                    } else {
//                        if (statusnets.toString().equals("ok")) {
//                            Bundle data = new Bundle();
//                            //data.putParcelable(Global.OBJECT1, mBitmap);
//                            data.putParcelable(Global1.PARCE1, mBitmap);
//                            data.putInt(Global1.INTPARA1, nPaperWidth);
//                            data.putInt(Global1.INTPARA2, 0);
//                            DrawerService1.workThread.handleCmd(
//                                    Global1.CMD_POS_PRINTBWPICTURE, data);
//                        }
//                    }
//                    //}
//                } while (c.moveToNext());
//            } else {
//                imageButton.setVisibility(View.GONE);
//            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(bold);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strcompanyname);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress1);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress2);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress3);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(pp);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(stremailid);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strwebsite);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strtaxone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }



            Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor10.moveToFirst()) {
                billtypea = cursor10.getString(5);
                paymmethoda = cursor10.getString(6);
            }

            TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
            ttv.setText(billtypea);

            TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
            ttv1.setText(paymmethoda);



            if (ttv.getText().toString().equals("  Cash")) {
                billtypeaa = "Cash"; //0
            }
            if (ttv.getText().toString().equals("  Card")) {
                billtypeaa = "Card"; //0
            }
            if (ttv.getText().toString().equals("  Paytm")) {
                billtypeaa = "Paytm"; //0
            }
            if (ttv.getText().toString().equals("  Mobikwik")) {
                billtypeaa = "Mobikwik"; //0
            }
            if (ttv.getText().toString().equals("  Freecharge")) {
                billtypeaa = "Freecharge"; //0
            }
            if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                billtypeaa = getString(R.string.pay_later_nospace); //0
            }
            if (ttv.getText().toString().equals("  Cheque")) {
                billtypeaa = "Cheque"; //0
            }
            if (ttv.getText().toString().equals("  Sodexo")) {
                billtypeaa = "Sodexo"; //0
            }
            if (ttv.getText().toString().equals("  Zeta")) {
                billtypeaa = "Zeta"; //0
            }
            if (ttv.getText().toString().equals("  Ticket")) {
                billtypeaa = "Ticket"; //0
            }
            if (ttv.getText().toString().equals(" Upiqr")) {
                billtypeaa = "upiqr"; //0
            }
            if (ttv.getText().toString().equals("  Upiqr")) {
                billtypeaa = "Upiqr"; //0
            }
            billtypeaa = ttv.getText().toString().replace(" ", "");

            //String bill_no = billnum.getText().toString();
            allbufbillno = new byte[][]{
                    setHT32, un1, "Bill no.".getBytes(), billnumb.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(normal);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Bill no."+billnumb);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(billtypeaa);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                //billtypee.setText("Dine-in");
                if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                    paymmethodaa = "Dine-in";
                }else {
                    paymmethodaa = getString(R.string.pref_header_general);
                }
            } else {
                if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                    paymmethodaa = "Takeaway";
                    //billtypee.setText("Takeaway");
                } else {
                    paymmethodaa = "Home delivery";
                    //billtypee.setText("Home delivery");
                }
            }

            Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);
            if (date.moveToFirst()) {
                datee = date.getString(25);
                timee = date.getString(12);
            }

            allbuf10 = new byte[][]{
                    setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), datee.getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(paymmethodaa);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+datee);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
            if (cursor9.moveToFirst()) {
                tableida = cursor9.getString(15);
                Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
                if (vbnm.moveToFirst()) {
                    assa1 = vbnm.getString(1);
                    assa2 = vbnm.getString(2);
                }
                TextView cx = new TextView(Cash_Card_Credit_Sales2.this);
                cx.setText(assa1);

                if (cx.getText().toString().equals("")) {
                    tableidaa = "Tab" + assa2;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                } else {
                    tableidaa = "Tab" + assa1;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                }

            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(tableidaa);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+timee);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            String u_name = "";
            Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "'", null);
            if (cursor9_1.moveToFirst()) {
                u_name = cursor9_1.getString(45);
            }
            cursor9_1.close();

            TextView tv_u_name = new TextView(Cash_Card_Credit_Sales2.this);
            tv_u_name.setText(u_name);

            if (tv_u_name.getText().toString().equals("")){

            }else {
                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(left);    //
                    mPrinter.addCommand(setHT321);    //
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Counter person: "+tv_u_name.getText().toString());
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
            if (caddress.moveToFirst()) {
                String nam = caddress.getString(1);
                String addr = caddress.getString(4);
                String phon = caddress.getString(2);
                String emai = caddress.getString(3);

                if (nam.toString().length() > 0 || addr.toString().length() > 0 ||
                        phon.toString().length() > 0 || emai.toString().length() > 0) {
                    allbufcust = new byte[][]{
                            left, un, "Customer:".getBytes(), LF, un1,
                    };

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(un);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Customer:");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                        mPrinter.addCommand(un1); //LF
                    }
                } else {

                }

                if (nam.toString().length() > 0) {
                    allbufcustname = new byte[][]{
                            nam.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(nam);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (addr.toString().length() > 0) {
                    allbufcustadd = new byte[][]{
                            addr.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(addr);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (phon.toString().length() > 0) {
                    String cust_ph = "Ph. " + phon.toString();
                    allbufcustph = new byte[][]{
                            cust_ph.getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(cust_ph);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (emai.toString().length() > 0) {
                    allbufcustemail = new byte[][]{
                            emai.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(emai);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(left);
                    mPrinter.addCommand(un1);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(str_line);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            allbufqty = new byte[][]{
                    setHT34, normal, "Qty".getBytes(), HT, getString(R.string.action_item).getBytes(), HT, "Price".getBytes(), HT, getString(R.string.amount).getBytes(), left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT34);
                mPrinter.addCommand(normal);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Qty");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(getString(R.string.action_item));
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData3 = new StringBuilder();
                textData3.append("  Price");
                mPrinter.addText(textData3.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData4 = new StringBuilder();
                textData4.append("  Amount");
                mPrinter.addText(textData4.toString());
                mPrinter.addCommand(left);
                mPrinter.addCommand(LF); //LF
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursorr.moveToFirst()) {

                do {

                    String nbg = ccursorr.getString(0);
                    String name = ccursorr.getString(1);
                    String value = ccursorr.getString(2);
                    String pq = ccursorr.getString(5);
                    String itna = ccursorr.getString(2);
                    String pricee = ccursorr.getString(3);
                    String tototot = ccursorr.getString(4);

                    final String newid = ccursorr.getString(20);
                    int padding_in_px;

                    int padding_in_dp = 30;  // 34 dps
                    final float scale1 = getResources().getDisplayMetrics().density;
                    padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                    if (pq.equals(getString(R.string.action_item))) {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                        final TableRow row1 = new TableRow(Cash_Card_Credit_Sales2.this);
                        row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                        final TableRow row2 = new TableRow(Cash_Card_Credit_Sales2.this);
                        row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));

                        //TableLayout.LayoutParams tableLayoutParams = new TableLayout.LayoutParams();
                        final TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        //tv.setTextSize(18);
                        tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv.setPadding(0, 0, 0, 0);
                        //text = ccursorr.getString(1);
                        tv.setText(value);
                        row.addView(tv);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setGravity(Gravity.CENTER_VERTICAL);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv1.setTextSize(15);
                        //tv.setPadding(0, 0, 0, 0);
                        //text = ccursorr.getString(1);
                        tv1.setText(name);
                        String value1 = tv1.getText().toString();
                        row.addView(tv1);

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 4.5f);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv2.append(value + "% " + name);
                        tv2.setText(pricee);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(R.color.black);
                        row.addView(tv2);

//                                            TextView textView1 = new TextView(CancelActivity.this);
//                                            //lp1 = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 1.5f);
//                                            textView1.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                                                    android.widget.TableRow.LayoutParams.WRAP_CONTENT, 1.5f));
//                                            //tv.setBackgroundResource(R.drawable.cell_shape);
//                                            textView1.setGravity(Gravity.RIGHT | Gravity.CENTER_VERTICAL);
//                                            textView1.setText(insert1_cc);
//                                            //textView1.setBackgroundResource(R.drawable.rs_border);
//                                            textView1.setPadding(0, 0, 5, 0);
//                                            //textView1.setTextColor(R.color.black);
//                                            textView1.setTextSize(14);
//                                            row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setPadding(5, 0, 0, 0);
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv2.setPadding(0, 0, 1, 0);
                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv3.setText(tototot);
                        //tv3.setTextColor(R.color.black);
                        //row.addView(tv3);


                        String value2 = tv3.getText().toString();

                        Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                        if (modcursor.moveToFirst()) {

                            Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnumb + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                            if (cursor4.moveToFirst()) {
                                float sub2a = cursor4.getFloat(0);
                                String sub2a1 = String.valueOf(sub2a);
                                ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot);
                                ss1 = String.valueOf(ss);
                            }

                            if (name.toString().length() > charlength) {
                                int print1 = 0;
                                if (value.length() > quanlentha && name.toString().length() > charlength) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }
//                            if (name.toString().length()>charlength){
//                                String string1 = name.substring(0, charlength);
//                                String string2 = name.substring(charlength);
//                                allbufitems = new byte[][]{
//                                        setHT34, normal,value.getBytes(),HT,string1.getBytes(),HT, pricee.getBytes(),HT, ss1.getBytes(),LF,"    ".getBytes(),string2.getBytes(),LF
//                                };
//                            }

                                if (value.length() > quanlentha && name.toString().length() > charlength1) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength1) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }

                            } else {

                                if (value.toString().length() > quanlentha) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(string1quan);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(ss1);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF); //LF
                                    StringBuilder textData5 = new StringBuilder();
                                    textData5.append(string2quan);
                                    mPrinter.addText(textData5.toString());
                                    mPrinter.addCommand(LF);
                                } else {
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), left, LF,
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(value);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(ss1);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF); //LF
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }

                            }

                            do {

                                final String modiname = modcursor.getString(1);
                                final String modiquan = modcursor.getString(2);
                                String modiprice = modcursor.getString(3);
                                String moditotal = modcursor.getString(4);
                                final String modiid = modcursor.getString(0);

                                float modprice1 = Float.parseFloat(modiprice);
                                String modpricestr = String.valueOf(modprice1);

                                if (modiname.toString().length() > charlength) {
                                    if (modiname.toString().length() > charlength) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append("");
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(">");
                                        mPrinter.addText(textData2.toString());
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(string1);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(modpricestr);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("");
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append("    ");
                                        mPrinter.addText(textData6.toString());
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append(string2);
                                        mPrinter.addText(textData7.toString());
                                        mPrinter.addCommand(LF); //LF
                                    }
                                    if (modiname.toString().length() > charlength1) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength, charlength1);
                                        String string3 = modiname.substring(charlength1);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF, "    ".getBytes(), string3.getBytes(), left, LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append("");
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(">");
                                        mPrinter.addText(textData2.toString());
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(string1);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(modpricestr);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("");
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append("    ");
                                        mPrinter.addText(textData6.toString());
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append(string2);
                                        mPrinter.addText(textData7.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append("    ");
                                        mPrinter.addText(textData8.toString());
                                        StringBuilder textData9 = new StringBuilder();
                                        textData9.append(string3);
                                        mPrinter.addText(textData9.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.toString().equals("ok")) {
                                                mPrinter.addCommand(left);
                                                mPrinter.addCommand(normal);
                                                StringBuilder textData1 = new StringBuilder();
                                                textData1.append("HSN " + hsn);
                                                mPrinter.addText(textData1.toString());
                                                mPrinter.addCommand(HT);
                                                mPrinter.addCommand(LF);
                                            }
                                        }
                                    }

                                } else {
                                    allbufmodifiers = new byte[][]{
                                            setHT34, normal, "".getBytes(), HT, ">".getBytes(), modiname.getBytes(), HT, modpricestr.getBytes(), HT, "".getBytes(), left, LF
                                            //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                    };
                                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                                    if (statussusbs.toString().equals("ok")) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append("");
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(">");
                                        mPrinter.addText(textData2.toString());
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(modiname);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(modpricestr);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("");
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.toString().equals("ok")) {
                                                mPrinter.addCommand(left);
                                                mPrinter.addCommand(normal);
                                                StringBuilder textData1 = new StringBuilder();
                                                textData1.append("HSN " + hsn);
                                                mPrinter.addText(textData1.toString());
                                                mPrinter.addCommand(HT);
                                                mPrinter.addCommand(LF);
                                            }
                                        }
                                    }

                                }

                                final TableRow tableRow11 = new TableRow(Cash_Card_Credit_Sales2.this);
                                tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                        TableRow.LayoutParams.MATCH_PARENT,
                                        TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                final TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                                // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                                tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                //tv.setGravity(Gravity.CENTER);
                                tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tvv.setText("");
                                tableRow11.addView(tvv);

                                TextView tv4 = new TextView(Cash_Card_Credit_Sales2.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv4.setText(modiname);
                                tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv4.setGravity(Gravity.CENTER_VERTICAL);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv4);

                                TextView tv5 = new TextView(Cash_Card_Credit_Sales2.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv2.setPadding(0, 0, 1, 0);
                                tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv5.setText(modiprice);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv5);

                                TextView tv6 = new TextView(Cash_Card_Credit_Sales2.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setPadding(5, 0, 0, 0);
                                tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv6.setText("");
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv6);


                                final TextView tv7 = new TextView(Cash_Card_Credit_Sales2.this);
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv3.setPadding(0,0,10,0);
                                tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                                final String number = tv.getText().toString();
                                float newmul = Float.parseFloat(number);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                                //row.addView(tv3);

                                row.removeView(tv8);


                                tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                                tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                //tv3.setPadding(0, 0, 10, 0);
                                tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                final String numberr = tv.getText().toString();
                                float newmulr = Float.parseFloat(numberr);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                tv8.setText(String.valueOf(ss));
                                row.addView(tv8);


                                tableLayout1.addView(tableRow11);
                            } while (modcursor.moveToNext());

                            //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.toString().equals(getString(R.string.no))) {

                                    } else {

//                                    Cursor cursor113 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "' AND disc_thereornot = 'yes' AND itemname = '" + name + "' AND _id = '" + nbg + "'", null);
//                                    if (cursor113.moveToFirst()) {
//                                        float vtq = cursor113.getFloat(31);
//                                        total_disc_print_q = String.valueOf(vtq);
//                                    }

//                                    allbufitems = new byte[][]{
//                                            setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, total_disc_print.getBytes(), left, LF,
//                                    };

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(setHT34);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("");
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData2 = new StringBuilder();
                                            textData2.append("");
                                            mPrinter.addText(textData2.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData3 = new StringBuilder();
                                            textData3.append("");
                                            mPrinter.addText(textData3.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData4 = new StringBuilder();
                                            textData4.append("(");
                                            mPrinter.addText(textData4.toString());
                                            StringBuilder textData5 = new StringBuilder();
                                            textData5.append("-");
                                            mPrinter.addText(textData5.toString());
                                            StringBuilder textData6 = new StringBuilder();
                                            textData6.append(total_disc_print_q);
                                            mPrinter.addText(textData6.toString());
                                            StringBuilder textData7 = new StringBuilder();
                                            textData7.append(")");
                                            mPrinter.addText(textData7.toString());
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(LF); //LF
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }

                        } else {

                            if (name.toString().length() > charlength) {
                                int print1 = 0;
                                if (value.length() > quanlentha && name.toString().length() > charlength) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }
//                            if (name.toString().length()>charlength){
//                                String string1 = name.substring(0, charlength);
//                                String string2 = name.substring(charlength);
//                                allbufitems = new byte[][]{
//                                        setHT34,normal,value.getBytes(),HT,string1.getBytes(),HT, pricee.getBytes(),HT, tototot.getBytes(),LF,"    ".getBytes(),string2.getBytes(),LF
//                                };
//                            }
////////////////////////////////////////////////
                                if (value.length() > quanlentha && name.toString().length() > charlength1) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength1) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }

                            } else {
                                if (value.toString().length() > quanlentha) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(string1quan);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(tototot);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF);
                                    StringBuilder textData5 = new StringBuilder();
                                    textData5.append(string2quan);
                                    mPrinter.addText(textData5.toString());
                                    mPrinter.addCommand(LF); //LF
                                } else {
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), left, LF,
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(value);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(tototot);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF); //LF
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }

                            }

                            tv8 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(multiply));
                            row.addView(tv8);

                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.toString().equals(getString(R.string.no))) {

                                    } else {

//                                    Cursor cursor113 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "' AND disc_thereornot = 'yes' AND itemname = '" + name + "' AND _id = '" + nbg + "'", null);
//                                    if (cursor113.moveToFirst()) {
//                                        float vtq = cursor113.getFloat(31);
//                                        total_disc_print_q = String.valueOf(vtq);
//                                    }

//                                    allbufitems = new byte[][]{
//                                            setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, total_disc_print.getBytes(), left, LF,
//                                    };

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(setHT34);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("");
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData2 = new StringBuilder();
                                            textData2.append("");
                                            mPrinter.addText(textData2.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData3 = new StringBuilder();
                                            textData3.append("");
                                            mPrinter.addText(textData3.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData4 = new StringBuilder();
                                            textData4.append("(");
                                            mPrinter.addText(textData4.toString());
                                            StringBuilder textData5 = new StringBuilder();
                                            textData5.append("-");
                                            mPrinter.addText(textData5.toString());
                                            StringBuilder textData6 = new StringBuilder();
                                            textData6.append(total_disc_print_q);
                                            mPrinter.addText(textData6.toString());
                                            StringBuilder textData7 = new StringBuilder();
                                            textData7.append(")");
                                            mPrinter.addText(textData7.toString());
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(LF); //LF
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }
                        }
                    }


                } while (ccursorr.moveToNext());
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }
////////////////////////////////////sub total
            Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor3.moveToFirst()) {
                sub = cursor3.getString(7);
            }


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
            float to = Float.parseFloat(sub);
            String tot = String.format("%.2f", to);


            allbufsubtot = new byte[][]{
                    setHT32, left, "Sub total".getBytes(), HT, tot.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Sub total");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(tot);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }
/////////////////////////tax




///////////////////////////////// discount

            Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
            if (cursor4.moveToFirst()) {
                taxpe = cursor4.getString(5);
            } else {
                taxpe = "0";
            }

            Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnumb + "'", null);
            if (cursor5.moveToFirst()) {
                dsirs = cursor5.getString(7);
            } else {
                dsirs = "0";
            }

            String alldiscinperc1 = "Discount(" + taxpe + "%)";
            allbufdisc = new byte[][]{
                    setHT32, left, alldiscinperc1.getBytes(), HT, dsirs.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(alldiscinperc1);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(dsirs);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }
            float newe;
//////////////////////////////////////////////

            Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnumb + "'", null);
            if (cursor113.moveToFirst()) {
                float level = cursor113.getFloat(0);
                total = String.valueOf(level);
                float total1 = Float.parseFloat(total);
                total_disc_print_q = String.format("%.2f", total1);

                allbufrounded = new byte[][]{
                        setHT32, left, "Savings".getBytes(), HT, total_disc_print_q.getBytes(), LF
                };

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(setHT32);
                    mPrinter.addCommand(left);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Savings");
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(HT);
                    StringBuilder textData2 = new StringBuilder();
                    textData2.append(total_disc_print_q);
                    mPrinter.addText(textData2.toString());
                    mPrinter.addCommand(LF); //LF
                }

            }
////////////////////////////////

            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor.moveToFirst()) {
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {
                    allbufrounded = new byte[][]{
                            setHT32, left, "Loyalty".getBytes(), HT, v_tq.getBytes(), LF
                    };

                    if (statussusbs.equals("ok")) {
                        mPrinter.addCommand(setHT32);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Loyalty(" + t_total_points + ")");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append(v_tq);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                }
            }

//////////////////////////////////////Rounded off

            Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor7.moveToFirst()) {
                subro = cursor7.getString(9);
            }

            allbufrounded = new byte[][]{
                    setHT32, left, "Rounded".getBytes(), HT, subro.toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Rounded");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(subro);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }
//////////////Total main

            Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnumb + "'", null);
            if (cursor8.moveToFirst()) {
                alltotal1 = cursor8.getString(2);
            }

            float all = Float.parseFloat(alltotal1);
            String newf = String.format("%.2f", all);

            allbufrounded = new byte[][]{
                    setHT3212, left, "Total".getBytes(), HT, "Rs ".getBytes(), newf.toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT3212);
                mPrinter.addCommand(bold);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Total");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(insert1_rs+""+newf);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(normal);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            //////////////ttax
            TableLayout tableLayout1 = new TableLayout(Cash_Card_Credit_Sales2.this);
            tableLayout1.removeAllViews();

            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor.moveToFirst()) {

                do {
                    String name = ccursor.getString(10);
                    String value = ccursor.getString(9);
                    String pq = ccursor.getString(50);
                    String itna = ccursor.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor.moveToNext());
            }
            ccursor.close();

            Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor2.moveToFirst()) {

                do {
                    String name = ccursor2.getString(35);
                    String value = ccursor2.getString(36);
                    String pq = ccursor2.getString(50);
                    String itna = ccursor2.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor2.moveToNext());
            }
            ccursor2.close();

            Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor3.moveToFirst()) {

                do {
                    String name = ccursor3.getString(37);
                    String value = ccursor3.getString(38);
                    String pq = ccursor3.getString(50);
                    String itna = ccursor3.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor3.moveToNext());
            }
            ccursor3.close();

            Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor4.moveToFirst()) {

                do {
                    String name = ccursor4.getString(39);
                    String value = ccursor4.getString(40);
                    String pq = ccursor4.getString(50);
                    String itna = ccursor4.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor4.moveToNext());
            }
            ccursor4.close();

            Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnumb + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor5.moveToFirst()) {

                do {
                    String name = ccursor5.getString(41);
                    String value = ccursor5.getString(42);
                    String pq = ccursor5.getString(50);
                    String itna = ccursor5.getString(1);

                    TextView v = new TextView(Cash_Card_Credit_Sales2.this);
                    v.setText(value);

                    TextView v1 = new TextView(Cash_Card_Credit_Sales2.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor5.moveToNext());
            }
            ccursor5.close();


            ArrayList<String> groupList = new ArrayList<String>();

            float sum_p = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(Cash_Card_Credit_Sales2.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

                if (groupList.contains(mTextView.getText().toString())) {

                }else {
                    sum_p = 0;
                    for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                        TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                        mTextView1 = (TextView) mRow1.getChildAt(0);
                        mTextView2 = (TextView) mRow1.getChildAt(2);
                        if (groupList.contains(mTextView.getText().toString())) {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        } else {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                groupList.add(mTextView.getText().toString());
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Cash_Card_Credit_Sales2.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        }
                    }
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                    String mod1 = mTextView.getText().toString() + "" + String.format("%.2f", sum_p);
                    String mod12 = mTextView.getText().toString();

                    allbuftaxestype1 = new byte[][]{
                            left, normal, mod12.getBytes(), HT, LF
                    };

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT32);
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(mod12);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append(String.format("%.2f", sum_p));
                        mPrinter.addCommand(LF); //LF
                    }

//                    String match = "@";
//                    int position = mTextView.getText().toString().indexOf(match);
                    String mod2 = mTextView.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+mod2, Toast.LENGTH_LONG).show();
                    Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    if (ccursor6.moveToFirst()) {
                        String hsn = ccursor6.getString(34);

                        TextView hsn_hsn = new TextView(Cash_Card_Credit_Sales2.this);
                        hsn_hsn.setText(hsn);

                        if (hsn_hsn.getText().toString().equals("")) {
                        } else {
                            allbuftaxestype1 = new byte[][]{
                                    left, normal, hsn.getBytes(), HT, LF
                            };
                            if (statussusbs.toString().equals("ok")) {
                                mPrinter.addCommand(left);
                                mPrinter.addCommand(normal);
                                StringBuilder textData1 = new StringBuilder();
                                textData1.append("HSN " + hsn);
                                mPrinter.addText(textData1.toString());
                                mPrinter.addCommand(HT);
                                mPrinter.addCommand(LF); //LF
                            }
                        }
                    }

                }
            }

            String phon = "0";
            Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnumb + "'", null);
            if (caddress1.moveToFirst()) {
                phon = caddress1.getString(2);
            }

            TextView tvvs = new TextView(Cash_Card_Credit_Sales2.this);
            tvvs.setText(phon);

            Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
            if (us_name1.moveToLast()) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id there", Toast.LENGTH_LONG).show();
                String na53 = us_name1.getString(53);
                String na38 = us_name1.getString(38);
                String na39 = us_name1.getString(39);
                String na40 = us_name1.getString(40);
                String na41 = us_name1.getString(41);
                String na42 = us_name1.getString(42);
                String na43 = us_name1.getString(43);
                String na44 = us_name1.getString(44);
                String na45 = us_name1.getString(45);
                String na46 = us_name1.getString(46);
                String na47 = us_name1.getString(47);
                String na48 = us_name1.getString(48);
                String na49 = us_name1.getString(49);
                String na50 = us_name1.getString(50);
                String na51 = us_name1.getString(51);
                String na52 = us_name1.getString(52);
                String na38_value = us_name1.getString(54);
                String na39_value = us_name1.getString(55);
                String na40_value = us_name1.getString(56);
                String na41_value = us_name1.getString(57);
                String na42_value = us_name1.getString(58);
                String na43_value = us_name1.getString(59);
                String na44_value = us_name1.getString(60);
                String na45_value = us_name1.getString(61);
                String na46_value = us_name1.getString(62);
                String na47_value = us_name1.getString(63);
                String na48_value = us_name1.getString(64);
                String na49_value = us_name1.getString(65);
                String na50_value = us_name1.getString(66);
                String na51_value = us_name1.getString(67);
                String na52_value = us_name1.getString(68);

                String proc = us_name1.getString(69);

                TextView hid = new TextView(Cash_Card_Credit_Sales2.this);
                hid.setText(proc);

                if (hid.getText().toString().equals("off")) {
                    Cursor cursorr = null;
                    if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals(getString(R.string.general)) || paymmethoda.toString().equals("  Others")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.toString().equals("  Home delivery")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                    if (cursorr.moveToFirst()) {

                        do {

                            String name = cursorr.getString(1);
                            String value = cursorr.getString(2);

                            final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT));
                            row.setGravity(Gravity.CENTER);

                            TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                            TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText(name);

                            TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv1.setText(value);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format("%.2f", vbn);
                            tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                            //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                            //tv2.setLayoutParams(lp);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                            tv2.append(name + " @ " + bvn + "%");
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            //tv3.setPadding(0,0,10,0);
                            tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
                            float tota = mul;
                            String tota1 = String.format("%.2f", tota);
                            tv3.setText(String.valueOf(tota));
                            //row.addView(tv3);


                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value2 = tv3.getText().toString();
                            row.addView(tv3);

                            tableLayout1.addView(row);

                            String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                                    //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                            };
                            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                            if (statussusbs.toString().equals("ok")) {
                                mPrinter.addCommand(left);
                                mPrinter.addCommand(normal);
                                StringBuilder textData1 = new StringBuilder();
                                textData1.append(mod1);
                                mPrinter.addText(textData1.toString());
                                mPrinter.addCommand(HT);
                                mPrinter.addCommand(LF); //LF
                            }

                        } while (cursorr.moveToNext());
                    }
                } else {

                    for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                        int i1 = 0;
                        if (i2 == 38) {
                            i1 = 54;
                        }
                        if (i2 == 39) {
                            i1 = 55;
                        }
                        if (i2 == 40) {
                            i1 = 56;
                        }
                        if (i2 == 41) {
                            i1 = 57;
                        }
                        if (i2 == 42) {
                            i1 = 58;
                        }
                        if (i2 == 43) {
                            i1 = 59;
                        }
                        if (i2 == 44) {
                            i1 = 60;
                        }
                        if (i2 == 45) {
                            i1 = 61;
                        }
                        if (i2 == 46) {
                            i1 = 62;
                        }
                        if (i2 == 47) {
                            i1 = 63;
                        }
                        if (i2 == 48) {
                            i1 = 64;
                        }
                        if (i2 == 49) {
                            i1 = 65;
                        }
                        if (i2 == 50) {
                            i1 = 66;
                        }
                        if (i2 == 51) {
                            i1 = 67;
                        }
                        if (i2 == 52) {
                            i1 = 68;
                        }


                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);;
                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Cash_Card_Credit_Sales2.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv.setGravity(Gravity.START);
                        tv.setTextSize(15);
                        //text = cursor.getString(1);
//                String v = na;

                        tv.setText(us_name1.getString(i2));


                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        //text = cursor.getString(1);
                        tv1.setText(us_name1.getString(i1));
                        String value1 = "0";
                        if (tv1.getText().toString().equals("")) {

                        } else {
                            value1 = tv1.getText().toString();
                        }


                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                        tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

//                    Toast.makeText(Cash_Card_Credit_Sales2.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                        TextView tv33 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
                        float tota = mul;
                        String tota1 = String.format("%.2f", tota);
                        tv33.setText(String.valueOf(tota));
                        tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv3.setTextColor(Color.parseColor("#000000"));
                        //row.addView(tv3);


                        tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv33);

                        String value2 = tv33.getText().toString();
//                    Toast.makeText(Cash_Card_Credit_Sales2.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                        if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                                || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                        } else {
                            tableLayout1.addView(row);
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                            String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                            };

                            if (statussusbs.toString().equals("ok")) {
                                mPrinter.addCommand(left);
                                mPrinter.addCommand(normal);
                                StringBuilder textData1 = new StringBuilder();
                                textData1.append(mod1);
                                mPrinter.addText(textData1.toString());
                                mPrinter.addCommand(HT);
                                mPrinter.addCommand(LF); //LF
                            }

                        }

                    }
                }

            } else {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "user id not there", Toast.LENGTH_LONG).show();
                Cursor cursorr = null;
                if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals(getString(R.string.general)) || paymmethoda.toString().equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.toString().equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Cash_Card_Credit_Sales2.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Cash_Card_Credit_Sales2.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format("%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Cash_Card_Credit_Sales2.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Cash_Card_Credit_Sales2.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Cash_Card_Credit_Sales2.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
                        float tota = mul;
                        String tota1 = String.format("%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        allbuftaxestype2 = new byte[][]{
                                left, normal, mod1.getBytes(), HT, LF
                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.toString().equals("ok")) {
                            mPrinter.addCommand(left);
                            mPrinter.addCommand(normal);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append(mod1);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(HT);
                            mPrinter.addCommand(LF); //LF
                        }

                    } while (cursorr.moveToNext());
                }
            }

            float sum = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(2);
                sum = sum
                        + Float.parseFloat(mTextView.getText().toString());
            }


            String newsum = String.format("%.2f", sum);

            if (sum == 0 || sum == 0.0 || sum == 0.00) {

            } else {
                allbuftax = new byte[][]{
                        setHT32, left, getString(R.string.action_tax).getBytes(), HT, newsum.getBytes(), LF
                };

                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(setHT32);
                    mPrinter.addCommand(left);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(getString(R.string.action_tax));
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(HT);
                    StringBuilder textData2 = new StringBuilder();
                    textData2.append(newsum);
                    mPrinter.addText(textData2.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }
            //////////////ttax

            tvkot.setText(bill_coun);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, bill_coun.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(left);
                    mPrinter.addCommand(un1);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Bill id."+bill_coun);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                    mPrinter.addCommand(LF); //LF
                }
            }

//            allbuf2 = new byte[][]{
//                    normal, "Thank you! visit again.".getBytes(), LF, LF
//
//            };
//            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//            if (statussusbs.toString().equals("ok")) {
//                mPrinter.addCommand(normal);
//                StringBuilder textData1 = new StringBuilder();
//                textData1.append("Thank you! visit again.");
//                mPrinter.addText(textData1.toString());
//                mPrinter.addCommand(LF); //LF
//                mPrinter.addCommand(LF); //LF
//            }

            tvkot.setText(strbillone);
            if (tvkot.getText().toString().equals("")){

            }else {
                allbuf2 = new byte[][]{
                        normal, strbillone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strbillone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            Cursor acc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

            if(acc.moveToFirst()){
                acc.moveToFirst();
                do{
                    NAME = acc.getString(1);
                    if (NAME.equals("3 inch")) {
                        feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                    }
                    else {
                        feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                    }
                }while(acc.moveToNext());
            }

            byte[][] allbuf = new byte[][]{
                    feedcut2
            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(feedcut2);
            }

            if (str_print_ty.equals("POS")) {
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(feedcut2);
                }
            }
//            method = "addCut";
//            mPrinter.addCut(Printer.CUT_FEED);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here2", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, method, mContext);
            return false;
        }

        return true;
    }

    private boolean createCouponData_minireceipt_all() {

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x25,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x06,0x20,0x29,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    charlength = 23;
                    charlength1 = 46;
                    charlength2 = 69;
                    quanlentha = 5;
                    str_line = "------------------------------------------------";
                    allbufline = new byte[][]{
                            left,un1, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
                    if (print_ty.moveToFirst()){
                        str_print_ty = print_ty.getString(1);
                    }
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 16;
                        charlength1 = 32;
                        charlength2 = 48;
                        quanlentha = 5;
                        str_line = "------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------".getBytes(), LF
                        };
                    }
                }
            }while(cc.moveToNext());
        }

//        Cursor getprint_type = db1.rawQuery("SELECT * FROM Printer_text_size", null);
//        if (getprint_type.moveToFirst()) {
//            String type = getprint_type.getString(1);
//
//            Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
//
//            if (cc.moveToFirst()) {
//                cc.moveToFirst();
//                do {
//                    NAME = cc.getString(1);
//                    if (NAME.equals("3 inch")) {
//                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
//                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
//                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
//                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
//                        setHT34 = new byte[]{0x1b, 0x44, 0x08, 0x20, 0x29, 0x00};//4 tabs 3"
//                        setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 3"
//                        feedcut2 = new byte[]{0x1b, 0x64, 0x05, 0x1d, 0x56, 0x00};
//                        nPaperWidth = 576;
//                        charlength = 41;
//                        str_line = "------------------------------------------------";
//                        allbufline = new byte[][]{
//                                left, un1, "------------------------------------------------".getBytes(), LF
//
//                        };
//                    } else {
//
//                        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
//                        if (print_ty.moveToFirst()){
//                            str_print_ty = print_ty.getString(1);
//                        }
//                        if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x04, 0x12, 0x19, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 25;
//                            str_line = "--------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "--------------------------------".getBytes(), LF
//                            };
//                        }else {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 28;
//                            str_line = "------------------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "------------------------------------------".getBytes(), LF
//                            };
//                        }
//                    }
//                } while (cc.moveToNext());
//            }
//
//        }

//        final int barcodeWidth = 2;
//        final int barcodeHeight = 64;
        final int pageAreaHeight = 384;
        final int pageAreaWidth = 384;
//        final int fontAHeight = 24;
//        final int fontAWidth = 12;
//        final int barcodeWidthPos = 110;
//        final int barcodeHeightPos = 70;

        ArrayList<byte[]> list = new ArrayList<byte[]>();
        String method = "";
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
            yourBitmap = BitmapFactory.decodeByteArray(img, 0, img.length);
        }

//        String method = "";
//        Bitmap coffeeData = BitmapFactory.decodeResource(getResources(), R.drawable.coffee);
//        Bitmap wmarkData = BitmapFactory.decodeResource(getResources(), R.drawable.wmark);

        if (mPrinter == null) {
            return false;
        }
        try{
//            method = "addPageBegin";
//            mPrinter.addPageBegin();

            method = "addPageArea";
            mPrinter.addPageArea(0, 0, nPaperWidth, pageAreaHeight);

            method = "addPageDirection";
            mPrinter.addPageDirection(Printer.DIRECTION_TOP_TO_BOTTOM);

            method = "addFeedLine";
            mPrinter.addFeedLine(1);
            method = "addPagePosition";
            mPrinter.addPagePosition(0, nPaperWidth);

//            // RECEIPT BODY//

            mPrinter.addCommand(LF);

//            method = "addPagePosition";
//            mPrinter.addPagePosition(0, wmarkData.getHeight());
//            mPrinter.addPagePosition(0, logoData.getScaledHeight(0));

//            method = "addImage";
//            mPrinter.addImage(wmarkData, 0, 0, wmarkData.getWidth(), wmarkData.getHeight(),
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
//Free coffee text

//            method = "addTextSize";
//            mPrinter.addTextSize(3, 3);
//            method = "addTextStyle";
//            mPrinter.addTextStyle(Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.TRUE, Printer.PARAM_DEFAULT);
//            method = "addTextSmooth";
//            mPrinter.addTextSmooth(Printer.TRUE);
//            method = "addText";
//            mPrinter.addText("FREE Coffee\n");

            Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
            if (connnet.moveToFirst()) {
                ipnamegets = connnet.getString(1);
                portgets = connnet.getString(2);
                statusnets = connnet.getString(3);
            }

            Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
            if (connnet_counter.moveToFirst()) {
                ipnamegets_counter = connnet_counter.getString(1);
                portgets_counter = connnet_counter.getString(2);
                statusnets_counter = connnet_counter.getString(3);
            }
            connnet_counter.close();

            Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
            if (connusb.moveToFirst()) {
                addgets = connusb.getString(1);
                namegets = connusb.getString(2);
                statussusbs = connusb.getString(3);
            }

            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(bold);
                mPrinter.addCommand(un);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Sales Overview");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(bold);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strcompanyname);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress1);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress2);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress3);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(pp);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(stremailid);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strwebsite);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strtaxone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText11.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText22.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText_from_day_visible.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText_to_day_visible.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(getString(R.string.Sales));
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+"No. of bills");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(insert1_rs+""+total);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+noofbills.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            final String Text = getlisting.getSelectedItem().toString();

            int i = 1;
            if (Text.equals("All")) {
                Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' OR paymentmethod = '  Mobikwik' OR paymentmethod = '  Freecharge' GROUP By billno ORDER BY datetimee DESC", null);
//                Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 GROUP By billno", null);
                if (cursor.moveToFirst()) {
                    do {
                        String bill_no = cursor.getString(4);
                        String billtypea = cursor.getString(8);
                        String paymmethoda = cursor.getString(9);
                        String date = cursor.getString(1);
                        String time = cursor.getString(2);
                        String am = cursor.getString(6);


                        TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                        ttv.setText(billtypea);

                        TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                        ttv1.setText(paymmethoda);




                        if (ttv.getText().toString().equals("  Cash")) {
                            billtypeaa = "Cash"; //0
                        }
                        if (ttv.getText().toString().equals("  Card")) {
                            billtypeaa = "Card"; //0
                        }
                        if (ttv.getText().toString().equals("  Paytm")) {
                            billtypeaa = "Paytm"; //0
                        }
                        if (ttv.getText().toString().equals("  Mobikwik")) {
                            billtypeaa = "Mobikwik"; //0
                        }
                        if (ttv.getText().toString().equals("  Freecharge")) {
                            billtypeaa = "Freecharge"; //0
                        }
                        if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                            billtypeaa = getString(R.string.pay_later_nospace); //0
                        }
                        if (ttv.getText().toString().equals("  Cheque")) {
                            billtypeaa = "Cheque"; //0
                        }
                        if (ttv.getText().toString().equals("  Sodexo")) {
                            billtypeaa = "Sodexo"; //0
                        }
                        if (ttv.getText().toString().equals("  Zeta")) {
                            billtypeaa = "Zeta"; //0
                        }
                        if (ttv.getText().toString().equals("  Ticket")) {
                            billtypeaa = "Ticket"; //0
                        }
                        if (ttv.getText().toString().equals(" Upiqr")) {
                            billtypeaa = "upiqr"; //0
                        }
                        if (ttv.getText().toString().equals("  Upiqr")) {
                            billtypeaa = "Upiqr"; //0
                        }
                        billtypeaa = ttv.getText().toString().replace(" ", "");


                        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                            //billtypee.setText("Dine-in");
                            if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                                paymmethodaa = "Dine-in";
                            }else {
                                paymmethodaa = getString(R.string.pref_header_general);
                            }
                        } else {
                            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                                paymmethodaa = "Takeaway";
                                //billtypee.setText("Takeaway");
                            } else {
                                paymmethodaa = "Home delivery";
                                //billtypee.setText("Home delivery");
                            }
                        }

                        allbuf2 = new byte[][]{
                                normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.toString().equals("ok")) {
                            mPrinter.addCommand(normal);
                            mPrinter.addCommand(un1);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append("Bill("+String.valueOf(i)+")");
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(LF); //LF
                        }


                        Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                        if (billtype.moveToFirst()) {
                            String bill_coun = billtype.getString(11);

                            if (statussusbs.equals("ok")) {
                                mPrinter.addCommand(normal);
                                mPrinter.addCommand(un1);
                                StringBuilder textData1 = new StringBuilder();
                                textData1.append("Bill id."+bill_coun);
                                mPrinter.addText(textData1.toString());
                                mPrinter.addCommand(LF); //LF
                            }
                        }


                        allbufbillno = new byte[][]{
                                setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                        };


                        if (statussusbs.toString().equals("ok")) {
                            mPrinter.addCommand(setHT321);
                            mPrinter.addCommand(un1);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append("Bill no."+bill_no);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(HT);
                            StringBuilder textData2 = new StringBuilder();
                            textData2.append("   "+billtypeaa);
                            mPrinter.addText(textData2.toString());
                            mPrinter.addCommand(LF); //LF
                        }

                        allbuf10 = new byte[][]{
                                setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                                //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.toString().equals("ok")) {
                            mPrinter.addCommand(setHT321);
                            mPrinter.addCommand(left);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append(paymmethodaa);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(HT);
                            StringBuilder textData2 = new StringBuilder();
                            textData2.append("  "+date);
                            mPrinter.addText(textData2.toString());
                            mPrinter.addCommand(LF); //LF
                        }

                        allbuftime = new byte[][]{
                                setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                        };


                        if (statussusbs.toString().equals("ok")) {
                            mPrinter.addCommand(setHT321);
                            mPrinter.addCommand(left);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append(insert1_rs+""+am);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(HT);
                            StringBuilder textData2 = new StringBuilder();
                            textData2.append("  "+time);
                            mPrinter.addText(textData2.toString());
                            mPrinter.addCommand(LF); //LF
                        }

                        if (statussusbs.toString().equals("ok")) {
                            mPrinter.addCommand(left);
                            mPrinter.addCommand(un1);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append(str_line);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(LF); //LF
                        }

                        i++;

                    } while (cursor.moveToNext());
                }
            }


            Cursor acc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

            if(acc.moveToFirst()){
                acc.moveToFirst();
                do{
                    NAME = acc.getString(1);
                    if (NAME.equals("3 inch")) {
                        feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                    }
                    else {
                        feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                    }
                }while(acc.moveToNext());
            }

            byte[][] allbuf = new byte[][]{
                    feedcut2
            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(feedcut2);
            }
            if (str_print_ty.equals("POS")) {
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(feedcut2);
                }
            }

//            method = "addCut";
//            mPrinter.addCut(Printer.CUT_FEED);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here2", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, method, mContext);
            return false;
        }

        return true;
    }

    private boolean createCouponData_minireceipt_cash() {

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x25,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x06,0x20,0x29,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    charlength = 23;
                    charlength1 = 46;
                    charlength2 = 69;
                    quanlentha = 5;
                    str_line = "------------------------------------------------";
                    allbufline = new byte[][]{
                            left,un1, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
                    if (print_ty.moveToFirst()){
                        str_print_ty = print_ty.getString(1);
                    }
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 16;
                        charlength1 = 32;
                        charlength2 = 48;
                        quanlentha = 5;
                        str_line = "------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------".getBytes(), LF
                        };
                    }
                }
            }while(cc.moveToNext());
        }

//        Cursor getprint_type = db1.rawQuery("SELECT * FROM Printer_text_size", null);
//        if (getprint_type.moveToFirst()) {
//            String type = getprint_type.getString(1);
//
//            Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
//
//            if (cc.moveToFirst()) {
//                cc.moveToFirst();
//                do {
//                    NAME = cc.getString(1);
//                    if (NAME.equals("3 inch")) {
//                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
//                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
//                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
//                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
//                        setHT34 = new byte[]{0x1b, 0x44, 0x08, 0x20, 0x29, 0x00};//4 tabs 3"
//                        setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 3"
//                        feedcut2 = new byte[]{0x1b, 0x64, 0x05, 0x1d, 0x56, 0x00};
//                        nPaperWidth = 576;
//                        charlength = 41;
//                        str_line = "------------------------------------------------";
//                        allbufline = new byte[][]{
//                                left, un1, "------------------------------------------------".getBytes(), LF
//
//                        };
//                    } else {
//
//                        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
//                        if (print_ty.moveToFirst()){
//                            str_print_ty = print_ty.getString(1);
//                        }
//                        if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x04, 0x12, 0x19, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 25;
//                            str_line = "--------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "--------------------------------".getBytes(), LF
//                            };
//                        }else {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 28;
//                            str_line = "------------------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "------------------------------------------".getBytes(), LF
//                            };
//                        }
//                    }
//                } while (cc.moveToNext());
//            }
//
//        }

//        final int barcodeWidth = 2;
//        final int barcodeHeight = 64;
        final int pageAreaHeight = 384;
        final int pageAreaWidth = 384;
//        final int fontAHeight = 24;
//        final int fontAWidth = 12;
//        final int barcodeWidthPos = 110;
//        final int barcodeHeightPos = 70;

        ArrayList<byte[]> list = new ArrayList<byte[]>();
        String method = "";
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
            yourBitmap = BitmapFactory.decodeByteArray(img, 0, img.length);
        }

//        String method = "";
//        Bitmap coffeeData = BitmapFactory.decodeResource(getResources(), R.drawable.coffee);
//        Bitmap wmarkData = BitmapFactory.decodeResource(getResources(), R.drawable.wmark);

        if (mPrinter == null) {
            return false;
        }
        try{
//            method = "addPageBegin";
//            mPrinter.addPageBegin();

            method = "addPageArea";
            mPrinter.addPageArea(0, 0, nPaperWidth, pageAreaHeight);

            method = "addPageDirection";
            mPrinter.addPageDirection(Printer.DIRECTION_TOP_TO_BOTTOM);

            method = "addFeedLine";
            mPrinter.addFeedLine(1);
            method = "addPagePosition";
            mPrinter.addPagePosition(0, nPaperWidth);

//            // RECEIPT BODY//

            mPrinter.addCommand(LF);

//            method = "addPagePosition";
//            mPrinter.addPagePosition(0, wmarkData.getHeight());
//            mPrinter.addPagePosition(0, logoData.getScaledHeight(0));

//            method = "addImage";
//            mPrinter.addImage(wmarkData, 0, 0, wmarkData.getWidth(), wmarkData.getHeight(),
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
//Free coffee text

//            method = "addTextSize";
//            mPrinter.addTextSize(3, 3);
//            method = "addTextStyle";
//            mPrinter.addTextStyle(Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.TRUE, Printer.PARAM_DEFAULT);
//            method = "addTextSmooth";
//            mPrinter.addTextSmooth(Printer.TRUE);
//            method = "addText";
//            mPrinter.addText("FREE Coffee\n");

            Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
            if (connnet.moveToFirst()) {
                ipnamegets = connnet.getString(1);
                portgets = connnet.getString(2);
                statusnets = connnet.getString(3);
            }

            Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
            if (connnet_counter.moveToFirst()) {
                ipnamegets_counter = connnet_counter.getString(1);
                portgets_counter = connnet_counter.getString(2);
                statusnets_counter = connnet_counter.getString(3);
            }
            connnet_counter.close();

            Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
            if (connusb.moveToFirst()) {
                addgets = connusb.getString(1);
                namegets = connusb.getString(2);
                statussusbs = connusb.getString(3);
            }

            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(bold);
                mPrinter.addCommand(un);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Sales Overview");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(bold);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strcompanyname);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress1);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress2);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress3);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(pp);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(stremailid);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strwebsite);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strtaxone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText11.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText22.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText_from_day_visible.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText_to_day_visible.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(getString(R.string.Sales));
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+"No. of bills");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(insert1_rs+""+total);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+noofbills.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            int i = 1;
            Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Upiqr' GROUP By billno", null);
            if (cursor.moveToFirst()) {
                do {
                    String bill_no = cursor.getString(4);
                    String billtypea = cursor.getString(8);
                    String paymmethoda = cursor.getString(9);
                    String date = cursor.getString(1);
                    String time = cursor.getString(2);
                    String am = cursor.getString(6);

                    TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv.setText(billtypea);

                    TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv1.setText(paymmethoda);



                    if (ttv.getText().toString().equals("  Cash")) {
                        billtypeaa = "Cash"; //0
                    }
                    if (ttv.getText().toString().equals("  Card")) {
                        billtypeaa = "Card"; //0
                    }
                    if (ttv.getText().toString().equals("  Paytm")) {
                        billtypeaa = "Paytm"; //0
                    }
                    if (ttv.getText().toString().equals("  Mobikwik")) {
                        billtypeaa = "Mobikwik"; //0
                    }
                    if (ttv.getText().toString().equals("  Freecharge")) {
                        billtypeaa = "Freecharge"; //0
                    }
                    if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                        billtypeaa = getString(R.string.pay_later_nospace); //0
                    }
                    if (ttv.getText().toString().equals("  Cheque")) {
                        billtypeaa = "Cheque"; //0
                    }
                    if (ttv.getText().toString().equals("  Sodexo")) {
                        billtypeaa = "Sodexo"; //0
                    }
                    if (ttv.getText().toString().equals("  Zeta")) {
                        billtypeaa = "Zeta"; //0
                    }
                    if (ttv.getText().toString().equals("  Ticket")) {
                        billtypeaa = "Ticket"; //0
                    }
                    if (ttv.getText().toString().equals(" Upiqr")) {
                        billtypeaa = "upiqr"; //0
                    }
                    if (ttv.getText().toString().equals("  Upiqr")) {
                        billtypeaa = "Upiqr"; //0
                    }
                    billtypeaa = ttv.getText().toString().replace(" ", "");


                    if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                        //billtypee.setText("Dine-in");
                        if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                            paymmethodaa = "Dine-in";
                        }else {
                            paymmethodaa = getString(R.string.pref_header_general);
                        }
                    } else {
                        if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                            paymmethodaa = "Takeaway";
                            //billtypee.setText("Takeaway");
                        } else {
                            paymmethodaa = "Home delivery";
                            //billtypee.setText("Home delivery");
                        }
                    }

                    allbuf2 = new byte[][]{
                            normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(normal);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Bill("+String.valueOf(i)+")");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }


                    Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                    if (billtype.moveToFirst()) {
                        String bill_coun = billtype.getString(11);

                        if (statussusbs.equals("ok")) {
                            mPrinter.addCommand(normal);
                            mPrinter.addCommand(un1);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append("Bill id."+bill_coun);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(LF); //LF
                        }
                    }


                    allbufbillno = new byte[][]{
                            setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };


                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Bill no."+bill_no);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("   "+billtypeaa);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    allbuf10 = new byte[][]{
                            setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                            //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(paymmethodaa);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("  "+date);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    allbuftime = new byte[][]{
                            setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                    };


                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(insert1_rs+""+am);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("  "+time);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(str_line);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                    i++;

                } while (cursor.moveToNext());
            }


            Cursor acc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

            if(acc.moveToFirst()){
                acc.moveToFirst();
                do{
                    NAME = acc.getString(1);
                    if (NAME.equals("3 inch")) {
                        feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                    }
                    else {
                        feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                    }
                }while(acc.moveToNext());
            }

            byte[][] allbuf = new byte[][]{
                    feedcut2
            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(feedcut2);
            }
            if (str_print_ty.equals("POS")) {
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(feedcut2);
                }
            }


//            method = "addCut";
//            mPrinter.addCut(Printer.CUT_FEED);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here2", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, method, mContext);
            return false;
        }

        return true;
    }

    private boolean createCouponData_minireceipt_card() {

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x25,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x06,0x20,0x29,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    charlength = 23;
                    charlength1 = 46;
                    charlength2 = 69;
                    quanlentha = 5;
                    str_line = "------------------------------------------------";
                    allbufline = new byte[][]{
                            left,un1, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
                    if (print_ty.moveToFirst()){
                        str_print_ty = print_ty.getString(1);
                    }
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 16;
                        charlength1 = 32;
                        charlength2 = 48;
                        quanlentha = 5;
                        str_line = "------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------".getBytes(), LF
                        };
                    }
                }
            }while(cc.moveToNext());
        }

//        Cursor getprint_type = db1.rawQuery("SELECT * FROM Printer_text_size", null);
//        if (getprint_type.moveToFirst()) {
//            String type = getprint_type.getString(1);
//
//            Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
//
//            if (cc.moveToFirst()) {
//                cc.moveToFirst();
//                do {
//                    NAME = cc.getString(1);
//                    if (NAME.equals("3 inch")) {
//                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
//                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
//                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
//                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
//                        setHT34 = new byte[]{0x1b, 0x44, 0x08, 0x20, 0x29, 0x00};//4 tabs 3"
//                        setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 3"
//                        feedcut2 = new byte[]{0x1b, 0x64, 0x05, 0x1d, 0x56, 0x00};
//                        nPaperWidth = 576;
//                        charlength = 41;
//                        str_line = "------------------------------------------------";
//                        allbufline = new byte[][]{
//                                left, un1, "------------------------------------------------".getBytes(), LF
//
//                        };
//                    } else {
//
//                        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
//                        if (print_ty.moveToFirst()){
//                            str_print_ty = print_ty.getString(1);
//                        }
//                        if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x04, 0x12, 0x19, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 25;
//                            str_line = "--------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "--------------------------------".getBytes(), LF
//                            };
//                        }else {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 28;
//                            str_line = "------------------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "------------------------------------------".getBytes(), LF
//                            };
//                        }
//                    }
//                } while (cc.moveToNext());
//            }
//
//        }

//        final int barcodeWidth = 2;
//        final int barcodeHeight = 64;
        final int pageAreaHeight = 384;
        final int pageAreaWidth = 384;
//        final int fontAHeight = 24;
//        final int fontAWidth = 12;
//        final int barcodeWidthPos = 110;
//        final int barcodeHeightPos = 70;

        ArrayList<byte[]> list = new ArrayList<byte[]>();
        String method = "";
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
            yourBitmap = BitmapFactory.decodeByteArray(img, 0, img.length);
        }

//        String method = "";
//        Bitmap coffeeData = BitmapFactory.decodeResource(getResources(), R.drawable.coffee);
//        Bitmap wmarkData = BitmapFactory.decodeResource(getResources(), R.drawable.wmark);

        if (mPrinter == null) {
            return false;
        }
        try{
//            method = "addPageBegin";
//            mPrinter.addPageBegin();

            method = "addPageArea";
            mPrinter.addPageArea(0, 0, nPaperWidth, pageAreaHeight);

            method = "addPageDirection";
            mPrinter.addPageDirection(Printer.DIRECTION_TOP_TO_BOTTOM);

            method = "addFeedLine";
            mPrinter.addFeedLine(1);
            method = "addPagePosition";
            mPrinter.addPagePosition(0, nPaperWidth);

//            // RECEIPT BODY//

            mPrinter.addCommand(LF);

//            method = "addPagePosition";
//            mPrinter.addPagePosition(0, wmarkData.getHeight());
//            mPrinter.addPagePosition(0, logoData.getScaledHeight(0));

//            method = "addImage";
//            mPrinter.addImage(wmarkData, 0, 0, wmarkData.getWidth(), wmarkData.getHeight(),
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
//Free coffee text

//            method = "addTextSize";
//            mPrinter.addTextSize(3, 3);
//            method = "addTextStyle";
//            mPrinter.addTextStyle(Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.TRUE, Printer.PARAM_DEFAULT);
//            method = "addTextSmooth";
//            mPrinter.addTextSmooth(Printer.TRUE);
//            method = "addText";
//            mPrinter.addText("FREE Coffee\n");

            Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
            if (connnet.moveToFirst()) {
                ipnamegets = connnet.getString(1);
                portgets = connnet.getString(2);
                statusnets = connnet.getString(3);
            }

            Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
            if (connnet_counter.moveToFirst()) {
                ipnamegets_counter = connnet_counter.getString(1);
                portgets_counter = connnet_counter.getString(2);
                statusnets_counter = connnet_counter.getString(3);
            }
            connnet_counter.close();

            Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
            if (connusb.moveToFirst()) {
                addgets = connusb.getString(1);
                namegets = connusb.getString(2);
                statussusbs = connusb.getString(3);
            }

            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(bold);
                mPrinter.addCommand(un);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Sales Overview");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(bold);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strcompanyname);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress1);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress2);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress3);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(pp);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(stremailid);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strwebsite);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strtaxone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText11.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText22.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText_from_day_visible.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText_to_day_visible.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(getString(R.string.Sales));
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+"No. of bills");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(insert1_rs+""+total);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+noofbills.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            int i = 1;
            Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Mobikwik' GROUP By billno", null);
            if (cursor.moveToFirst()) {
                do {
                    String bill_no = cursor.getString(4);
                    String billtypea = cursor.getString(8);
                    String paymmethoda = cursor.getString(9);
                    String date = cursor.getString(1);
                    String time = cursor.getString(2);
                    String am = cursor.getString(6);

                    TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv.setText(billtypea);

                    TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv1.setText(paymmethoda);



                    if (ttv.getText().toString().equals("  Cash")) {
                        billtypeaa = "Cash"; //0
                    }
                    if (ttv.getText().toString().equals("  Card")) {
                        billtypeaa = "Card"; //0
                    }
                    if (ttv.getText().toString().equals("  Paytm")) {
                        billtypeaa = "Paytm"; //0
                    }
                    if (ttv.getText().toString().equals("  Mobikwik")) {
                        billtypeaa = "Mobikwik"; //0
                    }
                    if (ttv.getText().toString().equals("  Freecharge")) {
                        billtypeaa = "Freecharge"; //0
                    }
                    if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                        billtypeaa = getString(R.string.pay_later_nospace); //0
                    }
                    if (ttv.getText().toString().equals("  Cheque")) {
                        billtypeaa = "Cheque"; //0
                    }
                    if (ttv.getText().toString().equals("  Sodexo")) {
                        billtypeaa = "Sodexo"; //0
                    }
                    if (ttv.getText().toString().equals("  Zeta")) {
                        billtypeaa = "Zeta"; //0
                    }
                    if (ttv.getText().toString().equals("  Ticket")) {
                        billtypeaa = "Ticket"; //0
                    }
                    if (ttv.getText().toString().equals(" Upiqr")) {
                        billtypeaa = "upiqr"; //0
                    }
                    if (ttv.getText().toString().equals("  Upiqr")) {
                        billtypeaa = "Upiqr"; //0
                    }
                    billtypeaa = ttv.getText().toString().replace(" ", "");


                    if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                        //billtypee.setText("Dine-in");
                        if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                            paymmethodaa = "Dine-in";
                        }else {
                            paymmethodaa = getString(R.string.pref_header_general);
                        }
                    } else {
                        if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                            paymmethodaa = "Takeaway";
                            //billtypee.setText("Takeaway");
                        } else {
                            paymmethodaa = "Home delivery";
                            //billtypee.setText("Home delivery");
                        }
                    }

                    allbuf2 = new byte[][]{
                            normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(normal);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Bill("+String.valueOf(i)+")");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }


                    Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                    if (billtype.moveToFirst()) {
                        String bill_coun = billtype.getString(11);

                        if (statussusbs.equals("ok")) {
                            mPrinter.addCommand(normal);
                            mPrinter.addCommand(un1);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append("Bill id."+bill_coun);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(LF); //LF
                        }
                    }


                    allbufbillno = new byte[][]{
                            setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };


                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Bill no."+bill_no);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("   "+billtypeaa);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    allbuf10 = new byte[][]{
                            setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                            //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(paymmethodaa);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("  "+date);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    allbuftime = new byte[][]{
                            setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                    };


                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(insert1_rs+""+am);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("  "+time);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(str_line);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    i++;

                } while (cursor.moveToNext());
            }


            Cursor acc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

            if(acc.moveToFirst()){
                acc.moveToFirst();
                do{
                    NAME = acc.getString(1);
                    if (NAME.equals("3 inch")) {
                        feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                    }
                    else {
                        feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                    }
                }while(acc.moveToNext());
            }

            byte[][] allbuf = new byte[][]{
                    feedcut2
            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(feedcut2);
            }
            if (str_print_ty.equals("POS")) {
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(feedcut2);
                }
            }

//            method = "addCut";
//            mPrinter.addCut(Printer.CUT_FEED);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here2", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, method, mContext);
            return false;
        }

        return true;
    }

    private  boolean createCouponData_minireceipt_credit() {

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x25,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x06,0x20,0x29,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    charlength = 23;
                    charlength1 = 46;
                    charlength2 = 69;
                    quanlentha = 5;
                    str_line = "------------------------------------------------";
                    allbufline = new byte[][]{
                            left,un1, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
                    if (print_ty.moveToFirst()){
                        str_print_ty = print_ty.getString(1);
                    }
                    if (str_print_ty.toString().equals("Generic")) {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
//                        Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 16;
                        charlength1 = 32;
                        charlength2 = 48;
                        quanlentha = 5;
                        str_line = "------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------".getBytes(), LF
                        };
                    }
                }
            }while(cc.moveToNext());
        }

//        Cursor getprint_type = db1.rawQuery("SELECT * FROM Printer_text_size", null);
//        if (getprint_type.moveToFirst()) {
//            String type = getprint_type.getString(1);
//
//            Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
//
//            if (cc.moveToFirst()) {
//                cc.moveToFirst();
//                do {
//                    NAME = cc.getString(1);
//                    if (NAME.equals("3 inch")) {
//                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
//                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
//                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
//                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
//                        setHT34 = new byte[]{0x1b, 0x44, 0x08, 0x20, 0x29, 0x00};//4 tabs 3"
//                        setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 3"
//                        feedcut2 = new byte[]{0x1b, 0x64, 0x05, 0x1d, 0x56, 0x00};
//                        nPaperWidth = 576;
//                        charlength = 41;
//                        str_line = "------------------------------------------------";
//                        allbufline = new byte[][]{
//                                left, un1, "------------------------------------------------".getBytes(), LF
//
//                        };
//                    } else {
//
//                        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
//                        if (print_ty.moveToFirst()){
//                            str_print_ty = print_ty.getString(1);
//                        }
//                        if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "phi", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x04, 0x12, 0x19, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 25;
//                            str_line = "--------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "--------------------------------".getBytes(), LF
//                            };
//                        }else {
//                            Toast.makeText(Cash_Card_Credit_Sales2.this, "epson", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 28;
//                            str_line = "------------------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "------------------------------------------".getBytes(), LF
//                            };
//                        }
//                    }
//                } while (cc.moveToNext());
//            }
//
//        }

//        final int barcodeWidth = 2;
//        final int barcodeHeight = 64;
        final int pageAreaHeight = 384;
        final int pageAreaWidth = 384;
//        final int fontAHeight = 24;
//        final int fontAWidth = 12;
//        final int barcodeWidthPos = 110;
//        final int barcodeHeightPos = 70;

        ArrayList<byte[]> list = new ArrayList<byte[]>();
        String method = "";
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
            yourBitmap = BitmapFactory.decodeByteArray(img, 0, img.length);
        }

//        String method = "";
//        Bitmap coffeeData = BitmapFactory.decodeResource(getResources(), R.drawable.coffee);
//        Bitmap wmarkData = BitmapFactory.decodeResource(getResources(), R.drawable.wmark);

        if (mPrinter == null) {
            return false;
        }
        try{
//            method = "addPageBegin";
//            mPrinter.addPageBegin();

            method = "addPageArea";
            mPrinter.addPageArea(0, 0, nPaperWidth, pageAreaHeight);

            method = "addPageDirection";
            mPrinter.addPageDirection(Printer.DIRECTION_TOP_TO_BOTTOM);

            method = "addFeedLine";
            mPrinter.addFeedLine(1);
            method = "addPagePosition";
            mPrinter.addPagePosition(0, nPaperWidth);

//            // RECEIPT BODY//

            mPrinter.addCommand(LF);

//            method = "addPagePosition";
//            mPrinter.addPagePosition(0, wmarkData.getHeight());
//            mPrinter.addPagePosition(0, logoData.getScaledHeight(0));

//            method = "addImage";
//            mPrinter.addImage(wmarkData, 0, 0, wmarkData.getWidth(), wmarkData.getHeight(),
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
//Free coffee text

//            method = "addTextSize";
//            mPrinter.addTextSize(3, 3);
//            method = "addTextStyle";
//            mPrinter.addTextStyle(Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.TRUE, Printer.PARAM_DEFAULT);
//            method = "addTextSmooth";
//            mPrinter.addTextSmooth(Printer.TRUE);
//            method = "addText";
//            mPrinter.addText("FREE Coffee\n");

            Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
            if (connnet.moveToFirst()) {
                ipnamegets = connnet.getString(1);
                portgets = connnet.getString(2);
                statusnets = connnet.getString(3);
            }

            Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
            if (connnet_counter.moveToFirst()) {
                ipnamegets_counter = connnet_counter.getString(1);
                portgets_counter = connnet_counter.getString(2);
                statusnets_counter = connnet_counter.getString(3);
            }
            connnet_counter.close();

            Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
            if (connusb.moveToFirst()) {
                addgets = connusb.getString(1);
                namegets = connusb.getString(2);
                statussusbs = connusb.getString(3);
            }

            allbuf1 = new byte[][]{
                    bold, un, "Sales Overview".getBytes(), LF

            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(bold);
                mPrinter.addCommand(un);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Sales Overview");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(bold);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strcompanyname);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress1);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress2);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress3);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(pp);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(stremailid);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strwebsite);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strtaxone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuf10 = new byte[][]{
                    setHT321, left, editText11.getText().toString().getBytes(), HT, "  ".getBytes(), editText22.getText().toString().getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText11.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText22.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            allbuftax = new byte[][]{
                    setHT321, left, editText_from_day_visible.getText().toString().getBytes(), HT, "  ".getBytes(), editText_to_day_visible.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(editText_from_day_visible.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+editText_to_day_visible.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbuftax = new byte[][]{
                    setHT321, left, getString(R.string.Sales).getBytes(), HT, "| ".getBytes(), "No. of bills".getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(getString(R.string.Sales));
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+"No. of bills");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor cursor11 = db.rawQuery("SELECT SUM(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (cursor11.moveToFirst()) {
                level = cursor11.getInt(0);
                total = String.valueOf(level);
            }

            Cursor count = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (count.moveToFirst()) {
                level = count.getInt(0);
                total1 = String.valueOf(level);
            }

            String avgbill = String.valueOf(Integer.parseInt(total) / Integer.parseInt(total1));


            noofbills = new TextView(Cash_Card_Credit_Sales2.this);


            Cursor countc = db.rawQuery("SELECT COUNT(total) FROM Billnumber WHERE datetimee_new >= '" + editText1_filter.getText().toString() + "' AND datetimee_new <='" + editText2_filter.getText().toString() + "' ", null);
            if (countc.moveToFirst()) {
                level = countc.getInt(0);
                String total1 = String.valueOf(level);
                noofbills.setText(total1);
            }


            allbuftax = new byte[][]{
                    setHT321, left, "Rs.".getBytes(), total.toString().getBytes(), HT, "| ".getBytes(), noofbills.getText().toString().getBytes(), LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(insert1_rs+""+total);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("| "+noofbills.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            int i = 1;

            Cursor cursor = db.rawQuery("SELECT * FROM Generalorderlistascdesc1 WHERE paymentmethod = '  Freecharge' GROUP By billno", null);
            if (cursor.moveToFirst()) {
                do {
                    String bill_no = cursor.getString(4);
                    String billtypea = cursor.getString(8);
                    String paymmethoda = cursor.getString(9);
                    String date = cursor.getString(1);
                    String time = cursor.getString(2);
                    String am = cursor.getString(6);

                    TextView ttv = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv.setText(billtypea);

                    TextView ttv1 = new TextView(Cash_Card_Credit_Sales2.this);
                    ttv1.setText(paymmethoda);



                    if (ttv.getText().toString().equals("  Cash")) {
                        billtypeaa = "Cash"; //0
                    }
                    if (ttv.getText().toString().equals("  Card")) {
                        billtypeaa = "Card"; //0
                    }
                    if (ttv.getText().toString().equals("  Paytm")) {
                        billtypeaa = "Paytm"; //0
                    }
                    if (ttv.getText().toString().equals("  Mobikwik")) {
                        billtypeaa = "Mobikwik"; //0
                    }
                    if (ttv.getText().toString().equals("  Freecharge")) {
                        billtypeaa = "Freecharge"; //0
                    }
                    if (ttv.getText().toString().equals(getString(R.string.pay_later))) {
                        billtypeaa = getString(R.string.pay_later_nospace); //0
                    }
                    if (ttv.getText().toString().equals("  Cheque")) {
                        billtypeaa = "Cheque"; //0
                    }
                    if (ttv.getText().toString().equals("  Sodexo")) {
                        billtypeaa = "Sodexo"; //0
                    }
                    if (ttv.getText().toString().equals("  Zeta")) {
                        billtypeaa = "Zeta"; //0
                    }
                    if (ttv.getText().toString().equals("  Ticket")) {
                        billtypeaa = "Ticket"; //0
                    }
                    if (ttv.getText().toString().equals(" Upiqr")) {
                        billtypeaa = "upiqr"; //0
                    }
                    if (ttv.getText().toString().equals("  Upiqr")) {
                        billtypeaa = "Upiqr"; //0
                    }
                    billtypeaa = ttv.getText().toString().replace(" ", "");


                    if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals(getString(R.string.general)) || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
                        //billtypee.setText("Dine-in");
                        if (account_selection.toString().equals(getString(R.string.dine_nospace)) || account_selection.toString().equals(getString(R.string.qsr_nospace))) {
                            paymmethodaa = "Dine-in";
                        }else {
                            paymmethodaa = getString(R.string.pref_header_general);
                        }
                    } else {
                        if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                            paymmethodaa = "Takeaway";
                            //billtypee.setText("Takeaway");
                        } else {
                            paymmethodaa = "Home delivery";
                            //billtypee.setText("Home delivery");
                        }
                    }


                    allbuf2 = new byte[][]{
                            normal, un1, "Bill(".getBytes(), String.valueOf(i).getBytes(), ")".getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(normal);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Bill("+String.valueOf(i)+")");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }


                    Cursor billtype = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + bill_no + "' ", null);
                    if (billtype.moveToFirst()) {
                        String bill_coun = billtype.getString(11);

                        if (statussusbs.equals("ok")) {
                            mPrinter.addCommand(normal);
                            mPrinter.addCommand(un1);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append("Bill id."+bill_coun);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(LF); //LF
                        }
                    }


                    allbufbillno = new byte[][]{
                            setHT321, un1, "Bill no.".getBytes(), bill_no.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };


                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Bill no."+bill_no);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("   "+billtypeaa);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    allbuf10 = new byte[][]{
                            setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), date.getBytes(), LF
                            //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(paymmethodaa);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("  "+date);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    allbuftime = new byte[][]{
                            setHT321, left, "Rs.".getBytes(), am.getBytes(), HT, "  ".getBytes(), time.getBytes(), LF
                    };


                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT321);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(insert1_rs+""+am);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append("  "+time);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(str_line);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                    i++;
                } while (cursor.moveToNext());
            }


            Cursor acc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

            if(acc.moveToFirst()){
                acc.moveToFirst();
                do{
                    NAME = acc.getString(1);
                    if (NAME.equals("3 inch")) {
                        feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                    }
                    else {
                        feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                    }
                }while(acc.moveToNext());
            }

            byte[][] allbuf = new byte[][]{
                    feedcut2
            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(feedcut2);
            }
            if (str_print_ty.equals("POS")) {
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(feedcut2);
                }
            }


//            method = "addCut";
//            mPrinter.addCut(Printer.CUT_FEED);
        } catch (Exception e) {
//            Toast.makeText(Cash_Card_Credit_Sales2.this, "Here2", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, method, mContext);
            return false;
        }

        return true;
    }

    @Override
    public void onStart() {
        super.onStart();

        String printer_type="";
        Cursor aallrows = db1.rawQuery("SELECT * FROM Printer_type WHERE _id = '1'", null);
        if (aallrows.moveToFirst()) {
            do {
                printer_type = aallrows.getString(1);

            } while (aallrows.moveToNext());
        }
        aallrows.close();

        if(printer_type.equalsIgnoreCase("wiseposplus")){
            doBindMswipeWisepadDeviceService();
        }

    }

    @Override
    protected void onStop() {
        super.onStop();

        String printer_type="";
        Cursor aallrows = db1.rawQuery("SELECT * FROM Printer_type WHERE _id = '1'", null);
        if (aallrows.moveToFirst()) {
            do {
                printer_type = aallrows.getString(1);

            } while (aallrows.moveToNext());
        }
        aallrows.close();

        if(printer_type.equalsIgnoreCase("wiseposplus")){
            doUnbindMswipeWisepadDeviceService();
        }


    }

    void doBindMswipeWisepadDeviceService()
    {
        bindService(new Intent(this, MSWisepadDeviceController.class), mMSWisepadDeviceControllerService, Context.BIND_AUTO_CREATE);
    }


    public void doUnbindMswipeWisepadDeviceService()
    {

        if (ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,  "wisePadConnection ", true, true);

        unbindService(mMSWisepadDeviceControllerService);

    }

    private ServiceConnection mMSWisepadDeviceControllerService = new ServiceConnection()
    {
        public void onServiceConnected(ComponentName className, IBinder service)
        {
            try
            {
                MSWisepadDeviceController.LocalBinder localBinder = (MSWisepadDeviceController.LocalBinder) service;
                mMSWisepadDeviceController = localBinder.getService();

                if(mMSWisepadDeviceController != null) {

                    mMSWisepadDeviceController.initMswipeWisepadDeviceController(new Cash_Card_Credit_Sales2.MSWisepadDeviceObserver(),
                            true, false, false,
                            false, null);

                }
            }
            catch (Exception e) {

                if (ApplicationData.IS_DEBUGGING_ON)
                    Logs.v(ApplicationData.packName, "exception."+e.toString(), true, true);
            }
        }

        public void onServiceDisconnected(ComponentName className)
        {
            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName, "Wisepad servcie un-binded and wisepad is disconnected...", true, true);
            /**
             * This is called when the connection with the service has been
             * unexpectedly disconnected - process crashed.
             *
             */

            mMSWisepadDeviceController = null;

        }
    };


    class MSWisepadDeviceObserver implements MSWisepadDeviceControllerResponseListener
    {

        @Override
        public void onReturnWisepadConnection(WisePadConnection wisePadConntection, BluetoothDevice bluetoothDevice) {

            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName,  "wisePadConntection " + wisePadConntection, true, true);

            String msg = getString(R.string.unknown);

            if(wisePadConntection == WisePadConnection.WisePadConnection_CONNECTED)
            {
                msg = getString(R.string.device_connected);
            }
            else if(wisePadConntection == WisePadConnection.WisePadConnection_CONNECTING){

                msg = getString(R.string.device_connecting);
            }
            else if(wisePadConntection == WisePadConnection.WisePadConnection_NOT_CONNECTED){

                msg = getString(R.string.device_not_connected);
            }
            else if(wisePadConntection == WisePadConnection.WisePadConnection_DIS_CONNECTED){

                msg = getString(R.string.device_disconnected);
            }

            //mTXTStatus.setText(msg);

        }

        @Override
        public void onRequestWisePadCheckCardProcess(CheckCardProcess checkCardProcess, ArrayList<String> dataList) {

        }

        @Override
        public void onReturnWisePadOfflineCardTransactionResults(CheckCardProcessResults checkCardResults, Hashtable<String, Object> paramHashtable) {

        }

        @Override
        public void onError(Error error, String errorMsg) {

            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName,  "error " + error, true, true);

        }

        @Override
        public void onRequestDisplayWispadStatusInfo(DisplayText msg) {

        }

        @Override
        public void onReturnDeviceInfo(Hashtable<String, String> paramHashtable) {

        }

        @Override
        public void onReturnFunctionKeyResult(FunctionKeyResult keyType) {

        }

        @Override
        public void onReturnWispadNetwrokSettingInfo(WispadNetwrokSetting wispadNetwrokSetting, boolean status, Hashtable<String, Object> netwrokSettingInfo) {

        }

        @Override
        public void onReturnNfcDetectCardResult(NfcDetectCardResult nfcDetectCardResult, Hashtable<String, Object> hashtable) {

        }

        @Override
        public void onReturnNfcDataExchangeResult(boolean isSuccess, Hashtable<String, String> data) {

        }

        @Override
        public void onPrintResult(PrintResult printResult) {


            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName,  "printResult " + printResult, true, true);

            String msg = getString(R.string.unknown);

            if(printResult == PrintResult.PRINT_SUCCESS)
            {
                msg = getString(R.string.printer_command_success);

            }
            else if(printResult == PrintResult.PRINT_NO_PAPER_OR_COVER_OPENED)
            {
                msg = getString(R.string.no_paper);

            }
            else if(printResult == PrintResult.PRINT_WRONG_PRINTER_COMMAND)
            {
                msg = getString(R.string.printer_command_not_available);

            }
            else if(printResult == PrintResult.PRINT_OVERHEAT)
            {
                msg = getString(R.string.printer_overheat);

            }
            else if(printResult == PrintResult.PRINT_PRINTER_ERROR)
            {
                msg = getString(R.string.printer_command_not_available);

            }

            //mTXTStatus.setText(msg);


        }
    }
}
