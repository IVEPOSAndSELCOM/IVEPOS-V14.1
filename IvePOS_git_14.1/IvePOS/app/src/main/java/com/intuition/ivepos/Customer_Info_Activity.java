package com.intuition.ivepos;

import android.Manifest;
import android.app.AlarmManager;
import android.app.Dialog;
import android.app.PendingIntent;
import android.app.ProgressDialog;
import android.bluetooth.BluetoothDevice;
import android.content.ComponentName;
import android.content.ContentValues;
import android.content.Context;
import android.content.DialogInterface;
import android.content.Intent;
import android.content.ServiceConnection;
import android.content.SharedPreferences;
import android.content.pm.PackageManager;
import android.database.Cursor;
import android.database.SQLException;
import android.database.sqlite.SQLiteDatabase;
import android.graphics.Bitmap;
import android.graphics.BitmapFactory;
import android.graphics.Color;
import android.graphics.Typeface;
import android.graphics.drawable.BitmapDrawable;
import android.hardware.usb.UsbDevice;
import android.hardware.usb.UsbDeviceConnection;
import android.hardware.usb.UsbEndpoint;
import android.hardware.usb.UsbInterface;
import android.hardware.usb.UsbManager;
import android.net.ConnectivityManager;
import android.net.NetworkCapabilities;
import android.net.NetworkInfo;
import android.net.Uri;
import android.os.AsyncTask;
import android.os.Build;
import android.os.Bundle;
import android.os.Environment;
import android.os.IBinder;
import android.telephony.SmsManager;
import android.telephony.TelephonyManager;
import android.text.Editable;
import android.text.Html;
import android.text.TextWatcher;
import android.text.method.LinkMovementMethod;
import android.util.Log;
import android.util.TypedValue;
import android.view.Gravity;
import android.view.KeyEvent;
import android.view.View;
import android.view.WindowManager;
import android.view.inputmethod.EditorInfo;
import android.view.inputmethod.InputMethodManager;
import android.widget.AdapterView;
import android.widget.ArrayAdapter;
import android.widget.Button;
import android.widget.CheckBox;
import android.widget.CompoundButton;
import android.widget.EditText;
import android.widget.FilterQueryProvider;
import android.widget.ImageButton;
import android.widget.ImageView;
import android.widget.LinearLayout;
import android.widget.ListView;
import android.widget.RadioButton;
import android.widget.RadioGroup;
import android.widget.RelativeLayout;
import android.widget.SimpleCursorAdapter;
import android.widget.Spinner;
import android.widget.Switch;
import android.widget.TableLayout;
import android.widget.TableRow;
import android.widget.TextView;
import android.widget.Toast;

import com.amazonaws.auth.CognitoCachingCredentialsProvider;
import com.amazonaws.regions.Region;
import com.amazonaws.regions.Regions;
import com.amazonaws.services.s3.AmazonS3;
import com.amazonaws.services.s3.AmazonS3Client;
import com.amazonaws.services.sns.AmazonSNSClient;
import com.amazonaws.services.sns.model.MessageAttributeValue;
import com.amazonaws.services.sns.model.PublishRequest;
import com.amazonaws.services.sns.model.PublishResult;
import com.android.volley.DefaultRetryPolicy;
import com.android.volley.Request;
import com.android.volley.RequestQueue;
import com.android.volley.Response;
import com.android.volley.VolleyError;
import com.android.volley.toolbox.StringRequest;
import com.android.volley.toolbox.Volley;
import com.epson.epos2.Epos2Exception;
import com.epson.epos2.printer.Printer;
import com.epson.epos2.printer.PrinterStatusInfo;
import com.epson.epos2.printer.ReceiveListener;
import com.google.android.gms.common.ConnectionResult;
import com.google.android.gms.common.GoogleApiAvailability;
import com.google.android.material.textfield.TextInputLayout;
import com.google.api.client.extensions.android.http.AndroidHttp;
import com.google.api.client.googleapis.extensions.android.gms.auth.GoogleAccountCredential;
import com.google.api.client.googleapis.extensions.android.gms.auth.GooglePlayServicesAvailabilityIOException;
import com.google.api.client.googleapis.extensions.android.gms.auth.UserRecoverableAuthIOException;
import com.google.api.client.http.HttpTransport;
import com.google.api.client.json.JsonFactory;
import com.google.api.client.json.jackson2.JacksonFactory;
import com.google.api.client.repackaged.org.apache.commons.codec.binary.Base64;
import com.google.api.client.util.ExponentialBackOff;
import com.google.api.services.gmail.Gmail;
import com.google.api.services.gmail.GmailScopes;
import com.google.api.services.gmail.model.Label;
import com.google.api.services.gmail.model.ListLabelsResponse;
import com.intuition.ivepos.A4.A4_Printer_new;
import com.intuition.ivepos.csv.RequestSingleton;
import com.intuition.ivepos.mSwipe.ApplicationData;
import com.intuition.ivepos.mSwipe.Logs;
import com.intuition.ivepos.sync.StubProvider;
import com.intuition.ivepos.syncapp.StubProviderApp;
import com.intuition.ivepos.wisepos.ReceiptBitmap;
import com.mswipetech.wisepad.sdk.Print;
import com.mswipetech.wisepad.sdk.device.MSWisepadDeviceController;
import com.mswipetech.wisepad.sdk.device.MSWisepadDeviceControllerResponseListener;
import com.mswipetech.wisepad.sdk.device.WisePadConnection;
import com.socsi.smartposapi.printer.Align;
import com.socsi.smartposapi.printer.FontLattice;

import org.json.JSONException;
import org.json.JSONObject;

import java.io.ByteArrayOutputStream;
import java.io.File;
import java.io.IOException;
import java.text.SimpleDateFormat;
import java.util.ArrayList;
import java.util.Arrays;
import java.util.Calendar;
import java.util.Date;
import java.util.Formatter;
import java.util.HashMap;
import java.util.Hashtable;
import java.util.Iterator;
import java.util.List;
import java.util.Locale;
import java.util.Map;
import java.util.Properties;

import javax.activation.DataHandler;
import javax.activation.DataSource;
import javax.activation.FileDataSource;
import javax.mail.MessagingException;
import javax.mail.Multipart;
import javax.mail.Session;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeBodyPart;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeMultipart;

import androidx.annotation.Nullable;
import androidx.annotation.RequiresApi;
import androidx.appcompat.app.AlertDialog;
import androidx.appcompat.app.AppCompatActivity;
import androidx.core.app.ActivityCompat;
import androidx.core.content.ContextCompat;
import pub.devrel.easypermissions.AfterPermissionGranted;
import pub.devrel.easypermissions.EasyPermissions;

import static com.intuition.ivepos.BluetoothPrintDriver.BT_Write;
import static com.intuition.ivepos.SplashScreenActivity.getDefaultSharedPreferencesMultiProcess;

/**
 * Created by Rohithkumar on 12/16/2016.
 */

public class Customer_Info_Activity extends AppCompatActivity implements ReceiveListener {

    public static String[] storge_permissions = {
            Manifest.permission.WRITE_EXTERNAL_STORAGE,
            Manifest.permission.READ_EXTERNAL_STORAGE
    };

    @RequiresApi(api = Build.VERSION_CODES.TIRAMISU)
    public static String[] storge_permissions_33 = {
            Manifest.permission.READ_MEDIA_IMAGES,
            Manifest.permission.READ_MEDIA_AUDIO,
            Manifest.permission.READ_MEDIA_VIDEO
    };

    public static String[] permissions() {
        String[] p;
        if (Build.VERSION.SDK_INT >= Build.VERSION_CODES.TIRAMISU) {
            p = storge_permissions_33;
        } else {
            p = storge_permissions;
        }
        return p;
    }
    public SQLiteDatabase db = null;
    public SQLiteDatabase db1 = null;
    SQLiteDatabase db_inapp = null;
    String name, ph_no, sum, idv, idv_email, idv_address, idv_pincode, idv_email1, idv_address1, idv_pincode1, idv_dob, idv_user_id, date_first, date_first_hide, name_name;

    ListView listView;
    Customer_ListviewAdapter dataAdapterr;
    private int year, year1;
    private int month, month1;
    private int day, day1;

    String onee, two, three, four, five, six, seven, eight, nine, ten, eleven, twelve;
    String onee1, two1, three1, four1, five1, six1, seven1, eight1, nine1, ten1, eleven1, twelve1;
    String assa1, assa2, sub;

    TextView tv8, disc_tv;
    float ss;
    String ss1;

    String ipnameget, portget, statusnet, nameget, addget, statussusb;
    String ipnameget_counter, portget_counter, statusnet_counter;
    String ipnamegets, portgets, statusnets, addgets, namegets, statussusbs;
    String ipnamegets_counter, portgets_counter, statusnets_counter;
    String NAME;
    byte[] setHT32, setHT321, setHT33, setHT34, setHT3212, setHT32122, setHTKOT, feedcut2;
    int nPaperWidth;
    int charlength, charlength1, charlength2, quanlentha; TextView mTextView1, mTextView2;

    byte[][] allbuf, allbuf1, allbuf2, allbuf3, allbuf4, allbuf5, allbuf6, allbuf7, allbuf8, allbuf9, allbuf10, allbuf11, allbufqty, allbufitems, allbufmodifiers, allbufsubtot,
            allbuftax, allbufdisc, allbufrounded, allbuffulltot, allbuf12, allbuf13, allbuf14,allbufbillno,allbuftime,allbufline1,allbufline,allbufcust,allbufcustname,
            allbufcustadd,allbufcustph,allbufcustemail, allbuftaxestype2, allbuftaxestype1, allbuf1122, allbufKOT;
    String strcompanyname, straddress1, straddress2, straddress3, strphone, stremailid, strwebsite, strtaxone, strbillone;
    ImageView imageViewPicture;
    private View mView;
    TextView tvkot;

    String billtypea, paymmethoda, billtypeaa, paymmethodaa;
    String datee, timee, tableida, tableidaa;

    String billnum_click, bill_coun;

    String alltotal1, subro, total_disc_print_q, total, taxpe, dsirs;

    private RadioGroup radioGroupWebsitecashout;
    private RadioButton radioBtncash;

    float dsirsq1 = 0, dsirsq2 = 0, dsirsq3 = 0, dsirsq4 = 0, dsirsq5 = 0;
    float div2 = 0, div3 = 0;

    String ch_swit;

    String otp_ch;

    String bday, bir_d, bir_d_status;

    final static int RQS_1 = 1;

    String dis_val, dis_status, dis_ty;
    String d_d_status, d_d_amount, d_d_value, d_d_type;


    TextView pho_num, cust_name, date1_hide, date2_hide, date1, date2, total_sales, total_credit, cashout_product_total, cashout_money_total, disc_val_def, disc_per_def;
    TextView refunds_tot_val, charges_tot_val, deposits_tot_val, total_balance;



    EditText add_bank_no, add_bank_ifsc, add_bank_cust_name, add_bank_name;
    String add_bank_no_string, add_bank_ifsc_string, add_bank_cust_name_string, add_bank_name_string;


    ArrayList<Country_deposit> list = new ArrayList<Country_deposit>();
    ArrayAdapter<Country_deposit> adapter;

    ArrayAdapter<Country_tax> adapter_tax;
    ArrayList<Country_tax> list_tax;

    String ch_swit_tax;


    String response;
    GoogleAccountCredential mCredential;
    ProgressDialog mProgress;

    String time1;

    static final int REQUEST_ACCOUNT_PICKER = 1000;
    static final int REQUEST_AUTHORIZATION = 1001;
    static final int REQUEST_GOOGLE_PLAY_SERVICES = 1002;
    static final int REQUEST_PERMISSION_GET_ACCOUNTS = 1003;

    private static final String BUTTON_TEXT = "Call Gmail API";
    private static final String PREF_ACCOUNT_NAME = "accountName";
    private static final String[] SCOPES = { GmailScopes.GMAIL_SEND };

    String str_print_ty;

    private Context mContext = null;

    private Printer mPrinter = null;
    int barcodeWidth, barcodeHeight, pageAreaHeight, pageAreaWidth;

    private EditText mEditTarget = null;
    private Spinner mSpnSeries = null;
    private Spinner mSpnLang = null;
    Bitmap logoData, yourBitmap;

    private WifiPrintDriver wifiSocket = null;
    private WifiPrintDriver2 wifiSocket2 = null;

    String insert1_cc = "", insert1_rs = "", str_country;
    Uri contentUri,resultUri;

    CognitoCachingCredentialsProvider credentialsProvider1;
    AmazonS3 s3client,s3client1;

    String t_total_points;
    float v_tq;
    boolean reachable;

    String limit_value_get, present_limit_get;

    Dialog dialog_deposit;
    TextInputLayout pin_layout;
    EditText enter_pint;
    TextView ema_add, add_r, pinc_r;
    EditText deposit_value;
    EditText deposit_notes;
    String currentDateandTime2;
    Dialog dialog;

    String WebserviceUrl;

    int count = 0;
    String smschceccking;
    int countlimit;
    String account_selection;

    String u_name;

    public MSWisepadDeviceController mMSWisepadDeviceController = null;
    private ArrayList<byte[]> mPrintData;

    boolean mswipe_text = true;

    byte[] testBytes;
    byte[] command;
    private UsbManager mUsbManager;
    private UsbDevice mDevice;
    private UsbDeviceConnection mConnection;
    private UsbInterface mInterface;
    private UsbEndpoint mEndPoint;
    private static Boolean forceCLaim = true;
    HashMap<String, UsbDevice> mDeviceList;
    Iterator<UsbDevice> mDeviceIterator;

    Formatter fmt;

    @Override
    protected void onCreate(@Nullable Bundle savedInstanceState) {
        super.onCreate(savedInstanceState);
        setContentView(R.layout.dialog_customer_management);

        mContext = this;

        SharedPreferences sharedpreferences_select =  SplashScreenActivity_Selection.getDefaultSharedPreferencesMultiProcess(Customer_Info_Activity.this);
        account_selection= sharedpreferences_select.getString("account_selection", null);

        if (account_selection.toString().equals("Dine")) {
            WebserviceUrl = "https://theandroidpos.com/IVEPOS_NEW/";
        }else {
            if (account_selection.toString().equals("Qsr")) {
                WebserviceUrl = "https://theandroidpos.com/IVEPOS_NEW/";
            }else {
                WebserviceUrl = "https://theandroidpos.com/IVEPOSRETAIL_NEW/";
            }
        }

        mSpnSeries = (Spinner) findViewById(R.id.spnModel);
        ArrayAdapter<SpnModelsItem> seriesAdapter = new ArrayAdapter<SpnModelsItem>(Customer_Info_Activity.this, android.R.layout.simple_spinner_item);
        seriesAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        seriesAdapter.add(new SpnModelsItem(getString(R.string.printerseries_t82), Printer.TM_T82));
        mSpnSeries.setAdapter(seriesAdapter);
        mSpnSeries.setSelection(0);


        credentialsProvider1 = new CognitoCachingCredentialsProvider(
                getApplicationContext(),
                "us-east-1:0730d9ff-ed86-40f5-9c5a-6afa8ecf0dd7", // Identity pool ID
                Regions.US_EAST_1 // Region
        );
        setAmazonS3Client1(credentialsProvider1);

        mSpnLang = (Spinner) findViewById(R.id.spnLang);
        ArrayAdapter<SpnModelsItem> langAdapter = new ArrayAdapter<SpnModelsItem>(Customer_Info_Activity.this, android.R.layout.simple_spinner_item);
        langAdapter.setDropDownViewResource(android.R.layout.simple_spinner_dropdown_item);
        langAdapter.add(new SpnModelsItem(getString(R.string.lang_ank), Printer.MODEL_ANK));
        mSpnLang.setAdapter(langAdapter);
        mSpnLang.setSelection(0);

        tvkot = new TextView(Customer_Info_Activity.this);

//        try {
//            com.epson.epos2.Log.setLogSettings(mContext, com.epson.epos2.Log.PERIOD_TEMPORARY, com.epson.epos2.Log.OUTPUT_STORAGE, null, 0, 1, com.epson.epos2.Log.LOGLEVEL_LOW);
//        } catch (Exception e) {
////            Toast.makeText(Customer_Info_Activity.this, "Here8", Toast.LENGTH_SHORT).show();
//            ShowMsg.showException(e, "setLogSettings", mContext);
//        }
        mEditTarget = (EditText) findViewById(R.id.edtTarget);

        db = openOrCreateDatabase("mydb_Salesdata", Context.MODE_PRIVATE, null);
        db1 = openOrCreateDatabase("mydb_Appdata", Context.MODE_PRIVATE, null);
        db_inapp = openOrCreateDatabase("amazoninapp", Context.MODE_PRIVATE, null);

        Cursor cursor_country = db1.rawQuery("SELECT * FROM Country_Selection", null);
        if (cursor_country.moveToFirst()){
            str_country = cursor_country.getString(1);
        }
        cursor_country.close();

        TextView inn = (TextView) findViewById(R.id.inn);
        TextView inn1 = (TextView) findViewById(R.id.inn1);
        TextView inn2 = (TextView) findViewById(R.id.inn2);
        TextView inn3 = (TextView) findViewById(R.id.inn3);

        if (str_country.toString().equals("Rupee") || str_country.toString().equals("India")) {
            insert1_cc = "\u20B9";
            insert1_rs = "Rs.";
            inn.setText(insert1_cc);
            inn1.setText(insert1_cc);
            inn2.setText(insert1_cc);
            inn3.setText(insert1_cc);
        }else {
            if (str_country.toString().equals("Pound") || str_country.toString().equals("UK Pound")) {
                insert1_cc = "\u00a3";
                insert1_rs = "BP.";
                inn.setText(insert1_cc);
                inn1.setText(insert1_cc);
                inn2.setText(insert1_cc);
                inn3.setText(insert1_cc);
            }else {
                if (str_country.toString().equals("Euro") || str_country.toString().equals("UK Euro")) {
                    insert1_cc = "\u20ac";
                    insert1_rs = "EU.";
                    inn.setText(insert1_cc);
                    inn1.setText(insert1_cc);
                    inn2.setText(insert1_cc);
                    inn3.setText(insert1_cc);
                }else {
                    if (str_country.toString().equals("Dollar")) {
                        insert1_cc = "\u0024";
                        insert1_rs = "\u0024";
                        inn.setText(insert1_cc);
                        inn1.setText(insert1_cc);
                        inn2.setText(insert1_cc);
                        inn3.setText(insert1_cc);
                    }else {
                        if (str_country.toString().equals("Dinars")) {
                            insert1_cc = "D";
                            insert1_rs = "KD.";
                            inn.setText(insert1_cc);
                            inn1.setText(insert1_cc);
                            inn2.setText(insert1_cc);
                            inn3.setText(insert1_cc);
                        }else {
                            if (str_country.toString().equals("Shilling")) {
                                insert1_cc = "S";
                                insert1_rs = "S.";
                                inn.setText(insert1_cc);
                                inn1.setText(insert1_cc);
                                inn2.setText(insert1_cc);
                                inn3.setText(insert1_cc);
                            }else {
                                if (str_country.toString().equals("Ringitt")) {
                                    insert1_cc = "R";
                                    insert1_rs = "RM.";
                                    inn.setText(insert1_cc);
                                    inn1.setText(insert1_cc);
                                    inn2.setText(insert1_cc);
                                    inn3.setText(insert1_cc);
                                }else {
                                    if (str_country.toString().equals("Rial")) {
                                        insert1_cc = "R";
                                        insert1_rs = "OR.";
                                        inn.setText(insert1_cc);
                                        inn1.setText(insert1_cc);
                                        inn2.setText(insert1_cc);
                                        inn3.setText(insert1_cc);
                                    }else {
                                        if (str_country.toString().equals("Yen")) {
                                            insert1_cc = "\u00a5";
                                            insert1_rs = "\u00a5";
                                            inn.setText(insert1_cc);
                                            inn1.setText(insert1_cc);
                                            inn2.setText(insert1_cc);
                                            inn3.setText(insert1_cc);
                                        }else {
                                            if (str_country.toString().equals("Papua New Guinean")) {
                                                insert1_cc = "K";
                                                insert1_rs = "K.";
                                                inn.setText(insert1_cc);
                                                inn1.setText(insert1_cc);
                                                inn2.setText(insert1_cc);
                                                inn3.setText(insert1_cc);
                                            }else {
                                                if (str_country.toString().equals("UAE")) {
                                                    insert1_cc = "D";
                                                    insert1_rs = "DH.";
                                                    inn.setText(insert1_cc);
                                                    inn1.setText(insert1_cc);
                                                    inn2.setText(insert1_cc);
                                                    inn3.setText(insert1_cc);
                                                }else {
                                                    if (str_country.toString().equals("South African Rand")) {
                                                        insert1_cc = "R";
                                                        insert1_rs = "R.";
                                                        inn.setText(insert1_cc);
                                                        inn1.setText(insert1_cc);
                                                        inn2.setText(insert1_cc);
                                                        inn3.setText(insert1_cc);
                                                    }else {
                                                        if (str_country.toString().equals("Congolese Franc")) {
                                                            insert1_cc = "F";
                                                            insert1_rs = "FC.";
                                                            inn.setText(insert1_cc);
                                                            inn1.setText(insert1_cc);
                                                            inn2.setText(insert1_cc);
                                                            inn3.setText(insert1_cc);
                                                        }else {
                                                            if (str_country.toString().equals("Qatari Riyals")) {
                                                                insert1_cc = "QAR";
                                                                insert1_rs = "QAR.";
                                                                inn.setText(insert1_cc);
                                                                inn1.setText(insert1_cc);
                                                                inn2.setText(insert1_cc);
                                                                inn3.setText(insert1_cc);
                                                            }else {
                                                                if (str_country.toString().equals("Dirhams")) {
                                                                    insert1_cc = "AED";
                                                                    insert1_rs = "AED.";
                                                                    inn.setText(insert1_cc);
                                                                    inn1.setText(insert1_cc);
                                                                    inn2.setText(insert1_cc);
                                                                    inn3.setText(insert1_cc);
                                                                }else {
                                                                    if (str_country.toString().equals("Kuwait Dinar")) {
                                                                        insert1_cc = "KWD";
                                                                        insert1_rs = "KWD.";
                                                                        inn.setText(insert1_cc);
                                                                        inn1.setText(insert1_cc);
                                                                        inn2.setText(insert1_cc);
                                                                        inn3.setText(insert1_cc);
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            }
        }

        Cursor ccornn = db1.rawQuery("SELECT * FROM BTConn", null);
        if (ccornn.moveToFirst()) {
            nameget = ccornn.getString(1);
            addget = ccornn.getString(2);
            statussusb = ccornn.getString(3);
            mEditTarget.setText(addget);
        }
        ccornn.close();

        mCredential = GoogleAccountCredential.usingOAuth2(
                getApplicationContext(), Arrays.asList(SCOPES))
                .setBackOff(new ExponentialBackOff());

        mProgress = new ProgressDialog(Customer_Info_Activity.this);
        mProgress.setMessage(getString(R.string.setmessage16));

        db1.execSQL("UPDATE Taxes set checked = ''");

//        Cursor cursor1_1 = db1.rawQuery("SELECT * FROM Taxes", null);
//        if (cursor1_1.moveToFirst()){
//            do {
//                String id = cursor1_1.getString(0);
//                ContentValues contentValues = new ContentValues();
//                contentValues.put("checked", "");
//                String where1 = "_id = '"+id+"' ";
//
//                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
//                getContentResolver().update(contentUri, contentValues,where1,new String[]{});
//                resultUri = new Uri.Builder()
//                        .scheme("content")
//                        .authority(StubProviderApp.AUTHORITY)
//                        .path("Taxes")
//                        .appendQueryParameter("operation", "update")
//                        .appendQueryParameter("_id",id)
//                        .build();
//                getContentResolver().notifyChange(resultUri, null);
//
//
//
//             //   db1.update("Taxes", contentValues, where1, new String[]{});
//            }while (cursor1_1.moveToNext());
//        }
//        cursor1_1.close();

        db.execSQL("UPDATE Customerdetails SET total_amount = rupees WHERE refunds = '' OR refunds IS NULL");

//        Cursor ref = db.rawQuery("SELECT * FROM Customerdetails", null);
//        if (ref.moveToFirst()){
//            do {
//                String id = ref.getString(0);
//                String old_t = ref.getString(5);
//                String ref_t = ref.getString(18);
//
//                TextView tv = new TextView(Customer_Info_Activity.this);
//                tv.setText(old_t);
//
//                TextView tv1 = new TextView(Customer_Info_Activity.this);
//                tv1.setText(ref_t);
//
//                if (tv1.getText().toString().equals("")){
//                    ContentValues contentValues = new ContentValues();
//                    contentValues.put("total_amount", tv.getText().toString());
//                    String wherecu = "_id = '" + id + "'";
//                    db.update("Customerdetails", contentValues, wherecu, new String[]{});
//                }else {
//                    float ff = Float.parseFloat(tv.getText().toString()) - Float.parseFloat(tv1.getText().toString());
//
//                    ContentValues contentValues = new ContentValues();
//                    contentValues.put("total_amount", String.valueOf(ff));
//                    String wherecu = "_id = '" + id + "'";
//                    db.update("Customerdetails", contentValues, wherecu, new String[]{});
//                }
//            }while (ref.moveToNext());
//        }


        Cursor cursorff = db.rawQuery("SELECT * FROM Clicked_cust_name", null);
        if (cursorff.moveToFirst()){
            name = cursorff.getString(1);
        }
        cursorff.close();

//        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//        // the XML defined views which the data will be bound to
//        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};

        db.execSQL("UPDATE Customerdetails SET total_amount = '0' WHERE (total_amount = '' OR total_amount IS NULL) AND phoneno = '"+name+"'");
        db.execSQL("UPDATE Customerdetails SET deposit = '0' WHERE (deposit = '' OR deposit IS NULL) AND phoneno = '"+name+"'");
        db.execSQL("UPDATE Customerdetails SET cashout = '0' WHERE (cashout = '' OR cashout IS NULL) AND phoneno = '"+name+"'");
        db.execSQL("UPDATE Customerdetails SET credit = '0' WHERE (credit = '' OR credit IS NULL) AND phoneno = '"+name+"'");
        db.execSQL("UPDATE Customerdetails SET charges = '0' WHERE (charges = '' OR charges IS NULL) AND phoneno = '"+name+"'");
        db.execSQL("UPDATE Customerdetails SET refunds = '0' WHERE (refunds = '' OR refunds IS NULL) AND phoneno = '"+name+"'");

        SimpleDateFormat sdf2 = new SimpleDateFormat("yyyy MM dd");
        final String currentDateandTime1 = sdf2.format(new Date());

        SimpleDateFormat sdf3 = new SimpleDateFormat("dd MMM yyyy");
        final String currentDateandTime2 = sdf3.format(new Date());

        Cursor vb = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"' AND date1 IS NOT NULL", null);
        if (vb.moveToFirst()){
            name_name = vb.getString(1);
            date_first = vb.getString(7);
            date_first_hide = vb.getString(9);
        }
        vb.close();

        Cursor vb1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
        if (vb1.moveToFirst()){
            name_name = vb1.getString(1);
            ph_no = vb1.getString(2);
            idv = vb1.getString(0);
            idv_email = vb1.getString(3);
            idv_address = vb1.getString(4);
            idv_pincode = vb1.getString(79);
        }
        vb1.close();

        date1 = (TextView) findViewById(R.id.date1_visible);
        date1.setText(date_first);

        cust_name = (TextView) findViewById(R.id.cust_name);
        cust_name.setText(name_name);

        disc_val_def = (TextView) findViewById(R.id.disc_val_def);
        disc_per_def = (TextView) findViewById(R.id.disc_per_def);

        Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
        if (set21w.moveToFirst()){
            dis_val = set21w.getString(29);
            dis_status = set21w.getString(27);
            dis_ty = set21w.getString(30);

            TextView one = new TextView(Customer_Info_Activity.this);
            one.setText(dis_val);

            TextView two = new TextView(Customer_Info_Activity.this);
            two.setText(dis_ty);

            if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                disc_val_def.setText("0");
            }else {
                disc_val_def.setText(dis_val);
            }
            if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                disc_per_def.setText("%");
            }else {
                disc_per_def.setText(dis_ty);
            }

        }
        set21w.close();

//        final Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
//        if (c.moveToFirst()){
//            ph_no = c.getString(2);
//        }
//        c.close();
//
//        final Cursor c1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+ph_no+"'", null);
//        if (c1.moveToFirst()){
//            idv = c1.getString(0);
//            idv_email = c1.getString(3);
//            idv_address = c1.getString(4);
//        }
//        c1.close();

        pho_num = (TextView) findViewById(R.id.phoneno);
        pho_num.setText(ph_no);

        date2 = (TextView) findViewById(R.id.date2_visible);
        Cursor cd = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date1 IS NOT NULL", null);
        int coud = cd.getCount();
//        Toast.makeText(Customer_Info_Activity.this, " "+coud, Toast.LENGTH_SHORT).show();
//        Toast.makeText(Customer_Info_Activity.this, " "+coud, Toast.LENGTH_SHORT).show();
//        Toast.makeText(Customer_Info_Activity.this, " "+coud, Toast.LENGTH_SHORT).show();
//        Toast.makeText(Customer_Info_Activity.this, " "+coud, Toast.LENGTH_SHORT).show();
        if (coud>0){
            date2.setVisibility(View.VISIBLE);
            date2.setText(currentDateandTime2);
        }else {
            date2.setVisibility(View.GONE);
        }

        date1_hide = (TextView) findViewById(R.id.date1_hide);
        date1_hide.setText(date_first_hide);

        date2_hide = (TextView) findViewById(R.id.date2_hide);
        date2_hide.setText(currentDateandTime1);

        LinearLayout linearLayout = (LinearLayout) findViewById(R.id.back_activity);
        linearLayout.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Intent intent = new Intent(Customer_Info_Activity.this, MultiFragCustomerActivity.class);
                intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                startActivity(intent);

                Cursor cursorf = db.rawQuery("SELECT * FROM Clicked_cust_name", null);
                if (cursorf.moveToFirst()){
                    String idff = cursorf.getString(0);
                    ContentValues contentValues = new ContentValues();
                    contentValues.put("name", "");
                    String wherecu = "_id = '" + idff + "'";


                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Clicked_cust_name");
                    getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                    resultUri = new Uri.Builder()
                            .scheme("content")
                            .authority(StubProvider.AUTHORITY)
                            .path("Clicked_cust_name")
                            .appendQueryParameter("operation", "update")
                            .appendQueryParameter("_id",idff)
                            .build();
                    getContentResolver().notifyChange(resultUri, null);


            //        db.update("Clicked_cust_name", contentValues, wherecu, new String[]{});

                }
                cursorf.close();

            }
        });





        ema_add = new TextView(Customer_Info_Activity.this);
        ema_add.setText(idv_email);

        add_r = new TextView(Customer_Info_Activity.this);
        add_r.setText(idv_address);

        pinc_r = new TextView(Customer_Info_Activity.this);
        pinc_r.setText(idv_pincode);


//        Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
//        if (cursor1.moveToFirst()) {
//            String pin = cursor1.getString(15);
//            String dob = cursor1.getString(17);
//            String cre_def = cursor1.getString(21);
//            String pin_statu = cursor1.getString(25);
//            String dob_alarm = cursor1.getString(26);
//            String dis_sta = cursor1.getString(27);
//            String dis_amou = cursor1.getString(28);
//            String dis_val = cursor1.getString(29);
//            String dis_typ = cursor1.getString(30);
//            String usr_id = cursor1.getString(37);
//            Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
//            if (cursor11.moveToFirst()){
//                do {
//                    String id = cursor11.getString(0);
//                    ContentValues contentValues = new ContentValues();
//                    contentValues.put("authentication_pin", pin);
//                    contentValues.put("dob", dob);
//                    contentValues.put("user_id", usr_id);
//                    contentValues.put("credit_default", cre_def);
//                    contentValues.put("authentication_pin_status", pin_statu);
//                    contentValues.put("dob_alaram", dob_alarm);
//                    contentValues.put("default_discount_status", dis_sta);
//                    contentValues.put("default_discount_amount", dis_amou);
//                    contentValues.put("default_discount_value", dis_val);
//                    contentValues.put("default_discount_type", dis_typ);
//                    String where = "_id = '" + id + "'";
//
//                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
//                    getContentResolver().update(contentUri, contentValues,where,new String[]{});
//                    resultUri = new Uri.Builder()
//                            .scheme("content")
//                            .authority(StubProvider.AUTHORITY)
//                            .path("Customerdetails")
//                            .appendQueryParameter("operation", "update")
//                            .appendQueryParameter("_id",id)
//                            .build();
//                    getContentResolver().notifyChange(resultUri, null);
//
//
//              //      db.update("Customerdetails", contentValues, where, new String[]{});
//                }while (cursor11.moveToNext());
//            }
//            cursor11.close();
//
//        }
//        cursor1.close();

        final Cursor comm = db.rawQuery("SELECT * FROM Customerdetails WHERE commission_charges_status = 'on' AND phoneno = '"+pho_num.getText().toString()+"'", null);
        if (comm.moveToFirst()){
            do {
                String id = comm.getString(0);
                String tot_amou = comm.getString(19);
                String type = comm.getString(23);
                String value = comm.getString(22);
                TextView tv = new TextView(Customer_Info_Activity.this);
                tv.setText(value);

                if (type.toString().equals("%")){
                    float div = Float.parseFloat(tv.getText().toString());
                    float div1 = Float.parseFloat(tot_amou);
                    div3 = (div / 100) * div1;

                    if (div3 % 1 != 0) {
                        int roo = (int) div3;
                        float decpartt = div3 - roo;
                        if (decpartt > 0.5) {
                            float dee = 1 - decpartt;
                            float rundee = div3 + dee;
                            int rumdee = (int) rundee;

                            ContentValues contentValues = new ContentValues();
                            contentValues.put("charges", String.valueOf(rumdee));
                            String wherecu = "_id = '" + id + "'";



                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                            getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                            resultUri = new Uri.Builder()
                                    .scheme("content")
                                    .authority(StubProvider.AUTHORITY)
                                    .path("Customerdetails")
                                    .appendQueryParameter("operation", "update")
                                    .appendQueryParameter("_id",id)
                                    .build();
                            getContentResolver().notifyChange(resultUri, null);


                     //       db.update("Customerdetails", contentValues, wherecu, new String[]{});

//                                                    fulltotal.setText(String.valueOf(rumdee));
                        } else {
                            float rundee = div3 - decpartt;
                            int rumdee = (int) rundee;

                            ContentValues contentValues = new ContentValues();
                            contentValues.put("charges", String.valueOf(rumdee));
                            String wherecu = "_id = '" + id + "'";


                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                            getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                            resultUri = new Uri.Builder()
                                    .scheme("content")
                                    .authority(StubProvider.AUTHORITY)
                                    .path("Customerdetails")
                                    .appendQueryParameter("operation", "update")
                                    .appendQueryParameter("_id",id)
                                    .build();
                            getContentResolver().notifyChange(resultUri, null);


                    //        db.update("Customerdetails", contentValues, wherecu, new String[]{});
                        }
                    } else {
                        ContentValues contentValues = new ContentValues();
                        contentValues.put("charges", String.valueOf(div3));
                        String wherecu = "_id = '" + id + "'";


                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                        getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                        resultUri = new Uri.Builder()
                                .scheme("content")
                                .authority(StubProvider.AUTHORITY)
                                .path("Customerdetails")
                                .appendQueryParameter("operation", "update")
                                .appendQueryParameter("_id",id)
                                .build();
                        getContentResolver().notifyChange(resultUri, null);


                   //     db.update("Customerdetails", contentValues, wherecu, new String[]{});
                    }

                }else {
                    ContentValues contentValues = new ContentValues();
                    contentValues.put("charges", value);
                    String wherecu = "_id = '" + id + "'";


                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                    getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                    resultUri = new Uri.Builder()
                            .scheme("content")
                            .authority(StubProvider.AUTHORITY)
                            .path("Customerdetails")
                            .appendQueryParameter("operation", "update")
                            .appendQueryParameter("_id",id)
                            .build();
                    getContentResolver().notifyChange(resultUri, null);


               //     db.update("Customerdetails", contentValues, wherecu, new String[]{});
                }
            }while (comm.moveToNext());

        }
        comm.close();


        //        Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'  AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//        if (sales_t.moveToFirst()){
//            dsirsq1 = sales_t.getFloat(0);
//        }
//        sales_t.close();

        Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'  AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
        if (credit_t.moveToFirst()){
            dsirsq2 = credit_t.getFloat(0);
        }
        credit_t.close();

        Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'  AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
        if (deposi_t.moveToFirst()){
            dsirsq3 = deposi_t.getFloat(0);
        }
        deposi_t.close();

        Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
        if (cashout_t.moveToFirst()){
            dsirsq4 = cashout_t.getFloat(0);
        }
        cashout_t.close();

        Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
        if (write_off_t.moveToFirst()){
            dsirsq5 = write_off_t.getFloat(0);
        }
        write_off_t.close();

        final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

        total_balance = (TextView) findViewById(R.id.total_balance);
        total_balance.setText(String.format("%.1f", cal_sale));

        total_sales = (TextView) findViewById(R.id.sale_value);

        Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
        if (cursor_sales.moveToFirst()){
            float dsirsq = cursor_sales.getFloat(0);
            String rop = String.format("%.1f", dsirsq);
            total_sales.setText(rop);
        }
        cursor_sales.close();


        total_credit = (TextView) findViewById(R.id.credit_value);

//        Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
//        if (cursor_credit.moveToFirst()){
//            float dsirsq = cursor_credit.getFloat(0);
//            String rop = String.format("%.1f", dsirsq);
//
//        }
//        cursor_credit.close();

        total_credit.setText(String.valueOf(dsirsq2));

        LinearLayout cashout_product = (LinearLayout) findViewById(R.id.cashout_product);
        LinearLayout cashout_money = (LinearLayout) findViewById(R.id.cashout_money);

        cashout_product_total = (TextView) findViewById(R.id.item_value);
        Cursor cursor_product_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Product/Items' ", null);
        if (cursor_product_total.moveToFirst()){
            cashout_product.setVisibility(View.VISIBLE);
            float dsirsq = cursor_product_total.getFloat(0);
            String rop = String.format("%.1f", dsirsq);
            cashout_product_total.setText(rop);
        }else {
            cashout_product.setVisibility(View.GONE);
        }
        cursor_product_total.close();

        cashout_money_total = (TextView) findViewById(R.id.money_value);
        Cursor cursor_money_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Money' ", null);
        if (cursor_money_total.moveToFirst()){
            cashout_money.setVisibility(View.VISIBLE);
            float dsirsq = cursor_money_total.getFloat(0);
            String rop = String.format("%.1f", dsirsq);
            cashout_money_total.setText(rop);
        }else {
            cashout_money.setVisibility(View.GONE);
        }
        cursor_money_total.close();


        RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
        RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
        RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);

        refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
        charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
        deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);

        Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
        if (cursor_refunds_tot_val.moveToFirst()){
            refunds_tot.setVisibility(View.VISIBLE);
            float dsirsq = cursor_refunds_tot_val.getFloat(0);
            String rop = String.format("%.1f", dsirsq);
            refunds_tot_val.setText(rop);
        }else {
            refunds_tot.setVisibility(View.GONE);
        }
        cursor_refunds_tot_val.close();

        Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
        if (cursor_charges_tot_val.moveToFirst()){
            charges_tot.setVisibility(View.VISIBLE);
            float dsirsq = cursor_charges_tot_val.getFloat(0);
            String rop = String.format("%.1f", dsirsq);
            charges_tot_val.setText(rop);
        }else {
            charges_tot.setVisibility(View.GONE);
        }
        cursor_charges_tot_val.close();

        Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
        if (cursor_deposits_tot_val.moveToFirst()){
            deposits_tot.setVisibility(View.VISIBLE);
            float dsirsq = cursor_deposits_tot_val.getFloat(0);
            String rop = String.format("%.1f", dsirsq);
            deposits_tot_val.setText(rop);
        }else {
            deposits_tot.setVisibility(View.GONE);
        }
        cursor_deposits_tot_val.close();


        RelativeLayout cust_details_notedit = (RelativeLayout) findViewById(R.id.cust_details);
        cust_details_notedit.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                final Dialog dialog_cust_details = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                dialog_cust_details.setContentView(R.layout.cust_details_notedit);
                dialog_cust_details.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                dialog_cust_details.show();

                ImageButton cancel = (ImageButton) dialog_cust_details.findViewById(R.id.btncancel);
                cancel.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        dialog_cust_details.dismiss();
                    }
                });

//                ImageButton btnsave = (ImageButton) dialog_cust_details.findViewById(R.id.btnsave);
//                btnsave.setOnClickListener(new View.OnClickListener() {
//                    @Override
//                    public void onClick(View view) {
//                        dialog_cust_details.dismiss();
//                    }
//                });

                TextView nameedit = (TextView) dialog_cust_details.findViewById(R.id.nameedit);
                TextView phonenoedit = (TextView) dialog_cust_details.findViewById(R.id.phonenoedit);
                TextView emailidedit = (TextView) dialog_cust_details.findViewById(R.id.emailidedit);
                TextView addressedit = (TextView) dialog_cust_details.findViewById(R.id.addressedit);
                TextView pincodeedit = (TextView) dialog_cust_details.findViewById(R.id.pincodeedit);
                TextView dobedit = (TextView) dialog_cust_details.findViewById(R.id.dobedit);

                Cursor cursor = db.rawQuery("Select * from Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (cursor.moveToFirst()){
                    String name = cursor.getString(1);
                    String pho = cursor.getString(2);
                    String ema = cursor.getString(3);
                    String addr = cursor.getString(4);
                    String pinc = cursor.getString(79);
                    String dob = cursor.getString(17);

                    TextView tvm = new TextView(Customer_Info_Activity.this);
                    tvm.setText(name);
                    TextView tvm1 = new TextView(Customer_Info_Activity.this);
                    tvm1.setText(pho);
                    TextView tvm2 = new TextView(Customer_Info_Activity.this);
                    tvm2.setText(ema);
                    TextView tvm3 = new TextView(Customer_Info_Activity.this);
                    tvm3.setText(addr);
                    TextView tvm31 = new TextView(Customer_Info_Activity.this);
                    tvm31.setText(pinc);
                    TextView tvm4 = new TextView(Customer_Info_Activity.this);
                    tvm4.setText(dob);

                    nameedit.setText(tvm.getText().toString());
                    phonenoedit.setText(tvm1.getText().toString());
                    emailidedit.setText(tvm2.getText().toString());
                    addressedit.setText(tvm3.getText().toString());
                    pincodeedit.setText(tvm31.getText().toString());
                    dobedit.setText(tvm4.getText().toString());
                }
                cursor.close();

                final ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

                if (cm != null) {
                    if (Build.VERSION.SDK_INT < 23) {
                        try {
                            Process p1 = Runtime.getRuntime().exec("ping -c 1 www.google.com");
                            int returnVal = p1.waitFor();
                            reachable = (returnVal==0);
                            System.out.println(""+reachable);
                        } catch (Exception e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
//                            return result;
                    } else {
                        boolean isOnline = false;
                        try {
                            ConnectivityManager manager = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
                            NetworkCapabilities capabilities = manager.getNetworkCapabilities(manager.getActiveNetwork());  // need ACCESS_NETWORK_STATE permission
                            isOnline = capabilities != null && capabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_VALIDATED);
                        } catch (Exception e) {
                            e.printStackTrace();
                        }

                        if (isOnline){
                            System.out.println("internet");
                            reachable = true;
                            total_loya(pho_num.getText().toString(), dialog_cust_details);
                        }else {
                            System.out.println("no internet");
                            reachable = false;
                            Cursor cursor2 = db.rawQuery("SELECT * FROM customer_loyalty_points WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                            if (cursor2.moveToFirst()){
                                t_total_points = cursor2.getString(2);

                                Cursor cursor_loyalty_points = db1.rawQuery("SELECT * FROM loyalty_points", null);
                                if (cursor_loyalty_points.moveToFirst()){
                                    String t_point2 = cursor_loyalty_points.getString(3);
                                    String t_money2 = cursor_loyalty_points.getString(4);

                                    v_tq = Float.parseFloat(t_total_points) * Float.parseFloat(t_money2);

                                }
                                cursor_loyalty_points.close();

                            }

                            final TextView total_points = (TextView) dialog_cust_details.findViewById(R.id.total_points);
                            total_points.setText(t_total_points);

                            final TextView total_amount = (TextView) dialog_cust_details.findViewById(R.id.total_amount);
                            total_amount.setText(String.format("%.2f", v_tq));
                        }

//                    return isOnline;
                    }
                }

//                Cursor cursor2 = db.rawQuery("SELECT * FROM customer_loyalty_points WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
//                if (cursor2.moveToFirst()){
//                    t_total_points = cursor2.getString(2);
//
//                    Cursor cursor_loyalty_points = db1.rawQuery("SELECT * FROM loyalty_points", null);
//                    if (cursor_loyalty_points.moveToFirst()){
//                        String t_point2 = cursor_loyalty_points.getString(3);
//                        String t_money2 = cursor_loyalty_points.getString(4);
//
//                        v_tq = Float.parseFloat(t_total_points) * Float.parseFloat(t_money2);
//
//                    }
//                    cursor_loyalty_points.close();
//
//                }
//
//                final TextView total_points = (TextView) dialog_cust_details.findViewById(R.id.total_points);
//                total_points.setText(t_total_points);
//
//                final TextView total_amount = (TextView) dialog_cust_details.findViewById(R.id.total_amount);
//                total_amount.setText(String.format("%.2f", v_tq));

            }
        });

        LinearLayout linearLayout25 = (LinearLayout) findViewById(R.id.linearLayout25);
        linearLayout25.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                final Dialog dialog_cust_details = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                dialog_cust_details.setContentView(R.layout.cust_details_notedit);
                dialog_cust_details.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                dialog_cust_details.show();

                ImageButton cancel = (ImageButton) dialog_cust_details.findViewById(R.id.btncancel);
                cancel.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        dialog_cust_details.dismiss();
                    }
                });

//                ImageButton btnsave = (ImageButton) dialog_cust_details.findViewById(R.id.btnsave);
//                btnsave.setOnClickListener(new View.OnClickListener() {
//                    @Override
//                    public void onClick(View view) {
//                        dialog_cust_details.dismiss();
//                    }
//                });

                TextView nameedit = (TextView) dialog_cust_details.findViewById(R.id.nameedit);
                TextView phonenoedit = (TextView) dialog_cust_details.findViewById(R.id.phonenoedit);
                TextView emailidedit = (TextView) dialog_cust_details.findViewById(R.id.emailidedit);
                TextView addressedit = (TextView) dialog_cust_details.findViewById(R.id.addressedit);
                TextView pincodeedit = (TextView) dialog_cust_details.findViewById(R.id.pincodeedit);
                TextView dobedit = (TextView) dialog_cust_details.findViewById(R.id.dobedit);

                Cursor cursor = db.rawQuery("Select * from Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (cursor.moveToFirst()){
                    String name = cursor.getString(1);
                    String pho = cursor.getString(2);
                    String ema = cursor.getString(3);
                    String addr = cursor.getString(4);
                    String pinc = cursor.getString(79);
                    String dob = cursor.getString(17);

                    TextView tvm = new TextView(Customer_Info_Activity.this);
                    tvm.setText(name);
                    TextView tvm1 = new TextView(Customer_Info_Activity.this);
                    tvm1.setText(pho);
                    TextView tvm2 = new TextView(Customer_Info_Activity.this);
                    tvm2.setText(ema);
                    TextView tvm3 = new TextView(Customer_Info_Activity.this);
                    tvm3.setText(addr);
                    TextView tvm31 = new TextView(Customer_Info_Activity.this);
                    tvm31.setText(pinc);
                    TextView tvm4 = new TextView(Customer_Info_Activity.this);
                    tvm4.setText(dob);

                    nameedit.setText(tvm.getText().toString());
                    phonenoedit.setText(tvm1.getText().toString());
                    emailidedit.setText(tvm2.getText().toString());
                    addressedit.setText(tvm3.getText().toString());
                    pincodeedit.setText(tvm31.getText().toString());
                    dobedit.setText(tvm4.getText().toString());
                }
                cursor.close();

                final ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

                if (cm != null) {
                    if (Build.VERSION.SDK_INT < 23) {
                        try {
                            Process p1 = Runtime.getRuntime().exec("ping -c 1 www.google.com");
                            int returnVal = p1.waitFor();
                            reachable = (returnVal==0);
                            System.out.println(""+reachable);
                        } catch (Exception e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
//                            return result;
                    } else {
                        boolean isOnline = false;
                        try {
                            ConnectivityManager manager = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
                            NetworkCapabilities capabilities = manager.getNetworkCapabilities(manager.getActiveNetwork());  // need ACCESS_NETWORK_STATE permission
                            isOnline = capabilities != null && capabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_VALIDATED);
                        } catch (Exception e) {
                            e.printStackTrace();
                        }

                        if (isOnline){
                            System.out.println("internet");
                            reachable = true;
                            total_loya(pho_num.getText().toString(), dialog_cust_details);
                        }else {
                            System.out.println("no internet");
                            reachable = false;
                            Cursor cursor2 = db.rawQuery("SELECT * FROM customer_loyalty_points WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                            if (cursor2.moveToFirst()){
                                t_total_points = cursor2.getString(2);

                                Cursor cursor_loyalty_points = db1.rawQuery("SELECT * FROM loyalty_points", null);
                                if (cursor_loyalty_points.moveToFirst()){
                                    String t_point2 = cursor_loyalty_points.getString(3);
                                    String t_money2 = cursor_loyalty_points.getString(4);

                                    v_tq = Float.parseFloat(t_total_points) * Float.parseFloat(t_money2);

                                }
                                cursor_loyalty_points.close();

                            }

                            final TextView total_points = (TextView) dialog_cust_details.findViewById(R.id.total_points);
                            total_points.setText(t_total_points);

                            final TextView total_amount = (TextView) dialog_cust_details.findViewById(R.id.total_amount);
                            total_amount.setText(String.format("%.2f", v_tq));
                        }

//                    return isOnline;
                    }
                }

//                Cursor cursor2 = db.rawQuery("SELECT * FROM customer_loyalty_points WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
//                if (cursor2.moveToFirst()){
//                    t_total_points = cursor2.getString(2);
//
//                    Cursor cursor_loyalty_points = db1.rawQuery("SELECT * FROM loyalty_points", null);
//                    if (cursor_loyalty_points.moveToFirst()){
//                        String t_point2 = cursor_loyalty_points.getString(3);
//                        String t_money2 = cursor_loyalty_points.getString(4);
//
//                        v_tq = Float.parseFloat(t_total_points) * Float.parseFloat(t_money2);
//
//                    }
//                    cursor_loyalty_points.close();
//
//                }
//
//                final TextView total_points = (TextView) dialog_cust_details.findViewById(R.id.total_points);
//                total_points.setText(t_total_points);
//
//                final TextView total_amount = (TextView) dialog_cust_details.findViewById(R.id.total_amount);
//                total_amount.setText(String.format("%.2f", v_tq));

            }
        });

        LinearLayout cust_feedback = (LinearLayout) findViewById(R.id.edit_but1_feedback);
        cust_feedback.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Cursor fff = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '"+pho_num.getText().toString()+"' AND " +
                        "date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                if (fff.moveToFirst()) {
                    final Dialog dialog = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                    dialog.setContentView(R.layout.dialog_customer_management_feedback);
                    dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                    dialog.show();


                    ImageButton cancel = (ImageButton) dialog.findViewById(R.id.btncancel);
                    cancel.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            dialog.dismiss();
                        }
                    });

                    Cursor cursor = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '" + pho_num.getText().toString() + "' AND " +
                            "date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                    int cou = cursor.getCount();
                    TextView total_no_feedback = (TextView) dialog.findViewById(R.id.total_no_feedback);
                    total_no_feedback.setText(String.valueOf(cou));

                    Cursor cursor1 = db.rawQuery("SELECT SUM(percentage) FROM Cust_feedback WHERE cust_phoneno = '" + pho_num.getText().toString() + "' AND " +
                            "date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                    if (cursor1.moveToFirst()) {
                        do {
                            float aq = cursor1.getFloat(0);
                            sum = String.valueOf(aq);
                        }
                        while (cursor1.moveToNext());
                    }

                    float sum1 = Float.parseFloat(sum) / cou;

                    TextView percent = (TextView) dialog.findViewById(R.id.percent);
                    percent.setText(String.valueOf(sum1));

                    Cursor c1 = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '" + pho_num.getText().toString() + "' AND " +
                            "date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                    String[] fromFieldNames = {"date", "time", "percentage", "ambience_rating", "pro_qual_rating", "service_rating", "overall_exp_rating", "comments"};
                    // the XML defined views which the data will be bound to
                    int[] toViewsID = {R.id.date, R.id.time, R.id.percent, R.id.amb_rat, R.id.pro_qu_rat, R.id.ser_rat, R.id.exp_rat, R.id.oldname};
                    Log.e("Checamos que hay id", String.valueOf(R.id.name));
                    SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.cust_feedback_listview, c1, fromFieldNames, toViewsID, 0);
                    ListView listview = (ListView) dialog.findViewById(R.id.cust_feedback_list);
                    listview.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error



                }else {
                    Toast.makeText(Customer_Info_Activity.this, "no feedback to display", Toast.LENGTH_SHORT).show();
                }
                fff.close();
            }
        });

        LinearLayout cust_details = (LinearLayout) findViewById(R.id.edit_but_cust_details);
        cust_details.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                final Dialog dialog_cust = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                dialog_cust.setContentView(R.layout.dialog_customerlist_edit);
                dialog_cust.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                dialog_cust.show();

                final TextView ph_num = (TextView) dialog_cust.findViewById(R.id.phonenoedit);
                ph_num.setText(pho_num.getText().toString());

                final TextView rs = (TextView) dialog_cust.findViewById(R.id.rs);
                rs.setText(insert1_rs);

                final TextView cu_name = (TextView) dialog_cust.findViewById(R.id.nameedit);
                cu_name.setText(cust_name.getText().toString());

                Cursor ty = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+ph_no+"'", null);
                if (ty.moveToFirst()){
                    idv_email1 = ty.getString(3);
                    idv_address1 = ty.getString(4);
                    idv_pincode1 = ty.getString(79);
                    idv_dob = ty.getString(17);
                    idv_user_id = ty.getString(37);
                }
                ty.close();

                final TextView cu_email = (TextView) dialog_cust.findViewById(R.id.emailidedit);
                cu_email.setText(idv_email1);

                final TextView cu_add = (TextView) dialog_cust.findViewById(R.id.addressedit);
                cu_add.setText(idv_address1);

                final TextView cu_pinc = (TextView) dialog_cust.findViewById(R.id.pincodeedit);
                cu_pinc.setText(idv_pincode1);

                final TextView cu_dob = (TextView) dialog_cust.findViewById(R.id.dobedit);
                cu_dob.setText(idv_dob);

                final TextView cu_usr_id = (TextView) dialog_cust.findViewById(R.id.cust_id_edit);
                cu_usr_id.setText(idv_user_id);

                final ConnectivityManager cm = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);

                if (cm != null) {
                    if (Build.VERSION.SDK_INT < 23) {
                        try {
                            Process p1 = Runtime.getRuntime().exec("ping -c 1 www.google.com");
                            int returnVal = p1.waitFor();
                            reachable = (returnVal==0);
                            System.out.println(""+reachable);
                        } catch (Exception e) {
                            // TODO Auto-generated catch block
                            e.printStackTrace();
                        }
//                            return result;
                    } else {
                        boolean isOnline = false;
                        try {
                            ConnectivityManager manager = (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
                            NetworkCapabilities capabilities = manager.getNetworkCapabilities(manager.getActiveNetwork());  // need ACCESS_NETWORK_STATE permission
                            isOnline = capabilities != null && capabilities.hasCapability(NetworkCapabilities.NET_CAPABILITY_VALIDATED);
                        } catch (Exception e) {
                            e.printStackTrace();
                        }

                        if (isOnline){
                            System.out.println("internet");
                            reachable = true;
                            total_loya(ph_no, dialog_cust);
                        }else {
                            System.out.println("no internet");
                            reachable = false;
                            Cursor cursor2 = db.rawQuery("SELECT * FROM customer_loyalty_points WHERE phoneno = '"+ph_no+"'", null);
                            if (cursor2.moveToFirst()){
                                t_total_points = cursor2.getString(2);

                                Cursor cursor_loyalty_points = db1.rawQuery("SELECT * FROM loyalty_points", null);
                                if (cursor_loyalty_points.moveToFirst()){
                                    String t_point2 = cursor_loyalty_points.getString(3);
                                    String t_money2 = cursor_loyalty_points.getString(4);

                                    v_tq = Float.parseFloat(t_total_points) * Float.parseFloat(t_money2);

                                }
                                cursor_loyalty_points.close();

                            }

                            final TextView total_points = (TextView) dialog_cust.findViewById(R.id.total_points);
                            total_points.setText(t_total_points);

                            final TextView total_amount = (TextView) dialog_cust.findViewById(R.id.total_amount);
                            total_amount.setText(String.format("%.2f", v_tq));
                        }

//                    return isOnline;
                    }
                }

//                Cursor cursor2 = db.rawQuery("SELECT * FROM customer_loyalty_points WHERE phoneno = '"+ph_no+"'", null);
//                if (cursor2.moveToFirst()){
//                    t_total_points = cursor2.getString(2);
//
//                    Cursor cursor_loyalty_points = db1.rawQuery("SELECT * FROM loyalty_points", null);
//                    if (cursor_loyalty_points.moveToFirst()){
//                        String t_point2 = cursor_loyalty_points.getString(3);
//                        String t_money2 = cursor_loyalty_points.getString(4);
//
//                        v_tq = Float.parseFloat(t_total_points) * Float.parseFloat(t_money2);
//
//                    }
//                    cursor_loyalty_points.close();
//
//                }
//
//                final TextView total_points = (TextView) dialog_cust.findViewById(R.id.total_points);
//                total_points.setText(t_total_points);
//
//                final TextView total_amount = (TextView) dialog_cust.findViewById(R.id.total_amount);
//                total_amount.setText(String.format("%.2f", v_tq));

                cu_dob.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        Calendar now = Calendar.getInstance();
                        com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
                                datePickerListener,now.get(Calendar.YEAR), now.get(Calendar.MONTH), now.get(Calendar.DAY_OF_MONTH)
                        );

                        dpd.show(Customer_Info_Activity.this.getFragmentManager(), "Datepickerdialog");
                    }

                    com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener datePickerListener
                            = new com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener() {

                        @Override
                        public void onDateSet(com.wdullaer.materialdatetimepicker.date.DatePickerDialog datePickerDialog, int selectedYear1, int selectedMonth1, int selectedDay1) {
                            year1 = selectedYear1;
                            month1 = selectedMonth1;
                            day1 = selectedDay1;

                            // set selected date into textview
                            populateSetDate(year1, month1 + 1, day1);
                        }
                    };

                    public void populateSetDate(int year, int month, int day) {
                        TextView mEdit1 = (TextView) dialog_cust.findViewById(R.id.dobedit);
//                        TextView mEdit  = (TextView)dialog_date.findViewById(R.id.from_date_hide);

//                        Toast.makeText(Customer_Info_Activity.this, "from "+mEdit.getText().toString(), Toast.LENGTH_SHORT).show();

                        if (month == 1 && day < 10) {
                            onee1 = "0" + day + " " + "Jan" + " " + year;
                            mEdit1.setText(onee1);
                        } else {
                            if (month == 1) {
                                onee = day + " " + "Jan" + " " + year;
                                mEdit1.setText(onee);
                            }
                        }

                        if (month == 2 && day < 10) {
                            two1 = "0" + day + " " + "Feb" + " " + year;
                            mEdit1.setText(two1);
                        } else {
                            if (month == 2) {
                                two = day + " " + "Feb" + " " + year;
                                mEdit1.setText(two);
                            }
                        }

                        if (month == 3 && day < 10) {
                            three1 = "0" + day + " " + "Mar" + " " + year;
                            mEdit1.setText(three1);
                        } else {
                            if (month == 3) {
                                three = day + " " + "Mar" + " " + year;
                                mEdit1.setText(three);
                            }
                        }

                        if (month == 4 && day < 10) {
                            four1 = "0" + day + " " + "Apr" + " " + year;
                            mEdit1.setText(four1);
                        } else {
                            if (month == 4) {
                                four = day + " " + "Apr" + " " + year;
                                mEdit1.setText(four);
                            }
                        }

                        if (month == 5 && day < 10) {
                            five1 = "0" + day + " " + "May" + " " + year;
                            mEdit1.setText(five1);
                        } else {
                            if (month == 5) {
                                five = day + " " + "May" + " " + year;
                                mEdit1.setText(five);
                            }
                        }

                        if (month == 6 && day < 10) {
                            six1 = "0" + day + " " + "Jun" + " " + year;
                            mEdit1.setText(six1);
                        } else {
                            if (month == 6) {
                                six = day + " " + "Jun" + " " + year;
                                mEdit1.setText(six);
                            }
                        }

                        if (month == 7 && day < 10) {
                            seven1 = "0" + day + " " + "Jul" + " " + year;
                            mEdit1.setText(seven1);
                        } else {
                            if (month == 7) {
                                seven = day + " " + "Jul" + " " + year;
                                mEdit1.setText(seven);
                            }
                        }

                        if (month == 8 && day < 10) {
                            eight1 = "0" + day + " " + "Aug" + " " + year;
                            mEdit1.setText(eight1);
                        } else {
                            if (month == 8) {
                                eight = day + " " + "Aug" + " " + year;
                                mEdit1.setText(eight);
                            }
                        }

                        if (month == 9 && day < 10) {
                            nine1 = "0" + day + " " + "Sep" + " " + year;
                            mEdit1.setText(nine1);
                        } else {
                            if (month == 9) {
                                nine = day + " " + "Sep" + " " + year;
                                mEdit1.setText(nine);
                            }
                        }

                        if (month == 10 && day < 10) {
                            ten1 = "0" + day + " " + "Oct" + " " + year;
                            mEdit1.setText(ten1);
                        } else {
                            if (month == 10) {
                                ten = day + " " + "Oct" + " " + year;
                                mEdit1.setText(ten);
                            }
                        }

                        if (month == 11 && day < 10) {
                            eleven1 = "0" + day + " " + "Nov" + " " + year;
                            mEdit1.setText(eleven1);
                        } else {
                            if (month == 11) {
                                eleven = day + " " + "Nov" + " " + year;
                                mEdit1.setText(eleven);
                            }
                        }

                        if (month == 12 && day < 10) {
                            twelve1 = "0" + day + " " + "Dec" + " " + year;
                            mEdit1.setText(twelve1);
                        } else {
                            if (month == 12) {
                                twelve = day + " " + "Dec" + " " + year;
                                mEdit1.setText(twelve);
                            }
                        }

                    }

                });


                ImageButton bank = (ImageButton) dialog_cust.findViewById(R.id.delete_edit);
                bank.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        final Dialog dialog_cust_bank = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                        dialog_cust_bank.setContentView(R.layout.dialog_customerlist_new_bank);
                        dialog_cust_bank.show();

                        ImageButton btn_close1 = (ImageButton) dialog_cust_bank.findViewById(R.id.canceledit);
                        btn_close1.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View v) {
                                dialog_cust_bank.dismiss();
                                add_bank_no_string = "";
                                add_bank_ifsc_string = "";
                                add_bank_cust_name_string = "";
                                add_bank_name_string = "";
                            }
                        });

                        add_bank_no = (EditText) dialog_cust_bank.findViewById(R.id.accountnoedit);
                        add_bank_ifsc = (EditText) dialog_cust_bank.findViewById(R.id.ifscedit);
                        add_bank_cust_name = (EditText) dialog_cust_bank.findViewById(R.id.accnameedit);
                        add_bank_name = (EditText) dialog_cust_bank.findViewById(R.id.banknameedit);


                        Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+ph_no+"'", null);
                        if (c.moveToFirst()){
                            add_bank_no_string = c.getString(32);
                            add_bank_ifsc_string = c.getString(33);
                            add_bank_cust_name_string = c.getString(34);
                            add_bank_name_string = c.getString(35);
                        }
                        c.close();

                        add_bank_no.setText(add_bank_no_string);
                        add_bank_ifsc.setText(add_bank_ifsc_string);
                        add_bank_cust_name.setText(add_bank_cust_name_string);
                        add_bank_name.setText(add_bank_name_string);

                        final TextInputLayout n = (TextInputLayout) dialog_cust_bank.findViewById(R.id.n);
                        final TextInputLayout i = (TextInputLayout) dialog_cust_bank.findViewById(R.id.i);


                        add_bank_no.addTextChangedListener(new TextWatcher() {
                            @Override
                            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                            }
                            @Override
                            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                n.setError(null);
                            }
                            @Override
                            public void afterTextChanged(Editable editable) {

                            }
                        });

                        add_bank_ifsc.addTextChangedListener(new TextWatcher() {
                            @Override
                            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                            }
                            @Override
                            public void onTextChanged(CharSequence charSequence, int ii, int i1, int i2) {
                                i.setError(null);
                            }
                            @Override
                            public void afterTextChanged(Editable editable) {

                            }
                        });

                        ImageButton save = (ImageButton) dialog_cust_bank.findViewById(R.id.okedit);
                        save.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {

                                if (add_bank_no.getText().toString().equals("") || add_bank_ifsc.getText().toString().equals("")){
                                    if (add_bank_ifsc.getText().toString().equals("")){
                                        i.setError("Enter IFSC Code");
                                    }
                                    if (add_bank_no.getText().toString().equals("")){
                                        n.setError("Enter Account no.");
                                    }
                                }else {
                                    add_bank_no_string = add_bank_no.getText().toString();
                                    add_bank_ifsc_string = add_bank_ifsc.getText().toString();
                                    add_bank_cust_name_string = add_bank_cust_name.getText().toString();
                                    add_bank_name_string = add_bank_name.getText().toString();
                                    dialog_cust_bank.dismiss();
                                }

                            }
                        });
                    }
                });


                ImageButton cancel = (ImageButton) dialog_cust.findViewById(R.id.canceledit);
                cancel.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        dialog_cust.dismiss();
                    }
                });

                ImageButton save = (ImageButton) dialog_cust.findViewById(R.id.okedit);
                save.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        if (ph_num.getText().toString().equals(ph_no.toString())){
                            if (cu_name.getText().toString().equals("") || ph_num.getText().toString().equals("")){
                                if (cu_name.getText().toString().equals("")){
                                    cu_name.setError("Enter customer name");
                                }
                                if (ph_num.getText().toString().equals("")){
                                    ph_num.setError("Enter customer phone no");
                                }
                            }else {

                                ema_add.setText(cu_email.getText().toString());
                                add_r.setText(cu_add.getText().toString());

                                ContentValues contentValues = new ContentValues();
                                contentValues.put("name", cu_name.getText().toString());
                                contentValues.put("emailid", cu_email.getText().toString());
                                contentValues.put("phoneno", ph_num.getText().toString());
                                contentValues.put("address", cu_add.getText().toString());
                                contentValues.put("pincode", cu_pinc.getText().toString());
                                contentValues.put("dob", cu_dob.getText().toString());
                                contentValues.put("user_id", cu_usr_id.getText().toString());

                                String wherecu = "_id = '" + idv + "'";


                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                resultUri = new Uri.Builder()
                                        .scheme("content")
                                        .authority(StubProvider.AUTHORITY)
                                        .path("Customerdetails")
                                        .appendQueryParameter("operation", "update")
                                        .appendQueryParameter("_id",idv)
                                        .build();
                                getContentResolver().notifyChange(resultUri, null);



                          //      db.update("Customerdetails", contentValues, wherecu, new String[]{});

                                dialog_cust.dismiss();

                                Cursor c1 = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '"+ph_no+"'", null);
                                if (c1.moveToFirst()){
                                    do {
                                        String id = c1.getString(0);

                                        ContentValues co = new ContentValues();
                                        co.put("cust_phoneno", ph_num.getText().toString());
                                        co.put("cust_name", cu_name.getText().toString());
                                        String where = "_id = '" + id + "'";


                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Cust_feedback");
                                        getContentResolver().update(contentUri, co,where,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Cust_feedback")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);



                                   //     db.update("Cust_feedback", co, where, new String[]{});
                                    }while (c1.moveToNext());
                                }
                                c1.close();

                                Cursor c2 = db.rawQuery("SELECT * FROM Customerdetails_temporary WHERE phoneno = '"+ph_no+"'", null);
                                if (c2.moveToFirst()){
                                    do {
                                        String id = c2.getString(0);

                                        ContentValues co = new ContentValues();
                                        co.put("phoneno", ph_num.getText().toString());
                                        co.put("name", cu_name.getText().toString());
                                        String where = "_id = '" + id + "'";


                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails_temporary");
                                        getContentResolver().update(contentUri, co,where,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Customerdetails_temporary")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);


                             //           db.update("Customerdetails_temporary", co, where, new String[]{});
                                    }while (c2.moveToNext());
                                }
                                c2.close();

                                Cursor c3 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+ph_no+"'", null);
                                if (c3.moveToFirst()){
                                    do {
                                        String id = c3.getString(0);

                                        ContentValues co = new ContentValues();
                                        co.put("phoneno", ph_num.getText().toString());
                                        co.put("name", cu_name.getText().toString());
                                        co.put("emailid", cu_email.getText().toString());
                                        co.put("phoneno", ph_num.getText().toString());
                                        co.put("address", cu_add.getText().toString());
                                        co.put("pincode", cu_pinc.getText().toString());
                                        co.put("dob", cu_dob.getText().toString());
                                        co.put("user_id", cu_usr_id.getText().toString());
                                        co.put("cust_account_no", add_bank_no_string);
                                        co.put("cust_ifsc_code", add_bank_ifsc_string);
                                        co.put("cust_account_holder_name", add_bank_cust_name_string);
                                        co.put("cust_bank_name", add_bank_name_string);
                                        String where = "_id = '" + id + "'";


                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                        getContentResolver().update(contentUri, co,where,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Customerdetails")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);



                                  //      db.update("Customerdetails", co, where, new String[]{});
                                    }while (c3.moveToNext());
                                }
                                c3.close();

                                cust_name.setText(cu_name.getText().toString());
                                pho_num.setText(ph_num.getText().toString());
                            }
                        }else {
                            Cursor cv = db.rawQuery("Select * from Customerdetails WHERE phoneno = '"+ph_num.getText().toString()+"'", null);
                            if (cv.moveToFirst()) {
                                ph_num.setError("Phone no already in list");
                            }else {
                                Cursor usr_id_get =  db.rawQuery("Select * from Customerdetails WHERE user_id = '"+cu_usr_id.getText().toString()+"'", null);
                                if (usr_id_get.moveToFirst()){
                                    cu_usr_id.setError("User id already in list");
                                }else {
                                    if (cu_name.getText().toString().equals("") || ph_num.getText().toString().equals("")) {
                                        if (cu_name.getText().toString().equals("")) {
                                            cu_name.setError("Enter customer name");
                                        }
                                        if (ph_num.getText().toString().equals("")) {
                                            ph_num.setError("Enter customer phone no");
                                        }
                                    } else {
                                        ContentValues contentValues = new ContentValues();
                                        contentValues.put("name", cu_name.getText().toString());
                                        contentValues.put("emailid", cu_email.getText().toString());
                                        contentValues.put("phoneno", ph_num.getText().toString());
                                        contentValues.put("address", cu_add.getText().toString());
                                        contentValues.put("pincode", cu_pinc.getText().toString());
                                        contentValues.put("user_id", cu_usr_id.getText().toString());
                                        contentValues.put("cust_account_no", add_bank_no_string);
                                        contentValues.put("cust_ifsc_code", add_bank_ifsc_string);
                                        contentValues.put("cust_account_holder_name", add_bank_cust_name_string);
                                        contentValues.put("cust_bank_name", add_bank_name_string);

                                        String wherecu = "_id = '" + idv + "'";


                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                        getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Customerdetails")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",idv)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);


                                     //   db.update("Customerdetails", contentValues, wherecu, new String[]{});

                                        dialog_cust.dismiss();

                                        Cursor c1 = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '" + ph_no + "'", null);
                                        if (c1.moveToFirst()) {
                                            do {
                                                String id = c1.getString(0);

                                                ContentValues co = new ContentValues();
                                                co.put("cust_phoneno", ph_num.getText().toString());
                                                co.put("cust_name", cu_name.getText().toString());
                                                String where = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Cust_feedback");
                                                getContentResolver().update(contentUri, co,where,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProvider.AUTHORITY)
                                                        .path("Cust_feedback")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);



                                         //       db.update("Cust_feedback", co, where, new String[]{});
                                            } while (c1.moveToNext());
                                        }
                                        c1.close();

                                        Cursor c2 = db.rawQuery("SELECT * FROM Customerdetails_temporary WHERE phoneno = '" + ph_no + "'", null);
                                        if (c2.moveToFirst()) {
                                            do {
                                                String id = c2.getString(0);

                                                ContentValues co = new ContentValues();
                                                co.put("phoneno", ph_num.getText().toString());
                                                co.put("name", cu_name.getText().toString());
                                                String where = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails_temporary");
                                                getContentResolver().update(contentUri, co,where,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProvider.AUTHORITY)
                                                        .path("Customerdetails_temporary")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);



                                     //           db.update("Customerdetails_temporary", co, where, new String[]{});
                                            } while (c2.moveToNext());
                                        }
                                        c2.close();

                                        Cursor c3 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + ph_no + "'", null);
                                        if (c3.moveToFirst()) {
                                            do {
                                                String id = c3.getString(0);

                                                ContentValues co = new ContentValues();
                                                co.put("phoneno", ph_num.getText().toString());
                                                co.put("name", cu_name.getText().toString());
                                                co.put("emailid", cu_email.getText().toString());
                                                co.put("phoneno", ph_num.getText().toString());
                                                co.put("address", cu_add.getText().toString());
                                                co.put("pincode", cu_pinc.getText().toString());
                                                co.put("dob", cu_dob.getText().toString());
                                                co.put("user_id", cu_usr_id.getText().toString());
                                                contentValues.put("cust_account_no", add_bank_no_string);
                                                contentValues.put("cust_ifsc_code", add_bank_ifsc_string);
                                                contentValues.put("cust_account_holder_name", add_bank_cust_name_string);
                                                contentValues.put("cust_bank_name", add_bank_name_string);
                                                String where = "_id = '" + id + "'";



                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                getContentResolver().update(contentUri, co,where,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProvider.AUTHORITY)
                                                        .path("Customerdetails")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                         //       db.update("Customerdetails", co, where, new String[]{});
                                            } while (c3.moveToNext());
                                        }
                                        c3.close();

                                        cust_name.setText(cu_name.getText().toString());
                                        pho_num.setText(ph_num.getText().toString());

//                                    Cursor c1 = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '"+ph_no+"'", null);
//                                    if (c1.moveToFirst()){
//                                        do {
//                                            String id = c1.getString(0);
//
//                                            ContentValues co = new ContentValues();
//                                            co.put("cust_phoneno", ph_num.getText().toString());
//                                            String where = "_id = '" + id + "'";
//                                            db.update("Cust_feedback", co, where, new String[]{});
//                                        }while (c1.moveToNext());
//                                    }
                                    }
                                }
                                usr_id_get.close();
                            }
                        }


                    }
                });

                ImageButton delete = (ImageButton) dialog_cust.findViewById(R.id.delete);
                delete.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        final Dialog dialog_confirm = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                        dialog_confirm.setContentView(R.layout.dialog_customer_management_confirm_delete);
                        dialog_confirm.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                        dialog_confirm.show();

                        ImageView no1 = (ImageView) dialog_confirm.findViewById(R.id.closetext);
                        no1.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                dialog_confirm.dismiss();
                            }
                        });

                        Button no = (Button) dialog_confirm.findViewById(R.id.cancel);
                        no.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                dialog_confirm.dismiss();
                            }
                        });

                        Button yes = (Button) dialog_confirm.findViewById(R.id.ok);
                        yes.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                Cursor cz = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                if (cz.moveToFirst()){
                                    do {
                                        String id = cz.getString(0);

                                        String where = "_id = '" + id + "' ";

                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                        getContentResolver().delete(contentUri, where,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Customerdetails")
                                                .appendQueryParameter("operation", "delete")
                                                .appendQueryParameter("_id", id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);


                                 //       db.delete("Customerdetails", where, new String[]{});

                                    }while (cz.moveToNext());
                                }
                                cz.close();

                                Cursor cz1 = db.rawQuery("SELECT * FROM Cust_feedback WHERE cust_phoneno = '"+pho_num.getText().toString()+"'", null);
                                if (cz1.moveToFirst()){
                                    do {
                                        String id = cz1.getString(0);

                                        String where = "_id = '" + id + "' ";


                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Cust_feedback");
                                        getContentResolver().delete(contentUri, where,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Cust_feedback")
                                                .appendQueryParameter("operation", "delete")
                                                .appendQueryParameter("_id", id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);


                                  //      db.delete("Cust_feedback", where, new String[]{});

                                    }while (cz1.moveToNext());
                                }
                                cz1.close();

                                Intent intent = new Intent(Customer_Info_Activity.this, MultiFragCustomerActivity.class);
                                intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                startActivity(intent);
                            }
                        });
                    }
                });
            }
        });

        LinearLayout date_filter = (LinearLayout) findViewById(R.id.filter_but1_date_filter);
        date_filter.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                final Dialog dialog_date = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                dialog_date.setContentView(R.layout.dialog_customer_management_date_filter);
                dialog_date.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                dialog_date.show();

                ImageButton cancel = (ImageButton) dialog_date.findViewById(R.id.btncancel);
                cancel.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        dialog_date.dismiss();
                    }
                });

                final TextView from_date_visible = (TextView) dialog_date.findViewById(R.id.from_date_visible);
                from_date_visible.setText(date1.getText().toString());
                final TextView from_date_hide = (TextView) dialog_date.findViewById(R.id.from_date_hide);
                from_date_hide.setText(date1_hide.getText().toString());

                final TextView to_date_visible = (TextView) dialog_date.findViewById(R.id.to_date_visible);
                to_date_visible.setText(date2.getText().toString());
                final TextView to_date_hide = (TextView) dialog_date.findViewById(R.id.to_date_hide);
                to_date_hide.setText(date2_hide.getText().toString());

                from_date_visible.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        Calendar now = Calendar.getInstance();
                        com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
                                datePickerListener,now.get(Calendar.YEAR), now.get(Calendar.MONTH), now.get(Calendar.DAY_OF_MONTH)
                        );

                        dpd.show(Customer_Info_Activity.this.getFragmentManager(), "Datepickerdialog");
                    }

                    com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener datePickerListener
                            = new com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener() {

                        @Override
                        public void onDateSet(com.wdullaer.materialdatetimepicker.date.DatePickerDialog datePickerDialog, int selectedYear1, int selectedMonth1, int selectedDay1) {
                            year1 = selectedYear1;
                            month1 = selectedMonth1;
                            day1 = selectedDay1;

                            // set selected date into textview
                            populateSetDate(year1, month1 + 1, day1);
                        }
                    };

                    public void populateSetDate(int year, int month, int day) {
                        TextView mEdit1 = (TextView) dialog_date.findViewById(R.id.from_date_visible);
                        TextView mEdit  = (TextView)dialog_date.findViewById(R.id.from_date_hide);

//                        Toast.makeText(Customer_Info_Activity.this, "from "+mEdit.getText().toString(), Toast.LENGTH_SHORT).show();

                        if (month == 1 && day < 10) {
                            mEdit.setText(year + " " + "0" + 1 + " " + "0" + day);
                            onee1 = "0" + day + " " + "Jan" + " " + year;
                            mEdit1.setText(onee1);
                        } else {
                            if (month == 1) {
                                mEdit.setText(year + " " + "0" + 1 + " " + day);
                                onee = day + " " + "Jan" + " " + year;
                                mEdit1.setText(onee);
                            }
                        }

                        if (month == 2 && day < 10) {
                            mEdit.setText(year + " " + "0" + 2 + " " + "0" + day);
                            two1 = "0" + day + " " + "Feb" + " " + year;
                            mEdit1.setText(two1);
                        } else {
                            if (month == 2) {
                                mEdit.setText(year + " " + "0" + 2 + " " + day);
                                two = day + " " + "Feb" + " " + year;
                                mEdit1.setText(two);
                            }
                        }

                        if (month == 3 && day < 10) {
                            mEdit.setText(year + " " + "0" + 3 + " " + "0" + day);
                            three1 = "0" + day + " " + "Mar" + " " + year;
                            mEdit1.setText(three1);
                        } else {
                            if (month == 3) {
                                mEdit.setText(year + " " + "0" + 3 + " " + day);
                                three = day + " " + "Mar" + " " + year;
                                mEdit1.setText(three);
                            }
                        }

                        if (month == 4 && day < 10) {
                            mEdit.setText(year + " " + "0" + 4 + " " + "0" + day);
                            four1 = "0" + day + " " + "Apr" + " " + year;
                            mEdit1.setText(four1);
                        } else {
                            if (month == 4) {
                                mEdit.setText(year + " " + "0" + 4 + " " + day);
                                four = day + " " + "Apr" + " " + year;
                                mEdit1.setText(four);
                            }
                        }

                        if (month == 5 && day < 10) {
                            mEdit.setText(year + " " + "0" + 5 + " " + "0" + day);
                            five1 = "0" + day + " " + "May" + " " + year;
                            mEdit1.setText(five1);
                        } else {
                            if (month == 5) {
                                mEdit.setText(year + " " + "0" + 5 + " " + day);
                                five = day + " " + "May" + " " + year;
                                mEdit1.setText(five);
                            }
                        }

                        if (month == 6 && day < 10) {
                            mEdit.setText(year + " " + "0" + 6 + " " + "0" + day);
                            six1 = "0" + day + " " + "Jun" + " " + year;
                            mEdit1.setText(six1);
                        } else {
                            if (month == 6) {
                                mEdit.setText(year + " " + "0" + 6 + " " + day);
                                six = day + " " + "Jun" + " " + year;
                                mEdit1.setText(six);
                            }
                        }

                        if (month == 7 && day < 10) {
                            mEdit.setText(year + " " + "0" + 7 + " " + "0" + day);
                            seven1 = "0" + day + " " + "Jul" + " " + year;
                            mEdit1.setText(seven1);
                        } else {
                            if (month == 7) {
                                mEdit.setText(year + " " + "0" + 7 + " " + day);
                                seven = day + " " + "Jul" + " " + year;
                                mEdit1.setText(seven);
                            }
                        }

                        if (month == 8 && day < 10) {
                            mEdit.setText(year + " " + "0" + 8 + " " + "0" + day);
                            eight1 = "0" + day + " " + "Aug" + " " + year;
                            mEdit1.setText(eight1);
                        } else {
                            if (month == 8) {
                                mEdit.setText(year + " " + "0" + 8 + " " + day);
                                eight = day + " " + "Aug" + " " + year;
                                mEdit1.setText(eight);
                            }
                        }

                        if (month == 9 && day < 10) {
                            mEdit.setText(year + " " + "0" + 9 + " " + "0" + day);
                            nine1 = "0" + day + " " + "Sep" + " " + year;
                            mEdit1.setText(nine1);
                        } else {
                            if (month == 9) {
                                mEdit.setText(year + " " + "0" + 9 + " " + day);
                                nine = day + " " + "Sep" + " " + year;
                                mEdit1.setText(nine);
                            }
                        }

                        if (month == 10 && day < 10) {
                            mEdit.setText(year + " " + 10 + " " + "0" + day);
                            ten1 = "0" + day + " " + "Oct" + " " + year;
                            mEdit1.setText(ten1);
                        } else {
                            if (month == 10) {
                                mEdit.setText(year + " " + 10 + " " + day);
                                ten = day + " " + "Oct" + " " + year;
                                mEdit1.setText(ten);
                            }
                        }

                        if (month == 11 && day < 10) {
                            mEdit.setText(year + " " + 11 + " " + "0" + day);
                            eleven1 = "0" + day + " " + "Nov" + " " + year;
                            mEdit1.setText(eleven1);
                        } else {
                            if (month == 11) {
                                mEdit.setText(year + " " + 11 + " " + day);
                                eleven = day + " " + "Nov" + " " + year;
                                mEdit1.setText(eleven);
                            }
                        }

                        if (month == 12 && day < 10) {
                            mEdit.setText(year + " " + 12 + " " + "0" + day);
                            twelve1 = "0" + day + " " + "Dec" + " " + year;
                            mEdit1.setText(twelve1);
                        } else {
                            if (month == 12) {
                                mEdit.setText(year + " " + 12 + " " + day);
                                twelve = day + " " + "Dec" + " " + year;
                                mEdit1.setText(twelve);
                            }
                        }

                    }

                });

                to_date_visible.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        Calendar now = Calendar.getInstance();
                        com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
                                datePickerListener,now.get(Calendar.YEAR), now.get(Calendar.MONTH), now.get(Calendar.DAY_OF_MONTH)
                        );

                        dpd.show(Customer_Info_Activity.this.getFragmentManager(), "Datepickerdialog");
                    }

                    com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener datePickerListener
                            = new com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener() {

                        @Override
                        public void onDateSet(com.wdullaer.materialdatetimepicker.date.DatePickerDialog datePickerDialog, int selectedYear1, int selectedMonth1, int selectedDay1) {
                            year1 = selectedYear1;
                            month1 = selectedMonth1;
                            day1 = selectedDay1;

                            // set selected date into textview
                            populateSetDate(year1, month1 + 1, day1);
                        }
                    };

                    public void populateSetDate(int year, int month, int day) {
                        TextView mEdit1 = (TextView) dialog_date.findViewById(R.id.to_date_visible);
                        TextView mEdit  = (TextView)dialog_date.findViewById(R.id.to_date_hide);

//                        Toast.makeText(Customer_Info_Activity.this, "to "+mEdit.getText().toString(), Toast.LENGTH_SHORT).show();

                        if (month == 1 && day < 10) {
                            mEdit.setText(year + " " + "0" + 1 + " " + "0" + day);
                            onee1 = "0" + day + " " + "Jan" + " " + year;
                            mEdit1.setText(onee1);
                        } else {
                            if (month == 1) {
                                mEdit.setText(year + " " + "0" + 1 + " " + day);
                                onee = day + " " + "Jan" + " " + year;
                                mEdit1.setText(onee);
                            }
                        }

                        if (month == 2 && day < 10) {
                            mEdit.setText(year + " " + "0" + 2 + " " + "0" + day);
                            two1 = "0" + day + " " + "Feb" + " " + year;
                            mEdit1.setText(two1);
                        } else {
                            if (month == 2) {
                                mEdit.setText(year + " " + "0" + 2 + " " + day);
                                two = day + " " + "Feb" + " " + year;
                                mEdit1.setText(two);
                            }
                        }

                        if (month == 3 && day < 10) {
                            mEdit.setText(year + " " + "0" + 3 + " " + "0" + day);
                            three1 = "0" + day + " " + "Mar" + " " + year;
                            mEdit1.setText(three1);
                        } else {
                            if (month == 3) {
                                mEdit.setText(year + " " + "0" + 3 + " " + day);
                                three = day + " " + "Mar" + " " + year;
                                mEdit1.setText(three);
                            }
                        }

                        if (month == 4 && day < 10) {
                            mEdit.setText(year + " " + "0" + 4 + " " + "0" + day);
                            four1 = "0" + day + " " + "Apr" + " " + year;
                            mEdit1.setText(four1);
                        } else {
                            if (month == 4) {
                                mEdit.setText(year + " " + "0" + 4 + " " + day);
                                four = day + " " + "Apr" + " " + year;
                                mEdit1.setText(four);
                            }
                        }

                        if (month == 5 && day < 10) {
                            mEdit.setText(year + " " + "0" + 5 + " " + "0" + day);
                            five1 = "0" + day + " " + "May" + " " + year;
                            mEdit1.setText(five1);
                        } else {
                            if (month == 5) {
                                mEdit.setText(year + " " + "0" + 5 + " " + day);
                                five = day + " " + "May" + " " + year;
                                mEdit1.setText(five);
                            }
                        }

                        if (month == 6 && day < 10) {
                            mEdit.setText(year + " " + "0" + 6 + " " + "0" + day);
                            six1 = "0" + day + " " + "Jun" + " " + year;
                            mEdit1.setText(six1);
                        } else {
                            if (month == 6) {
                                mEdit.setText(year + " " + "0" + 6 + " " + day);
                                six = day + " " + "Jun" + " " + year;
                                mEdit1.setText(six);
                            }
                        }

                        if (month == 7 && day < 10) {
                            mEdit.setText(year + " " + "0" + 7 + " " + "0" + day);
                            seven1 = "0" + day + " " + "Jul" + " " + year;
                            mEdit1.setText(seven1);
                        } else {
                            if (month == 7) {
                                mEdit.setText(year + " " + "0" + 7 + " " + day);
                                seven = day + " " + "Jul" + " " + year;
                                mEdit1.setText(seven);
                            }
                        }

                        if (month == 8 && day < 10) {
                            mEdit.setText(year + " " + "0" + 8 + " " + "0" + day);
                            eight1 = "0" + day + " " + "Aug" + " " + year;
                            mEdit1.setText(eight1);
                        } else {
                            if (month == 8) {
                                mEdit.setText(year + " " + "0" + 8 + " " + day);
                                eight = day + " " + "Aug" + " " + year;
                                mEdit1.setText(eight);
                            }
                        }

                        if (month == 9 && day < 10) {
                            mEdit.setText(year + " " + "0" + 9 + " " + "0" + day);
                            nine1 = "0" + day + " " + "Sep" + " " + year;
                            mEdit1.setText(nine1);
                        } else {
                            if (month == 9) {
                                mEdit.setText(year + " " + "0" + 9 + " " + day);
                                nine = day + " " + "Sep" + " " + year;
                                mEdit1.setText(nine);
                            }
                        }

                        if (month == 10 && day < 10) {
                            mEdit.setText(year + " " + 10 + " " + "0" + day);
                            ten1 = "0" + day + " " + "Oct" + " " + year;
                            mEdit1.setText(ten1);
                        } else {
                            if (month == 10) {
                                mEdit.setText(year + " " + 10 + " " + day);
                                ten = day + " " + "Oct" + " " + year;
                                mEdit1.setText(ten);
                            }
                        }

                        if (month == 11 && day < 10) {
                            mEdit.setText(year + " " + 11 + " " + "0" + day);
                            eleven1 = "0" + day + " " + "Nov" + " " + year;
                            mEdit1.setText(eleven1);
                        } else {
                            if (month == 11) {
                                mEdit.setText(year + " " + 11 + " " + day);
                                eleven = day + " " + "Nov" + " " + year;
                                mEdit1.setText(eleven);
                            }
                        }

                        if (month == 12 && day < 10) {
                            mEdit.setText(year + " " + 12 + " " + "0" + day);
                            twelve1 = "0" + day + " " + "Dec" + " " + year;
                            mEdit1.setText(twelve1);
                        } else {
                            if (month == 12) {
                                mEdit.setText(year + " " + 12 + " " + day);
                                twelve = day + " " + "Dec" + " " + year;
                                mEdit1.setText(twelve);
                            }
                        }

                    }
                });

                ImageButton save = (ImageButton) dialog_date.findViewById(R.id.btnsave);
                save.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        System.out.println("date is "+date1_hide.getText().toString()+" "+date2_hide.getText().toString());
                        date1.setText(from_date_visible.getText().toString());
                        date1_hide.setText(from_date_hide.getText().toString());
                        date2.setText(to_date_visible.getText().toString());
                        date2_hide.setText(to_date_hide.getText().toString());

//                        Toast.makeText(Customer_Info_Activity.this, "from1 "+from_date_hide.getText().toString(), Toast.LENGTH_SHORT).show();
//                        Toast.makeText(Customer_Info_Activity.this, "to1 "+to_date_hide.getText().toString(), Toast.LENGTH_SHORT).show();

                        dialog_date.dismiss();

                        TextView total_sales = (TextView) findViewById(R.id.sale_value);

                        Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
                        if (cursor_sales.moveToFirst()){
                            float dsirsq = cursor_sales.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            total_sales.setText(rop);
                        }
                        cursor_sales.close();


                        TextView total_credit = (TextView) findViewById(R.id.credit_value);

                        Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
                        if (cursor_credit.moveToFirst()){
                            float dsirsq = cursor_credit.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            total_credit.setText(rop);
                        }
                        cursor_credit.close();





                        ListView listView = (ListView) findViewById(R.id.listView);

//                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
//                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                        // the XML defined views which the data will be bound to
//                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                        Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                        final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
                        if (cursor_country1.moveToFirst()){
                            str_country = cursor_country1.getString(1);
                        }
                        
                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};
                        // the XML defined views which the data will be bound to
                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
                        final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
                        dataAdapterr.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                            @Override
                            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                if (view.getId() == R.id.rs_sale1) {
                                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                    TextView dateTextView = (TextView) view;
                                    if (tadl_id.toString().equals("India") || tadl_id.toString().equals("Rupee")){
                                        dateTextView.setText(insert1_cc);
                                    }else {
                                        dateTextView.setText(insert1_cc);
                                    }
                                    return true;
                                }
                                return false;
                            }
                        });
                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                        Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (sales_t.moveToFirst()){
                            dsirsq1 = sales_t.getFloat(0);
                        }
                        sales_t.close();

                        Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (credit_t.moveToFirst()){
                            dsirsq2 = credit_t.getFloat(0);
                        }
                        credit_t.close();

                        Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (deposi_t.moveToFirst()){
                            dsirsq3 = deposi_t.getFloat(0);
                        }
                        deposi_t.close();

                        Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (cashout_t.moveToFirst()){
                            dsirsq4 = cashout_t.getFloat(0);
                        }
                        cashout_t.close();

                        Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (write_off_t.moveToFirst()){
                            dsirsq5 = write_off_t.getFloat(0);
                        }
                        write_off_t.close();

                        final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

                        TextView total_balance = (TextView) findViewById(R.id.total_balance);
                        total_balance.setText(String.format("%.1f", cal_sale));

                        RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
                        RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
                        RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);

                        TextView refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
                        TextView charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
                        TextView deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);

                        Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (cursor_refunds_tot_val.moveToFirst()){
                            refunds_tot.setVisibility(View.VISIBLE);
                            float dsirsq = cursor_refunds_tot_val.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            refunds_tot_val.setText(rop);
                        }else {
                            refunds_tot.setVisibility(View.GONE);
                        }
                        cursor_refunds_tot_val.close();

                        Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (cursor_charges_tot_val.moveToFirst()){
                            charges_tot.setVisibility(View.VISIBLE);
                            float dsirsq = cursor_charges_tot_val.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            charges_tot_val.setText(rop);
                        }else {
                            charges_tot.setVisibility(View.GONE);
                        }
                        cursor_charges_tot_val.close();

                        Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (cursor_deposits_tot_val.moveToFirst()){
                            deposits_tot.setVisibility(View.VISIBLE);
                            float dsirsq = cursor_deposits_tot_val.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            deposits_tot_val.setText(rop);
                        }else {
                            deposits_tot.setVisibility(View.GONE);
                        }
                        cursor_deposits_tot_val.close();

                        LinearLayout cashout_product = (LinearLayout) findViewById(R.id.cashout_product);
                        LinearLayout cashout_money = (LinearLayout) findViewById(R.id.cashout_money);

                        TextView cashout_product_total = (TextView) findViewById(R.id.item_value);
                        Cursor cursor_product_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Product/Items' ", null);
                        if (cursor_product_total.moveToFirst()){
                            cashout_product.setVisibility(View.VISIBLE);
                            float dsirsq = cursor_product_total.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            cashout_product_total.setText(rop);
                        }else {
                            cashout_product.setVisibility(View.GONE);
                        }
                        cursor_product_total.close();


                        TextView cashout_money_total = (TextView) findViewById(R.id.money_value);
                        Cursor cursor_money_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Money' ", null);
                        if (cursor_money_total.moveToFirst()){
                            cashout_money.setVisibility(View.VISIBLE);
                            float dsirsq = cursor_money_total.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            cashout_money_total.setText(rop);
                        }else {
                            cashout_money.setVisibility(View.GONE);
                        }
                        cursor_money_total.close();
                    }
                });

                Button alltime = (Button) dialog_date.findViewById(R.id.alltime);
                alltime.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        date1.setText(date_first);
                        date2.setText(currentDateandTime2);
                        date1_hide.setText(date_first_hide);
                        date2_hide.setText(currentDateandTime1);
                        dialog_date.dismiss();

                        TextView total_sales = (TextView) findViewById(R.id.sale_value);

                        Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
                        if (cursor_sales.moveToFirst()){
                            float dsirsq = cursor_sales.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            total_sales.setText(rop);
                        }
                        cursor_sales.close();


                        TextView total_credit = (TextView) findViewById(R.id.credit_value);

                        Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
                        if (cursor_credit.moveToFirst()){
                            float dsirsq = cursor_credit.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            total_credit.setText(rop);
                        }
                        cursor_credit.close();





                        ListView listView = (ListView) findViewById(R.id.listView);

//                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
//                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                        // the XML defined views which the data will be bound to
//                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                        Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
                        // the XML defined views which the data will be bound to
                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
                        final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                        Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'  AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (sales_t.moveToFirst()){
                            dsirsq1 = sales_t.getFloat(0);
                        }
                        sales_t.close();

                        Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'  AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (credit_t.moveToFirst()){
                            dsirsq2 = credit_t.getFloat(0);
                        }
                        credit_t.close();

                        Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'  AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (deposi_t.moveToFirst()){
                            dsirsq3 = deposi_t.getFloat(0);
                        }
                        deposi_t.close();

                        Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (cashout_t.moveToFirst()){
                            dsirsq4 = cashout_t.getFloat(0);
                        }
                        cashout_t.close();

                        Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                        if (write_off_t.moveToFirst()){
                            dsirsq5 = write_off_t.getFloat(0);
                        }
                        write_off_t.close();

                        final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

                        TextView total_balance = (TextView) findViewById(R.id.total_balance);
                        total_balance.setText(String.format("%.1f", cal_sale));

                        LinearLayout cashout_product = (LinearLayout) findViewById(R.id.cashout_product);
                        LinearLayout cashout_money = (LinearLayout) findViewById(R.id.cashout_money);

                        TextView cashout_product_total = (TextView) findViewById(R.id.item_value);
                        Cursor cursor_product_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Product/Items' ", null);
                        if (cursor_product_total.moveToFirst()){
                            cashout_product.setVisibility(View.VISIBLE);
                            float dsirsq = cursor_product_total.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            cashout_product_total.setText(rop);
                        }else {
                            cashout_product.setVisibility(View.GONE);
                        }
                        cursor_product_total.close();


                        TextView cashout_money_total = (TextView) findViewById(R.id.money_value);
                        Cursor cursor_money_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Money' ", null);
                        if (cursor_money_total.moveToFirst()){
                            cashout_money.setVisibility(View.VISIBLE);
                            float dsirsq = cursor_money_total.getFloat(0);
                            String rop = String.format("%.1f", dsirsq);
                            cashout_money_total.setText(rop);
                        }else {
                            cashout_money.setVisibility(View.GONE);
                        }
                        cursor_money_total.close();
                    }
                });
            }
        });

        LinearLayout deposit_button = (LinearLayout) findViewById(R.id.deposit_but);
        deposit_button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {

                Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                if (cursor5.moveToFirst()) {
                    do {
                        String id = cursor5.getString(0);
                        ContentValues contentValues = new ContentValues();
                        contentValues.put("print_value", "");
                        contentValues.put("checked", "");
                        String where1 = "_id = '" + id + "' ";
                //        db1.update("Items", contentValues, where1, new String[]{});

                        contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                        getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                        resultUri = new Uri.Builder()
                                .scheme("content")
                                .authority(StubProviderApp.AUTHORITY)
                                .path("Items")
                                .appendQueryParameter("operation", "update")
                                .appendQueryParameter("_id",id)
                                .build();
                        getContentResolver().notifyChange(resultUri, null);

                        String where1_v1 = "docid = '" + id + "'";
                        db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});


                    } while (cursor5.moveToNext());
                }
                cursor5.close();

                dialog_deposit = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                dialog_deposit.setContentView(R.layout.dialog_customer_management_deposit);
                dialog_deposit.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                dialog_deposit.show();

                TextView inn_deposit = (TextView) dialog_deposit.findViewById(R.id.inn_deposit);
                inn_deposit.setText("Deposit ("+insert1_cc+")");

                ImageButton cancel = (ImageButton) dialog_deposit.findViewById(R.id.btncancel);
                cancel.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        dialog_deposit.dismiss();
                    }
                });

                deposit_notes = (EditText) dialog_deposit.findViewById(R.id.deposit_notes);

                final TextInputLayout deposit_valid = (TextInputLayout) dialog_deposit.findViewById(R.id.deposit_valid);
                deposit_value = (EditText) dialog_deposit.findViewById(R.id.deposit_value);

                deposit_value.addTextChangedListener(new TextWatcher() {
                    @Override
                    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                    }

                    @Override
                    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                        deposit_valid.setError(null);
                    }

                    @Override
                    public void afterTextChanged(Editable editable) {

                    }
                });


                ImageButton btnproducts = (ImageButton) dialog_deposit.findViewById(R.id.btnproducts);
                btnproducts.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {

//                        if (deposit_value.getText().toString().equals("")){
//
//                        }else {

                            final Dialog dialog = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                            dialog.setContentView(R.layout.dialog_deposit_itemselection);
                            dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialog.setCanceledOnTouchOutside(false);
                            dialog.show();

                            TextView rs = (TextView) dialog.findViewById(R.id.rs);
                            rs.setText(insert1_cc);

                            dialog.setOnKeyListener(new DialogInterface.OnKeyListener() {
                                @Override
                                public boolean onKey(DialogInterface dialogInterface, int i, KeyEvent keyEvent) {
                                    if (i == KeyEvent.KEYCODE_BACK) {
                                        dialog.cancel();

                                        Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE checked = ''", null);
                                        if (cursor5.moveToFirst()) {
                                            do {
                                                String id = cursor5.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("print_value", "");
                                                String where1 = "_id = '" + id + "' ";
                                                //    db1.update("Items", contentValues, where1, new String[]{});

                                                String where1_v1 = "docid = '" + id + "'";
                                                db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                getContentResolver().update(contentUri, contentValues, where1, new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Items")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id", id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                                //      db1.update("Items", contentValues, where1, new String[]{});
//                                            Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                            } while (cursor5.moveToNext());
                                        }
                                        cursor5.close();
                                    }
                                    return false;
                                }
                            });

                            ImageButton cancel = (ImageButton) dialog.findViewById(R.id.btncancel);
                            cancel.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    dialog.dismiss();

                                    Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE checked = ''", null);
                                    if (cursor5.moveToFirst()) {
                                        do {
                                            String id = cursor5.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("print_value", "");
                                            String where1 = "_id = '" + id + "' ";
                                            //        db1.update("Items", contentValues, where1, new String[]{});

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                            getContentResolver().update(contentUri, contentValues, where1, new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Items")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id", id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);
                                            String where1_v1 = "docid = '" + id + "'";
                                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

//                                        Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                        } while (cursor5.moveToNext());
                                    }
                                    cursor5.close();
                                }
                            });

                            ListView myListView = (ListView) dialog.findViewById(R.id.list);

//                        list = new ArrayList<Country_deposit>();
//
//                        String statement = "SELECT * FROM Items";
//                        //Execute the query
//                        Cursor aallrows = db1.rawQuery(statement, null);
//                        System.out.println("COUNT : " + aallrows.getCount());
//                        ////Toast.makeText(Customer_Info_Activity.this, "limit is a " + limit, Toast.LENGTH_SHORT).show();
//                        if (aallrows.moveToFirst()) {
//                            do {
//                                String ID = aallrows.getString(0);
//                                String NAme = aallrows.getString(1);
//                                String BAr = aallrows.getString(18);
//
//                                Country_deposit NAME = new Country_deposit(NAme, BAr);
//                                list.add(NAME);
//
//                            } while (aallrows.moveToNext());
//                        }
//
//                        adapter = new MyAdapter_deposit(Customer_Info_Activity.this,list);

                            final TextView items_selected = (TextView) dialog.findViewById(R.id.itemname_selected);
                            final TextView quanity_selected = (TextView) dialog.findViewById(R.id.quantity_selected);
                            final TextView tot_amount = (TextView) dialog.findViewById(R.id.tot_amount);


                            Cursor cursor21 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            int cou1 = cursor21.getCount();

                            if (cou1 == 0) {
                                items_selected.setText("0");
                            } else {
                                items_selected.setText(String.valueOf(cou1));
                            }

                            Cursor cursor31 = db1.rawQuery("SELECT SUM(print_value) FROM Items WHERE print_value != ''", null);
                            if (cursor31.moveToFirst()) {
                                float dsirsq = cursor31.getFloat(0);
                                String rop = String.format("%.1f", dsirsq);
                                quanity_selected.setText(rop);
                            }
                        cursor31.close();


                            float sum_tot1 = 0;
                            Cursor c51 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            if (c51.moveToFirst()) {
                                do {
                                    String price = c51.getString(2);
                                    String quan = c51.getString(18);

                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                    tv.setText(quan);

                                    if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")) {

                                    } else {
                                        float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                        sum_tot1 = sum_tot1 + q;
                                    }
                                } while (c51.moveToNext());
                            }
                        c51.close();

                            tot_amount.setText(String.valueOf(sum_tot1));

                            if (deposit_value.getText().toString().equals("")) {
                                Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                if (cursor5.moveToFirst()) {
                                    do {
                                        String id = cursor5.getString(0);
                                        ContentValues contentValues = new ContentValues();
                                        contentValues.put("print_value", "");
                                        String where1 = "_id = '" + id + "' ";
                                        //      db1.update("Items", contentValues, where1, new String[]{});

                                        String where1_v1 = "docid = '" + id + "'";
                                        db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                        contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                        getContentResolver().update(contentUri, contentValues, where1, new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProviderApp.AUTHORITY)
                                                .path("Items")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id", id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);


                                        //      db1.update("Items", contentValues, where1, new String[]{});
//                                        Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                    } while (cursor5.moveToNext());
                                }
                                cursor5.close();
                            } else {
//                            Toast.makeText(Customer_Info_Activity.this, "deposit_value "+deposit_value.getText().toString(), Toast.LENGTH_SHORT).show();
//                            Toast.makeText(Customer_Info_Activity.this, "sum_tot "+sum_tot1, Toast.LENGTH_SHORT).show();
                                if (Float.parseFloat(deposit_value.getText().toString()) == sum_tot1) {
//                                Toast.makeText(Customer_Info_Activity.this, "same", Toast.LENGTH_SHORT).show();
                                } else {
//                                Toast.makeText(Customer_Info_Activity.this, "not same", Toast.LENGTH_SHORT).show();
                                    Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                    if (cursor5.moveToFirst()) {
                                        do {
                                            String id = cursor5.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("print_value", "");
                                            String where1 = "_id = '" + id + "' ";
                                            //    db1.update("Items", contentValues, where1, new String[]{});

                                            String where1_v1 = "docid = '" + id + "'";
                                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                            getContentResolver().update(contentUri, contentValues, where1, new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Items")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id", id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                            //     db1.update("Items", contentValues, where1, new String[]{});
//                                        Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                        } while (cursor5.moveToNext());
                                    }
                                    cursor5.close();
                                }
                            }


                            final Cursor cursor = db1.rawQuery("SELECT * FROM Items", null);
                            String[] fromFieldNames = {"itemname", "print_value"};
                            int[] toViewsID = {R.id.label, R.id.enter_value};
                            final SimpleCursorAdapter ddataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.row_with_number, cursor, fromFieldNames, toViewsID, 0);
                            myListView.setAdapter(ddataAdapterr);


                            final EditText myFilter = (EditText) dialog.findViewById(R.id.custombar_text);
                            myFilter.addTextChangedListener(new TextWatcher() {

                                public void afterTextChanged(Editable s) {
                                }

                                public void beforeTextChanged(CharSequence s, int start, int count, int after) {
                                }

                                public void onTextChanged(CharSequence s, int start, int before, int count) {
                                    ddataAdapterr.getFilter().filter(s.toString());
                                }
                            });

                            ddataAdapterr.setFilterQueryProvider(new FilterQueryProvider() {
                                public Cursor runQuery(CharSequence constraint) {
                                    return fetchCountriesByName1(constraint.toString());
                                }
                            });


                            Cursor cursor2 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            int cou = cursor2.getCount();

                            if (cou == 0) {
                                items_selected.setText("0");
                            } else {
                                items_selected.setText(String.valueOf(cou));
                            }

                            Cursor cursor3 = db1.rawQuery("SELECT SUM(print_value) FROM Items WHERE print_value != ''", null);
                            if (cursor3.moveToFirst()) {
                                float dsirsq = cursor3.getFloat(0);
                                String rop = String.format("%.1f", dsirsq);
                                quanity_selected.setText(rop);
                            }
                        cursor3.close();


                            float sum_tot = 0;
                            Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            if (c5.moveToFirst()) {
                                do {
                                    String price = c5.getString(2);
                                    String quan = c5.getString(18);

                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                    tv.setText(quan);

                                    if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")) {

                                    } else {
                                        float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                        sum_tot = sum_tot + q;
                                    }
                                } while (c5.moveToNext());
                            }
                        c5.close();

                            tot_amount.setText(String.valueOf(sum_tot));

                            myListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
                                @Override
                                public void onItemClick(AdapterView<?> parent, View view, final int position, long l) {
//                                final Country_deposit country = (Country_deposit) parent.getItemAtPosition(position);
//                                final String ingr_name = country.getName();
//
//                                final TextView tv = (TextView) view.findViewById(R.id.enter_value);

                                    final Cursor cursor1 = (Cursor) parent.getItemAtPosition(position);
                                    final String ingr_name = cursor1.getString(cursor1.getColumnIndex("itemname"));

                                    final TextView tv = (TextView) view.findViewById(R.id.enter_value);

//                                final CheckBox check = (CheckBox) view.findViewById(R.id.check);

                                    final Dialog dialog1 = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                    dialog1.setContentView(R.layout.dialog_deposit_noofquantity);
                                    dialog1.show();

                                    ImageButton btncancel = (ImageButton) dialog1.findViewById(R.id.btncancel);
                                    btncancel.setOnClickListener(new View.OnClickListener() {
                                        @Override
                                        public void onClick(View view) {
                                            dialog1.dismiss();
                                        }
                                    });

                                    TextView tv1 = (TextView) dialog1.findViewById(R.id.itemname);
                                    tv1.setText(ingr_name);

                                    final EditText tv2 = (EditText) dialog1.findViewById(R.id.editText1);
                                    tv2.setText(tv.getText().toString());

                                    tv2.requestFocus();

                                    InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
                                    imm.showSoftInput(tv2, InputMethodManager.SHOW_IMPLICIT);

                                    final TextInputLayout t = (TextInputLayout) dialog1.findViewById(R.id.layoutcatname_dialog);

                                    tv2.addTextChangedListener(new TextWatcher() {
                                        @Override
                                        public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                        }

                                        @Override
                                        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                            t.setError(null);
                                        }

                                        @Override
                                        public void afterTextChanged(Editable editable) {

                                        }
                                    });

                                    final Button save = (Button) dialog1.findViewById(R.id.btnsave);

                                    tv2.setOnEditorActionListener(new EditText.OnEditorActionListener() {
                                        @Override
                                        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
                                            if (actionId == EditorInfo.IME_ACTION_GO) {
                                                save.performClick();
                                                return true;
                                            }
                                            return false;
                                        }
                                    });

                                    save.setOnClickListener(new View.OnClickListener() {
                                        @Override
                                        public void onClick(View view) {
                                            if (tv2.getText().toString().equals("")) {
                                                t.setError("Enter valid no.");
                                            } else {
                                                if (tv2.getText().toString().equals("0")) {
                                                    Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE itemname = '" + ingr_name + "'", null);
                                                    if (cursor5.moveToFirst()) {
                                                        do {
                                                            String id = cursor5.getString(0);
                                                            ContentValues contentValues = new ContentValues();
                                                            contentValues.put("print_value", "");
                                                            String where1 = "_id = '" + id + "' ";
                                                            //    db1.update("Items", contentValues, where1, new String[]{});

                                                            String where1_v1 = "docid = '" + id + "'";
                                                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                            getContentResolver().update(contentUri, contentValues, where1, new String[]{});
                                                            resultUri = new Uri.Builder()
                                                                    .scheme("content")
                                                                    .authority(StubProviderApp.AUTHORITY)
                                                                    .path("Items")
                                                                    .appendQueryParameter("operation", "update")
                                                                    .appendQueryParameter("_id", id)
                                                                    .build();
                                                            getContentResolver().notifyChange(resultUri, null);


                                                            //          db1.update("Items", contentValues, where1, new String[]{});
                                                        } while (cursor5.moveToNext());
                                                    }
                                                    cursor5.close();
                                                } else {
                                                    Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE itemname = '" + ingr_name + "'", null);
                                                    if (cursor5.moveToFirst()) {
                                                        do {
                                                            String id = cursor5.getString(0);
                                                            ContentValues contentValues = new ContentValues();
                                                            contentValues.put("print_value", tv2.getText().toString());
                                                            String where1 = "_id = '" + id + "' ";
                                                            //          db1.update("Items", contentValues, where1, new String[]{});

                                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                            getContentResolver().update(contentUri, contentValues, where1, new String[]{});
                                                            resultUri = new Uri.Builder()
                                                                    .scheme("content")
                                                                    .authority(StubProviderApp.AUTHORITY)
                                                                    .path("Items")
                                                                    .appendQueryParameter("operation", "update")
                                                                    .appendQueryParameter("_id", id)
                                                                    .build();
                                                            getContentResolver().notifyChange(resultUri, null);


                                                            String where1_v1 = "docid = '" + id + "'";
                                                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});


                                                        } while (cursor5.moveToNext());
                                                    }
                                                    cursor5.close();
                                                }
                                                dialog1.dismiss();

//                                            check.setChecked(true);
                                                tv.setText(tv2.getText().toString());


//                                            Toast.makeText(Customer_Info_Activity.this, "1 "+tv.getText().toString(), Toast.LENGTH_LONG).show();
//                                            Toast.makeText(Customer_Info_Activity.this, "1 "+country.getqty(), Toast.LENGTH_LONG).show();

//                                            country.moveToPosition(position);
//                                            country.requery();
//                                            adapter.notifyDataSetChanged();

                                                cursor1.moveToPosition(position);
                                                cursor1.requery();
                                                ddataAdapterr.notifyDataSetChanged();

                                                Cursor cursor2 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                                int cou = cursor2.getCount();

                                                if (cou == 0) {
                                                    items_selected.setText("0");
                                                } else {
                                                    items_selected.setText(String.valueOf(cou));
                                                }

                                                Cursor cursor3 = db1.rawQuery("SELECT SUM(print_value) FROM Items WHERE print_value != ''", null);
                                                if (cursor3.moveToFirst()) {
                                                    float dsirsq = cursor3.getFloat(0);
                                                    String rop = String.format("%.1f", dsirsq);
                                                    quanity_selected.setText(rop);
                                                }
                                                cursor3.close();

                                                Cursor cursor4 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                                int cou1 = cursor4.getCount();

                                                float sum_tot = 0;
//                                            for (int i = 0; i < cou1; i++){
                                                Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                                if (c5.moveToFirst()) {
                                                    do {
                                                        String price = c5.getString(2);
                                                        String quan = c5.getString(18);

                                                        TextView tv = new TextView(Customer_Info_Activity.this);
                                                        tv.setText(quan);

                                                        if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")) {

                                                        } else {
                                                            float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                                            sum_tot = sum_tot + q;
                                                        }
                                                    } while (c5.moveToNext());
                                                }
                                                c5.close();
//                                            }

                                                tot_amount.setText(String.valueOf(sum_tot));

                                            }

                                        }
                                    });
                                }
                            });


                            ImageButton save_listview = (ImageButton) dialog.findViewById(R.id.btnsave);
                            save_listview.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    Cursor che = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                    if (che.moveToFirst()) {
                                        do {
                                            String id = che.getString(0);
                                            String bar = che.getString(18);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("checked", "checked");
                                            String where1 = "_id = '" + id + "' ";
                                            //            db1.update("Items", contentValues, where1, new String[]{});

                                            String where1_v1 = "docid = '" + id + "'";
                                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                            getContentResolver().update(contentUri, contentValues, where1, new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Items")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id", id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                            //      db1.update("Items", contentValues, where1, new String[]{});

                                        } while (che.moveToNext());
                                    }
                                    che.close();
                                    dialog.dismiss();

                                    float sum_tot = 0;
                                    Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
                                    if (c5.moveToFirst()) {
                                        do {
                                            String price = c5.getString(2);
                                            String quan = c5.getString(18);

                                            TextView tv = new TextView(Customer_Info_Activity.this);
                                            tv.setText(quan);

                                            if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")) {

                                            } else {
                                                float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                                sum_tot = sum_tot + q;
                                            }
                                        } while (c5.moveToNext());
                                    }
                                    c5.close();

                                    if (sum_tot == 0 || sum_tot == 0.0) {
//                                    Toast.makeText(Customer_Info_Activity.this, "0", Toast.LENGTH_LONG).show();
                                    } else {
                                        deposit_value.setText(String.valueOf(sum_tot));
                                    }
                                }
                            });
//                        }
                    }
                });


                ImageButton save = (ImageButton) dialog_deposit.findViewById(R.id.btnsave);
                save.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        if (deposit_value.getText().toString().equals("") || deposit_value.getText().toString().equals("")){
                            deposit_valid.setError("Enter valid number");
                        }else {
                            dialog = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                            dialog.setContentView(R.layout.dialog_customer_management_deposit_cashout_warning);
                            dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialog.show();

                            TextView inn = (TextView) dialog.findViewById(R.id.inn);
                            inn.setText(insert1_rs);

                            ImageView close = (ImageView) dialog.findViewById(R.id.closetext);
                            close.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    dialog.dismiss();
                                }
                            });

                            TextView enter_amo_wa = (TextView) dialog.findViewById(R.id.enter_amo);
                            enter_amo_wa.setText(deposit_value.getText().toString());

                            Button cancel1 = (Button) dialog.findViewById(R.id.cancel);
                            cancel1.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    dialog.dismiss();
                                }
                            });

                            pin_layout = (TextInputLayout) dialog.findViewById(R.id.pin_layout);

                            enter_pint = (EditText) dialog.findViewById(R.id.pin_check);


                            enter_pint.addTextChangedListener(new TextWatcher() {
                                @Override
                                public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                }

                                @Override
                                public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                    pin_layout.setError(null);
                                }

                                @Override
                                public void afterTextChanged(Editable editable) {

                                }
                            });

                            Cursor pin = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                            if (pin.moveToFirst()){
                                do {
                                    String pin1 = pin.getString(25);

                                    TextView tvb = new TextView(Customer_Info_Activity.this);
                                    tvb.setText(pin1);
                                    if (tvb.getText().toString().equals("on")){
                                        pin_layout.setVisibility(View.VISIBLE);
                                    }else {
                                        pin_layout.setVisibility(View.GONE);
                                    }
                                }while (pin.moveToNext());
                            }
                            pin.close();

                            Button save = (Button) dialog.findViewById(R.id.ok);
                            save.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {

                                    DownloadMusicfromInternet_Deposit downloadMusicfromInternet = new DownloadMusicfromInternet_Deposit();
                                    downloadMusicfromInternet.execute();



                                }
                            });

                        }
                    }
                });
            }
        });


        LinearLayout cashout_button = (LinearLayout) findViewById(R.id.cashout_but);
        cashout_button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (sales_t.moveToFirst()){
                    dsirsq1 = sales_t.getFloat(0);
                }
                sales_t.close();

                Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (credit_t.moveToFirst()){
                    dsirsq2 = credit_t.getFloat(0);
                }
                credit_t.close();

                Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (deposi_t.moveToFirst()){
                    dsirsq3 = deposi_t.getFloat(0);
                }
                deposi_t.close();

                Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (cashout_t.moveToFirst()){
                    dsirsq4 = cashout_t.getFloat(0);
                }
                cashout_t.close();

                Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                if (write_off_t.moveToFirst()){
                    dsirsq5 = write_off_t.getFloat(0);
                }
                write_off_t.close();

                final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

//                final float cal_sale = -1;

                if (cal_sale >= 0){
                    Toast.makeText(Customer_Info_Activity.this, "cashout not possible", Toast.LENGTH_SHORT).show();
                }else {
                    final Dialog dialog_cashout = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                    dialog_cashout.setContentView(R.layout.dialog_customer_management_cashout);
                    dialog_cashout.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                    dialog_cashout.show();

                    TextView inn_deposit = (TextView) dialog_cashout.findViewById(R.id.inn);
                    inn_deposit.setText("Cashout ("+insert1_cc+")");

                    TextView inn1 = (TextView) dialog_cashout.findViewById(R.id.inn1);
                    inn1.setText(insert1_cc);

                    final ImageButton cancel = (ImageButton) dialog_cashout.findViewById(R.id.btncancel);
                    cancel.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            dialog_cashout.dismiss();
                        }
                    });


                    Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                    if (cursor5.moveToFirst()) {
                        do {
                            String id = cursor5.getString(0);
                            ContentValues contentValues = new ContentValues();
                            contentValues.put("print_value", "");
                            contentValues.put("checked", "");
                            String where1 = "_id = '" + id + "' ";
                        //    db1.update("Items", contentValues, where1, new String[]{});

                            String where1_v1 = "docid = '" + id + "'";
                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                            getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                            resultUri = new Uri.Builder()
                                    .scheme("content")
                                    .authority(StubProviderApp.AUTHORITY)
                                    .path("Items")
                                    .appendQueryParameter("operation", "update")
                                    .appendQueryParameter("_id",id)
                                    .build();
                            getContentResolver().notifyChange(resultUri, null);


                     //       db1.update("Items", contentValues, where1, new String[]{});
                        } while (cursor5.moveToNext());
                    }
                    cursor5.close();

                    final TextView balance = (TextView) dialog_cashout.findViewById(R.id.balance);
                    float x = Math.abs(cal_sale);
                    balance.setText(String.valueOf(x));

                    final TextInputLayout cashout_valid = (TextInputLayout) dialog_cashout.findViewById(R.id.cashout_valid);
                    final EditText cashout_value = (EditText) dialog_cashout.findViewById(R.id.cashout_value);

                    final EditText cashout_notes = (EditText) dialog_cashout.findViewById(R.id.cashout_notes);


                    final RadioButton mon = (RadioButton) dialog_cashout.findViewById(R.id.delayed);
                    final RadioButton pro = (RadioButton) dialog_cashout.findViewById(R.id.damage);
                    pro.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
//                            Toast.makeText(Customer_Info_Activity.this, "product11", Toast.LENGTH_SHORT).show();

                            final Dialog dialog = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                            dialog.setContentView(R.layout.dialog_deposit_itemselection);
                            dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialog.setCanceledOnTouchOutside(false);
                            dialog.show();

                            TextView rs = (TextView) dialog.findViewById(R.id.rs);
                            rs.setText(insert1_cc);

                            dialog.setOnKeyListener(new DialogInterface.OnKeyListener() {
                                @Override
                                public boolean onKey(DialogInterface dialogInterface, int i, KeyEvent keyEvent) {
                                    if (i == KeyEvent.KEYCODE_BACK){
                                        dialog.cancel();

                                        Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE checked = ''", null);
                                        if (cursor5.moveToFirst()) {
                                            do {
                                                String id = cursor5.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("print_value", "");
                                                String where1 = "_id = '" + id + "' ";
                                             //   db1.update("Items", contentValues, where1, new String[]{});

                                                String where1_v1 = "docid = '" + id + "'";
                                                db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Items")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                          //      db1.update("Items", contentValues, where1, new String[]{});
//                                            Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                            } while (cursor5.moveToNext());
                                        }
                                        cursor5.close();

                                        float sum_tot = 0;
                                        Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
                                        if (c5.moveToFirst()){
                                            do {
                                                String price = c5.getString(2);
                                                String quan = c5.getString(18);

                                                TextView tv = new TextView(Customer_Info_Activity.this);
                                                tv.setText(quan);

                                                if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")){

                                                }else {
                                                    float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                                    sum_tot = sum_tot+q;
                                                }
                                            }while (c5.moveToNext());
                                        }
                                        c5.close();

                                        if (sum_tot == 0 || sum_tot == 0.0){
//                                    Toast.makeText(Customer_Info_Activity.this, "0", Toast.LENGTH_LONG).show();
                                            pro.setChecked(false);
                                            mon.setChecked(true);
                                        }else {
                                            pro.setChecked(true);
                                            mon.setChecked(false);
                                        }
                                    }
                                    return false;
                                }
                            });

                            ImageButton cancel = (ImageButton) dialog.findViewById(R.id.btncancel);
                            cancel.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    dialog.dismiss();

                                    Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE checked = ''", null);
                                    if (cursor5.moveToFirst()) {
                                        do {
                                            String id = cursor5.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("print_value", "");
                                            String where1 = "_id = '" + id + "' ";
                                      //      db1.update("Items", contentValues, where1, new String[]{});

                                            String where1_v1 = "docid = '" + id + "'";
                                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                            getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Items")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                  //          db1.update("Items", contentValues, where1, new String[]{});
//                                        Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                        } while (cursor5.moveToNext());
                                    }
                                    cursor5.close();

                                    float sum_tot = 0;
                                    Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
                                    if (c5.moveToFirst()){
                                        do {
                                            String price = c5.getString(2);
                                            String quan = c5.getString(18);

                                            TextView tv = new TextView(Customer_Info_Activity.this);
                                            tv.setText(quan);

                                            if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")){

                                            }else {
                                                float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                                sum_tot = sum_tot+q;
                                            }
                                        }while (c5.moveToNext());
                                    }
                                    c5.close();

                                    if (sum_tot == 0 || sum_tot == 0.0){
//                                    Toast.makeText(Customer_Info_Activity.this, "0", Toast.LENGTH_LONG).show();
                                        pro.setChecked(false);
                                        mon.setChecked(true);
                                    }else {
                                        pro.setChecked(true);
                                        mon.setChecked(false);
                                    }
                                }
                            });

                            ListView myListView = (ListView) dialog.findViewById(R.id.list);

                            final TextView items_selected = (TextView) dialog.findViewById(R.id.itemname_selected);
                            final TextView quanity_selected = (TextView) dialog.findViewById(R.id.quantity_selected);
                            final TextView tot_amount = (TextView) dialog.findViewById(R.id.tot_amount);


                            Cursor cursor21 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            int cou1 = cursor21.getCount();

                            if (cou1 == 0){
                                items_selected.setText("0");
                            }else {
                                items_selected.setText(String.valueOf(cou1));
                            }

                            Cursor cursor31 = db1.rawQuery("SELECT SUM(print_value) FROM Items WHERE print_value != ''", null);
                            if (cursor31.moveToFirst()){
                                float dsirsq = cursor31.getFloat(0);
                                String rop = String.format("%.1f", dsirsq);
                                quanity_selected.setText(rop);
                            }
                            cursor31.close();


                            float sum_tot1 = 0;
                            Cursor c51 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            if (c51.moveToFirst()){
                                do {
                                    String price = c51.getString(2);
                                    String quan = c51.getString(18);

                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                    tv.setText(quan);

                                    if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")){

                                    }else {
                                        float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                        sum_tot1 = sum_tot1+q;
                                    }
                                }while (c51.moveToNext());
                            }
                            c51.close();

                            tot_amount.setText(String.valueOf(sum_tot1));

                            if (cashout_value.getText().toString().equals("")){
                                Cursor cursor51 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                if (cursor51.moveToFirst()) {
                                    do {
                                        String id = cursor51.getString(0);
                                        ContentValues contentValues = new ContentValues();
                                        contentValues.put("print_value", "");
                                        String where1 = "_id = '" + id + "' ";
                                  //      db1.update("Items", contentValues, where1, new String[]{});

                                        String where1_v1 = "docid = '" + id + "'";
                                        db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                        contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                        getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProviderApp.AUTHORITY)
                                                .path("Items")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);


                               //         db1.update("Items", contentValues, where1, new String[]{});
//                                        Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                    } while (cursor51.moveToNext());
                                }
                                cursor51.close();
                            }else {
//                            Toast.makeText(Customer_Info_Activity.this, "deposit_value "+deposit_value.getText().toString(), Toast.LENGTH_SHORT).show();
//                            Toast.makeText(Customer_Info_Activity.this, "sum_tot "+sum_tot1, Toast.LENGTH_SHORT).show();
                                if (Float.parseFloat(cashout_value.getText().toString()) == sum_tot1) {
//                                Toast.makeText(Customer_Info_Activity.this, "same", Toast.LENGTH_SHORT).show();
                                } else {
//                                Toast.makeText(Customer_Info_Activity.this, "not same", Toast.LENGTH_SHORT).show();
                                    Cursor cursor51 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                    if (cursor51.moveToFirst()) {
                                        do {
                                            String id = cursor51.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("print_value", "");
                                            String where1 = "_id = '" + id + "' ";
                                     //       db1.update("Items", contentValues, where1, new String[]{});

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                            getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Items")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);

//                                        Toast.makeText(Customer_Info_Activity.this, "updating", Toast.LENGTH_SHORT).show();
                                        } while (cursor51.moveToNext());
                                    }
                                    cursor51.close();
                                }
                            }


                            final Cursor cursor = db1.rawQuery("SELECT * FROM Items", null);
                            String[] fromFieldNames = {"itemname", "print_value"};
                            int[] toViewsID = {R.id.label, R.id.enter_value};
                            final SimpleCursorAdapter ddataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.row_with_number, cursor, fromFieldNames, toViewsID, 0);
                            myListView.setAdapter(ddataAdapterr);


                            final EditText myFilter = (EditText) dialog.findViewById(R.id.custombar_text);
                            myFilter.addTextChangedListener(new TextWatcher() {

                                public void afterTextChanged(Editable s) {
                                }

                                public void beforeTextChanged(CharSequence s, int start, int count, int after) {
                                }

                                public void onTextChanged(CharSequence s, int start, int before, int count) {
                                    ddataAdapterr.getFilter().filter(s.toString());
                                }
                            });

                            ddataAdapterr.setFilterQueryProvider(new FilterQueryProvider() {
                                public Cursor runQuery(CharSequence constraint) {
                                    return fetchCountriesByName1(constraint.toString());
                                }
                            });


                            Cursor cursor2 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            int cou = cursor2.getCount();

                            if (cou == 0){
                                items_selected.setText("0");
                            }else {
                                items_selected.setText(String.valueOf(cou));
                            }

                            Cursor cursor3 = db1.rawQuery("SELECT SUM(print_value) FROM Items WHERE print_value != ''", null);
                            if (cursor3.moveToFirst()){
                                float dsirsq = cursor3.getFloat(0);
                                String rop = String.format("%.1f", dsirsq);
                                quanity_selected.setText(rop);
                            }
                            cursor3.close();


                            float sum_tot = 0;
                            Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                            if (c5.moveToFirst()){
                                do {
                                    String price = c5.getString(2);
                                    String quan = c5.getString(18);

                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                    tv.setText(quan);

                                    if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")){

                                    }else {
                                        float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                        sum_tot = sum_tot+q;
                                    }
                                }while (c5.moveToNext());
                            }
                            c5.close();

                            tot_amount.setText(String.valueOf(sum_tot));

                            myListView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
                                @Override
                                public void onItemClick(AdapterView<?> parent, View view, final int position, long l) {
//                                final Country_deposit country = (Country_deposit) parent.getItemAtPosition(position);
//                                final String ingr_name = country.getName();
//
//                                final TextView tv = (TextView) view.findViewById(R.id.enter_value);

                                    final Cursor cursor1 = (Cursor) parent.getItemAtPosition(position);
                                    final String ingr_name = cursor1.getString(cursor1.getColumnIndex("itemname"));

                                    final TextView tv = (TextView) view.findViewById(R.id.enter_value);

//                                final CheckBox check = (CheckBox) view.findViewById(R.id.check);

                                    final Dialog dialog1 = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                    dialog1.setContentView(R.layout.dialog_deposit_noofquantity);
                                    dialog1.show();

                                    ImageButton btncancel = (ImageButton) dialog1.findViewById(R.id.btncancel);
                                    btncancel.setOnClickListener(new View.OnClickListener() {
                                        @Override
                                        public void onClick(View view) {
                                            dialog1.dismiss();
                                        }
                                    });

                                    TextView tv1 = (TextView) dialog1.findViewById(R.id.itemname);
                                    tv1.setText(ingr_name);

                                    final EditText tv2 = (EditText) dialog1.findViewById(R.id.editText1);
                                    tv2.setText(tv.getText().toString());

                                    tv2.requestFocus();

                                    InputMethodManager imm = (InputMethodManager) getSystemService(Context.INPUT_METHOD_SERVICE);
                                    imm.showSoftInput(tv2, InputMethodManager.SHOW_IMPLICIT);

                                    final TextInputLayout t = (TextInputLayout) dialog1.findViewById(R.id.layoutcatname_dialog);

                                    tv2.addTextChangedListener(new TextWatcher() {
                                        @Override
                                        public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                        }

                                        @Override
                                        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                            t.setError(null);
                                        }

                                        @Override
                                        public void afterTextChanged(Editable editable) {

                                        }
                                    });

                                    final Button save = (Button) dialog1.findViewById(R.id.btnsave);

                                    tv2.setOnEditorActionListener(new EditText.OnEditorActionListener() {
                                        @Override
                                        public boolean onEditorAction(TextView v, int actionId, KeyEvent event) {
                                            if (actionId == EditorInfo.IME_ACTION_GO) {
                                                save.performClick();
                                                return true;
                                            }
                                            return false;
                                        }
                                    });


                                    save.setOnClickListener(new View.OnClickListener() {
                                        @Override
                                        public void onClick(View view) {
                                            if (tv2.getText().toString().equals("")){
                                                t.setError("Enter valid no.");
                                            }else {
                                                Cursor cursor511 = db1.rawQuery("SELECT * FROM Items WHERE itemname = '" + ingr_name + "'", null);
                                                if (cursor511.moveToFirst()) {
                                                    do {
                                                        String pre_q = cursor511.getString(3);

                                                        if (Float.parseFloat(tv2.getText().toString()) > Float.parseFloat(pre_q)){
                                                            t.setError("Enter lesser than "+pre_q);
                                                        }else {
                                                            if (tv2.getText().toString().equals("0")){
                                                                Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE itemname = '" + ingr_name + "'", null);
                                                                if (cursor5.moveToFirst()) {
                                                                    do {
                                                                        String id = cursor5.getString(0);
                                                                        ContentValues contentValues = new ContentValues();
                                                                        contentValues.put("print_value", "");
                                                                        String where1 = "_id = '" + id + "' ";

                                                                        contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                                        getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                                                        resultUri = new Uri.Builder()
                                                                                .scheme("content")
                                                                                .authority(StubProviderApp.AUTHORITY)
                                                                                .path("Items")
                                                                                .appendQueryParameter("operation", "update")
                                                                                .appendQueryParameter("_id",id)
                                                                                .build();
                                                                        getContentResolver().notifyChange(resultUri, null);
                                                                        String where1_v1 = "docid = '" + id + "'";
                                                                        db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});


                                                                //        db1.update("Items", contentValues, where1, new String[]{});
                                                                    } while (cursor5.moveToNext());
                                                                }
                                                                cursor5.close();
                                                            }else {
                                                                Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE itemname = '" + ingr_name + "'", null);
                                                                if (cursor5.moveToFirst()) {
                                                                    do {
                                                                        String id = cursor5.getString(0);
                                                                        ContentValues contentValues = new ContentValues();
                                                                        contentValues.put("print_value", tv2.getText().toString());
                                                                        String where1 = "_id = '" + id + "' ";
                                                           //             db1.update("Items", contentValues, where1, new String[]{});


                                                                        contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                                        getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                                                        resultUri = new Uri.Builder()
                                                                                .scheme("content")
                                                                                .authority(StubProviderApp.AUTHORITY)
                                                                                .path("Items")
                                                                                .appendQueryParameter("operation", "update")
                                                                                .appendQueryParameter("_id",id)
                                                                                .build();
                                                                        getContentResolver().notifyChange(resultUri, null);

                                                                        String where1_v1 = "docid = '" + id + "'";
                                                                        db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});


                                                                  //      db1.update("Items", contentValues, where1, new String[]{});

                                                                    } while (cursor5.moveToNext());
                                                                }
                                                                cursor5.close();
                                                            }
                                                            dialog1.dismiss();

                                                            tv.setText(tv2.getText().toString());

                                                            cursor1.moveToPosition(position);
                                                            cursor1.requery();
                                                            ddataAdapterr.notifyDataSetChanged();

                                                            Cursor cursor2 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                                            int cou = cursor2.getCount();

                                                            if (cou == 0){
                                                                items_selected.setText("0");
                                                            }else {
                                                                items_selected.setText(String.valueOf(cou));
                                                            }

                                                            Cursor cursor3 = db1.rawQuery("SELECT SUM(print_value) FROM Items WHERE print_value != ''", null);
                                                            if (cursor3.moveToFirst()){
                                                                float dsirsq = cursor3.getFloat(0);
                                                                String rop = String.format("%.1f", dsirsq);
                                                                quanity_selected.setText(rop);
                                                            }
                                                            cursor3.close();

                                                            Cursor cursor4 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                                            int cou1 = cursor4.getCount();

                                                            float sum_tot = 0;
                                                            Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                                            if (c5.moveToFirst()){
                                                                do {
                                                                    String price = c5.getString(2);
                                                                    String quan = c5.getString(18);

                                                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                                                    tv.setText(quan);

                                                                    if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")){

                                                                    }else {
                                                                        float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                                                        sum_tot = sum_tot+q;
                                                                    }
                                                                }while (c5.moveToNext());
                                                            }
                                                            c5.close();

                                                            tot_amount.setText(String.valueOf(sum_tot));
                                                        }
                                                    } while (cursor511.moveToNext());
                                                }
                                                cursor511.close();


                                            }

                                        }
                                    });
                                }
                            });

                            ImageButton save_listview = (ImageButton) dialog.findViewById(R.id.btnsave);
                            save_listview.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    Cursor che = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
                                    if (che.moveToFirst()) {
                                        do {
                                            String id = che.getString(0);
                                            String bar = che.getString(18);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("checked", "checked");
                                            String where1 = "_id = '" + id + "' ";
                                     //       db1.update("Items", contentValues, where1, new String[]{});

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                            getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Items")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);

                                            String where1_v1 = "docid = '" + id + "'";
                                            db1.update("Items_Virtual", contentValues, where1_v1, new String[]{});

                                     //       db1.update("Items", contentValues, where1, new String[]{});

                                        } while (che.moveToNext());
                                    }
                                    che.close();
                                    dialog.dismiss();

                                    float sum_tot = 0;
                                    Cursor c5 = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
                                    if (c5.moveToFirst()){
                                        do {
                                            String price = c5.getString(2);
                                            String quan = c5.getString(18);

                                            TextView tv = new TextView(Customer_Info_Activity.this);
                                            tv.setText(quan);

                                            if (tv.getText().toString().equals("0") || tv.getText().toString().equals("") || tv.getText().toString().equals("-")){

                                            }else {
                                                float q = Float.parseFloat(price) * Float.parseFloat(quan);
                                                sum_tot = sum_tot+q;
                                            }
                                        }while (c5.moveToNext());
                                    }
                                    c5.close();

                                    if (sum_tot == 0 || sum_tot == 0.0){
//                                    Toast.makeText(Customer_Info_Activity.this, "0", Toast.LENGTH_LONG).show();
                                        pro.setChecked(false);
                                        mon.setChecked(true);
                                    }else {
                                        cashout_value.setText(String.valueOf(sum_tot));
                                        pro.setChecked(true);
                                        mon.setChecked(false);
                                    }
                                }
                            });

                        }
                    });

                    radioGroupWebsitecashout = (RadioGroup) dialog_cashout.findViewById(R.id.cashouttype);
                    radioGroupWebsitecashout.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {
                        @Override
                        public void onCheckedChanged(RadioGroup radioGroup, int i) {
                            final int selected = radioGroupWebsitecashout.getCheckedRadioButtonId();
                            radioBtncash = (RadioButton) dialog_cashout.findViewById(selected);
                        }
                    });

                    cashout_value.addTextChangedListener(new TextWatcher() {
                        @Override
                        public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                        }

                        @Override
                        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                            cashout_valid.setError(null);
                            pro.setChecked(false);
                            mon.setChecked(true);
                        }

                        @Override
                        public void afterTextChanged(Editable editable) {

                        }
                    });

                    ImageButton save = (ImageButton) dialog_cashout.findViewById(R.id.btnsave);
                    save.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            if (cashout_value.getText().toString().equals("") || cashout_value.getText().toString().equals("")) {
                                cashout_valid.setError("Enter valid number");
                            } else {
                                if (Float.parseFloat(cashout_value.getText().toString()) > Float.parseFloat(balance.getText().toString())){
                                    Toast.makeText(Customer_Info_Activity.this, "Enter lessthan balance", Toast.LENGTH_SHORT).show();
                                }else {
                                    final int selected = radioGroupWebsitecashout.getCheckedRadioButtonId();
                                    radioBtncash = (RadioButton) dialog_cashout.findViewById(selected);
                                    if (selected == -1) {
                                        Toast.makeText(Customer_Info_Activity.this, "Check anyone product or money", Toast.LENGTH_SHORT).show();
                                    } else {
                                        final Dialog dialog = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                        dialog.setContentView(R.layout.dialog_customer_management_deposit_cashout_warning);
                                        dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                                        dialog.show();

                                        TextView enter_amo_wa = (TextView) dialog.findViewById(R.id.enter_amo);
                                        enter_amo_wa.setText(cashout_value.getText().toString());

                                        final TextInputLayout pin_layout = (TextInputLayout) dialog.findViewById(R.id.pin_layout);

                                        final EditText enter_pint = (EditText) dialog.findViewById(R.id.pin_check);


                                        enter_pint.addTextChangedListener(new TextWatcher() {
                                            @Override
                                            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                            }

                                            @Override
                                            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                                pin_layout.setError(null);
                                            }

                                            @Override
                                            public void afterTextChanged(Editable editable) {

                                            }
                                        });

                                        Cursor pin = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                        if (pin.moveToFirst()){
                                            do {
                                                String pin1 = pin.getString(25);

                                                TextView tvb = new TextView(Customer_Info_Activity.this);
                                                tvb.setText(pin1);
                                                if (tvb.getText().toString().equals("on")){
                                                    pin_layout.setVisibility(View.VISIBLE);

                                                }else {
                                                    pin_layout.setVisibility(View.GONE);

                                                }
                                            }while (pin.moveToNext());
                                        }
                                        pin.close();

                                        ImageView close = (ImageView) dialog.findViewById(R.id.closetext);
                                        close.setOnClickListener(new View.OnClickListener() {
                                            @Override
                                            public void onClick(View view) {
                                                dialog.dismiss();
                                            }
                                        });

                                        Button cancel1 = (Button) dialog.findViewById(R.id.cancel);
                                        cancel1.setOnClickListener(new View.OnClickListener() {
                                            @Override
                                            public void onClick(View view) {
                                                dialog.dismiss();
                                            }
                                        });

                                        Button save = (Button) dialog.findViewById(R.id.ok);
                                        save.setOnClickListener(new View.OnClickListener() {
                                            @Override
                                            public void onClick(View view) {

                                                Cursor pin = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                                if (pin.moveToFirst()){
                                                    String pin1 = pin.getString(25);
                                                    String pin_get = pin.getString(15);

                                                    TextView tvb = new TextView(Customer_Info_Activity.this);
                                                    tvb.setText(pin1);
                                                    if (tvb.getText().toString().equals("on")){
                                                        if (enter_pint.getText().toString().equals("")){
                                                            pin_layout.setError("Enter 4 digit pin");
                                                        }else {

                                                            if (enter_pint.getText().toString().equals(pin_get)){
                                                                SimpleDateFormat sdf2 = new SimpleDateFormat("yyyy MM dd");
                                                                final String currentDateandTime1 = sdf2.format(new Date());

                                                                SimpleDateFormat sdf3 = new SimpleDateFormat("dd MMM yyyy");
                                                                final String currentDateandTime2 = sdf3.format(new Date());

                                                                Date dt = new Date();
                                                                SimpleDateFormat sdf1 = new SimpleDateFormat("hh:mm:ss aa");
                                                                final String time1 = sdf1.format(dt);

                                                                ContentValues contentValues = new ContentValues();
                                                                contentValues.put("name", cust_name.getText().toString());
                                                                contentValues.put("phoneno", pho_num.getText().toString());
                                                                contentValues.put("emailid", ema_add.getText().toString());
                                                                contentValues.put("address", add_r.getText().toString());
                                                                contentValues.put("pincode", pinc_r.getText().toString());
                                                                contentValues.put("cashout", cashout_value.getText().toString());
                                                                contentValues.put("deposit", "0");
                                                                contentValues.put("total_amount", "0");
                                                                contentValues.put("credit", "0");
                                                                contentValues.put("write_off", "0");
                                                                contentValues.put("charges", "0");
                                                                contentValues.put("refunds", "0");
                                                                contentValues.put("cashout_type", radioBtncash.getText().toString());
                                                                contentValues.put("date1", currentDateandTime2);
                                                                contentValues.put("time1", time1);
                                                                contentValues.put("date", currentDateandTime1);
                                                                contentValues.put("notes", cashout_notes.getText().toString());
                                                                Cursor c_tax = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                if (c_tax.moveToLast()){
                                                                    String tax1 = c_tax.getString(38);
                                                                    String tax2 = c_tax.getString(39);
                                                                    String tax3 = c_tax.getString(40);
                                                                    String tax4 = c_tax.getString(41);
                                                                    String tax5 = c_tax.getString(42);
                                                                    String tax6 = c_tax.getString(43);
                                                                    String tax7 = c_tax.getString(44);
                                                                    String tax8 = c_tax.getString(45);
                                                                    String tax9 = c_tax.getString(46);
                                                                    String tax10 = c_tax.getString(47);
                                                                    String tax11 = c_tax.getString(48);
                                                                    String tax12 = c_tax.getString(49);
                                                                    String tax13 = c_tax.getString(50);
                                                                    String tax14 = c_tax.getString(51);
                                                                    String tax15 = c_tax.getString(52);
                                                                    String tax_sele = c_tax.getString(53);
                                                                    String tax1_value = c_tax.getString(54);
                                                                    String tax2_value = c_tax.getString(55);
                                                                    String tax3_value = c_tax.getString(56);
                                                                    String tax4_value = c_tax.getString(57);
                                                                    String tax5_value = c_tax.getString(58);
                                                                    String tax6_value = c_tax.getString(59);
                                                                    String tax7_value = c_tax.getString(60);
                                                                    String tax8_value = c_tax.getString(61);
                                                                    String tax9_value = c_tax.getString(62);
                                                                    String tax10_value = c_tax.getString(63);
                                                                    String tax11_value = c_tax.getString(64);
                                                                    String tax12_value = c_tax.getString(65);
                                                                    String tax13_value = c_tax.getString(66);
                                                                    String tax14_value = c_tax.getString(67);
                                                                    String tax15_value = c_tax.getString(68);

                                                                    String proc = c_tax.getString(69);
                                                                    String lim_st = c_tax.getString(80);
                                                                    String lim_val = c_tax.getString(81);
                                                                    String lim_pre_val = c_tax.getString(82);

                                                                    contentValues.put("tax1", tax1);
                                                                    contentValues.put("tax2", tax2);
                                                                    contentValues.put("tax3", tax3);
                                                                    contentValues.put("tax4", tax4);
                                                                    contentValues.put("tax5", tax5);
                                                                    contentValues.put("tax6", tax6);
                                                                    contentValues.put("tax7", tax7);
                                                                    contentValues.put("tax8", tax8);
                                                                    contentValues.put("tax9", tax9);
                                                                    contentValues.put("tax10", tax10);
                                                                    contentValues.put("tax11", tax11);
                                                                    contentValues.put("tax12", tax12);
                                                                    contentValues.put("tax13", tax13);
                                                                    contentValues.put("tax14", tax14);
                                                                    contentValues.put("tax15", tax15);
                                                                    contentValues.put("tax_selection", tax_sele);
                                                                    contentValues.put("tax1_value", tax1_value);
                                                                    contentValues.put("tax2_value", tax2_value);
                                                                    contentValues.put("tax3_value", tax3_value);
                                                                    contentValues.put("tax4_value", tax4_value);
                                                                    contentValues.put("tax5_value", tax5_value);
                                                                    contentValues.put("tax6_value", tax6_value);
                                                                    contentValues.put("tax7_value", tax7_value);
                                                                    contentValues.put("tax8_value", tax8_value);
                                                                    contentValues.put("tax9_value", tax9_value);
                                                                    contentValues.put("tax10_value", tax10_value);
                                                                    contentValues.put("tax11_value", tax11_value);
                                                                    contentValues.put("tax12_value", tax12_value);
                                                                    contentValues.put("tax13_value", tax13_value);
                                                                    contentValues.put("tax14_value", tax14_value);
                                                                    contentValues.put("tax15_value", tax15_value);

                                                                    contentValues.put("proceedings", proc);
                                                                    contentValues.put("limit_status", lim_st);
                                                                    contentValues.put("limit_value", lim_val);
                                                                    contentValues.put("limit_present_value", lim_pre_val);

                                                                }
                                                                c_tax.close();


                                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                resultUri = getContentResolver().insert(contentUri, contentValues);
                                                                getContentResolver().notifyChange(resultUri, null);

                                                        //        db.insert("Customerdetails", null, contentValues);
                                                                dialog.dismiss();
                                                                dialog_cashout.dismiss();


                                                                Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                if (cursor1.moveToFirst()) {
                                                                    String pin5 = cursor1.getString(15);
                                                                    String dob = cursor1.getString(17);
                                                                    String cre_def = cursor1.getString(21);
                                                                    String pin_statu = cursor1.getString(25);
                                                                    String dob_alarm = cursor1.getString(26);
                                                                    String dis_sta = cursor1.getString(27);
                                                                    String dis_amou = cursor1.getString(28);
                                                                    String dis_val = cursor1.getString(29);
                                                                    String dis_typ = cursor1.getString(30);
                                                                    String usr_id = cursor1.getString(37);
                                                                    Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                    if (cursor11.moveToFirst()){
                                                                        do {
                                                                            String id = cursor11.getString(0);
                                                                            ContentValues contentValues5 = new ContentValues();
                                                                            contentValues5.put("authentication_pin", pin5);
                                                                            contentValues5.put("dob", dob);
                                                                            contentValues5.put("user_id", usr_id);
                                                                            contentValues5.put("credit_default", cre_def);
                                                                            contentValues5.put("authentication_pin_status", pin_statu);
                                                                            contentValues5.put("dob_alaram", dob_alarm);
                                                                            contentValues5.put("default_discount_status", dis_sta);
                                                                            contentValues5.put("default_discount_amount", dis_amou);
                                                                            contentValues5.put("default_discount_value", dis_val);
                                                                            contentValues5.put("default_discount_type", dis_typ);
                                                                            String where = "_id = '" + id + "'";



                                                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                            getContentResolver().update(contentUri, contentValues5,where,new String[]{});
                                                                            resultUri = new Uri.Builder()
                                                                                    .scheme("content")
                                                                                    .authority(StubProvider.AUTHORITY)
                                                                                    .path("Customerdetails")
                                                                                    .appendQueryParameter("operation", "update")
                                                                                    .appendQueryParameter("_id",id)
                                                                                    .build();
                                                                            getContentResolver().notifyChange(resultUri, null);

                                                                            Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                                                                            if (set21w.moveToFirst()){
                                                                                dis_val = set21w.getString(29);
                                                                                dis_status = set21w.getString(27);
                                                                                dis_ty = set21w.getString(30);

                                                                                TextView one = new TextView(Customer_Info_Activity.this);
                                                                                one.setText(dis_val);

                                                                                TextView two = new TextView(Customer_Info_Activity.this);
                                                                                two.setText(dis_ty);

                                                                                if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                                                                    disc_val_def.setText("0");
                                                                                }else {
                                                                                    disc_val_def.setText(dis_val);
                                                                                }
                                                                                if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                                                                    disc_per_def.setText("%");
                                                                                }else {
                                                                                    disc_per_def.setText(dis_ty);
                                                                                }

                                                                            }
                                                                            set21w.close();


                                                              //              db.update("Customerdetails", contentValues5, where, new String[]{});
                                                                        }while (cursor11.moveToNext());
                                                                    }
                                                                    cursor11.close();

                                                                }
                                                                cursor1.close();

                                                                Cursor return_items = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
                                                                if (return_items.moveToFirst()){
                                                                    do {
                                                                        String id = return_items.getString(0);
                                                                        String pre_qu = return_items.getString(3);
                                                                        String add = return_items.getString(18);

                                                                        float a = Float.parseFloat(pre_qu) - Float.parseFloat(add);

                                                                        ContentValues con = new ContentValues();
                                                                        con.put("stockquan", String.valueOf(a));
                                                                        String where = "_id = '" + id + "'";
                                                                   //     db1.update("Items", con, where, new String[]{});

                                                                        contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                                        getContentResolver().update(contentUri, con,where,new String[]{});
                                                                        resultUri = new Uri.Builder()
                                                                                .scheme("content")
                                                                                .authority(StubProviderApp.AUTHORITY)
                                                                                .path("Items")
                                                                                .appendQueryParameter("operation", "update")
                                                                                .appendQueryParameter("_id",id)
                                                                                .build();
                                                                        getContentResolver().notifyChange(resultUri, null);

                                                                        String where1_v1 = "docid = '" + id + "'";
                                                                        db1.update("Items_Virtual", con, where1_v1, new String[]{});



                                                                    }while (return_items.moveToNext());
                                                                }
                                                                return_items.close();


                                                                TextView total_sales = (TextView) findViewById(R.id.sale_value);

                                                                Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                                                if (cursor_sales.moveToFirst()) {
                                                                    float dsirsq = cursor_sales.getFloat(0);
                                                                    String rop = String.format("%.1f", dsirsq);
                                                                    total_sales.setText(rop);
                                                                }
                                                                cursor_sales.close();


                                                                TextView total_credit = (TextView) findViewById(R.id.credit_value);

                                                                Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                                                if (cursor_credit.moveToFirst()) {
                                                                    float dsirsq = cursor_credit.getFloat(0);
                                                                    String rop = String.format("%.1f", dsirsq);
                                                                    total_credit.setText(rop);
                                                                }
                                                                cursor_credit.close();


                                                                ListView listView = (ListView) findViewById(R.id.listView);

//                                                                Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY _id DESC", null);
//                                                                String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                                                                // the XML defined views which the data will be bound to
//                                                                int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                                                                Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                                                Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                                                                listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                                                final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
                                                                if (cursor_country1.moveToFirst()){
                                                                    str_country = cursor_country1.getString(1);
                                                                }
                                                                Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
                                                                String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
                                                                // the XML defined views which the data will be bound to
                                                                int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                                                                Log.e("Checamos que hay id", String.valueOf(R.id.name));
                                                                final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
//                                                                listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error
                                                                dataAdapterr.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                                                    @Override
                                                                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                                                        if (view.getId() == R.id.rs_sale1 || view.getId() == R.id.rs_credit1 || view.getId() == R.id.rs_refunds_val || view.getId() == R.id.rs_charges_val || view.getId() == R.id.rs_deposits_val || view.getId() == R.id.rs_write_off_val || view.getId() == R.id.rs_cashout_val) {
                                                                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                                                            TextView dateTextView = (TextView) view;
                                                                            if (tadl_id.toString().equals("India") || tadl_id.toString().equals("Rupee")){
                                                                                dateTextView.setText(insert1_cc);
                                                                            }else {
                                                                                dateTextView.setText(insert1_cc);
                                                                            }
                                                                            return true;
                                                                        }
                                                                        return false;
                                                                    }
                                                                });
                                                                listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                                                Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                                if (sales_t.moveToFirst()){
                                                                    dsirsq1 = sales_t.getFloat(0);
                                                                }
                                                                sales_t.close();

                                                                Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                                if (credit_t.moveToFirst()){
                                                                    dsirsq2 = credit_t.getFloat(0);
                                                                }
                                                                credit_t.close();

                                                                Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                                if (deposi_t.moveToFirst()){
                                                                    dsirsq3 = deposi_t.getFloat(0);
                                                                }
                                                                deposi_t.close();

                                                                Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                                if (cashout_t.moveToFirst()){
                                                                    dsirsq4 = cashout_t.getFloat(0);
                                                                }
                                                                cashout_t.close();

                                                                Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                                if (write_off_t.moveToFirst()){
                                                                    dsirsq5 = write_off_t.getFloat(0);
                                                                }
                                                                write_off_t.close();

                                                                final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

                                                                TextView total_balance = (TextView) findViewById(R.id.total_balance);
                                                                total_balance.setText(String.format("%.1f", cal_sale));

                                                                LinearLayout cashout_product = (LinearLayout) findViewById(R.id.cashout_product);
                                                                LinearLayout cashout_money = (LinearLayout) findViewById(R.id.cashout_money);

                                                                TextView cashout_product_total = (TextView) findViewById(R.id.item_value);
                                                                Cursor cursor_product_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Product/Items' ", null);
                                                                if (cursor_product_total.moveToFirst()){
                                                                    cashout_product.setVisibility(View.VISIBLE);
                                                                    float dsirsq = cursor_product_total.getFloat(0);
                                                                    String rop = String.format("%.1f", dsirsq);
                                                                    cashout_product_total.setText(rop);
                                                                }else {
                                                                    cashout_product.setVisibility(View.GONE);
                                                                }
                                                                cursor_product_total.close();


                                                                TextView cashout_money_total = (TextView) findViewById(R.id.money_value);
                                                                Cursor cursor_money_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Money' ", null);
                                                                if (cursor_money_total.moveToFirst()){
                                                                    cashout_money.setVisibility(View.VISIBLE);
                                                                    float dsirsq = cursor_money_total.getFloat(0);
                                                                    String rop = String.format("%.1f", dsirsq);
                                                                    cashout_money_total.setText(rop);
                                                                }else {
                                                                    cashout_money.setVisibility(View.GONE);
                                                                }
                                                                cursor_money_total.close();
                                                            }else {
                                                                pin_layout.setError("Incorrect pin");
                                                            }

                                                        }

                                                    }else {
                                                        SimpleDateFormat sdf2 = new SimpleDateFormat("yyyy MM dd");
                                                        final String currentDateandTime1 = sdf2.format(new Date());

                                                        SimpleDateFormat sdf3 = new SimpleDateFormat("dd MMM yyyy");
                                                        final String currentDateandTime2 = sdf3.format(new Date());

                                                        Date dt = new Date();
                                                        SimpleDateFormat sdf1 = new SimpleDateFormat("hh:mm:ss aa");
                                                        final String time1 = sdf1.format(dt);

                                                        ContentValues contentValues = new ContentValues();
                                                        contentValues.put("name", cust_name.getText().toString());
                                                        contentValues.put("phoneno", pho_num.getText().toString());
                                                        contentValues.put("emailid", ema_add.getText().toString());
                                                        contentValues.put("address", add_r.getText().toString());
                                                        contentValues.put("pincode", pinc_r.getText().toString());
                                                        contentValues.put("cashout", cashout_value.getText().toString());
                                                        contentValues.put("deposit", "0");
                                                        contentValues.put("total_amount", "0");
                                                        contentValues.put("credit", "0");
                                                        contentValues.put("write_off", "0");
                                                        contentValues.put("charges", "0");
                                                        contentValues.put("refunds", "0");
                                                        contentValues.put("cashout_type", radioBtncash.getText().toString());
                                                        contentValues.put("date1", currentDateandTime2);
                                                        contentValues.put("time1", time1);
                                                        contentValues.put("date", currentDateandTime1);
                                                        contentValues.put("notes", cashout_notes.getText().toString());
                                                        Cursor c_tax = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                        if (c_tax.moveToLast()){
                                                            String tax1 = c_tax.getString(38);
                                                            String tax2 = c_tax.getString(39);
                                                            String tax3 = c_tax.getString(40);
                                                            String tax4 = c_tax.getString(41);
                                                            String tax5 = c_tax.getString(42);
                                                            String tax6 = c_tax.getString(43);
                                                            String tax7 = c_tax.getString(44);
                                                            String tax8 = c_tax.getString(45);
                                                            String tax9 = c_tax.getString(46);
                                                            String tax10 = c_tax.getString(47);
                                                            String tax11 = c_tax.getString(48);
                                                            String tax12 = c_tax.getString(49);
                                                            String tax13 = c_tax.getString(50);
                                                            String tax14 = c_tax.getString(51);
                                                            String tax15 = c_tax.getString(52);
                                                            String tax_sele = c_tax.getString(53);
                                                            String tax1_value = c_tax.getString(54);
                                                            String tax2_value = c_tax.getString(55);
                                                            String tax3_value = c_tax.getString(56);
                                                            String tax4_value = c_tax.getString(57);
                                                            String tax5_value = c_tax.getString(58);
                                                            String tax6_value = c_tax.getString(59);
                                                            String tax7_value = c_tax.getString(60);
                                                            String tax8_value = c_tax.getString(61);
                                                            String tax9_value = c_tax.getString(62);
                                                            String tax10_value = c_tax.getString(63);
                                                            String tax11_value = c_tax.getString(64);
                                                            String tax12_value = c_tax.getString(65);
                                                            String tax13_value = c_tax.getString(66);
                                                            String tax14_value = c_tax.getString(67);
                                                            String tax15_value = c_tax.getString(68);

                                                            String proc = c_tax.getString(69);
                                                            String lim_st = c_tax.getString(80);
                                                            String lim_val = c_tax.getString(81);
                                                            String lim_pre_val = c_tax.getString(82);

                                                            contentValues.put("tax1", tax1);
                                                            contentValues.put("tax2", tax2);
                                                            contentValues.put("tax3", tax3);
                                                            contentValues.put("tax4", tax4);
                                                            contentValues.put("tax5", tax5);
                                                            contentValues.put("tax6", tax6);
                                                            contentValues.put("tax7", tax7);
                                                            contentValues.put("tax8", tax8);
                                                            contentValues.put("tax9", tax9);
                                                            contentValues.put("tax10", tax10);
                                                            contentValues.put("tax11", tax11);
                                                            contentValues.put("tax12", tax12);
                                                            contentValues.put("tax13", tax13);
                                                            contentValues.put("tax14", tax14);
                                                            contentValues.put("tax15", tax15);
                                                            contentValues.put("tax_selection", tax_sele);
                                                            contentValues.put("tax1_value", tax1_value);
                                                            contentValues.put("tax2_value", tax2_value);
                                                            contentValues.put("tax3_value", tax3_value);
                                                            contentValues.put("tax4_value", tax4_value);
                                                            contentValues.put("tax5_value", tax5_value);
                                                            contentValues.put("tax6_value", tax6_value);
                                                            contentValues.put("tax7_value", tax7_value);
                                                            contentValues.put("tax8_value", tax8_value);
                                                            contentValues.put("tax9_value", tax9_value);
                                                            contentValues.put("tax10_value", tax10_value);
                                                            contentValues.put("tax11_value", tax11_value);
                                                            contentValues.put("tax12_value", tax12_value);
                                                            contentValues.put("tax13_value", tax13_value);
                                                            contentValues.put("tax14_value", tax14_value);
                                                            contentValues.put("tax15_value", tax15_value);

                                                            contentValues.put("proceedings", proc);
                                                            contentValues.put("limit_status", lim_st);
                                                            contentValues.put("limit_value", lim_val);
                                                            contentValues.put("limit_present_value", lim_pre_val);

                                                        }
                                                        c_tax.close();

                                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                        resultUri = getContentResolver().insert(contentUri, contentValues);
                                                        getContentResolver().notifyChange(resultUri, null);


                                            //            db.insert("Customerdetails", null, contentValues);
                                                        dialog.dismiss();
                                                        dialog_cashout.dismiss();


                                                        Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                        if (cursor1.moveToFirst()) {
                                                            String pin5 = cursor1.getString(15);
                                                            String dob = cursor1.getString(17);
                                                            String cre_def = cursor1.getString(21);
                                                            String pin_statu = cursor1.getString(25);
                                                            String dob_alarm = cursor1.getString(26);
                                                            String dis_sta = cursor1.getString(27);
                                                            String dis_amou = cursor1.getString(28);
                                                            String dis_val = cursor1.getString(29);
                                                            String dis_typ = cursor1.getString(30);
                                                            String usr_id = cursor1.getString(37);
                                                            Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                            if (cursor11.moveToFirst()){
                                                                do {
                                                                    String id = cursor11.getString(0);
                                                                    ContentValues contentValues5 = new ContentValues();
                                                                    contentValues5.put("authentication_pin", pin5);
                                                                    contentValues5.put("dob", dob);
                                                                    contentValues5.put("user_id", usr_id);
                                                                    contentValues5.put("credit_default", cre_def);
                                                                    contentValues5.put("authentication_pin_status", pin_statu);
                                                                    contentValues5.put("dob_alaram", dob_alarm);
                                                                    contentValues5.put("default_discount_status", dis_sta);
                                                                    contentValues5.put("default_discount_amount", dis_amou);
                                                                    contentValues5.put("default_discount_value", dis_val);
                                                                    contentValues5.put("default_discount_type", dis_typ);
                                                                    String where = "_id = '" + id + "'";



                                                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                    getContentResolver().update(contentUri, contentValues5,where,new String[]{});
                                                                    resultUri = new Uri.Builder()
                                                                            .scheme("content")
                                                                            .authority(StubProvider.AUTHORITY)
                                                                            .path("Customerdetails")
                                                                            .appendQueryParameter("operation", "update")
                                                                            .appendQueryParameter("_id",id)
                                                                            .build();
                                                                    getContentResolver().notifyChange(resultUri, null);

                                                                    Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                                                                    if (set21w.moveToFirst()){
                                                                        dis_val = set21w.getString(29);
                                                                        dis_status = set21w.getString(27);
                                                                        dis_ty = set21w.getString(30);

                                                                        TextView one = new TextView(Customer_Info_Activity.this);
                                                                        one.setText(dis_val);

                                                                        TextView two = new TextView(Customer_Info_Activity.this);
                                                                        two.setText(dis_ty);

                                                                        if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                                                            disc_val_def.setText("0");
                                                                        }else {
                                                                            disc_val_def.setText(dis_val);
                                                                        }
                                                                        if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                                                            disc_per_def.setText("%");
                                                                        }else {
                                                                            disc_per_def.setText(dis_ty);
                                                                        }

                                                                    }
                                                                    set21w.close();


                                                             //       db.update("Customerdetails", contentValues5, where, new String[]{});
                                                                }while (cursor11.moveToNext());
                                                            }
                                                            cursor11.close();

                                                        }
                                                        cursor1.close();

                                                        Cursor return_items = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
                                                        if (return_items.moveToFirst()){
                                                            do {
                                                                String id = return_items.getString(0);
                                                                String pre_qu = return_items.getString(3);
                                                                String add = return_items.getString(18);

                                                                float a = Float.parseFloat(pre_qu) - Float.parseFloat(add);

                                                                ContentValues con = new ContentValues();
                                                                con.put("stockquan", String.valueOf(a));
                                                                String where = "_id = '" + id + "'";

                                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                                                                getContentResolver().update(contentUri, con,where,new String[]{});
                                                                resultUri = new Uri.Builder()
                                                                        .scheme("content")
                                                                        .authority(StubProviderApp.AUTHORITY)
                                                                        .path("Items")
                                                                        .appendQueryParameter("operation", "update")
                                                                        .appendQueryParameter("_id",id)
                                                                        .build();
                                                                getContentResolver().notifyChange(resultUri, null);
                                                                String where1_v1 = "docid = '" + id + "'";
                                                                db1.update("Items_Virtual", con, where1_v1, new String[]{});


                                                //                db1.update("Items", con, where, new String[]{});
                                                            }while (return_items.moveToNext());
                                                        }
                                                        return_items.close();

                                                        TextView total_sales = (TextView) findViewById(R.id.sale_value);

                                                        Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                                        if (cursor_sales.moveToFirst()) {
                                                            float dsirsq = cursor_sales.getFloat(0);
                                                            String rop = String.format("%.1f", dsirsq);
                                                            total_sales.setText(rop);
                                                        }
                                                        cursor_sales.close();


                                                        TextView total_credit = (TextView) findViewById(R.id.credit_value);

                                                        Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                                        if (cursor_credit.moveToFirst()) {
                                                            float dsirsq = cursor_credit.getFloat(0);
                                                            String rop = String.format("%.1f", dsirsq);
                                                            total_credit.setText(rop);
                                                        }
                                                        cursor_credit.close();

                                                        ListView listView = (ListView) findViewById(R.id.listView);

                                                        final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
                                                        if (cursor_country1.moveToFirst()){
                                                            str_country = cursor_country1.getString(1);
                                                        }

//                                                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY _id DESC", null);
//                                                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                                                        // the XML defined views which the data will be bound to
//                                                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                                                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                                        Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                                                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
                                                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
                                                        // the XML defined views which the data will be bound to
                                                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                                                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
                                                        final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
                                                        dataAdapterr.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                                            @Override
                                                            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                                                if (view.getId() == R.id.rs_sale1 || view.getId() == R.id.rs_credit1 || view.getId() == R.id.rs_refunds_val || view.getId() == R.id.rs_charges_val || view.getId() == R.id.rs_deposits_val || view.getId() == R.id.rs_write_off_val || view.getId() == R.id.rs_cashout_val) {
                                                                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                                                    TextView dateTextView = (TextView) view;
                                                                    if (tadl_id.toString().equals("India")){
                                                                        dateTextView.setText(insert1_cc);
                                                                    }else {
                                                                        dateTextView.setText(insert1_cc);
                                                                    }
                                                                    return true;
                                                                }
                                                                return false;
                                                            }
                                                        });
                                                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                                        Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                        if (sales_t.moveToFirst()){
                                                            dsirsq1 = sales_t.getFloat(0);
                                                        }
                                                        sales_t.close();

                                                        Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                        if (credit_t.moveToFirst()){
                                                            dsirsq2 = credit_t.getFloat(0);
                                                        }
                                                        credit_t.close();

                                                        Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                        if (deposi_t.moveToFirst()){
                                                            dsirsq3 = deposi_t.getFloat(0);
                                                        }
                                                        deposi_t.close();

                                                        Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                        if (cashout_t.moveToFirst()){
                                                            dsirsq4 = cashout_t.getFloat(0);
                                                        }
                                                        cashout_t.close();

                                                        Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
                                                        if (write_off_t.moveToFirst()){
                                                            dsirsq5 = write_off_t.getFloat(0);
                                                        }
                                                        write_off_t.close();

                                                        final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

                                                        TextView total_balance = (TextView) findViewById(R.id.total_balance);
                                                        total_balance.setText(String.format("%.1f", cal_sale));

                                                        LinearLayout cashout_product = (LinearLayout) findViewById(R.id.cashout_product);
                                                        LinearLayout cashout_money = (LinearLayout) findViewById(R.id.cashout_money);

                                                        TextView cashout_product_total = (TextView) findViewById(R.id.item_value);
                                                        Cursor cursor_product_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Product/Items' ", null);
                                                        if (cursor_product_total.moveToFirst()){
                                                            cashout_product.setVisibility(View.VISIBLE);
                                                            float dsirsq = cursor_product_total.getFloat(0);
                                                            String rop = String.format("%.1f", dsirsq);
                                                            cashout_product_total.setText(rop);
                                                        }else {
                                                            cashout_product.setVisibility(View.GONE);
                                                        }
                                                        cursor_product_total.close();

                                                        TextView cashout_money_total = (TextView) findViewById(R.id.money_value);
                                                        Cursor cursor_money_total = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' AND cashout_type = 'Money' ", null);
                                                        if (cursor_money_total.moveToFirst()){
                                                            cashout_money.setVisibility(View.VISIBLE);
                                                            float dsirsq = cursor_money_total.getFloat(0);
                                                            String rop = String.format("%.1f", dsirsq);
                                                            cashout_money_total.setText(rop);
                                                        }else {
                                                            cashout_money.setVisibility(View.GONE);
                                                        }
                                                        cursor_money_total.close();
                                                    }
                                                }
                                                pin.close();

                                            }
                                        });
                                    }
                                }

                            }
                        }
                    });
                }
            }
        });



        LinearLayout settings_button = (LinearLayout) findViewById(R.id.settings_but);
        settings_button.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {
                final Dialog dialog_settings = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                dialog_settings.setContentView(R.layout.dialog_customer_management_settings);
                dialog_settings.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                dialog_settings.show();

                ImageButton cancel = (ImageButton) dialog_settings.findViewById(R.id.btncancel);
                cancel.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        dialog_settings.dismiss();
                    }
                });

                ImageButton save = (ImageButton) dialog_settings.findViewById(R.id.btnsave);
                save.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        dialog_settings.dismiss();
                    }
                });


                TextView nameds = (TextView) dialog_settings.findViewById(R.id.customer_name);
                nameds.setText(cust_name.getText().toString());
                final Switch mySwitch = (Switch) dialog_settings.findViewById(R.id.mySwitch);

                Cursor switch_check = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (switch_check.moveToFirst()){
                    ch_swit = switch_check.getString(21);
                }
                switch_check.close();

                TextView tvg = new TextView(Customer_Info_Activity.this);
                tvg.setText(ch_swit);

                if (tvg.getText().toString().equals("on")){
                    mySwitch.setChecked(true);
                }else {
                    mySwitch.setChecked(false);
                }

                mySwitch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                    @Override
                    public void onCheckedChanged(CompoundButton compoundButton, boolean isChecked) {
                        if (isChecked) {
//                            Toast.makeText(Customer_Info_Activity.this, "Checked", Toast.LENGTH_SHORT).show();
                            Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                            if (cursor.moveToFirst()){
                                String name = cursor.getString(2);
                                do {
                                    ContentValues newValues = new ContentValues();
                                    newValues.put("credit_default", "on");
                                    String where = "phoneno = '" + name + "'";



                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                    getContentResolver().update(contentUri, newValues,where,new String[]{});
                                    resultUri = new Uri.Builder()
                                            .scheme("content")
                                            .authority(StubProvider.AUTHORITY)
                                            .path("Customerdetails")
                                            .appendQueryParameter("operation", "update")
                                            .appendQueryParameter("phoneno",name)
                                            .build();
                                    getContentResolver().notifyChange(resultUri, null);



                          //          db.update("Customerdetails", newValues, where, new String[]{});
                                }while (cursor.moveToNext());
                            }
                            cursor.close();
                        } else {
//                            Toast.makeText(Customer_Info_Activity.this, "not checked", Toast.LENGTH_SHORT).show();
                            Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                            if (cursor.moveToFirst()){
                                String name = cursor.getString(2);
                                do {
                                    ContentValues newValues = new ContentValues();
                                    newValues.put("credit_default", "off");
                                    String where = "phoneno = '" + name + "'";


                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                    getContentResolver().update(contentUri, newValues,where,new String[]{});
                                    resultUri = new Uri.Builder()
                                            .scheme("content")
                                            .authority(StubProvider.AUTHORITY)
                                            .path("Customerdetails")
                                            .appendQueryParameter("operation", "update")
                                            .appendQueryParameter("phoneno",name)
                                            .build();
                                    getContentResolver().notifyChange(resultUri, null);


                            //        db.update("Customerdetails", newValues, where, new String[]{});
                                }while (cursor.moveToNext());
                            }
                            cursor.close();
                        }
                    }
                });



                String last_id = "", lim_sta = "", lim_val = "", lim_pre_val = "0";

                Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString() + "'", null);
                if (c.moveToLast()) {
                    last_id = c.getString(0);
                    lim_sta = c.getString(80);
                    lim_val = c.getString(81);
                    lim_pre_val = c.getString(82);
                }

                final TextView limit_status = (TextView) dialog_settings.findViewById(R.id.limit_status);
                final TextView limit_value = (TextView) dialog_settings.findViewById(R.id.limit_value);
                final TextView present_limit = (TextView) dialog_settings.findViewById(R.id.present_limit);

                limit_status.setText(lim_sta);
                limit_value.setText(lim_val);
                present_limit.setText(lim_pre_val);

                if (present_limit.getText().toString().equals("")){
                    lim_pre_val = lim_val;
                    present_limit.setText(lim_val);
                }

                LinearLayout pay_later_limit = (LinearLayout) dialog_settings.findViewById(R.id.pay_later_limit);
                final String finalLast_id = last_id;
                final String finalLim_val = lim_val;
                final String finalLim_pre_val = lim_pre_val;
                pay_later_limit.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        final Dialog dialogspl = new Dialog(Customer_Info_Activity.this, R.style.notitle);
                        dialogspl.setContentView(R.layout.dialog_pay_later_limit);
                        dialogspl.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                        dialogspl.show();

                        TextView inn = (TextView) dialogspl.findViewById(R.id.inn);
                        inn.setText(insert1_rs);

                        ImageView closesp = (ImageView) dialogspl.findViewById(R.id.closetext);
                        closesp.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View v) {
//                                dialogspl.dismiss();
                                credit_sms_limit(limit_value.getText().toString(), present_limit.getText().toString());
                            }
                        });

                        Button closesp1 = (Button) dialogspl.findViewById(R.id.splitcancel);
                        closesp1.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View v) {
                                dialogspl.dismiss();
                            }
                        });

                        final RadioGroup radioGroupSplit = (RadioGroup) dialogspl.findViewById(R.id.splitgroup);

                        final RadioButton limit_nolimit = (RadioButton) dialogspl.findViewById(R.id.limit_nolimit);
                        final RadioButton limit_limit = (RadioButton) dialogspl.findViewById(R.id.limit_limit);

                        final LinearLayout edittextthree = (LinearLayout) dialogspl.findViewById(R.id.edittextthree);

                        final EditText limit_value_edit = (EditText) dialogspl.findViewById(R.id.limit_value_edit);
                        limit_value_edit.setText(finalLim_val);

                        if (limit_status.getText().toString().equalsIgnoreCase("limit")){
                            limit_limit.setChecked(true);
                            limit_nolimit.setChecked(false);
                            edittextthree.setVisibility(View.VISIBLE);
                        }else {
                            limit_limit.setChecked(false);
                            limit_nolimit.setChecked(true);
                        }



                        Button apply = (Button) dialogspl.findViewById(R.id.splitapply);
                        apply.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View v) {
                                final int selected1 = radioGroupSplit.getCheckedRadioButtonId();
                                RadioButton radioBtnSplit = (RadioButton) dialogspl.findViewById(selected1);

                                final RadioButton limit_nolimit = (RadioButton) dialogspl.findViewById(R.id.limit_nolimit);
                                final RadioButton limit_limit = (RadioButton) dialogspl.findViewById(R.id.limit_limit);

                                if (limit_nolimit.isChecked()) {
//                                    limit_no_limit();
                                    limit_status.setText("No Limit");
                                    limit_value.setText("");
                                    dialogspl.dismiss();

                                    String where = "_id = '" + finalLast_id + "' ";

                                    ContentValues contentValues = new ContentValues();
                                    contentValues.put("limit_status", "no limit");
                                    contentValues.put("limit_value", "");


                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                    getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                    resultUri = new Uri.Builder()
                                            .scheme("content")
                                            .authority(StubProvider.AUTHORITY)
                                            .path("Customerdetails")
                                            .appendQueryParameter("operation", "update")
                                            .appendQueryParameter("_id",finalLast_id)
                                            .build();
                                    getContentResolver().notifyChange(resultUri, null);

                                }else {
                                    if (limit_limit.isChecked()) {
                                        if (!limit_value_edit.getText().toString().equals("")) {
//                                        limit_yes_limit();
                                            limit_status.setText("limit");
                                            limit_value.setText(limit_value_edit.getText().toString());
                                            dialogspl.dismiss();

                                            String where = "_id = '" + finalLast_id + "' ";


                                            TextView tv = new TextView(Customer_Info_Activity.this);
                                            tv.setText(finalLim_val);

                                            if (tv.getText().toString().equals("infinity") || tv.getText().toString().equals("")) {
                                                if (total_balance.getText().toString().equals("")) {
                                                    present_limit.setText(limit_value_edit.getText().toString());

                                                    ContentValues contentValues = new ContentValues();
                                                    contentValues.put("limit_value", limit_value_edit.getText().toString());
                                                    contentValues.put("limit_present_value", limit_value_edit.getText().toString());
                                                    contentValues.put("limit_status", "limit");

                                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                    getContentResolver().update(contentUri, contentValues, where, new String[]{});
                                                    resultUri = new Uri.Builder()
                                                            .scheme("content")
                                                            .authority(StubProvider.AUTHORITY)
                                                            .path("Customerdetails")
                                                            .appendQueryParameter("operation", "update")
                                                            .appendQueryParameter("_id", finalLast_id)
                                                            .build();
                                                    getContentResolver().notifyChange(resultUri, null);
                                                }else {
                                                    float nw = Float.parseFloat(limit_value_edit.getText().toString()) - Float.parseFloat(total_balance.getText().toString());
                                                    present_limit.setText(String.format("%.2f", nw));

                                                    ContentValues contentValues = new ContentValues();
                                                    contentValues.put("limit_value", limit_value_edit.getText().toString());
                                                    contentValues.put("limit_present_value", String.format("%.2f", nw));
                                                    contentValues.put("limit_status", "limit");

                                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                    getContentResolver().update(contentUri, contentValues, where, new String[]{});
                                                    resultUri = new Uri.Builder()
                                                            .scheme("content")
                                                            .authority(StubProvider.AUTHORITY)
                                                            .path("Customerdetails")
                                                            .appendQueryParameter("operation", "update")
                                                            .appendQueryParameter("_id", finalLast_id)
                                                            .build();
                                                    getContentResolver().notifyChange(resultUri, null);
                                                }

                                            } else {

                                                TextView tv1 = new TextView(Customer_Info_Activity.this);
                                                tv1.setText(finalLim_val);

                                                float nw1 = 0;
                                                if (tv1.getText().toString().equals("")) {
                                                    float nw = Float.parseFloat(limit_value_edit.getText().toString()) - Float.parseFloat(total_balance.getText().toString());
                                                    nw1 = nw + Float.parseFloat(finalLim_pre_val);
                                                    present_limit.setText(String.format("%.2f", nw1));
                                                }else {
                                                    float nw = Float.parseFloat(limit_value_edit.getText().toString()) - Float.parseFloat(finalLim_val);
                                                    nw1 = nw + Float.parseFloat(finalLim_pre_val);
                                                    present_limit.setText(String.format("%.2f", nw1));
                                                }

                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("limit_value", limit_value_edit.getText().toString());
                                                contentValues.put("limit_present_value", String.format("%.2f", nw1));
                                                contentValues.put("limit_status", "limit");

                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                getContentResolver().update(contentUri, contentValues, where, new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProvider.AUTHORITY)
                                                        .path("Customerdetails")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id", finalLast_id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);
                                            }


                                        } else {
                                            limit_value_edit.setError("Enter value");
                                        }
                                    }
                                }
                                if (!limit_nolimit.isChecked() && !limit_limit.isChecked()) {
//                                    dialogspl.dismiss();
                                    Toast.makeText(Customer_Info_Activity.this, "Select limit", Toast.LENGTH_LONG).show();
                                }
                            }
                        });

                        radioGroupSplit.setOnCheckedChangeListener(new RadioGroup.OnCheckedChangeListener() {
                            @Override
                            public void onCheckedChanged(RadioGroup group, int checkedId) {
                                final int selected1 = radioGroupSplit.getCheckedRadioButtonId();
                                if (selected1 == limit_nolimit.getId()) {
                                    edittextthree.setVisibility(View.GONE);
                                }else {
                                    edittextthree.setVisibility(View.VISIBLE);
                                }
                            }
                        });
                    }
                });



                final TextView comm_status = (TextView) dialog_settings.findViewById(R.id.comm_status);
                final TextView comm_value = (TextView) dialog_settings.findViewById(R.id.comm_value);

                Cursor vf1 = db.rawQuery("SELECT * FROM Customerdetails_temporary WHERE phoneno = '"+pho_num.getText().toString() + "'", null);
                if (vf1.moveToFirst()){
                    String commission_charges1 = vf1.getString(1);
                    String commission_charges_status1 = vf1.getString(2);
                    String commission_charges_type1 = vf1.getString(3);

                    comm_status.setText(commission_charges_status1);
                    if (commission_charges_type1.toString().equals("%")){
                        comm_value.setText(commission_charges1+"%");
                    }else {
                        comm_value.setText(insert1_rs+" "+commission_charges1);
                    }

                }
                vf1.close();

                LinearLayout commission_charges = (LinearLayout) dialog_settings.findViewById(R.id.commission_charges);
                commission_charges.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        final Dialog dialog_commission_charges = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                        dialog_commission_charges.setContentView(R.layout.dialog_customer_management_settings_charges);
                        dialog_commission_charges.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                        dialog_commission_charges.show();

                        Button cancel = (Button) dialog_commission_charges.findViewById(R.id.cancel);
                        cancel.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                dialog_commission_charges.dismiss();
                            }
                        });

                        final TextInputLayout commission_charges_valid = (TextInputLayout) dialog_commission_charges.findViewById(R.id.commission_charges_valid);
                        final EditText commission_charges_value = (EditText) dialog_commission_charges.findViewById(R.id.commission_charges_value);

                        final Switch mySwitch = (Switch) dialog_commission_charges.findViewById(R.id.mySwitch);
                        mySwitch.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                            @Override
                            public void onCheckedChanged(CompoundButton compoundButton, boolean isChecked) {
                                if (isChecked) {
                                    mySwitch.setChecked(true);
                                }else {
                                    mySwitch.setChecked(false);
                                }
                            }
                        });

                        final Spinner rs_per = (Spinner) dialog_commission_charges.findViewById(R.id.rspercent1);

                        ArrayList<String> my_array = new ArrayList<String>();
                        my_array.add("%");
                        my_array.add(insert1_cc);
                        final ArrayAdapter my_Adapterr1 = new ArrayAdapter(Customer_Info_Activity.this, R.layout.spinner_row,
                                my_array);
                        rs_per.setAdapter(my_Adapterr1);

                        commission_charges_value.addTextChangedListener(new TextWatcher() {
                            @Override
                            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                            }

                            @Override
                            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                commission_charges_valid.setError(null);
                            }

                            @Override
                            public void afterTextChanged(Editable editable) {

                            }
                        });

                        Cursor vf = db.rawQuery("SELECT * FROM Customerdetails_temporary WHERE phoneno = '"+pho_num.getText().toString() + "'", null);
                        if (vf.moveToFirst()){
                            String commission_charges1 = vf.getString(1);
                            String commission_charges_status1 = vf.getString(2);
                            String commission_charges_type1 = vf.getString(3);
                            String phoneno1 = vf.getString(4);
                            String name1 = vf.getString(5);

                            commission_charges_value.setText(commission_charges1);
                            if (commission_charges_status1.toString().equals("off")){
                                mySwitch.setChecked(false);
                            }else {
                                mySwitch.setChecked(true);
                            }
                            if (commission_charges_type1.toString().equals("%")){
                                rs_per.setSelection(0);
                            }else {
                                rs_per.setSelection(1);
                            }
                        }
                        vf.close();


                        Button save = (Button) dialog_commission_charges.findViewById(R.id.savetime);
                        save.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                if (commission_charges_value.getText().toString().equals("") || commission_charges_value.getText().toString().equals("")){
                                    commission_charges_value.setError("Enter valid number");
                                }else {

                                    Cursor c = db.rawQuery("SELECT * FROM Customerdetails_temporary WHERE phoneno = '"+pho_num.getText().toString() + "'", null);
                                    if (c.moveToFirst()){
                                        do {
                                            String _id = c.getString(0);
                                            String where = "_id = '" + _id + "' ";

                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails_temporary");
                                            getContentResolver().delete(contentUri, where,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProvider.AUTHORITY)
                                                    .path("Customerdetails_temporary")
                                                    .appendQueryParameter("operation", "delete")
                                                    .appendQueryParameter("_id", _id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);



                                     //       db.delete("Customerdetails_temporary", where, new String[]{});
                                        }while (c.moveToNext());
                                    }
                                    c.close();

                                    if (mySwitch.isChecked()){
                                        Object position1 = rs_per.getSelectedItem();
                                        if (position1.equals("%")) {
//                                            Toast.makeText(Customer_Info_Activity.this, "Sleced %", Toast.LENGTH_SHORT).show();
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("commission_charges", commission_charges_value.getText().toString());
                                            contentValues.put("commission_charges_type", "%");
                                            contentValues.put("commission_charges_status", "on");
                                            contentValues.put("name", cust_name.getText().toString());
                                            contentValues.put("phoneno", pho_num.getText().toString());

                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails_temporary");
                                            resultUri = getContentResolver().insert(contentUri, contentValues);
                                            getContentResolver().notifyChange(resultUri, null);


                                    //        db.insert("Customerdetails_temporary", null, contentValues);
                                            dialog_commission_charges.dismiss();
                                            comm_status.setText("on");
                                            comm_value.setText(commission_charges_value.getText().toString()+"%");
                                        }else {
//                                            Toast.makeText(Customer_Info_Activity.this, "Sleced rs", Toast.LENGTH_SHORT).show();
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("commission_charges", commission_charges_value.getText().toString());
                                            contentValues.put("commission_charges_type", position1.toString());
                                            contentValues.put("commission_charges_status", "on");
                                            contentValues.put("name", cust_name.getText().toString());
                                            contentValues.put("phoneno", pho_num.getText().toString());



                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails_temporary");
                                            resultUri = getContentResolver().insert(contentUri, contentValues);
                                            getContentResolver().notifyChange(resultUri, null);


                              //              db.insert("Customerdetails_temporary", null, contentValues);
                                            dialog_commission_charges.dismiss();
                                            comm_status.setText("on");
                                            comm_value.setText(insert1_rs+" "+commission_charges_value.getText().toString());
                                        }
                                    }else {
                                        Object position1 = rs_per.getSelectedItem();
                                        if (position1.equals("%")) {
//                                            Toast.makeText(Customer_Info_Activity.this, "Sleced %", Toast.LENGTH_SHORT).show();
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("commission_charges", commission_charges_value.getText().toString());
                                            contentValues.put("commission_charges_type", "%");
                                            contentValues.put("commission_charges_status", "off");
                                            contentValues.put("name", cust_name.getText().toString());
                                            contentValues.put("phoneno", pho_num.getText().toString());


                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails_temporary");
                                            resultUri = getContentResolver().insert(contentUri, contentValues);
                                            getContentResolver().notifyChange(resultUri, null);



                                       //     db.insert("Customerdetails_temporary", null, contentValues);
                                            dialog_commission_charges.dismiss();
                                            comm_status.setText("off");
                                            comm_value.setText(commission_charges_value.getText().toString()+"%");
                                        }else {
//                                            Toast.makeText(Customer_Info_Activity.this, "Sleced rs", Toast.LENGTH_SHORT).show();
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("commission_charges", commission_charges_value.getText().toString());
                                            contentValues.put("commission_charges_type", position1.toString());
                                            contentValues.put("commission_charges_status", "off");
                                            contentValues.put("name", cust_name.getText().toString());
                                            contentValues.put("phoneno", pho_num.getText().toString());



                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails_temporary");
                                            resultUri = getContentResolver().insert(contentUri, contentValues);
                                            getContentResolver().notifyChange(resultUri, null);



                                     //       db.insert("Customerdetails_temporary", null, contentValues);
                                            dialog_commission_charges.dismiss();
                                            comm_status.setText("off");
                                            comm_value.setText(insert1_rs+" "+commission_charges_value.getText().toString());
                                        }
                                    }

                                }
                            }
                        });

                    }
                });

                final TextView auth_pin_status = (TextView) dialog_settings.findViewById(R.id.auth_pin_status);
                final TextView auth_pin_set_notset = (TextView) dialog_settings.findViewById(R.id.auth_pin_set_notset);

                final TextView tv = new TextView(Customer_Info_Activity.this);
                final TextView tv1 = new TextView(Customer_Info_Activity.this);

                Cursor set11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (set11.moveToFirst()){
                    do {
                        String status = set11.getString(25);
                        String set1 = set11.getString(15);

                        tv.setText(set1);
                        if (tv.getText().toString().equals("")){
                            auth_pin_set_notset.setText("not set");
                        }else {
                            auth_pin_set_notset.setText("set");
                        }

                        tv1.setText(status);
                        if (tv1.getText().toString().equals("") || tv1.getText().toString().equals("off")){
                            auth_pin_status.setText("off");
                        }else {
                            auth_pin_status.setText("on");
                        }
                    }while (set11.moveToNext());
                }
                set11.close();

                LinearLayout auth_pin = (LinearLayout) dialog_settings.findViewById(R.id.auth_pin);
                auth_pin.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {

                        TextView tv5 = new TextView(Customer_Info_Activity.this);
                        Cursor set21 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                        if (set21.moveToFirst()){
                            do {
                                String status = set21.getString(25);
                                String set1 = set21.getString(15);
                                tv5.setText(set1);
                            }while (set21.moveToNext());
                        }
                        set21.close();

                        if (tv5.getText().toString().equals("")) {
                            final Dialog dialog_auth_pin = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                            dialog_auth_pin.setContentView(R.layout.dialog_customer_management_authenticate_pin);
                            dialog_auth_pin.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialog_auth_pin.show();

                            Button cancel = (Button) dialog_auth_pin.findViewById(R.id.cancel);
                            cancel.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    dialog_auth_pin.dismiss();
                                }
                            });

                            final TextInputLayout pin1 = (TextInputLayout) dialog_auth_pin.findViewById(R.id.pin1);
                            final TextInputLayout pin2 = (TextInputLayout) dialog_auth_pin.findViewById(R.id.pin2);
                            final EditText enterpin = (EditText) dialog_auth_pin.findViewById(R.id.enterpin);
                            final EditText confirmpin = (EditText) dialog_auth_pin.findViewById(R.id.confirmpin);

                            final Switch mw = (Switch) dialog_auth_pin.findViewById(R.id.mySwitch);

                            Button save = (Button) dialog_auth_pin.findViewById(R.id.savetime);


                            enterpin.addTextChangedListener(new TextWatcher() {
                                @Override
                                public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                }

                                @Override
                                public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                    pin1.setError(null);
                                }

                                @Override
                                public void afterTextChanged(Editable editable) {

                                }
                            });

                            confirmpin.addTextChangedListener(new TextWatcher() {
                                @Override
                                public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                }

                                @Override
                                public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                    pin2.setError(null);
                                }

                                @Override
                                public void afterTextChanged(Editable editable) {

                                }
                            });


                            save.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    if (enterpin.getText().toString().equals("") || enterpin.getText().length() < 4 ||
                                            confirmpin.getText().toString().equals("") || confirmpin.getText().length() < 4) {
                                        if (enterpin.getText().toString().equals("") || enterpin.getText().length() < 4) {
                                            pin1.setError("Enter valid number");
                                        }
                                        if (confirmpin.getText().toString().equals("") || confirmpin.getText().length() < 4) {
                                            pin2.setError("Enter valid number");
                                        }
                                    } else {
                                        if (confirmpin.getText().toString().equals(enterpin.getText().toString())) {
                                            Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                            if (cursor.moveToFirst()) {
                                                String phon = cursor.getString(2);
                                                String email = cursor.getString(3);
                                                TextView tv = new TextView(Customer_Info_Activity.this);
                                                tv.setText(phon);
                                                TextView tv1 = new TextView(Customer_Info_Activity.this);
                                                tv1.setText(email);
                                                if (tv.getText().toString().equals("") || tv1.getText().toString().equals("")) {
                                                    final Dialog dialog_phone_edit = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                                    dialog_phone_edit.setContentView(R.layout.dialog_customer_management_authenticate_pin_phone_email);
                                                    dialog_phone_edit.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                                                    dialog_phone_edit.show();

                                                    Button cancel = (Button) dialog_phone_edit.findViewById(R.id.cancel);
                                                    cancel.setOnClickListener(new View.OnClickListener() {
                                                        @Override
                                                        public void onClick(View view) {
                                                            dialog_phone_edit.dismiss();
                                                        }
                                                    });

                                                    final TextInputLayout email1 = (TextInputLayout) dialog_phone_edit.findViewById(R.id.email1);
                                                    final TextInputLayout email2 = (TextInputLayout) dialog_phone_edit.findViewById(R.id.conf_email1);

                                                    final EditText enter_email = (EditText) dialog_phone_edit.findViewById(R.id.enter_email);
                                                    final EditText confirm_enter_email = (EditText) dialog_phone_edit.findViewById(R.id.confirm_enter_email);

                                                    Button save = (Button) dialog_phone_edit.findViewById(R.id.savetime);
                                                    save.setOnClickListener(new View.OnClickListener() {
                                                        @Override
                                                        public void onClick(View view) {
                                                            if (enter_email.getText().toString().equals("") | confirm_enter_email.getText().toString().equals("")) {
                                                                if (enter_email.getText().toString().equals("")) {
                                                                    email1.setError("Enter valid email id");
                                                                }
                                                                if (confirm_enter_email.getText().toString().equals("")) {
                                                                    email2.setError("Enter valid email id");
                                                                }
                                                            } else {
                                                                if (!confirm_enter_email.getText().toString().equals(enter_email.getText().toString())) {
                                                                    if (!confirm_enter_email.getText().toString().equals(enter_email.getText().toString())) {
                                                                        email2.setError("Email-id not matching");
                                                                    }
                                                                } else {
                                                                    //everything is same update the database with phone and email
                                                                    Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                    if (cursor11.moveToFirst()) {
                                                                        do {
                                                                            String id = cursor11.getString(0);
                                                                            ContentValues contentValues = new ContentValues();
                                                                            contentValues.put("emailid", enter_email.getText().toString());
                                                                            String where = "_id = '" + id + "'";


                                                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                            getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                                            resultUri = new Uri.Builder()
                                                                                    .scheme("content")
                                                                                    .authority(StubProvider.AUTHORITY)
                                                                                    .path("Customerdetails")
                                                                                    .appendQueryParameter("operation", "update")
                                                                                    .appendQueryParameter("_id",id)
                                                                                    .build();
                                                                            getContentResolver().notifyChange(resultUri, null);



                                                                     //       db.update("Customerdetails", contentValues, where, new String[]{});
                                                                            dialog_phone_edit.dismiss();
                                                                            dialog_auth_pin.dismiss();
                                                                        }
                                                                        while (cursor11.moveToNext());
                                                                    }
                                                                    cursor11.close();

                                                                    Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                    if (cursor1.moveToFirst()) {
                                                                        do {
                                                                            String id = cursor1.getString(0);
                                                                            ContentValues contentValues = new ContentValues();
                                                                            contentValues.put("authentication_pin", enterpin.getText().toString());
                                                                            if (mw.isChecked()) {
                                                                                contentValues.put("authentication_pin_status", "on");
                                                                            } else {
                                                                                contentValues.put("authentication_pin_status", "off");
//                                                                                Toast.makeText(Customer_Info_Activity.this, "off1", Toast.LENGTH_SHORT).show();
                                                                            }
                                                                            String where = "_id = '" + id + "'";


                                                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                            getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                                            resultUri = new Uri.Builder()
                                                                                    .scheme("content")
                                                                                    .authority(StubProvider.AUTHORITY)
                                                                                    .path("Customerdetails")
                                                                                    .appendQueryParameter("operation", "update")
                                                                                    .appendQueryParameter("_id",id)
                                                                                    .build();
                                                                            getContentResolver().notifyChange(resultUri, null);


                                                                  //          db.update("Customerdetails", contentValues, where, new String[]{});
                                                                            dialog_auth_pin.dismiss();
                                                                        } while (cursor1.moveToNext());
                                                                    }
                                                                    cursor1.close();
                                                                    auth_pin_set_notset.setText("set");
                                                                    if (mw.isChecked()){
                                                                        auth_pin_status.setText("on");
                                                                    }else {
                                                                        auth_pin_status.setText("off");
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    });

                                                    enter_email.addTextChangedListener(new TextWatcher() {
                                                        @Override
                                                        public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                                        }

                                                        @Override
                                                        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                                            email1.setError(null);
                                                        }

                                                        @Override
                                                        public void afterTextChanged(Editable editable) {

                                                        }
                                                    });
                                                    confirm_enter_email.addTextChangedListener(new TextWatcher() {
                                                        @Override
                                                        public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                                        }

                                                        @Override
                                                        public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                                            email2.setError(null);
                                                        }

                                                        @Override
                                                        public void afterTextChanged(Editable editable) {

                                                        }
                                                    });


                                                } else {
                                                    Toast.makeText(Customer_Info_Activity.this, "Pin successfull", Toast.LENGTH_SHORT).show();
                                                    ///save pin along with on or off
                                                    Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                    if (cursor1.moveToFirst()) {
                                                        do {
                                                            String id = cursor1.getString(0);
                                                            ContentValues contentValues = new ContentValues();
                                                            contentValues.put("authentication_pin", enterpin.getText().toString());
                                                            if (mw.isChecked()) {
                                                                contentValues.put("authentication_pin_status", "on");
                                                            } else {
                                                                contentValues.put("authentication_pin_status", "off");
//                                                                Toast.makeText(Customer_Info_Activity.this, "off2", Toast.LENGTH_SHORT).show();
                                                            }
                                                            String where = "_id = '" + id + "'";




                                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                            getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                            resultUri = new Uri.Builder()
                                                                    .scheme("content")
                                                                    .authority(StubProvider.AUTHORITY)
                                                                    .path("Customerdetails")
                                                                    .appendQueryParameter("operation", "update")
                                                                    .appendQueryParameter("_id",id)
                                                                    .build();
                                                            getContentResolver().notifyChange(resultUri, null);


                                                     //       db.update("Customerdetails", contentValues, where, new String[]{});
                                                            dialog_auth_pin.dismiss();
                                                        } while (cursor1.moveToNext());
                                                    }
                                                    cursor1.close();
                                                    auth_pin_set_notset.setText("set");
                                                    if (mw.isChecked()){
                                                        auth_pin_status.setText("on");
                                                    }else {
                                                        auth_pin_status.setText("off");
                                                    }
                                                }
                                            }
                                            cursor.close();
                                        } else {
                                            pin2.setError("Pin not matching");
                                        }
                                    }
                                }
                            });
                        }else {
                            final Dialog dialog_auth_pin_edit = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                            dialog_auth_pin_edit.setContentView(R.layout.dialog_customer_management_authenticate_pin_edit);
                            dialog_auth_pin_edit.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                            dialog_auth_pin_edit.show();

                            Button cancel = (Button) dialog_auth_pin_edit.findViewById(R.id.cancel);
                            cancel.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    dialog_auth_pin_edit.dismiss();
                                }
                            });

                            Switch msd = (Switch) dialog_auth_pin_edit.findViewById(R.id.mySwitch);
                            Cursor set = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                            if (set.moveToFirst()){
                                do {
                                    String status = set.getString(25);
                                    String set1 = set.getString(15);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                                    tv3.setText(status);
                                    if (tv3.getText().toString().equals("on")){
                                        msd.setChecked(true);
                                    }else {
                                        msd.setChecked(false);
                                    }

                                }while (set.moveToNext());
                            }
                            set.close();

                            msd.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                                @Override
                                public void onCheckedChanged(CompoundButton compoundButton, boolean isChecked) {
                                    if (isChecked){
                                        auth_pin_status.setText("on");

                                        Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                        if (cursor1.moveToFirst()) {
                                            do {
                                                String id = cursor1.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("authentication_pin_status", "on");
                                                String where = "_id = '" + id + "'";



                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProvider.AUTHORITY)
                                                        .path("Customerdetails")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);



                                       //         db.update("Customerdetails", contentValues, where, new String[]{});
                                            } while (cursor1.moveToNext());
                                        }
                                        cursor1.close();

                                    }else {
                                        auth_pin_status.setText("off");

                                        Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                        if (cursor1.moveToFirst()) {
                                            do {
                                                String id = cursor1.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("authentication_pin_status", "off");
//                                                Toast.makeText(Customer_Info_Activity.this, "off3", Toast.LENGTH_SHORT).show();
                                                String where = "_id = '" + id + "'";



                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProvider.AUTHORITY)
                                                        .path("Customerdetails")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);



                                           //     db.update("Customerdetails", contentValues, where, new String[]{});
                                            } while (cursor1.moveToNext());
                                        }
                                        cursor1.close();
                                    }
                                }
                            });


                            final RelativeLayout phoneno_valid_layout = (RelativeLayout) dialog_auth_pin_edit.findViewById(R.id.phoneno_valid_layout);
                            final RelativeLayout otp_valid_layout = (RelativeLayout) dialog_auth_pin_edit.findViewById(R.id.otp_valid_layout);

                            final TextInputLayout first_six = (TextInputLayout) dialog_auth_pin_edit.findViewById(R.id.first_six);
                            final TextInputLayout four_opt = (TextInputLayout) dialog_auth_pin_edit.findViewById(R.id.four_opt);

                            final EditText enter_phone_num = (EditText) dialog_auth_pin_edit.findViewById(R.id.enter_phone_num);
                            final EditText enter_otp = (EditText) dialog_auth_pin_edit.findViewById(R.id.enter_otp);

                            enter_phone_num.addTextChangedListener(new TextWatcher() {
                                @Override
                                public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                }

                                @Override
                                public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                    first_six.setError(null);
                                }

                                @Override
                                public void afterTextChanged(Editable editable) {

                                }
                            });
                            enter_otp.addTextChangedListener(new TextWatcher() {
                                @Override
                                public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                }

                                @Override
                                public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                    four_opt.setError(null);
                                }

                                @Override
                                public void afterTextChanged(Editable editable) {

                                }
                            });

                            Button forgot_pin = (Button) dialog_auth_pin_edit.findViewById(R.id.forgot_pin);
                            forgot_pin.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    phoneno_valid_layout.setVisibility(View.VISIBLE);
                                    enter_phone_num.setText("");
                                }
                            });

                            final TextView last_four = (TextView) dialog_auth_pin_edit.findViewById(R.id.last_four);
                            Cursor last_four_no = db.rawQuery("SElECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                            if (last_four_no.moveToFirst()){
                                String str = pho_num.getText().toString();
                                String substring = str.length() > 4 ? str.substring(str.length() - 4) : str;
                                last_four.setText(substring);
                            }
                            last_four_no.close();

                            Button phoneno_valid = (Button) dialog_auth_pin_edit.findViewById(R.id.phoneno_valid);
                            phoneno_valid.setOnClickListener(new View.OnClickListener() {
                                @Override
                                public void onClick(View view) {
                                    String con = enter_phone_num.getText().toString()+""+last_four.getText().toString();

                                    Cursor last_four_no = db.rawQuery("SElECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                    if (last_four_no.moveToFirst()){
                                        String ph = last_four_no.getString(2);
                                        String ema_send = last_four_no.getString(3);

                                        if (enter_phone_num.getText().toString().equals("") || enter_phone_num.getText().toString().length()<6){
                                            first_six.setError("Enter valid number");
                                        }else {
                                            if (ph.equals(con)) {
                                                otp_valid_layout.setVisibility(View.VISIBLE);

                                                Date dt = new Date();
                                                SimpleDateFormat sdf1 = new SimpleDateFormat("mmss");
                                                time1 = sdf1.format(dt);
//                                                Toast.makeText(Customer_Info_Activity.this, "otp is " + time1, Toast.LENGTH_SHORT).show();


//                                                String url = "www.intuitionsoftwares.com";
//
//                                                String msg = "OTP is "+time1+"Powered by: " + Uri.parse(url);
//
//                                                final Intent emailIntent = new Intent(Intent.ACTION_SEND_MULTIPLE);
//                                                emailIntent.setType("plain/text");
//                                                emailIntent.putExtra(android.content.Intent.EXTRA_EMAIL,
//                                                        new String[]{});
//                                                emailIntent.putExtra(android.content.Intent.EXTRA_CC,
//                                                        new String[]{});
//                                                emailIntent.putExtra(Intent.EXTRA_SUBJECT, "HI");
//                                                emailIntent.putExtra(Intent.EXTRA_TEXT, msg);
//
//                                                startActivity(Intent.createChooser(emailIntent, "Send mail..."));

//                                                String fromEmail = ((TextView) findViewById(R.id.editText1))
//                                                        .getText().toString();
//                                                String fromPassword = ((TextView) findViewById(R.id.editText2))
//                                                        .getText().toString();
//                                                String emailSubject = ((TextView) findViewById(R.id.editText4))
//                                                        .getText().toString();
//                                                String emailBody = ((TextView) findViewById(R.id.editText5))
//                                                        .getText().toString();

                                                String toEmails = ema_send;
                                                List toEmailList = Arrays.asList(toEmails
                                                        .split("\\s*,\\s*"));


                                                Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
                                                if (getcom.moveToFirst()) {
                                                    do {
                                                        strcompanyname = getcom.getString(1);
                                                    } while (getcom.moveToNext());
                                                }else {
                                                    strcompanyname = "";
                                                }
                                                getcom.close();

                                                Cursor cursore = db1.rawQuery("SELECT * FROM Email_setup", null);
                                                if (cursore.moveToFirst()){
//
                                                    Cursor cursor = db1.rawQuery("SELECT * FROM Email_setup", null);
                                                    if (cursor.moveToFirst()) {
                                                        String un = cursor.getString(1);
                                                        String pwd = cursor.getString(2);
                                                        String em_ca = cursor.getString(3);
                                                        if (em_ca.toString().equals("Gmail")) {
                                                            getResultsFromApi();
                                                            new MakeRequestTask(mCredential).execute();
//                                                        new SendMailTask(Customer_Info_Activity.this).execute(un,
//                                                                pwd, toEmailList, strcompanyname, "OTP is " + time1);
                                                        }else {
                                                            if (em_ca.toString().equals("Yahoo")) {
//                                                            Toast.makeText(Customer_Info_Activity.this, "Yahoo", Toast.LENGTH_LONG).show();
                                                                new SendMailTask_Yahoo(Customer_Info_Activity.this).execute(un,
                                                                        pwd, toEmailList, strcompanyname, "OTP is " + time1);
                                                            }else {
                                                                if (em_ca.toString().equals("Hotmail")) {
//                                                                Toast.makeText(Customer_Info_Activity.this, "Hotmail", Toast.LENGTH_LONG).show();
                                                                    new SendMailTask_Hotmail(Customer_Info_Activity.this).execute(un,
                                                                            pwd, toEmailList, strcompanyname, "OTP is " + time1);
                                                                }else {
                                                                    if (em_ca.toString().equals("Office365")) {
//                                                                    Toast.makeText(Customer_Info_Activity.this, "Outlook", Toast.LENGTH_LONG).show();
                                                                        new SendMailTask_Outlook(Customer_Info_Activity.this).execute(un,
                                                                                pwd, toEmailList, strcompanyname, "OTP is " + time1);
                                                                    }
                                                                }
                                                            }
                                                        }
                                                    }else {
//                                                            Toast.makeText(Customer_Info_Activity.this, "Email is not configured", Toast.LENGTH_LONG).show();
                                                    }
                                                    cursor.close();

                                                }else {
                                                    //only sender not there recipient not required
                                                    final Dialog dialoge = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                                    dialoge.setContentView(R.layout.email_prerequisites);
                                                    dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_ADJUST_RESIZE);
                                                    dialoge.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                                                    dialoge.show();

                                                    ImageButton btncancel = (ImageButton) dialoge.findViewById(R.id.btncancel);
                                                    btncancel.setOnClickListener(new View.OnClickListener() {
                                                        @Override
                                                        public void onClick(View v) {
                                                            dialoge.dismiss();
                                                        }
                                                    });

                                                    ImageView recipient_notset = (ImageView) dialoge.findViewById(R.id.recipient_notset);
                                                    ImageView recipient_set = (ImageView) dialoge.findViewById(R.id.recipient_set);

                                                    ImageView sender_notset = (ImageView) dialoge.findViewById(R.id.sender_notset);
                                                    ImageView sender_set = (ImageView) dialoge.findViewById(R.id.sender_set);

                                                    LinearLayout recipient_layout = (LinearLayout) dialoge.findViewById(R.id.recipient_layout);
                                                    recipient_layout.setVisibility(View.GONE);

                                                    sender_notset.setVisibility(View.VISIBLE);

                                                    recipient_set.setVisibility(View.VISIBLE);

                                                    Button gotosettings = (Button) dialoge.findViewById(R.id.gotosettings);
                                                    gotosettings.setVisibility(View.GONE);
                                                    gotosettings.setOnClickListener(new View.OnClickListener() {
                                                        @Override
                                                        public void onClick(View v) {
                                                            Intent intent = new Intent(Customer_Info_Activity.this, EmailSetup.class);
                                                            intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                                            startActivity(intent);
//                                                                getActivity().finish();
                                                            dialoge.dismiss();
                                                        }
                                                    });

                                                    Button gotosettings1 = (Button) dialoge.findViewById(R.id.gotosettings1);
                                                    gotosettings1.setOnClickListener(new View.OnClickListener() {
                                                        @Override
                                                        public void onClick(View v) {
                                                            Intent intent = new Intent(Customer_Info_Activity.this, EmailSetup.class);
                                                            intent.addFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
                                                            startActivity(intent);
//                                                                getActivity().finish();
                                                            dialoge.dismiss();
                                                        }
                                                    });
                                                }
                                                cursore.close();


                                                TelephonyManager tm = (TelephonyManager) getSystemService(Context.TELEPHONY_SERVICE);  //gets the current TelephonyManager
                                                if (tm.getSimState() != TelephonyManager.SIM_STATE_UNKNOWN){
                                                    if (ContextCompat.checkSelfPermission(Customer_Info_Activity.this, Manifest.permission.SEND_SMS)
                                                            != PackageManager.PERMISSION_GRANTED) {

                                                        ActivityCompat.requestPermissions(Customer_Info_Activity.this,
                                                                permissions(),
                                                                1);
                                                       /* // Should we show an explanation?
                                                        if (ActivityCompat.shouldShowRequestPermissionRationale(Customer_Info_Activity.this,
                                                                Manifest.permission.SEND_SMS)) {

                                                            ActivityCompat.requestPermissions(Customer_Info_Activity.this,
                                                                    new String[]{Manifest.permission.SEND_SMS},
                                                                    1);
                                                            // Show an explanation to the user *asynchronously* -- don't block
                                                            // this thread waiting for the user's response! After the user
                                                            // sees the explanation, try again to request the permission.

                                                        } else {

                                                            // No explanation needed, we can request the permission.

                                                            ActivityCompat.requestPermissions(Customer_Info_Activity.this,
                                                                    new String[]{Manifest.permission.SEND_SMS},
                                                                    1);

                                                            // MY_PERMISSIONS_REQUEST_READ_CONTACTS is an
                                                            // app-defined int constant. The callback method gets the
                                                            // result of the request.
                                                        }*/
                                                    }else {

                                                        if (!SdIsPresent()) ;

                                                        Log.i("Send SMS", "");
                                                        // String phoneNo = txtphoneNo.getText().toString();
                                                        String message = "OTP is "+time1;

                                                        try {
                                                            SmsManager smsManager = SmsManager.getDefault();
                                                            smsManager.sendTextMessage(pho_num.getText().toString(), null, message, null, null);
                                                            //Toast.makeText(getActivity(), "SMS sent.", Toast.LENGTH_LONG).show();
                                                        }

                                                        catch (Exception e) {
                                                            //Toast.makeText(getActivity(), "SMS faild, please try again.", Toast.LENGTH_LONG).show();
                                                            e.printStackTrace();
                                                        }

                                                    }
                                                }else {
                                                    Toast.makeText(Customer_Info_Activity.this, "no Sim option there", Toast.LENGTH_SHORT).show();
                                                }



                                                Cursor otp = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                if (otp.moveToFirst()) {
                                                    do {
                                                        String id = otp.getString(0);
                                                        ContentValues contentValues = new ContentValues();
                                                        contentValues.put("otp", time1);
                                                        String where = "_id = '" + id + "'";


                                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                        getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                        resultUri = new Uri.Builder()
                                                                .scheme("content")
                                                                .authority(StubProvider.AUTHORITY)
                                                                .path("Customerdetails")
                                                                .appendQueryParameter("operation", "update")
                                                                .appendQueryParameter("_id",id)
                                                                .build();
                                                        getContentResolver().notifyChange(resultUri, null);


                                                 //       db.update("Customerdetails", contentValues, where, new String[]{});
                                                    } while (otp.moveToNext());
                                                }
                                                otp.close();

                                                Button savetables = (Button) dialog_auth_pin_edit.findViewById(R.id.savetables);
                                                savetables.setOnClickListener(new View.OnClickListener() {
                                                    @Override
                                                    public void onClick(View view) {
                                                        if (enter_otp.getText().toString().equals("") || enter_otp.getText().toString().length() < 4) {
                                                            four_opt.setError("Enter valid number");
                                                        } else {
                                                            Cursor otp1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                            if (otp1.moveToFirst()) {
                                                                otp_ch = otp1.getString(16);
                                                            }
                                                            otp1.close();

                                                            if (otp_ch.equals(enter_otp.getText().toString())) {
                                                                dialog_auth_pin_edit.dismiss();
                                                                final Dialog dialog_auth_pin_edit_new = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                                                dialog_auth_pin_edit_new.setContentView(R.layout.dialog_customer_management_authenticate_pin);
                                                                dialog_auth_pin_edit_new.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                                                                dialog_auth_pin_edit_new.show();

                                                                Button cancel = (Button) dialog_auth_pin_edit_new.findViewById(R.id.cancel);
                                                                cancel.setOnClickListener(new View.OnClickListener() {
                                                                    @Override
                                                                    public void onClick(View view) {
                                                                        dialog_auth_pin_edit_new.dismiss();
                                                                    }
                                                                });

                                                                final TextInputLayout pin1 = (TextInputLayout) dialog_auth_pin_edit_new.findViewById(R.id.pin1);
                                                                final TextInputLayout pin2 = (TextInputLayout) dialog_auth_pin_edit_new.findViewById(R.id.pin2);
                                                                final EditText enterpin = (EditText) dialog_auth_pin_edit_new.findViewById(R.id.enterpin);
                                                                final EditText confirmpin = (EditText) dialog_auth_pin_edit_new.findViewById(R.id.confirmpin);

                                                                final Switch mw = (Switch) dialog_auth_pin_edit_new.findViewById(R.id.mySwitch);

                                                                Button save = (Button) dialog_auth_pin_edit_new.findViewById(R.id.savetime);


                                                                Cursor set = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                                                if (set.moveToFirst()){
                                                                    do {
                                                                        String status = set.getString(25);
                                                                        String set1 = set.getString(15);

                                                                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                                                                        tv3.setText(status);
                                                                        if (tv3.getText().toString().equals("on")){
                                                                            mw.setChecked(true);
                                                                        }else {
                                                                            mw.setChecked(false);
                                                                        }

                                                                    }while (set.moveToNext());
                                                                }
                                                                set.close();

                                                                enterpin.addTextChangedListener(new TextWatcher() {
                                                                    @Override
                                                                    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                                                    }

                                                                    @Override
                                                                    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                                                        pin1.setError(null);
                                                                    }

                                                                    @Override
                                                                    public void afterTextChanged(Editable editable) {

                                                                    }
                                                                });

                                                                confirmpin.addTextChangedListener(new TextWatcher() {
                                                                    @Override
                                                                    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                                                    }

                                                                    @Override
                                                                    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                                                        pin2.setError(null);
                                                                    }

                                                                    @Override
                                                                    public void afterTextChanged(Editable editable) {

                                                                    }
                                                                });


                                                                save.setOnClickListener(new View.OnClickListener() {
                                                                    @Override
                                                                    public void onClick(View view) {
                                                                        if (enterpin.getText().toString().equals("") || enterpin.getText().length() < 4 ||
                                                                                confirmpin.getText().toString().equals("") || confirmpin.getText().length() < 4) {
                                                                            if (enterpin.getText().toString().equals("") || enterpin.getText().length() < 4) {
                                                                                pin1.setError("Enter valid number");
                                                                            }
                                                                            if (confirmpin.getText().toString().equals("") || confirmpin.getText().length() < 4) {
                                                                                pin2.setError("Enter valid number");
                                                                            }
                                                                        } else {
                                                                            if (confirmpin.getText().toString().equals(enterpin.getText().toString())) {
                                                                                Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                                if (cursor.moveToFirst()) {
                                                                                    String phon = cursor.getString(2);
                                                                                    String email = cursor.getString(3);
                                                                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                                                                    tv.setText(phon);
                                                                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                                                                    tv1.setText(email);
                                                                                    if (tv.getText().toString().equals("") || tv1.getText().toString().equals("")) {
                                                                                        final Dialog dialog_phone_edit = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                                                                        dialog_phone_edit.setContentView(R.layout.dialog_customer_management_authenticate_pin_phone_email);
                                                                                        dialog_phone_edit.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                                                                                        dialog_phone_edit.show();

                                                                                        Button cancel = (Button) dialog_phone_edit.findViewById(R.id.cancel);
                                                                                        cancel.setOnClickListener(new View.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(View view) {
                                                                                                dialog_phone_edit.dismiss();
                                                                                            }
                                                                                        });

                                                                                        final TextInputLayout email1 = (TextInputLayout) dialog_phone_edit.findViewById(R.id.email1);
                                                                                        final TextInputLayout email2 = (TextInputLayout) dialog_phone_edit.findViewById(R.id.conf_email1);

                                                                                        final EditText enter_email = (EditText) dialog_phone_edit.findViewById(R.id.enter_email);
                                                                                        final EditText confirm_enter_email = (EditText) dialog_phone_edit.findViewById(R.id.confirm_enter_email);

                                                                                        Button save = (Button) dialog_phone_edit.findViewById(R.id.savetime);
                                                                                        save.setOnClickListener(new View.OnClickListener() {
                                                                                            @Override
                                                                                            public void onClick(View view) {
                                                                                                if (enter_email.getText().toString().equals("") | confirm_enter_email.getText().toString().equals("")) {
                                                                                                    if (enter_email.getText().toString().equals("")) {
                                                                                                        email1.setError("Enter valid email id");
                                                                                                    }
                                                                                                    if (confirm_enter_email.getText().toString().equals("")) {
                                                                                                        email2.setError("Enter valid email id");
                                                                                                    }
                                                                                                } else {
                                                                                                    if (!confirm_enter_email.getText().toString().equals(enter_email.getText().toString())) {
                                                                                                        if (!confirm_enter_email.getText().toString().equals(enter_email.getText().toString())) {
                                                                                                            email2.setError("Email-id not matching");
                                                                                                        }
                                                                                                    } else {
                                                                                                        //everything is same update the database with phone and email
                                                                                                        Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                                                        if (cursor11.moveToFirst()) {
                                                                                                            do {
                                                                                                                String id = cursor11.getString(0);
                                                                                                                ContentValues contentValues = new ContentValues();
                                                                                                                contentValues.put("emailid", enter_email.getText().toString());
                                                                                                                String where = "_id = '" + id + "'";

                                                                                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                                                                getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                                                                                resultUri = new Uri.Builder()
                                                                                                                        .scheme("content")
                                                                                                                        .authority(StubProvider.AUTHORITY)
                                                                                                                        .path("Customerdetails")
                                                                                                                        .appendQueryParameter("operation", "update")
                                                                                                                        .appendQueryParameter("_id",id)
                                                                                                                        .build();
                                                                                                                getContentResolver().notifyChange(resultUri, null);



                                                                                                       //         db.update("Customerdetails", contentValues, where, new String[]{});
                                                                                                                dialog_phone_edit.dismiss();
                                                                                                                dialog_auth_pin_edit_new.dismiss();
                                                                                                            }
                                                                                                            while (cursor11.moveToNext());
                                                                                                        }
                                                                                                        cursor11.close();

                                                                                                        Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                                                        if (cursor1.moveToFirst()) {
                                                                                                            do {
                                                                                                                String id = cursor1.getString(0);
                                                                                                                ContentValues contentValues = new ContentValues();
                                                                                                                contentValues.put("authentication_pin", enterpin.getText().toString());
                                                                                                                if (mw.isChecked()) {
                                                                                                                    contentValues.put("authentication_pin_status", "on");
                                                                                                                } else {
                                                                                                                    contentValues.put("authentication_pin_status", "off");
//                                                                                                                    Toast.makeText(Customer_Info_Activity.this, "off4", Toast.LENGTH_SHORT).show();
                                                                                                                }
                                                                                                                String where = "_id = '" + id + "'";


                                                                                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                                                                getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                                                                                resultUri = new Uri.Builder()
                                                                                                                        .scheme("content")
                                                                                                                        .authority(StubProvider.AUTHORITY)
                                                                                                                        .path("Customerdetails")
                                                                                                                        .appendQueryParameter("operation", "update")
                                                                                                                        .appendQueryParameter("_id",id)
                                                                                                                        .build();
                                                                                                                getContentResolver().notifyChange(resultUri, null);

                                                                                                            //    db.update("Customerdetails", contentValues, where, new String[]{});
                                                                                                                dialog_auth_pin_edit_new.dismiss();
                                                                                                            } while (cursor1.moveToNext());
                                                                                                        }
                                                                                                        cursor1.close();
                                                                                                        auth_pin_set_notset.setText("set");
                                                                                                        if (mw.isChecked()){
                                                                                                            auth_pin_status.setText("on");
                                                                                                        }else {
                                                                                                            auth_pin_status.setText("off");
                                                                                                        }
                                                                                                    }
                                                                                                }
                                                                                            }
                                                                                        });

                                                                                        enter_email.addTextChangedListener(new TextWatcher() {
                                                                                            @Override
                                                                                            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                                                                            }

                                                                                            @Override
                                                                                            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                                                                                email1.setError(null);
                                                                                            }

                                                                                            @Override
                                                                                            public void afterTextChanged(Editable editable) {

                                                                                            }
                                                                                        });
                                                                                        confirm_enter_email.addTextChangedListener(new TextWatcher() {
                                                                                            @Override
                                                                                            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                                                                            }

                                                                                            @Override
                                                                                            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                                                                                email2.setError(null);
                                                                                            }

                                                                                            @Override
                                                                                            public void afterTextChanged(Editable editable) {

                                                                                            }
                                                                                        });


                                                                                    } else {
                                                                                        Toast.makeText(Customer_Info_Activity.this, "Pin successfull", Toast.LENGTH_SHORT).show();
                                                                                        ///save pin along with on or off
                                                                                        Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                                                                        if (cursor1.moveToFirst()) {
                                                                                            do {
                                                                                                String id = cursor1.getString(0);
                                                                                                ContentValues contentValues = new ContentValues();
                                                                                                contentValues.put("authentication_pin", enterpin.getText().toString());
                                                                                                if (mw.isChecked()) {
                                                                                                    contentValues.put("authentication_pin_status", "on");
                                                                                                } else {
                                                                                                    contentValues.put("authentication_pin_status", "off");
//                                                                                                    Toast.makeText(Customer_Info_Activity.this, "off5", Toast.LENGTH_SHORT).show();
                                                                                                }
                                                                                                String where = "_id = '" + id + "'";

                                                                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                                                getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                                                                                resultUri = new Uri.Builder()
                                                                                                        .scheme("content")
                                                                                                        .authority(StubProvider.AUTHORITY)
                                                                                                        .path("Customerdetails")
                                                                                                        .appendQueryParameter("operation", "update")
                                                                                                        .appendQueryParameter("_id",id)
                                                                                                        .build();
                                                                                                getContentResolver().notifyChange(resultUri, null);


                                                                                        //        db.update("Customerdetails", contentValues, where, new String[]{});
                                                                                                dialog_auth_pin_edit_new.dismiss();
                                                                                            } while (cursor1.moveToNext());
                                                                                        }
                                                                                        cursor1.close();
                                                                                        auth_pin_set_notset.setText("set");
                                                                                        if (mw.isChecked()){
                                                                                            auth_pin_status.setText("on");
                                                                                        }else {
                                                                                            auth_pin_status.setText("off");
                                                                                        }
                                                                                    }
                                                                                }
                                                                                cursor.close();
                                                                            }else {
                                                                                pin2.setError("Pin not matching");
                                                                            }
                                                                        }
                                                                    }
                                                                });

                                                            }else {
                                                                four_opt.setError("Invalid OTP");
                                                            }
                                                        }
                                                    }
                                                });
                                            } else {
                                                otp_valid_layout.setVisibility(View.GONE);
                                                first_six.setError("Invalid phone no.");
                                            }
                                        }
                                    }
                                    last_four_no.close();

                                }
                            });
                        }

                    }
                });


                final TextView dbay_date = (TextView) dialog_settings.findViewById(R.id.dbay_date);
                final TextView dbay_date_status = (TextView) dialog_settings.findViewById(R.id.dbay_date_status);

                Cursor set21q = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (set21q.moveToFirst()){
                    bir_d = set21q.getString(17);
                    bir_d_status = set21q.getString(26);
                }
                set21q.close();

                TextView tv2 = new TextView(Customer_Info_Activity.this);
                tv2.setText(bir_d);

                if (tv2.getText().toString().equals("")){

                }else {
                    dbay_date.setText(bir_d);
                }

                TextView tv3 = new TextView(Customer_Info_Activity.this);
                tv3.setText(bir_d_status);

                if (tv3.getText().toString().equals("on")){
                    dbay_date_status.setText("on");
                }else {
                    dbay_date_status.setText("off");
                }

                LinearLayout bday_wish = (LinearLayout) dialog_settings.findViewById(R.id.bday_wish);
                bday_wish.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {

                        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
                        if (getcom.moveToFirst()) {
                            strcompanyname = getcom.getString(1);
                        }
                        getcom.close();

                        TextView tv5 = new TextView(Customer_Info_Activity.this);
                        Cursor set21 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                        if (set21.moveToFirst()){
                            do {
                                String status = set21.getString(25);
                                String set1 = set21.getString(15);
                                bday = set21.getString(17);
                                tv5.setText(set1);
                            }while (set21.moveToNext());
                        }
                        set21.close();

                        final Dialog dialog_bday_wish = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                        dialog_bday_wish.setContentView(R.layout.dialog_customer_management_birthday_wish);
                        dialog_bday_wish.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                        dialog_bday_wish.show();

                        Button cancel = (Button) dialog_bday_wish.findViewById(R.id.cancel);
                        cancel.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                dialog_bday_wish.dismiss();
                            }
                        });

                        TextView customer_name = (TextView) dialog_bday_wish.findViewById(R.id.customer_name);
                        customer_name.setText(cust_name.getText().toString());

                        final TextView birth_date = (TextView) dialog_bday_wish.findViewById(R.id.from_date);
                        birth_date.setText(bday);

                        TextView company_name = (TextView) dialog_bday_wish.findViewById(R.id.company_name);
                        company_name.setText(strcompanyname);

                        final Switch mySwitch = (Switch) dialog_bday_wish.findViewById(R.id.mySwitch);


                        Cursor cursor55 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                        if (cursor55.moveToFirst()){
                            String id = cursor55.getString(0);
                            String dob = cursor55.getString(26);

                            TextView b = new TextView(Customer_Info_Activity.this);
                            b.setText(dob);

                            if (b.getText().toString().equals("on")){
                                mySwitch.setChecked(true);
                            }else {
                                mySwitch.setChecked(false);
                            }
                        }
                        cursor55.close();


                        RelativeLayout select_bday = (RelativeLayout) dialog_bday_wish.findViewById(R.id.select_bday);
                        select_bday.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                Calendar now = Calendar.getInstance();
                                com.wdullaer.materialdatetimepicker.date.DatePickerDialog dpd = com.wdullaer.materialdatetimepicker.date.DatePickerDialog.newInstance(
                                        datePickerListener,now.get(Calendar.YEAR), now.get(Calendar.MONTH), now.get(Calendar.DAY_OF_MONTH)
                                );

                                dpd.show(Customer_Info_Activity.this.getFragmentManager(), "Datepickerdialog");

//                                android.app.TimePickerDialog timePickerDialog = new android.app.TimePickerDialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog, timePickerListener, hour, minute,
//                                        false);

//                                timePickerDialog.show();

                            }

                            com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener datePickerListener
                                    = new com.wdullaer.materialdatetimepicker.date.DatePickerDialog.OnDateSetListener() {

                                @Override
                                public void onDateSet(com.wdullaer.materialdatetimepicker.date.DatePickerDialog datePickerDialog, int selectedYear1, int selectedMonth1, int selectedDay1) {
                                    year1 = selectedYear1;
                                    month1 = selectedMonth1;
                                    day1 = selectedDay1;

                                    // set selected date into textview
                                    populateSetDate(year1, month1 + 1, day1);
                                }
                            };

                            public void populateSetDate(int year, int month, int day) {
                                TextView mEdit1 = (TextView) dialog_bday_wish.findViewById(R.id.from_date);
//                        TextView mEdit  = (TextView)dialog_date.findViewById(R.id.from_date_hide);

//                        Toast.makeText(Customer_Info_Activity.this, "from "+mEdit.getText().toString(), Toast.LENGTH_SHORT).show();

                                if (month == 1 && day < 10) {
                                    onee1 = "0" + day + " " + "Jan" + " " + year;
                                    mEdit1.setText(onee1);
                                } else {
                                    if (month == 1) {
                                        onee = day + " " + "Jan" + " " + year;
                                        mEdit1.setText(onee);
                                    }
                                }

                                if (month == 2 && day < 10) {
                                    two1 = "0" + day + " " + "Feb" + " " + year;
                                    mEdit1.setText(two1);
                                } else {
                                    if (month == 2) {
                                        two = day + " " + "Feb" + " " + year;
                                        mEdit1.setText(two);
                                    }
                                }

                                if (month == 3 && day < 10) {
                                    three1 = "0" + day + " " + "Mar" + " " + year;
                                    mEdit1.setText(three1);
                                } else {
                                    if (month == 3) {
                                        three = day + " " + "Mar" + " " + year;
                                        mEdit1.setText(three);
                                    }
                                }

                                if (month == 4 && day < 10) {
                                    four1 = "0" + day + " " + "Apr" + " " + year;
                                    mEdit1.setText(four1);
                                } else {
                                    if (month == 4) {
                                        four = day + " " + "Apr" + " " + year;
                                        mEdit1.setText(four);
                                    }
                                }

                                if (month == 5 && day < 10) {
                                    five1 = "0" + day + " " + "May" + " " + year;
                                    mEdit1.setText(five1);
                                } else {
                                    if (month == 5) {
                                        five = day + " " + "May" + " " + year;
                                        mEdit1.setText(five);
                                    }
                                }

                                if (month == 6 && day < 10) {
                                    six1 = "0" + day + " " + "Jun" + " " + year;
                                    mEdit1.setText(six1);
                                } else {
                                    if (month == 6) {
                                        six = day + " " + "Jun" + " " + year;
                                        mEdit1.setText(six);
                                    }
                                }

                                if (month == 7 && day < 10) {
                                    seven1 = "0" + day + " " + "Jul" + " " + year;
                                    mEdit1.setText(seven1);
                                } else {
                                    if (month == 7) {
                                        seven = day + " " + "Jul" + " " + year;
                                        mEdit1.setText(seven);
                                    }
                                }

                                if (month == 8 && day < 10) {
                                    eight1 = "0" + day + " " + "Aug" + " " + year;
                                    mEdit1.setText(eight1);
                                } else {
                                    if (month == 8) {
                                        eight = day + " " + "Aug" + " " + year;
                                        mEdit1.setText(eight);
                                    }
                                }

                                if (month == 9 && day < 10) {
                                    nine1 = "0" + day + " " + "Sep" + " " + year;
                                    mEdit1.setText(nine1);
                                } else {
                                    if (month == 9) {
                                        nine = day + " " + "Sep" + " " + year;
                                        mEdit1.setText(nine);
                                    }
                                }

                                if (month == 10 && day < 10) {
                                    ten1 = "0" + day + " " + "Oct" + " " + year;
                                    mEdit1.setText(ten1);
                                } else {
                                    if (month == 10) {
                                        ten = day + " " + "Oct" + " " + year;
                                        mEdit1.setText(ten);
                                    }
                                }

                                if (month == 11 && day < 10) {
                                    eleven1 = "0" + day + " " + "Nov" + " " + year;
                                    mEdit1.setText(eleven1);
                                } else {
                                    if (month == 11) {
                                        eleven = day + " " + "Nov" + " " + year;
                                        mEdit1.setText(eleven);
                                    }
                                }

                                if (month == 12 && day < 10) {
                                    twelve1 = "0" + day + " " + "Dec" + " " + year;
                                    mEdit1.setText(twelve1);
                                } else {
                                    if (month == 12) {
                                        twelve = day + " " + "Dec" + " " + year;
                                        mEdit1.setText(twelve);
                                    }
                                }

                            }

                        });


                        Button savetime = (Button) dialog_bday_wish.findViewById(R.id.savetime);
                        savetime.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                if (cursor1.moveToFirst()){
                                    do {
                                        String id = cursor1.getString(0);
                                        ContentValues contentValues = new ContentValues();
                                        contentValues.put("dob", birth_date.getText().toString());
                                        String where = "_id = '" + id + "'";


                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                        getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Customerdetails")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);


                                  //      db.update("Customerdetails", contentValues, where, new String[]{});
                                    }while (cursor1.moveToNext());
                                }
                                cursor1.close();

                                if (mySwitch.isChecked()){
                                    Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                    if (cursor.moveToFirst()){
                                        do {
                                            String id = cursor.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("dob_alaram", "on");
                                            String where = "_id = '" + id + "'";


                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                            getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProvider.AUTHORITY)
                                                    .path("Customerdetails")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                  //          db.update("Customerdetails", contentValues, where, new String[]{});
                                        }while (cursor.moveToNext());
                                    }
                                    cursor.close();
//                                    setAlarm(calSet);

                                    Calendar cal = Calendar.getInstance();

                                    cal.set(Calendar.YEAR, 2016);
                                    cal.set(Calendar.MONTH, 12);
                                    cal.set(Calendar.DAY_OF_MONTH, 28);
//                                    cal.set(Calendar.SECOND, 0);
//                                    cal.set(Calendar.MILLISECOND, 0);

                                    AlarmManager alarmMgr = (AlarmManager)getSystemService(Context.ALARM_SERVICE);
                                    Intent intent = new Intent(Customer_Info_Activity.this, AlarmReceiver1.class);
//                                    PendingIntent pendingIntent = PendingIntent.getBroadcast(Customer_Info_Activity.this, 0, intent, 0);
                                    PendingIntent pendingIntent = null;
                                    if (android.os.Build.VERSION.SDK_INT >= android.os.Build.VERSION_CODES.S) {
                                        pendingIntent = PendingIntent.getBroadcast(Customer_Info_Activity.this, 0, intent, PendingIntent.FLAG_MUTABLE);
                                    }
                                    else {
                                        pendingIntent = PendingIntent.getBroadcast(Customer_Info_Activity.this, 0, intent, PendingIntent.FLAG_ONE_SHOT);
                                    }
                                    // cal.add(Calendar.SECOND, 5);
                                    alarmMgr.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), pendingIntent);

                                    dbay_date_status.setText("on");
                                }else {
                                    Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                    if (cursor.moveToFirst()){
                                        do {
                                            String id = cursor.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("dob_alaram", "off");
                                            String where = "_id = '" + id + "'";



                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                            getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProvider.AUTHORITY)
                                                    .path("Customerdetails")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                    //        db.update("Customerdetails", contentValues, where, new String[]{});
                                        }while (cursor.moveToNext());
                                    }
                                    cursor.close();
                                    dbay_date_status.setText("off");
                                }

                                dialog_bday_wish.dismiss();
                                dbay_date.setText(birth_date.getText().toString());
                            }
                        });
                    }
                });


                final TextView def_dis_status = (TextView) dialog_settings.findViewById(R.id.def_dis_status);
                final TextView def_dis_val = (TextView) dialog_settings.findViewById(R.id.def_dis_val);
                final TextView def_dis_type = (TextView) dialog_settings.findViewById(R.id.def_dis_type);

                Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (set21w.moveToFirst()){
                    dis_val = set21w.getString(29);
                    dis_status = set21w.getString(27);
                    dis_ty = set21w.getString(30);
                }
                set21w.close();

                TextView tv4 = new TextView(Customer_Info_Activity.this);
                tv4.setText(dis_val);
                TextView tv6 = new TextView(Customer_Info_Activity.this);
                tv6.setText(dis_ty);

                if (tv4.getText().toString().equals("")){

                }else {
                    if (tv6.getText().toString().equals("%")){
                        def_dis_type.setVisibility(View.VISIBLE);
                        def_dis_val.setText(dis_val);
                        def_dis_type.setText("%");
                    }else {
                        def_dis_type.setVisibility(View.GONE);
                        def_dis_val.setText(insert1_rs+" "+dis_val);
                    }
                }

                TextView tv5 = new TextView(Customer_Info_Activity.this);
                tv5.setText(dis_status);

                if (tv5.getText().toString().equals("on")){
                    def_dis_status.setText("on");
                }else {
                    def_dis_status.setText("off");
                }

                LinearLayout default_discount = (LinearLayout) dialog_settings.findViewById(R.id.default_discount);
                default_discount.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        final Dialog dialog_default_discount = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                        dialog_default_discount.setContentView(R.layout.dialog_customer_management_settings_default_discount);
                        dialog_default_discount.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                        dialog_default_discount.show();

                        Button cancel = (Button) dialog_default_discount.findViewById(R.id.cancel);
                        cancel.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                dialog_default_discount.dismiss();
                            }
                        });

                        Cursor cvb = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                        if (cvb.moveToFirst()){
                            d_d_status = cvb.getString(27);
                            d_d_amount = cvb.getString(28);
                            d_d_value = cvb.getString(29);
                            d_d_type = cvb.getString(30);
                        }
                        cvb.close();

                        TextView t_status = new TextView(Customer_Info_Activity.this);
                        t_status.setText(d_d_status);
                        TextView t_amount = new TextView(Customer_Info_Activity.this);
                        t_amount.setText(d_d_amount);
                        TextView t_value = new TextView(Customer_Info_Activity.this);
                        t_value.setText(d_d_value);
                        TextView t_type = new TextView(Customer_Info_Activity.this);
                        t_type.setText(d_d_type);

                        final Switch def_dis_switch = (Switch) dialog_default_discount.findViewById(R.id.mySwitch);
                        if (t_status.getText().toString().equals("") || t_status.getText().toString().equals("off")){
                            def_dis_switch.setChecked(false);
                        }else {
                            def_dis_switch.setChecked(true);
                        }

                        final TextInputLayout def_dis_amount_l = (TextInputLayout) dialog_default_discount.findViewById(R.id.def_dis_amount_l);
                        final EditText def_dis_amount = (EditText) dialog_default_discount.findViewById(R.id.def_dis_amount);
                        if (t_amount.getText().toString().equals("")){

                        }else {
                            def_dis_amount.setText(t_amount.getText().toString());
                        }

                        final TextInputLayout def_dis_value_l = (TextInputLayout) dialog_default_discount.findViewById(R.id.def_dis_value_l);
                        final EditText def_dis_value = (EditText) dialog_default_discount.findViewById(R.id.def_dis_value);
                        if (t_value.getText().toString().equals("")){

                        }else {
                            def_dis_value.setText(t_value.getText().toString());
                        }

                        final Spinner rspercent = (Spinner) dialog_default_discount.findViewById(R.id.rspercent1);

                        ArrayList<String> my_array = new ArrayList<String>();
                        my_array.add("%");
                        my_array.add(insert1_cc);
                        final ArrayAdapter my_Adapterr1 = new ArrayAdapter(Customer_Info_Activity.this, R.layout.spinner_row,
                                my_array);
                        rspercent.setAdapter(my_Adapterr1);

                        if (t_type.getText().toString().equals("%")){
                            rspercent.setSelection(0);
                        }else {
                            rspercent.setSelection(1);
                        }


                        def_dis_value.addTextChangedListener(new TextWatcher() {
                            @Override
                            public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                            }

                            @Override
                            public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                def_dis_value_l.setError(null);
                            }

                            @Override
                            public void afterTextChanged(Editable editable) {

                            }
                        });

                        Button save = (Button) dialog_default_discount.findViewById(R.id.savetime);
                        save.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                if (def_dis_value.getText().toString().equals("")){
                                    def_dis_value_l.setError("Enter valid number");
                                }else {
                                    Object position1 = rspercent.getSelectedItem();
                                    Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                                    if (cursor.moveToFirst()){
                                        do {
                                            String id = cursor.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            if (position1.equals("%")) {
                                                contentValues.put("default_discount_value", def_dis_value.getText().toString());
                                                contentValues.put("default_discount_amount", def_dis_amount.getText().toString());
                                                contentValues.put("default_discount_type", position1.toString());
                                            }else {
                                                contentValues.put("default_discount_value", def_dis_value.getText().toString());
                                                contentValues.put("default_discount_amount", def_dis_amount.getText().toString());
                                                contentValues.put("default_discount_type", position1.toString());
                                            }

                                            if (def_dis_switch.isChecked()){
                                                contentValues.put("default_discount_status", "on");
                                            }else {
                                                contentValues.put("default_discount_status", "off");
                                            }
                                            String where = "_id = '" + id + "'";


                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                            getContentResolver().update(contentUri, contentValues,where,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProvider.AUTHORITY)
                                                    .path("Customerdetails")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);

                                            Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                                            if (set21w.moveToFirst()){
                                                dis_val = set21w.getString(29);
                                                dis_status = set21w.getString(27);
                                                dis_ty = set21w.getString(30);

                                                TextView one = new TextView(Customer_Info_Activity.this);
                                                one.setText(dis_val);

                                                TextView two = new TextView(Customer_Info_Activity.this);
                                                two.setText(dis_ty);

                                                if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                                    disc_val_def.setText("0");
                                                }else {
                                                    disc_val_def.setText(dis_val);
                                                }
                                                if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                                    disc_per_def.setText("%");
                                                }else {
                                                    disc_per_def.setText(dis_ty);
                                                }

                                            }
                                            set21w.close();

                                 //           db.update("Customerdetails", contentValues, where, new String[]{});
                                        }while (cursor.moveToNext());
                                    }
                                    cursor.close();

                                    dialog_default_discount.dismiss();
                                    if (def_dis_switch.isChecked()){
                                        def_dis_status.setText("on");
                                    }else {
                                        def_dis_status.setText("off");
                                    }

                                    if (position1.equals("%")) {
                                        def_dis_type.setVisibility(View.VISIBLE);
                                        def_dis_val.setText(def_dis_value.getText().toString());
                                        def_dis_type.setText("%");
                                    }else {
                                        def_dis_type.setVisibility(View.GONE);
                                        def_dis_val.setText(insert1_rs+" "+def_dis_value.getText().toString());

                                    }

                                }

                            }
                        });
                    }
                });

                final TextView no_of_taxes_all = (TextView) dialog_settings.findViewById(R.id.no_of_taxes);

                Cursor del1 = db1.rawQuery("SELECT * FROM Taxes WHERE taxtype = 'Globaltax'", null);
                int icount = del1.getCount();

                Cursor no_of = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                if (no_of.moveToLast()) {
                    String na38 = no_of.getString(38);
                    String na39 = no_of.getString(39);
                    String na40 = no_of.getString(40);
                    String na41 = no_of.getString(41);
                    String na42 = no_of.getString(42);
                    String na43 = no_of.getString(43);
                    String na44 = no_of.getString(44);
                    String na45 = no_of.getString(45);
                    String na46 = no_of.getString(46);
                    String na47 = no_of.getString(47);
                    String na48 = no_of.getString(48);
                    String na49 = no_of.getString(49);
                    String na50 = no_of.getString(50);
                    String na51 = no_of.getString(51);
                    String na52 = no_of.getString(52);

                    TextView tv38 = new TextView(Customer_Info_Activity.this);
                    tv38.setText(na38);
                    TextView tv39 = new TextView(Customer_Info_Activity.this);
                    tv39.setText(na39);
                    TextView tv40 = new TextView(Customer_Info_Activity.this);
                    tv40.setText(na40);
                    TextView tv41 = new TextView(Customer_Info_Activity.this);
                    tv41.setText(na41);
                    TextView tv42 = new TextView(Customer_Info_Activity.this);
                    tv42.setText(na42);
                    TextView tv43 = new TextView(Customer_Info_Activity.this);
                    tv43.setText(na43);
                    TextView tv44 = new TextView(Customer_Info_Activity.this);
                    tv44.setText(na44);
                    TextView tv45 = new TextView(Customer_Info_Activity.this);
                    tv45.setText(na45);
                    TextView tv46 = new TextView(Customer_Info_Activity.this);
                    tv46.setText(na46);
                    TextView tv47 = new TextView(Customer_Info_Activity.this);
                    tv47.setText(na47);
                    TextView tv48 = new TextView(Customer_Info_Activity.this);
                    tv48.setText(na48);
                    TextView tv49 = new TextView(Customer_Info_Activity.this);
                    tv49.setText(na49);
                    TextView tv50 = new TextView(Customer_Info_Activity.this);
                    tv50.setText(na50);
                    TextView tv51 = new TextView(Customer_Info_Activity.this);
                    tv51.setText(na51);
                    TextView tv52 = new TextView(Customer_Info_Activity.this);
                    tv52.setText(na52);
                    int q = 0;

                    if (!tv38.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv39.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv40.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv41.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv42.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv43.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv44.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv45.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv46.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv47.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv48.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv49.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv50.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv51.getText().toString().equals("")) {
                        q = q + 1;
                    }
                    if (!tv52.getText().toString().equals("")) {
                        q = q + 1;
                    }

                    if (icount == q){
//                        Toast.makeText(Customer_Info_Activity.this, "all", Toast.LENGTH_SHORT).show();
                        no_of_taxes_all.setText("All");
                    }else {
//                        Toast.makeText(Customer_Info_Activity.this, "icount "+icount, Toast.LENGTH_SHORT).show();
//                        Toast.makeText(Customer_Info_Activity.this, "q "+q, Toast.LENGTH_SHORT).show();
                        no_of_taxes_all.setText(String.valueOf(q));
                    }
                }
                no_of.close();


                final Switch mySwitch1 = (Switch) dialog_settings.findViewById(R.id.mySwitch_taxes);

                Cursor switch_check1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                if (switch_check1.moveToLast()){
                    ch_swit_tax = switch_check1.getString(69);
                }
                switch_check1.close();

                TextView tvg1 = new TextView(Customer_Info_Activity.this);
                tvg1.setText(ch_swit_tax);

                if (tvg1.getText().toString().equals("on")){
                    mySwitch1.setChecked(true);
                }else {
                    mySwitch1.setChecked(false);
                }

                mySwitch1.setOnCheckedChangeListener(new CompoundButton.OnCheckedChangeListener() {
                    @Override
                    public void onCheckedChanged(CompoundButton compoundButton, boolean isChecked) {
                        if (isChecked) {
//                            Toast.makeText(Customer_Info_Activity.this, "Checked", Toast.LENGTH_SHORT).show();
                            Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                            if (cursor.moveToLast()){
                                String na = cursor.getString(1);
                                String ph = cursor.getString(2);
                                String em = cursor.getString(3);
                                String add = cursor.getString(4);
                                String pinc = cursor.getString(79);
                                String cre_de = cursor.getString(21);
                                String us_id = cursor.getString(37);
                                String au_pi = cursor.getString(15);
                                String dob = cursor.getString(17);
                                String auth_pin_st = cursor.getString(25);
                                String dob_al = cursor.getString(26);
                                String dsf_dis_st = cursor.getString(27);
                                String def_dis_amo = cursor.getString(28);
                                String def_dis_val = cursor.getString(29);
                                String def_dis_ty = cursor.getString(30);
                                String not = cursor.getString(31);
                                String cus_acc_no = cursor.getString(32);
                                String cus_ifsc_co = cursor.getString(33);
                                String cus_acc_ho_nam = cursor.getString(34);
                                String ban_nam = cursor.getString(35);

                                String tax1 = cursor.getString(38);
                                String tax2 = cursor.getString(39);
                                String tax3 = cursor.getString(40);
                                String tax4 = cursor.getString(41);
                                String tax5 = cursor.getString(42);
                                String tax6 = cursor.getString(43);
                                String tax7 = cursor.getString(44);
                                String tax8 = cursor.getString(45);
                                String tax9 = cursor.getString(46);
                                String tax10 = cursor.getString(47);
                                String tax11 = cursor.getString(48);
                                String tax12 = cursor.getString(49);
                                String tax13 = cursor.getString(50);
                                String tax14 = cursor.getString(51);
                                String tax15 = cursor.getString(52);
                                String tax_sele = cursor.getString(53);
                                String tax1_value = cursor.getString(54);
                                String tax2_value = cursor.getString(55);
                                String tax3_value = cursor.getString(56);
                                String tax4_value = cursor.getString(57);
                                String tax5_value = cursor.getString(58);
                                String tax6_value = cursor.getString(59);
                                String tax7_value = cursor.getString(60);
                                String tax8_value = cursor.getString(61);
                                String tax9_value = cursor.getString(62);
                                String tax10_value = cursor.getString(63);
                                String tax11_value = cursor.getString(64);
                                String tax12_value = cursor.getString(65);
                                String tax13_value = cursor.getString(66);
                                String tax14_value = cursor.getString(67);
                                String tax15_value = cursor.getString(68);

//                                do {
                                ContentValues newValues = new ContentValues();
                                newValues.put("proceedings", "on");
                                newValues.put("name", na);
                                newValues.put("phoneno", ph);
                                newValues.put("emailid", em);
                                newValues.put("address", add);
                                newValues.put("pincode", pinc);
                                newValues.put("credit_default", cre_de);
                                newValues.put("user_id", us_id);
                                newValues.put("authentication_pin", au_pi);
                                newValues.put("dob", dob);
                                newValues.put("authentication_pin_status", auth_pin_st);
                                newValues.put("dob_alaram", dob_al);
                                newValues.put("default_discount_status", dsf_dis_st);
                                newValues.put("default_discount_amount", def_dis_amo);
                                newValues.put("default_discount_value", def_dis_val);
                                newValues.put("default_discount_type", def_dis_ty);
                                newValues.put("notes", not);
                                newValues.put("cust_account_no", cus_acc_no);
                                newValues.put("cust_ifsc_code", cus_ifsc_co);
                                newValues.put("cust_account_holder_name", cus_acc_ho_nam);
                                newValues.put("cust_bank_name", ban_nam);

                                newValues.put("tax1", tax1);
                                newValues.put("tax2", tax2);
                                newValues.put("tax3", tax3);
                                newValues.put("tax4", tax4);
                                newValues.put("tax5", tax5);
                                newValues.put("tax6", tax6);
                                newValues.put("tax7", tax7);
                                newValues.put("tax8", tax8);
                                newValues.put("tax9", tax9);
                                newValues.put("tax10", tax10);
                                newValues.put("tax11", tax11);
                                newValues.put("tax12", tax12);
                                newValues.put("tax13", tax13);
                                newValues.put("tax14", tax14);
                                newValues.put("tax15", tax15);
                                newValues.put("tax_selection", tax_sele);
                                newValues.put("tax1_value", tax1_value);
                                newValues.put("tax2_value", tax2_value);
                                newValues.put("tax3_value", tax3_value);
                                newValues.put("tax4_value", tax4_value);
                                newValues.put("tax5_value", tax5_value);
                                newValues.put("tax6_value", tax6_value);
                                newValues.put("tax7_value", tax7_value);
                                newValues.put("tax8_value", tax8_value);
                                newValues.put("tax9_value", tax9_value);
                                newValues.put("tax10_value", tax10_value);
                                newValues.put("tax11_value", tax11_value);
                                newValues.put("tax12_value", tax12_value);
                                newValues.put("tax13_value", tax13_value);
                                newValues.put("tax14_value", tax14_value);
                                newValues.put("tax15_value", tax15_value);


                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                resultUri = getContentResolver().insert(contentUri, newValues);
                                getContentResolver().notifyChange(resultUri, null);

                                Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                                if (set21w.moveToFirst()){
                                    dis_val = set21w.getString(29);
                                    dis_status = set21w.getString(27);
                                    dis_ty = set21w.getString(30);

                                    TextView one = new TextView(Customer_Info_Activity.this);
                                    one.setText(dis_val);

                                    TextView two = new TextView(Customer_Info_Activity.this);
                                    two.setText(dis_ty);

                                    if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                        disc_val_def.setText("0");
                                    }else {
                                        disc_val_def.setText(dis_val);
                                    }
                                    if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                        disc_per_def.setText("%");
                                    }else {
                                        disc_per_def.setText(dis_ty);
                                    }

                                }
                                set21w.close();

//                                    String where = "phoneno = '" + ph + "'";
                             //   db.insert("Customerdetails", null, newValues);
//                                }while (cursor.moveToNext());
                            }
                            cursor.close();
                        } else {
//                            Toast.makeText(Customer_Info_Activity.this, "not checked", Toast.LENGTH_SHORT).show();
                            Cursor cursor = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                            if (cursor.moveToLast()){
                                String na = cursor.getString(1);
                                String ph = cursor.getString(2);
                                String em = cursor.getString(3);
                                String add = cursor.getString(4);
                                String pinc = cursor.getString(79);
                                String cre_de = cursor.getString(21);
                                String us_id = cursor.getString(37);
                                String au_pi = cursor.getString(15);
                                String dob = cursor.getString(17);
                                String auth_pin_st = cursor.getString(25);
                                String dob_al = cursor.getString(26);
                                String dsf_dis_st = cursor.getString(27);
                                String def_dis_amo = cursor.getString(28);
                                String def_dis_val = cursor.getString(29);
                                String def_dis_ty = cursor.getString(30);
                                String not = cursor.getString(31);
                                String cus_acc_no = cursor.getString(32);
                                String cus_ifsc_co = cursor.getString(33);
                                String cus_acc_ho_nam = cursor.getString(34);
                                String ban_nam = cursor.getString(35);

                                String tax1 = cursor.getString(38);
                                String tax2 = cursor.getString(39);
                                String tax3 = cursor.getString(40);
                                String tax4 = cursor.getString(41);
                                String tax5 = cursor.getString(42);
                                String tax6 = cursor.getString(43);
                                String tax7 = cursor.getString(44);
                                String tax8 = cursor.getString(45);
                                String tax9 = cursor.getString(46);
                                String tax10 = cursor.getString(47);
                                String tax11 = cursor.getString(48);
                                String tax12 = cursor.getString(49);
                                String tax13 = cursor.getString(50);
                                String tax14 = cursor.getString(51);
                                String tax15 = cursor.getString(52);
                                String tax_sele = cursor.getString(53);
                                String tax1_value = cursor.getString(54);
                                String tax2_value = cursor.getString(55);
                                String tax3_value = cursor.getString(56);
                                String tax4_value = cursor.getString(57);
                                String tax5_value = cursor.getString(58);
                                String tax6_value = cursor.getString(59);
                                String tax7_value = cursor.getString(60);
                                String tax8_value = cursor.getString(61);
                                String tax9_value = cursor.getString(62);
                                String tax10_value = cursor.getString(63);
                                String tax11_value = cursor.getString(64);
                                String tax12_value = cursor.getString(65);
                                String tax13_value = cursor.getString(66);
                                String tax14_value = cursor.getString(67);
                                String tax15_value = cursor.getString(68);

//                                do {
                                ContentValues newValues = new ContentValues();
                                newValues.put("proceedings", "off");
                                newValues.put("name", na);
                                newValues.put("phoneno", ph);
                                newValues.put("emailid", em);
                                newValues.put("address", add);
                                newValues.put("pincode", pinc);
                                newValues.put("credit_default", cre_de);
                                newValues.put("user_id", us_id);
                                newValues.put("authentication_pin", au_pi);
                                newValues.put("dob", dob);
                                newValues.put("authentication_pin_status", auth_pin_st);
                                newValues.put("dob_alaram", dob_al);
                                newValues.put("default_discount_status", dsf_dis_st);
                                newValues.put("default_discount_amount", def_dis_amo);
                                newValues.put("default_discount_value", def_dis_val);
                                newValues.put("default_discount_type", def_dis_ty);
                                newValues.put("notes", not);
                                newValues.put("cust_account_no", cus_acc_no);
                                newValues.put("cust_ifsc_code", cus_ifsc_co);
                                newValues.put("cust_account_holder_name", cus_acc_ho_nam);
                                newValues.put("cust_bank_name", ban_nam);

                                newValues.put("tax1", tax1);
                                newValues.put("tax2", tax2);
                                newValues.put("tax3", tax3);
                                newValues.put("tax4", tax4);
                                newValues.put("tax5", tax5);
                                newValues.put("tax6", tax6);
                                newValues.put("tax7", tax7);
                                newValues.put("tax8", tax8);
                                newValues.put("tax9", tax9);
                                newValues.put("tax10", tax10);
                                newValues.put("tax11", tax11);
                                newValues.put("tax12", tax12);
                                newValues.put("tax13", tax13);
                                newValues.put("tax14", tax14);
                                newValues.put("tax15", tax15);
                                newValues.put("tax_selection", tax_sele);
                                newValues.put("tax1_value", tax1_value);
                                newValues.put("tax2_value", tax2_value);
                                newValues.put("tax3_value", tax3_value);
                                newValues.put("tax4_value", tax4_value);
                                newValues.put("tax5_value", tax5_value);
                                newValues.put("tax6_value", tax6_value);
                                newValues.put("tax7_value", tax7_value);
                                newValues.put("tax8_value", tax8_value);
                                newValues.put("tax9_value", tax9_value);
                                newValues.put("tax10_value", tax10_value);
                                newValues.put("tax11_value", tax11_value);
                                newValues.put("tax12_value", tax12_value);
                                newValues.put("tax13_value", tax13_value);
                                newValues.put("tax14_value", tax14_value);
                                newValues.put("tax15_value", tax15_value);

//                                    String where = "phoneno = '" + name + "'";

                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                resultUri = getContentResolver().insert(contentUri, newValues);
                                getContentResolver().notifyChange(resultUri, null);

                                Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                                if (set21w.moveToFirst()){
                                    dis_val = set21w.getString(29);
                                    dis_status = set21w.getString(27);
                                    dis_ty = set21w.getString(30);

                                    TextView one = new TextView(Customer_Info_Activity.this);
                                    one.setText(dis_val);

                                    TextView two = new TextView(Customer_Info_Activity.this);
                                    two.setText(dis_ty);

                                    if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                        disc_val_def.setText("0");
                                    }else {
                                        disc_val_def.setText(dis_val);
                                    }
                                    if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                        disc_per_def.setText("%");
                                    }else {
                                        disc_per_def.setText(dis_ty);
                                    }

                                }
                                set21w.close();

                            //    db.insert("Customerdetails", null, newValues);
//                                }while (cursor.moveToNext());
                            }
                            cursor.close();
                        }
                    }
                });

                LinearLayout default_tax = (LinearLayout) dialog_settings.findViewById(R.id.default_tax);
                default_tax.setOnClickListener(new View.OnClickListener() {
                    @Override
                    public void onClick(View view) {
                        final Dialog dialog_default_tax = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                        dialog_default_tax.setContentView(R.layout.dialog_customer_management_settings_default_tax);
                        dialog_default_tax.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                        dialog_default_tax.show();

                        Cursor cursor1_1 = db1.rawQuery("SELECT * FROM Taxes", null);
                        if (cursor1_1.moveToFirst()){
                            do {
                                String id = cursor1_1.getString(0);
                                ContentValues contentValues = new ContentValues();
                                contentValues.put("checked", "");
                                String where1 = "_id = '"+id+"' ";


                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                getContentResolver().update(contentUri, contentValues,where1,new String[]{});
                                resultUri = new Uri.Builder()
                                        .scheme("content")
                                        .authority(StubProviderApp.AUTHORITY)
                                        .path("Taxes")
                                        .appendQueryParameter("operation", "update")
                                        .appendQueryParameter("_id",id)
                                        .build();
                                getContentResolver().notifyChange(resultUri, null);


                          //      db1.update("Taxes", contentValues, where1, new String[]{});
                            }while (cursor1_1.moveToNext());
                        }
                        cursor1_1.close();

                        ImageButton btncancel = (ImageButton) dialog_default_tax.findViewById(R.id.btncancel);
                        btncancel.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                dialog_default_tax.dismiss();
                            }
                        });

                        final ListView listview_tax_list = (ListView) dialog_default_tax.findViewById(R.id.listview);

                        list_tax = new ArrayList<Country_tax>();
                        String statement = "SELECT * FROM Taxes WHERE taxtype = 'Globaltax'";
                        //Execute the query
                        Cursor aallrows = db1.rawQuery(statement, null);
                        System.out.println("COUNT : " + aallrows.getCount());
                        ////Toast.makeText(Customer_Info_Activity.this, "limit is a " + limit, Toast.LENGTH_SHORT).show();
                        if (aallrows.moveToFirst()) {
                            do {
                                String ID = aallrows.getString(0);
                                String NAme = aallrows.getString(1);

                                Country_tax NAME = new Country_tax(NAme);
                                list_tax.add(NAME);

                            } while (aallrows.moveToNext());
                        }
                        aallrows.close();

                        adapter_tax = new MyAdapter_tax(Customer_Info_Activity.this,list_tax);
                        listview_tax_list.setAdapter(adapter_tax);


                        Cursor sel = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
                        if (sel.moveToLast()){
                            View v;
                            do {
                                String na38 = sel.getString(38);
                                String na39 = sel.getString(39);
                                String na40 = sel.getString(40);
                                String na41 = sel.getString(41);
                                String na42 = sel.getString(42);
                                String na43 = sel.getString(43);
                                String na44 = sel.getString(44);
                                String na45 = sel.getString(45);
                                String na46 = sel.getString(46);
                                String na47 = sel.getString(47);
                                String na48 = sel.getString(48);
                                String na49 = sel.getString(49);
                                String na50 = sel.getString(50);
                                String na51 = sel.getString(51);
                                String na52 = sel.getString(52);
                                for(int i=0; i < listview_tax_list.getCount(); i++){
                                    v = listview_tax_list.getAdapter().getView(i, null, null);
//                                              LinearLayout itemLayout = (LinearLayout)listView.getChildAt(i);
                                    TextView cb = (TextView) v.findViewById(R.id.label);
                                    CheckBox cb1 = (CheckBox)v.findViewById(R.id.check);
//                                    Toast.makeText(Customer_Info_Activity.this, "na38 "+na38, Toast.LENGTH_LONG).show();
                                    if (cb.getText().toString().equals(na38)) {
                                        cb1.setChecked(true);
                                        //save the value here only
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na38+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";

                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                         //       db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
//                                    Toast.makeText(Customer_Info_Activity.this, "na39 "+na39, Toast.LENGTH_LONG).show();
                                    if (cb.getText().toString().equals(na39)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na39+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                         //       db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na40)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na40+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                   //             db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na41)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na41+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                          //      db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na42)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na42+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";

                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);

                                    //            db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na43)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na43+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";

                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                         //       db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na44)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na44+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                       //         db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na45)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na45+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                     //           db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na46)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na46+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);



                                         //       db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na47)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na47+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                           //     db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na48)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na48+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";



                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                          //      db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na49)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na49+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);



                                        //        db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na50)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na50+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                      //          db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na51)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na51+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                         //       db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    if (cb.getText().toString().equals(na52)) {
                                        cb1.setChecked(true);
                                        Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+na52+"'", null);
                                        if (c.moveToFirst()){
                                            do {
                                                String na = c.getString(1);
                                                String id = c.getString(0);
                                                ContentValues contentValues = new ContentValues();
                                                contentValues.put("checked", "checked");
                                                String wherecu = "_id = '" + id + "'";


                                                contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                                getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                                resultUri = new Uri.Builder()
                                                        .scheme("content")
                                                        .authority(StubProviderApp.AUTHORITY)
                                                        .path("Taxes")
                                                        .appendQueryParameter("operation", "update")
                                                        .appendQueryParameter("_id",id)
                                                        .build();
                                                getContentResolver().notifyChange(resultUri, null);


                                           //     db1.update("Taxes", contentValues, wherecu, new String[]{});
                                            }while (c.moveToNext());
                                        }
                                        c.close();
                                    }
                                    adapter_tax.notifyDataSetChanged();
                                }
//                                String na39 = sel.getString(39);
//                                for(int i=0; i < listview_tax_list.getCount(); i++){
//                                    v = listview_tax_list.getAdapter().getView(i, null, null);
////                                              LinearLayout itemLayout = (LinearLayout)listView.getChildAt(i);
//                                    TextView cb = (TextView) v.findViewById(R.id.label);
//                                    CheckBox cb1 = (CheckBox)v.findViewById(R.id.check);
//                                    if (cb.getText().toString().equals(na39)) {
//                                        cb1.setChecked(true);
//                                    }
//                                    adapter_tax.notifyDataSetChanged();
//                                }
//                                String na40 = sel.getString(40);
//                                for(int i=0; i < listview_tax_list.getCount(); i++){
//                                    v = listview_tax_list.getAdapter().getView(i, null, null);
////                                              LinearLayout itemLayout = (LinearLayout)listView.getChildAt(i);
//                                    TextView cb = (TextView) v.findViewById(R.id.label);
//                                    CheckBox cb1 = (CheckBox)v.findViewById(R.id.check);
//                                    if (cb.getText().toString().equals(na40)) {
//                                        cb1.setChecked(true);
//                                    }
//                                    adapter_tax.notifyDataSetChanged();
//                                }
                            }while (sel.moveToNext());
                        }
                        sel.close();

                        final EditText myFilter = (EditText) dialog_default_tax.findViewById(R.id.search_selecteditem);
                        myFilter.addTextChangedListener(new TextWatcher() {

                            public void afterTextChanged(Editable s) {
                            }

                            public void beforeTextChanged(CharSequence s, int start, int count, int after) {
                            }

                            public void onTextChanged(CharSequence s, int start, int before, int count) {
                                adapter_tax.getFilter().filter(s.toString());
                            }
                        });

                        final CheckBox chkAll =  (CheckBox) dialog_default_tax.findViewById(R.id.chkAll);

                        chkAll.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
//                                Toast.makeText(Customer_Info_Activity.this, "clicked", Toast.LENGTH_SHORT).show();
                                View v;
                                CheckBox chBox;

                                if (chkAll.isChecked()){
//                                    Toast.makeText(Customer_Info_Activity.this, "checked", Toast.LENGTH_SHORT).show();
                                    for(int i=0; i < listview_tax_list.getCount(); i++){
                                        v = listview_tax_list.getAdapter().getView(i, null, null);

                                        CheckBox cb = (CheckBox)v.findViewById(R.id.check);
                                        cb.setChecked(true);
                                        adapter_tax.notifyDataSetChanged();
                                    }
                                    Cursor del = db1.rawQuery("SELECT * FROM Taxes WHERE taxtype = 'Globaltax'", null);
                                    if (del.moveToFirst()){
                                        do {
                                            String na = del.getString(1);
                                            String id = del.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("checked", "checked");
                                            String wherecu = "_id = '" + id + "'";


                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                            getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Taxes")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                  //         db1.update("Taxes", contentValues, wherecu, new String[]{});
                                        }while (del.moveToNext());
                                    }
                                    del.close();
//                                    DownloadMusicfromInternet downloadMusicfromInternet = new DownloadMusicfromInternet();
//                                    downloadMusicfromInternet.execute();
                                }else {
//                                    Toast.makeText(Customer_Info_Activity.this, "not checked", Toast.LENGTH_SHORT).show();
                                    for(int i=0; i < listview_tax_list.getCount(); i++){
                                        v = listview_tax_list.getAdapter().getView(i, null, null);

                                        CheckBox cb = (CheckBox)v.findViewById(R.id.check);
                                        cb.setChecked(false);
                                        adapter_tax.notifyDataSetChanged();
                                    }
                                    Cursor del = db1.rawQuery("SELECT * FROM Taxes WHERE taxtype = 'Globaltax'", null);
                                    if (del.moveToFirst()){
                                        do {
                                            String na = del.getString(1);
                                            String id = del.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("checked", "");
                                            String wherecu = "_id = '" + id + "'";

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                            getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Taxes")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                       //     db1.update("Taxes", contentValues, wherecu, new String[]{});
                                        }while (del.moveToNext());
                                    }
                                    del.close();
//                                    DownloadMusicfromInternet1 downloadMusicfromInternet = new DownloadMusicfromInternet1();
//                                    downloadMusicfromInternet.execute();
                                }

                                int count = 0;
                                int size = list_tax.size();
                                for (int i1=0; i1<size; i1++){
                                    if (list_tax.get(i1).isSelected()){
                                        count++;
                                    }
                                }

                                if(listview_tax_list.getCount()==count)
                                    chkAll.setChecked(true);
                                else
                                    chkAll.setChecked(false);

//                                if (count >= 1){click functionality
//                                    display.setVisibility(View.VISIBLE);
//                                }else {
//                                    display.setVisibility(View.GONE);
//                                }
                            }
                        });

                        listview_tax_list.setOnItemClickListener(new AdapterView.OnItemClickListener() {
                            @Override
                            public void onItemClick(final AdapterView<?> adapterView, View view, final int position, long l) {
                                TextView txtview = (TextView) view.findViewById(R.id.label);
                                final String item = txtview.getText().toString();

                                final CheckBox checkbox = (CheckBox) view.getTag(R.id.check);

                                if (checkbox.isChecked()){
                                    checkbox.setChecked(false);
                                    Cursor del = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+txtview.getText().toString()+"'", null);
                                    if (del.moveToFirst()){
                                        do {
                                            String na = del.getString(1);
                                            String id = del.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("checked", "");
                                            String wherecu = "_id = '" + id + "'";

                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                            getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Taxes")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);



                                     //       db1.update("Taxes", contentValues, wherecu, new String[]{});
                                        }while (del.moveToNext());
                                    }
                                    del.close();
                                }else {
                                    checkbox.setChecked(true);
                                    Cursor del = db1.rawQuery("SELECT * FROM Taxes WHERE taxname = '"+txtview.getText().toString()+"'", null);
                                    if (del.moveToFirst()){
                                        do {
                                            String na = del.getString(1);
                                            String id = del.getString(0);
                                            ContentValues contentValues = new ContentValues();
                                            contentValues.put("checked", "checked");
                                            String wherecu = "_id = '" + id + "'";



                                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Taxes");
                                            getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProviderApp.AUTHORITY)
                                                    .path("Taxes")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id",id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);


                                        //    db1.update("Taxes", contentValues, wherecu, new String[]{});
                                        }while (del.moveToNext());
                                    }
                                    del.close();
                                }

                                int count = 0;
                                int size = list_tax.size();
                                for (int i1=0; i1<size; i1++){
                                    if (list_tax.get(i1).isSelected()){
                                        count++;
                                    }
                                }

                                if(listview_tax_list.getCount()==count)
                                    chkAll.setChecked(true);
                                else
                                    chkAll.setChecked(false);

//                                if (count >= 1){click functionality
//                                    display.setVisibility(View.VISIBLE);
//                                }else {
//                                    display.setVisibility(View.GONE);
//                                }

                                adapter_tax.notifyDataSetChanged();
                            }
                        });

                        int count = 0;
                        int size = list_tax.size();
                        for (int i1=0; i1<size; i1++){
                            if (list_tax.get(i1).isSelected()){
                                count++;
                            }
                        }

                        if(listview_tax_list.getCount()==count)
                            chkAll.setChecked(true);
                        else
                            chkAll.setChecked(false);

                        adapter_tax.notifyDataSetChanged();


                        Button save = (Button) dialog_default_tax.findViewById(R.id.btnsave);
                        save.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                //delete the value and save it
//                                int i1 = 1;
//                                Cursor del = db.rawQuery("SELECT * FROM Customerdetails", null);
//                                if (del.moveToFirst()){
//                                    do {
//                                        String id = del.getString(0);
//                                        ContentValues contentValues = new ContentValues();
//                                        for (int i1 = 1; i1<16; i1++) {
////                                            Toast.makeText(Customer_Info_Activity.this, "tax" + i1, Toast.LENGTH_SHORT).show();
//                                            contentValues.put("tax" + i1, "");
////                                            String wherecu = "phoneno = '" + pho_num.getText().toString() + "'";
//                                            if (chkAll.isChecked()){
//                                                contentValues.put("tax_selection", "All");
//                                            }else {
//                                                contentValues.put("tax_selection", "partial");
//                                            }
//                                            db.insert("Customerdetails", null, contentValues);
//                                        }
////                                        i1++;
//                                    }while (del.moveToNext());
//                                }

//                                int i = 1;
//                                Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE checked = 'checked'", null);
//                                if (c.moveToFirst()) {
//                                    do {
//                                        String tn = c.getString(1);
////                                        Toast.makeText(Customer_Info_Activity.this, "tax"+i+" "+tn, Toast.LENGTH_SHORT).show();
                                ContentValues contentValues5 = new ContentValues();
                                if (chkAll.isChecked()){
                                    contentValues5.put("tax_selection", "All");
                                }else {
                                    contentValues5.put("tax_selection", "partial");
                                }
//                                        contentValues.put("tax"+i, tn);
//                                        String wherecu = "phoneno = '" + pho_num.getText().toString() + "'";

                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                resultUri = getContentResolver().insert(contentUri, contentValues5);
                                getContentResolver().notifyChange(resultUri, null);



                         //       db.insert("Customerdetails", null, contentValues5);
//                                        i++;
//                                    }while (c.moveToNext());
//                                }

                                String _id = null;
                                Cursor max = db.rawQuery("SELECT * FROM Customerdetails ORDER BY _id DESC LIMIT 1", null);
                                if (max.moveToFirst()){
                                    _id = max.getString(0);
//                                    Toast.makeText(Customer_Info_Activity.this, "max is "+_id, Toast.LENGTH_SHORT).show();
                                }
                                max.close();

                                int i = 1;
                                Cursor c = db1.rawQuery("SELECT * FROM Taxes WHERE checked = 'checked'", null);
                                if (c.moveToFirst()) {
                                    do {
                                        String tn = c.getString(1);
                                        String tn_value = c.getString(2);
//                                        Toast.makeText(Customer_Info_Activity.this, "tax"+i+" "+tn, Toast.LENGTH_SHORT).show();
                                        ContentValues contentValues = new ContentValues();
                                        Cursor bn = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                                        if (bn.moveToLast()){
                                            String na = bn.getString(1);
                                            String ph = bn.getString(2);
                                            String em = bn.getString(3);
                                            String add = bn.getString(4);
                                            String pinc = bn.getString(79);
                                            String cre_de = bn.getString(21);
                                            String us_id = bn.getString(37);
                                            String au_pi = bn.getString(15);
                                            String dob = bn.getString(17);
                                            String auth_pin_st = bn.getString(25);
                                            String dob_al = bn.getString(26);
                                            String dsf_dis_st = bn.getString(27);
                                            String def_dis_amo = bn.getString(28);
                                            String def_dis_val = bn.getString(29);
                                            String def_dis_ty = bn.getString(30);
                                            String not = bn.getString(31);
                                            String cus_acc_no = bn.getString(32);
                                            String cus_ifsc_co = bn.getString(33);
                                            String cus_acc_ho_nam = bn.getString(34);
                                            String ban_nam = bn.getString(35);
                                            String proc = bn.getString(69);


//                                            ContentValues cv = new ContentValues();
                                            contentValues.put("name", na);
                                            contentValues.put("phoneno", ph);
                                            contentValues.put("emailid", em);
                                            contentValues.put("address", add);
                                            contentValues.put("pincode", pinc);
                                            contentValues.put("credit_default", cre_de);
                                            contentValues.put("user_id", us_id);
                                            contentValues.put("authentication_pin", au_pi);
                                            contentValues.put("dob", dob);
                                            contentValues.put("authentication_pin_status", auth_pin_st);
                                            contentValues.put("dob_alaram", dob_al);
                                            contentValues.put("default_discount_status", dsf_dis_st);
                                            contentValues.put("default_discount_amount", def_dis_amo);
                                            contentValues.put("default_discount_value", def_dis_val);
                                            contentValues.put("default_discount_type", def_dis_ty);
                                            contentValues.put("notes", not);
                                            contentValues.put("cust_account_no", cus_acc_no);
                                            contentValues.put("cust_ifsc_code", cus_ifsc_co);
                                            contentValues.put("cust_account_holder_name", cus_acc_ho_nam);
                                            contentValues.put("cust_bank_name", ban_nam);
                                            contentValues.put("proceedings", proc);


                                        }
                                        contentValues.put("tax"+i, tn);
                                        contentValues.put("tax"+i+"_value", tn_value);
//                                        Toast.makeText(Customer_Info_Activity.this, "name is "+tn+" value is "+tn_value, Toast.LENGTH_SHORT).show();
                                        String wherecu = "_id = '" + _id + "'";

                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                        getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Customerdetails")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",_id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);

                                        Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                                        if (set21w.moveToFirst()){
                                            dis_val = set21w.getString(29);
                                            dis_status = set21w.getString(27);
                                            dis_ty = set21w.getString(30);

                                            TextView one = new TextView(Customer_Info_Activity.this);
                                            one.setText(dis_val);

                                            TextView two = new TextView(Customer_Info_Activity.this);
                                            two.setText(dis_ty);

                                            if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                                disc_val_def.setText("0");
                                            }else {
                                                disc_val_def.setText(dis_val);
                                            }
                                            if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                                disc_per_def.setText("%");
                                            }else {
                                                disc_per_def.setText(dis_ty);
                                            }

                                        }
                                        set21w.close();


                               //         db.update("Customerdetails", contentValues, wherecu, new String[]{});

                                        i++;
                                    }while (c.moveToNext());
                                }
                                c.close();
                                dialog_default_tax.dismiss();

                                if (chkAll.isChecked()){

                                }else {
                                    ContentValues contentValues51 = new ContentValues();
                                    contentValues51.put("tax_selection", "partial");

                                    ContentValues contentValues = new ContentValues();
                                    Cursor bn = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                                    if (bn.moveToLast()){
                                        String na = bn.getString(1);
                                        String ph = bn.getString(2);
                                        String em = bn.getString(3);
                                        String add = bn.getString(4);
                                        String pinc = bn.getString(79);
                                        String cre_de = bn.getString(21);
                                        String us_id = bn.getString(37);
                                        String au_pi = bn.getString(15);
                                        String dob = bn.getString(17);
                                        String auth_pin_st = bn.getString(25);
                                        String dob_al = bn.getString(26);
                                        String dsf_dis_st = bn.getString(27);
                                        String def_dis_amo = bn.getString(28);
                                        String def_dis_val = bn.getString(29);
                                        String def_dis_ty = bn.getString(30);
                                        String not = bn.getString(31);
                                        String cus_acc_no = bn.getString(32);
                                        String cus_ifsc_co = bn.getString(33);
                                        String cus_acc_ho_nam = bn.getString(34);
                                        String ban_nam = bn.getString(35);
                                        String proc = bn.getString(69);


//                                            ContentValues cv = new ContentValues();
                                        contentValues.put("name", na);
                                        contentValues.put("phoneno", ph);
                                        contentValues.put("emailid", em);
                                        contentValues.put("address", add);
                                        contentValues.put("pincode", pinc);
                                        contentValues.put("credit_default", cre_de);
                                        contentValues.put("user_id", us_id);
                                        contentValues.put("authentication_pin", au_pi);
                                        contentValues.put("dob", dob);
                                        contentValues.put("authentication_pin_status", auth_pin_st);
                                        contentValues.put("dob_alaram", dob_al);
                                        contentValues.put("default_discount_status", dsf_dis_st);
                                        contentValues.put("default_discount_amount", def_dis_amo);
                                        contentValues.put("default_discount_value", def_dis_val);
                                        contentValues.put("default_discount_type", def_dis_ty);
                                        contentValues.put("notes", not);
                                        contentValues.put("cust_account_no", cus_acc_no);
                                        contentValues.put("cust_ifsc_code", cus_ifsc_co);
                                        contentValues.put("cust_account_holder_name", cus_acc_ho_nam);
                                        contentValues.put("cust_bank_name", ban_nam);
                                        contentValues.put("proceedings", proc);

                                        String wherecu = "_id = '" + _id + "'";


                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                        getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
                                        resultUri = new Uri.Builder()
                                                .scheme("content")
                                                .authority(StubProvider.AUTHORITY)
                                                .path("Customerdetails")
                                                .appendQueryParameter("operation", "update")
                                                .appendQueryParameter("_id",_id)
                                                .build();
                                        getContentResolver().notifyChange(resultUri, null);

                                        Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                                        if (set21w.moveToFirst()){
                                            dis_val = set21w.getString(29);
                                            dis_status = set21w.getString(27);
                                            dis_ty = set21w.getString(30);

                                            TextView one = new TextView(Customer_Info_Activity.this);
                                            one.setText(dis_val);

                                            TextView two = new TextView(Customer_Info_Activity.this);
                                            two.setText(dis_ty);

                                            if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                                disc_val_def.setText("0");
                                            }else {
                                                disc_val_def.setText(dis_val);
                                            }
                                            if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                                disc_per_def.setText("%");
                                            }else {
                                                disc_per_def.setText(dis_ty);
                                            }

                                        }
                                        set21w.close();


                               //         db.update("Customerdetails", contentValues, wherecu, new String[]{});
                                    }
                                    bn.close();
                                }

                                Cursor no_of = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' ", null);
                                if (no_of.moveToLast()){
                                    String na38 = no_of.getString(38);
                                    String na39 = no_of.getString(39);
                                    String na40 = no_of.getString(40);
                                    String na41 = no_of.getString(41);
                                    String na42 = no_of.getString(42);
                                    String na43 = no_of.getString(43);
                                    String na44 = no_of.getString(44);
                                    String na45 = no_of.getString(45);
                                    String na46 = no_of.getString(46);
                                    String na47 = no_of.getString(47);
                                    String na48 = no_of.getString(48);
                                    String na49 = no_of.getString(49);
                                    String na50 = no_of.getString(50);
                                    String na51 = no_of.getString(51);
                                    String na52 = no_of.getString(52);

                                    TextView tv38 = new TextView(Customer_Info_Activity.this);
                                    tv38.setText(na38);
                                    TextView tv39 = new TextView(Customer_Info_Activity.this);
                                    tv39.setText(na39);
                                    TextView tv40 = new TextView(Customer_Info_Activity.this);
                                    tv40.setText(na40);
                                    TextView tv41 = new TextView(Customer_Info_Activity.this);
                                    tv41.setText(na41);
                                    TextView tv42 = new TextView(Customer_Info_Activity.this);
                                    tv42.setText(na42);
                                    TextView tv43 = new TextView(Customer_Info_Activity.this);
                                    tv43.setText(na43);
                                    TextView tv44 = new TextView(Customer_Info_Activity.this);
                                    tv44.setText(na44);
                                    TextView tv45 = new TextView(Customer_Info_Activity.this);
                                    tv45.setText(na45);
                                    TextView tv46 = new TextView(Customer_Info_Activity.this);
                                    tv46.setText(na46);
                                    TextView tv47 = new TextView(Customer_Info_Activity.this);
                                    tv47.setText(na47);
                                    TextView tv48 = new TextView(Customer_Info_Activity.this);
                                    tv48.setText(na48);
                                    TextView tv49 = new TextView(Customer_Info_Activity.this);
                                    tv49.setText(na49);
                                    TextView tv50 = new TextView(Customer_Info_Activity.this);
                                    tv50.setText(na50);
                                    TextView tv51 = new TextView(Customer_Info_Activity.this);
                                    tv51.setText(na51);
                                    TextView tv52 = new TextView(Customer_Info_Activity.this);
                                    tv52.setText(na52);

                                    int q = 0;

                                    if (chkAll.isChecked()){

                                        no_of_taxes_all.setText("All");

//                                        ContentValues contentValues = new ContentValues();
//                                        contentValues.put("tax_selection", "All");
//                                        String wherecu = "phoneno = '" + pho_num.getText().toString() + "'";
//                                        db.update("Customerdetails", contentValues, wherecu, new String[]{});

//                                        Toast.makeText(Customer_Info_Activity.this, "selected all", Toast.LENGTH_SHORT).show();
                                    }else {
                                        if (!tv38.getText().toString().equals("")) {
                                            q = q + 1;
//                                            Toast.makeText(Customer_Info_Activity.this, "q38 is " + String.valueOf(q), Toast.LENGTH_SHORT).show();
                                        }
                                        if (!tv39.getText().toString().equals("")) {
                                            q = q + 1;
//                                            Toast.makeText(Customer_Info_Activity.this, "q39 is " + String.valueOf(q), Toast.LENGTH_SHORT).show();
                                        }
                                        if (!tv40.getText().toString().equals("")) {
                                            q = q + 1;
//                                            Toast.makeText(Customer_Info_Activity.this, "q40 is " + String.valueOf(q), Toast.LENGTH_SHORT).show();
                                        }
                                        if (!tv41.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv42.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv43.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv44.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv45.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv46.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv47.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv48.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv49.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv50.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv51.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
                                        if (!tv52.getText().toString().equals("")) {
                                            q = q + 1;
                                        }
//                                        Toast.makeText(Customer_Info_Activity.this, "q is " + String.valueOf(q), Toast.LENGTH_SHORT).show();
                                        no_of_taxes_all.setText(String.valueOf(q));
//                                        ContentValues contentValues = new ContentValues();
//                                        contentValues.put("tax_selection", "partial");
//                                        String wherecu = "phoneno = '" + pho_num.getText().toString() + "'";
//                                        db.update("Customerdetails", contentValues, wherecu, new String[]{});
                                    }
                                }
                                no_of.close();
                            }
                        });
                    }
                });
            }
        });






        final ListView listView = (ListView) findViewById(R.id.listView);

//        DownloadMusicfromInternet_new downloadMusicfromInternet_new = new DownloadMusicfromInternet_new();
//        downloadMusicfromInternet_new.execute();

        final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
        if (cursor_country1.moveToFirst()){
            str_country = cursor_country1.getString(1);
        }

        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
        // the XML defined views which the data will be bound to
        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
        Log.e("Checamos que hay id", String.valueOf(R.id.name));
        final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
        dataAdapterr.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
            @Override
            public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                if (view.getId() == R.id.rs_sale1 || view.getId() == R.id.rs_credit1 || view.getId() == R.id.rs_refunds_val || view.getId() == R.id.rs_charges_val || view.getId() == R.id.rs_deposits_val || view.getId() == R.id.rs_write_off_val || view.getId() == R.id.rs_cashout_val) {
                    final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                    TextView dateTextView = (TextView) view;
                    if (tadl_id.toString().equals("India") || tadl_id.toString().equals("Rupee")){
                        dateTextView.setText(insert1_cc);
                    }else {
                        dateTextView.setText(insert1_cc);
                    }
                    return true;
                }
                return false;
            }
        });
        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

        listView.setOnItemClickListener(new AdapterView.OnItemClickListener() {
            @Override
            public void onItemClick(AdapterView<?> parent, View view, int position, long l) {
                final Cursor cursor = (Cursor) parent.getItemAtPosition(position);
                billnum_click = cursor.getString(cursor.getColumnIndex("billnumber"));
                String datee = cursor.getString(cursor.getColumnIndex("date1"));
                String timee = cursor.getString(cursor.getColumnIndex("time1"));
                final String total_bill_amount = cursor.getString(cursor.getColumnIndex("total_amount"));
                final String notes = cursor.getString(cursor.getColumnIndex("notes"));

                TextView bn = new TextView(Customer_Info_Activity.this);
                bn.setText(billnum_click);
                if (bn.getText().toString().equals("")){

                    TextView bn1 = new TextView(Customer_Info_Activity.this);
                    bn1.setText(notes);

                    if (bn1.getText().toString().equals("")){

                    }else {
//                        Toast.makeText(Customer_Info_Activity.this, " "+bn1.getText().toString(), Toast.LENGTH_SHORT).show();
                        final AlertDialog alertDialog = new AlertDialog.Builder(Customer_Info_Activity.this).create();
                        alertDialog.setTitle(getString(R.string.title14));
                        alertDialog.setMessage(bn1.getText().toString());
                        alertDialog.show();
                    }


                }else {

                    Cursor cu = db.rawQuery("SELECT * FROM BIllnumber where billnumber = '" + billnum_click + "'", null);
                    if (cu.moveToFirst()) {
                        final Dialog dialog = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                        dialog.setContentView(R.layout.dialog_customer_manangement_bill_details);
                        dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                        dialog.show();

                        TextView rs = (TextView) dialog.findViewById(R.id.rs);
                        rs.setText(insert1_cc);

                        TableLayout.LayoutParams tableLayoutParams = new TableLayout.LayoutParams();
                        final TableLayout tableLayoutt1 = new TableLayout(Customer_Info_Activity.this);

                        final TableRow tableRow = new TableRow(Customer_Info_Activity.this);
                        tableRow.setOrientation(LinearLayout.HORIZONTAL);
                        tableRow.setPadding(55, 0, 0, 0);

                        ImageButton btncancel = (ImageButton) dialog.findViewById(R.id.btncancel);
                        btncancel.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                dialog.dismiss();
                            }
                        });

                        Button credit = (Button) dialog.findViewById(R.id.credit);
                        credit.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                final Dialog dialog_credit = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                dialog_credit.setContentView(R.layout.dialog_customer_management_credit);
                                dialog_credit.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                                dialog_credit.show();

                                TextView inn = (TextView) dialog_credit.findViewById(R.id.inn);
                                inn.setText("Credit (" + insert1_cc + ")");

                                ImageButton cancel = (ImageButton) dialog_credit.findViewById(R.id.btncancel);
                                cancel.setOnClickListener(new View.OnClickListener() {
                                    @Override
                                    public void onClick(View view) {
                                        dialog_credit.dismiss();
                                    }
                                });

                                final TextInputLayout credit_valid = (TextInputLayout) dialog_credit.findViewById(R.id.credit_valid);
                                final EditText credit_value = (EditText) dialog_credit.findViewById(R.id.credit_value);

                                credit_value.addTextChangedListener(new TextWatcher() {
                                    @Override
                                    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                    }

                                    @Override
                                    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                        credit_valid.setError(null);
                                    }

                                    @Override
                                    public void afterTextChanged(Editable editable) {

                                    }
                                });

                                ImageButton save = (ImageButton) dialog_credit.findViewById(R.id.btnsave);
                                save.setOnClickListener(new View.OnClickListener() {
                                    @Override
                                    public void onClick(View view) {
                                        if (credit_value.getText().toString().equals("") || credit_value.getText().toString().equals("")) {
                                            credit_valid.setError("Enter valid number");
                                        } else {
//                                    final Dialog dialog = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
//                                    dialog.setContentView(R.layout.dialog_customer_management_deposit_cashout_warning);
//                                    dialog.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
//                                    dialog.show();
//
//                                    ImageView close = (ImageView) dialog.findViewById(R.id.closetext);
//                                    close.setOnClickListener(new View.OnClickListener() {
//                                        @Override
//                                        public void onClick(View view) {
//                                            dialog.dismiss();
//                                        }
//                                    });
//
//                                    Button cancel1 = (Button) dialog.findViewById(R.id.cancel);
//                                    cancel1.setOnClickListener(new View.OnClickListener() {
//                                        @Override
//                                        public void onClick(View view) {
//                                            dialog.dismiss();
//                                        }
//                                    });
//
//                                    Button save = (Button) dialog.findViewById(R.id.ok);
//                                    save.setOnClickListener(new View.OnClickListener() {
//                                        @Override
//                                        public void onClick(View view) {
                                            if (Float.parseFloat(credit_value.getText().toString()) > Float.parseFloat(total_bill_amount)) {
                                                credit_valid.setError("Enter lower than bill amount");
                                            } else {
                                                Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
                                                if (c.moveToFirst()) {
                                                    String id = c.getString(0);
                                                    ContentValues contentValues = new ContentValues();
                                                    contentValues.put("credit", credit_value.getText().toString());
                                                    String wherecu = "_id = '" + id + "'";

                                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                    getContentResolver().update(contentUri, contentValues, wherecu, new String[]{});
                                                    resultUri = new Uri.Builder()
                                                            .scheme("content")
                                                            .authority(StubProvider.AUTHORITY)
                                                            .path("Customerdetails")
                                                            .appendQueryParameter("operation", "update")
                                                            .appendQueryParameter("_id", id)
                                                            .build();
                                                    getContentResolver().notifyChange(resultUri, null);


                                                    //     db.update("Customerdetails", contentValues, wherecu, new String[]{});
                                                    dialog.dismiss();
                                                    dialog_credit.dismiss();
                                                }
                                                c.close();
                                            }
//                                        }
//                                    });

                                            TextView total_sales = (TextView) findViewById(R.id.sale_value);

                                            Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                            if (cursor_sales.moveToFirst()) {
                                                float dsirsq = cursor_sales.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                total_sales.setText(rop);
                                            }
                                            cursor_sales.close();

                                            TextView total_credit = (TextView) findViewById(R.id.credit_value);

                                            Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                            if (cursor_credit.moveToFirst()) {
                                                float dsirsq = cursor_credit.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                total_credit.setText(rop);
                                            }
                                            cursor_credit.close();

                                            ListView listView = (ListView) findViewById(R.id.listView);

//                                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY _id DESC", null);
//                                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                                        // the XML defined views which the data will be bound to
//                                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                        Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                            Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY _id DESC", null);
                                            String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};
                                            ;
                                            // the XML defined views which the data will be bound to
                                            int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                                            Log.e("Checamos que hay id", String.valueOf(R.id.name));
                                            final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
                                            listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                            Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (sales_t.moveToFirst()) {
                                                dsirsq1 = sales_t.getFloat(0);
                                            }
                                            sales_t.close();

                                            Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (credit_t.moveToFirst()) {
                                                dsirsq2 = credit_t.getFloat(0);
                                            }
                                            credit_t.close();

                                            Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (deposi_t.moveToFirst()) {
                                                dsirsq3 = deposi_t.getFloat(0);
                                            }
                                            deposi_t.close();

                                            Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (cashout_t.moveToFirst()) {
                                                dsirsq4 = cashout_t.getFloat(0);
                                            }
                                            cashout_t.close();

                                            Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (write_off_t.moveToFirst()) {
                                                dsirsq5 = write_off_t.getFloat(0);
                                            }
                                            write_off_t.close();

                                            final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

                                            TextView total_balance = (TextView) findViewById(R.id.total_balance);
                                            total_balance.setText(String.format("%.1f", cal_sale));

                                            RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
                                            RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
                                            RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);

                                            TextView refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
                                            TextView charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
                                            TextView deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);

                                            Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (cursor_refunds_tot_val.moveToFirst()) {
                                                refunds_tot.setVisibility(View.VISIBLE);
                                                float dsirsq = cursor_refunds_tot_val.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                refunds_tot_val.setText(rop);
                                            } else {
                                                refunds_tot.setVisibility(View.GONE);
                                            }
                                            cursor_refunds_tot_val.close();

                                            Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (cursor_charges_tot_val.moveToFirst()) {
                                                charges_tot.setVisibility(View.VISIBLE);
                                                float dsirsq = cursor_charges_tot_val.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                charges_tot_val.setText(rop);
                                            } else {
                                                charges_tot.setVisibility(View.GONE);
                                            }
                                            cursor_charges_tot_val.close();

                                            Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (cursor_deposits_tot_val.moveToFirst()) {
                                                deposits_tot.setVisibility(View.VISIBLE);
                                                float dsirsq = cursor_deposits_tot_val.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                deposits_tot_val.setText(rop);
                                            } else {
                                                deposits_tot.setVisibility(View.GONE);
                                            }
                                            cursor_deposits_tot_val.close();

                                        }
                                    }
                                });
                            }
                        });

                        Button charges = (Button) dialog.findViewById(R.id.charges);
                        charges.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View view) {
                                final Dialog dialog_charges = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                                dialog_charges.setContentView(R.layout.dialog_customer_management_charges);
                                dialog_charges.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                                dialog_charges.show();

                                TextView inn = (TextView) dialog_charges.findViewById(R.id.inn);
                                inn.setText("Charges (" + insert1_cc + ")");

                                ImageButton cancel = (ImageButton) dialog_charges.findViewById(R.id.btncancel);
                                cancel.setOnClickListener(new View.OnClickListener() {
                                    @Override
                                    public void onClick(View view) {
                                        dialog_charges.dismiss();
                                    }
                                });

                                final TextInputLayout charges_valid = (TextInputLayout) dialog_charges.findViewById(R.id.charges_valid);
                                final EditText charges_value = (EditText) dialog_charges.findViewById(R.id.charges_value);


                                final Spinner rs_per = (Spinner) dialog_charges.findViewById(R.id.rspercent1);

                                ArrayList<String> my_array = new ArrayList<String>();
                                my_array.add("%");
                                my_array.add(insert1_cc);
                                final ArrayAdapter my_Adapterr1 = new ArrayAdapter(Customer_Info_Activity.this, R.layout.spinner_row,
                                        my_array);
                                rs_per.setAdapter(my_Adapterr1);

                                charges_value.addTextChangedListener(new TextWatcher() {
                                    @Override
                                    public void beforeTextChanged(CharSequence charSequence, int i, int i1, int i2) {

                                    }

                                    @Override
                                    public void onTextChanged(CharSequence charSequence, int i, int i1, int i2) {
                                        charges_valid.setError(null);
                                    }

                                    @Override
                                    public void afterTextChanged(Editable editable) {

                                    }
                                });

                                ImageButton save = (ImageButton) dialog_charges.findViewById(R.id.btnsave);
                                save.setOnClickListener(new View.OnClickListener() {
                                    @Override
                                    public void onClick(View view) {
                                        if (charges_value.getText().toString().equals("") || charges_value.getText().toString().equals("")) {
                                            charges_value.setError("Enter valid number");
                                        } else {
//                                    if (Float.parseFloat(charges_value.getText().toString()) > Float.parseFloat(total_bill_amount)){
//                                        charges_valid.setError("Enter lower than bill amount");
//                                    }else {

                                            Object position1 = rs_per.getSelectedItem();
                                            if (position1.equals("%")) {
                                                if (Float.parseFloat(charges_value.getText().toString()) > 100) {
                                                    charges_valid.setError("Enter lesser than 100");
                                                } else {
//                                                Toast.makeText(Customer_Info_Activity.this, "Sleced %", Toast.LENGTH_SHORT).show();

                                                    Cursor c2w = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
                                                    if (c2w.moveToFirst()) {
                                                        String t = c2w.getString(19);
                                                        float div = Float.parseFloat(charges_value.getText().toString());
                                                        float div1 = Float.parseFloat(t);
                                                        div2 = (div / 100) * div1;
                                                    }
                                                    c2w.close();

                                                    if (div2 % 1 != 0) {
                                                        int roo = (int) div2;
                                                        float decpartt = div2 - roo;
                                                        if (decpartt > 0.5) {
                                                            float dee = 1 - decpartt;
                                                            float rundee = div2 + dee;
                                                            int rumdee = (int) rundee;
                                                            Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
                                                            if (c.moveToFirst()) {
                                                                String id = c.getString(0);
                                                                ContentValues contentValues = new ContentValues();
                                                                contentValues.put("charges", String.valueOf(rumdee));
                                                                String wherecu = "_id = '" + id + "'";


                                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                getContentResolver().update(contentUri, contentValues, wherecu, new String[]{});
                                                                resultUri = new Uri.Builder()
                                                                        .scheme("content")
                                                                        .authority(StubProvider.AUTHORITY)
                                                                        .path("Customerdetails")
                                                                        .appendQueryParameter("operation", "update")
                                                                        .appendQueryParameter("_id", id)
                                                                        .build();
                                                                getContentResolver().notifyChange(resultUri, null);


                                                                //              db.update("Customerdetails", contentValues, wherecu, new String[]{});
                                                                dialog.dismiss();
                                                                dialog_charges.dismiss();
                                                            }
                                                            c.close();
//                                                    fulltotal.setText(String.valueOf(rumdee));
                                                        } else {
                                                            float rundee = div2 - decpartt;
                                                            int rumdee = (int) rundee;
                                                            Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
                                                            if (c.moveToFirst()) {
                                                                String id = c.getString(0);
                                                                ContentValues contentValues = new ContentValues();
                                                                contentValues.put("charges", String.valueOf(rumdee));
                                                                String wherecu = "_id = '" + id + "'";

                                                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                                getContentResolver().update(contentUri, contentValues, wherecu, new String[]{});
                                                                resultUri = new Uri.Builder()
                                                                        .scheme("content")
                                                                        .authority(StubProvider.AUTHORITY)
                                                                        .path("Customerdetails")
                                                                        .appendQueryParameter("operation", "update")
                                                                        .appendQueryParameter("_id", id)
                                                                        .build();
                                                                getContentResolver().notifyChange(resultUri, null);


                                                                //     db.update("Customerdetails", contentValues, wherecu, new String[]{});
                                                                dialog.dismiss();
                                                                dialog_charges.dismiss();
                                                            }
                                                            c.close();
//                                                    fulltotal.setText(String.valueOf(rumdee));
                                                        }
                                                    } else {
                                                        Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
                                                        if (c.moveToFirst()) {
                                                            String id = c.getString(0);
                                                            ContentValues contentValues = new ContentValues();
                                                            contentValues.put("charges", String.valueOf(div2));
                                                            String wherecu = "_id = '" + id + "'";

                                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                            getContentResolver().update(contentUri, contentValues, wherecu, new String[]{});
                                                            resultUri = new Uri.Builder()
                                                                    .scheme("content")
                                                                    .authority(StubProvider.AUTHORITY)
                                                                    .path("Customerdetails")
                                                                    .appendQueryParameter("operation", "update")
                                                                    .appendQueryParameter("_id", id)
                                                                    .build();
                                                            getContentResolver().notifyChange(resultUri, null);

                                                            //       db.update("Customerdetails", contentValues, wherecu, new String[]{});
                                                            dialog.dismiss();
                                                            dialog_charges.dismiss();
                                                        }
                                                        c.close();
                                                    }
                                                }


                                            } else {
//                                            Toast.makeText(Customer_Info_Activity.this, "Sleced rs", Toast.LENGTH_SHORT).show();
                                                Cursor c = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
                                                if (c.moveToFirst()) {
                                                    String id = c.getString(0);
                                                    ContentValues contentValues = new ContentValues();
                                                    contentValues.put("charges", charges_value.getText().toString());
                                                    String wherecu = "_id = '" + id + "'";

                                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                                    getContentResolver().update(contentUri, contentValues, wherecu, new String[]{});
                                                    resultUri = new Uri.Builder()
                                                            .scheme("content")
                                                            .authority(StubProvider.AUTHORITY)
                                                            .path("Customerdetails")
                                                            .appendQueryParameter("operation", "update")
                                                            .appendQueryParameter("_id", id)
                                                            .build();
                                                    getContentResolver().notifyChange(resultUri, null);


                                                    //          db.update("Customerdetails", contentValues, wherecu, new String[]{});
                                                    dialog.dismiss();
                                                    dialog_charges.dismiss();
                                                }
                                                c.close();
                                            }


                                            TextView total_sales = (TextView) findViewById(R.id.sale_value);

                                            Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                            if (cursor_sales.moveToFirst()) {
                                                float dsirsq = cursor_sales.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                total_sales.setText(rop);
                                            }
                                            cursor_sales.close();

                                            TextView total_credit = (TextView) findViewById(R.id.credit_value);

                                            Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                            if (cursor_credit.moveToFirst()) {
                                                float dsirsq = cursor_credit.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                total_credit.setText(rop);
                                            }
                                            cursor_credit.close();

                                            ListView listView = (ListView) findViewById(R.id.listView);

//                                        Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY _id DESC", null);
//                                        String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                                        // the XML defined views which the data will be bound to
//                                        int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                                        Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                        Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                                        listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                            Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY _id DESC", null);
                                            String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};
                                            ;
                                            // the XML defined views which the data will be bound to
                                            int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                                            Log.e("Checamos que hay id", String.valueOf(R.id.name));
                                            final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
                                            listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                            RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
                                            RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
                                            RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);

                                            TextView refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
                                            TextView charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
                                            TextView deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);

                                            Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (cursor_refunds_tot_val.moveToFirst()) {
                                                refunds_tot.setVisibility(View.VISIBLE);
                                                float dsirsq = cursor_refunds_tot_val.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                refunds_tot_val.setText(rop);
                                            } else {
                                                refunds_tot.setVisibility(View.GONE);
                                            }
                                            cursor_refunds_tot_val.close();

                                            Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (cursor_charges_tot_val.moveToFirst()) {
                                                charges_tot.setVisibility(View.VISIBLE);
                                                float dsirsq = cursor_charges_tot_val.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                charges_tot_val.setText(rop);
                                            } else {
                                                charges_tot.setVisibility(View.GONE);
                                            }
                                            cursor_charges_tot_val.close();

                                            Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                            if (cursor_deposits_tot_val.moveToFirst()) {
                                                deposits_tot.setVisibility(View.VISIBLE);
                                                float dsirsq = cursor_deposits_tot_val.getFloat(0);
                                                String rop = String.format("%.1f", dsirsq);
                                                deposits_tot_val.setText(rop);
                                            } else {
                                                deposits_tot.setVisibility(View.GONE);
                                            }
                                            cursor_deposits_tot_val.close();

//                                    }

                                        }
                                    }
                                });

                            }
                        });

                        Button print = (Button) dialog.findViewById(R.id.btnprint);
                        print.setOnClickListener(new View.OnClickListener() {
                            @Override
                            public void onClick(View v) {
                                Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
                                if (connnet.moveToFirst()) {
                                    ipnameget = connnet.getString(1);
                                    portget = connnet.getString(2);
                                    statusnet = connnet.getString(3);
                                }
                                connnet.close();

                                Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
                                if (connnet_counter.moveToFirst()) {
                                    ipnameget_counter = connnet_counter.getString(1);
                                    portget_counter = connnet_counter.getString(2);
                                    statusnet_counter = connnet_counter.getString(3);
                                }
                                connnet_counter.close();

                                Cursor conn = db1.rawQuery("SELECT * FROM BTConn", null);
                                if (conn.moveToFirst()) {
                                    nameget = conn.getString(1);
                                    addget = conn.getString(2);
                                    statussusb = conn.getString(3);
                                }
                                conn.close();Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
                                if (cc.moveToFirst()) {
                                    String Na = cc.getString(1);
                                    if (Na.equals("A4")) {
                                        Toast.makeText(getApplicationContext(), "A4", Toast.LENGTH_LONG).show();
                                        Intent intent = new Intent(Customer_Info_Activity.this, A4_Printer_new.class);
                                        intent.putExtra("billnumber", billnum_click);
                                        startActivity(intent);
                                    }else {
                                        if (statusnet.equals("ok")  || statusnet_counter.equals("ok") || statussusb.equals("ok")) {

                                            printbillcopy1(dialog);
                                            //dialog.dismiss();


                                        }else {

                                            String printer_type="";
                                            Cursor aallrows = db1.rawQuery("SELECT * FROM Printer_type WHERE _id = '1'", null);
                                            if (aallrows.moveToFirst()) {
                                                do {
                                                    printer_type = aallrows.getString(1);

                                                } while (aallrows.moveToNext());
                                            }
                                            aallrows.close();

                                            if(printer_type.equalsIgnoreCase("wiseposplus")) {
                                                if (MSWisepadDeviceController.getDeviceType() == MSWisepadDeviceController.DeviceType.WISEPOS_NEO) {
                                                    mPrintData = new ArrayList<>();

                                                    Log.e(Customer_Info_Activity.class.getSimpleName(), "mPrintData: " + mPrintData);
                                                    byte[] receiptData = neoprintbillcopy1(dialog);
                                                    mPrintData.add(receiptData);


                                                    if (mPrintData != null && mPrintData.size() > 0) {
                                                        mMSWisepadDeviceController.print(mPrintData);
                                                    }

                                                } else {
                                                    wiseposprintbillcopy1(dialog);

                                                }
                                            }else {

                                                final Dialog dialogconn = new Dialog(Customer_Info_Activity.this, R.style.notitle);
                                                dialogconn.setContentView(R.layout.dialog_printer_conn_error_orderlist);

                                                Button conti = (Button) dialogconn.findViewById(R.id.ok);
                                                conti.setOnClickListener(new View.OnClickListener() {
                                                    @Override
                                                    public void onClick(View v) {
                                                        //Toast.makeText(Customer_Info_Activity.this, "checkprinterconncash11", Toast.LENGTH_SHORT).show();
                                                        dialogconn.dismiss();
                                                    }
                                                });

                                                dialogconn.show();
                                            }
                                        }
                                        //printbillcopy1(dialog);
                                    }
                                }
                                cc.close();
                            }
                        });


                        Cursor alert = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
                        if (alert.moveToFirst()) {
                            do {
                                String paym = alert.getString(5);
                                String billt = alert.getString(6);

                                TextView tv = new TextView(Customer_Info_Activity.this);
                                tv.setText(paym);

                                TextView tv1 = new TextView(Customer_Info_Activity.this);
                                tv1.setText(billt);

                                ContentValues cv = new ContentValues();
                                if (tv.getText().toString().equals("")) {
                                    cv.put("paymentmethod", "  Cash");
                                    String where = "billnumber = '" + billnum_click + "' ";


                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Billnumber");
                                    getContentResolver().update(contentUri, cv, where, new String[]{});
                                    resultUri = new Uri.Builder()
                                            .scheme("content")
                                            .authority(StubProvider.AUTHORITY)
                                            .path("Billnumber")
                                            .appendQueryParameter("operation", "update")
                                            .appendQueryParameter("billnumber", billnum_click)
                                            .build();
                                    getContentResolver().notifyChange(resultUri, null);


                                    //      db.update("Billnumber", cv, where, new String[]{});
                                }

                            } while (alert.moveToNext());
                        }
                        alert.close();

                        Cursor alert1 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
                        if (alert1.moveToFirst()) {
                            do {
                                String paym = alert1.getString(5);
                                String billt = alert1.getString(6);

                                TextView tv = new TextView(Customer_Info_Activity.this);
                                tv.setText(paym);

                                TextView tv1 = new TextView(Customer_Info_Activity.this);
                                tv1.setText(billt);

                                ContentValues cv = new ContentValues();
                                if (tv1.getText().toString().equals("")) {
                                    cv.put("billtype", "  General");
                                    String where = "billnumber = '" + billnum_click + "' ";


                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Billnumber");
                                    getContentResolver().update(contentUri, cv, where, new String[]{});
                                    resultUri = new Uri.Builder()
                                            .scheme("content")
                                            .authority(StubProvider.AUTHORITY)
                                            .path("Billnumber")
                                            .appendQueryParameter("operation", "update")
                                            .appendQueryParameter("billnumber", billnum_click)
                                            .build();
                                    getContentResolver().notifyChange(resultUri, null);


                                    //    db.update("Billnumber", cv, where, new String[]{});
                                }

                            } while (alert1.moveToNext());
                        }
                        alert1.close();

                        Cursor alert2 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
                        if (alert2.moveToFirst()) {
                            do {
                                String paym = alert2.getString(17);

                                TextView tv = new TextView(Customer_Info_Activity.this);
                                tv.setText(paym);

                                ContentValues cv = new ContentValues();
                                if (tv.getText().toString().equals("")) {
                                    cv.put("paymentmethod", "  Cash");
                                    String where = "bill_no = '" + billnum_click + "' ";


                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "All_Sales");
                                    getContentResolver().update(contentUri, cv, where, new String[]{});
                                    resultUri = new Uri.Builder()
                                            .scheme("content")
                                            .authority(StubProvider.AUTHORITY)
                                            .path("All_Sales")
                                            .appendQueryParameter("operation", "update")
                                            .appendQueryParameter("bill_no", billnum_click)
                                            .build();
                                    getContentResolver().notifyChange(resultUri, null);


                                    //       db.update("All_Sales", cv, where, new String[]{});
                                }

                            } while (alert2.moveToNext());
                        }
                        alert2.close();

                        Cursor alert3 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
                        if (alert3.moveToFirst()) {
                            do {
                                String billt = alert3.getString(16);

                                TextView tv1 = new TextView(Customer_Info_Activity.this);
                                tv1.setText(billt);

                                ContentValues cv = new ContentValues();
                                if (tv1.getText().toString().equals("")) {
                                    cv.put("billtype", "  General");
                                    String where = "bill_no = '" + billnum_click + "' ";


                                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "All_Sales");
                                    getContentResolver().update(contentUri, cv, where, new String[]{});
                                    resultUri = new Uri.Builder()
                                            .scheme("content")
                                            .authority(StubProvider.AUTHORITY)
                                            .path("All_Sales")
                                            .appendQueryParameter("operation", "update")
                                            .appendQueryParameter("bill_no", billnum_click)
                                            .build();
                                    getContentResolver().notifyChange(resultUri, null);


                                    //    db.update("All_Sales", cv, where, new String[]{});
                                }

                            } while (alert3.moveToNext());
                        }
                        alert3.close();

                        Cursor bi = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "' AND type = 'Item' AND mod_assigned = 'yes'", null);
                        if (bi.moveToFirst()) {
                            do {

                                String na = bi.getString(1);
//                                            Toast.makeText(getActivity(), "Items are "+na, Toast.LENGTH_SHORT).show();

                                TextView tvmod = new TextView(Customer_Info_Activity.this);
                                tvmod.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                //tvmod.setPadding(100, 0, 0, 0);
                                tvmod.setText(na);
                                tvmod.setPadding(0, 0, 0, 0);
                                tvmod.setTextColor(Color.parseColor("#000000"));
                                tableRow.addView(tvmod);


                                Cursor mo = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "' AND type = 'Modifier' AND parent = '" + na + "'", null);
                                if (mo.moveToFirst()) {
                                    do {
                                        String mod = mo.getString(1);
//                                                    Toast.makeText(getActivity(), "modifiers of "+na+" is "+mod, Toast.LENGTH_SHORT).show();

                                        TextView tvmod1 = new TextView(Customer_Info_Activity.this);
                                        tvmod1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                        //tvmod.setPadding(100, 0, 0, 0);
                                        tvmod1.setText(mod);
                                        tvmod1.setPadding(0, 0, 0, 0);
                                        tvmod1.setTextColor(Color.parseColor("#000000"));
                                        tableRow.addView(tvmod1);
                                    } while (mo.moveToNext());
                                }
                                mo.close();
                            } while (bi.moveToNext());
                        }
                        bi = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "' AND type = 'Item' AND mod_assigned = 'no'", null);
                        if (bi.moveToFirst()) {
                            do {
                                String na = bi.getString(1);
//                                            Toast.makeText(getActivity(), "Items are "+na, Toast.LENGTH_SHORT).show();

                                TextView tvmod = new TextView(Customer_Info_Activity.this);
                                tvmod.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                //tvmod.setPadding(100, 0, 0, 0);
                                tvmod.setText(na);
                                tvmod.setPadding(0, 0, 0, 0);
                                tvmod.setTextColor(Color.parseColor("#000000"));
                                tableRow.addView(tvmod);

                            } while (bi.moveToNext());
                        }

                        tableLayoutt1.addView(tableRow);

                        TextView bilnumb = (TextView) dialog.findViewById(R.id.billnumb);
                        bilnumb.setText(String.valueOf(billnum_click));


                        Cursor billtypee = db.rawQuery("Select * from Billnumber WHERE billnumber = '" + billnum_click + "' ", null);
                        if (billtypee.moveToFirst()) {
                            bill_coun = billtypee.getString(11);
                        }
                        billtypee.close();

                        TextView billid_value = (TextView) dialog.findViewById(R.id.billid_value);
                        billid_value.setText(String.valueOf(bill_coun));

                        TextView datees = (TextView) dialog.findViewById(R.id.date);
                        datees.setText(datee);
                        TextView timees = (TextView) dialog.findViewById(R.id.time);
                        timees.setText(timee);

                        LinearLayout custadd = (LinearLayout) dialog.findViewById(R.id.address);
                        TextView custname = (TextView) dialog.findViewById(R.id.cust_name);
                        TextView custaddr = (TextView) dialog.findViewById(R.id.cust_address);
                        TextView custph = (TextView) dialog.findViewById(R.id.cust_phno);
                        TextView custema = (TextView) dialog.findViewById(R.id.cust_emailid);

                        LinearLayout comments = (LinearLayout) dialog.findViewById(R.id.comments);
                        TextView sale_comm = (TextView) dialog.findViewById(R.id.sale_comm);
                        sale_comm.setText("");
                        Cursor cursor_sale_comm = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
                        if (cursor_sale_comm.moveToFirst()) {
                            String string_sale_comm = cursor_sale_comm.getString(13);
                            sale_comm.setText(string_sale_comm);
                            if (sale_comm.getText().toString().equals("")) {
                                comments.setVisibility(View.GONE);
                            } else {
                                comments.setVisibility(View.VISIBLE);
                            }
                        }
                        cursor_sale_comm.close();

                        TextView subtotoalam = (TextView) dialog.findViewById(R.id.subtotal);
                        TextView discpercent = (TextView) dialog.findViewById(R.id.dispercent);
                        TextView discval = (TextView) dialog.findViewById(R.id.discount);
                        TextView savingsval = (TextView) dialog.findViewById(R.id.disc_savings);
                        TextView taxvalue = (TextView) dialog.findViewById(R.id.tax);
                        TextView roundedoffvalue = (TextView) dialog.findViewById(R.id.roundedoff);
                        TextView loyalty_points = (TextView) dialog.findViewById(R.id.loyalty_points);
                        TextView loyalty_amount = (TextView) dialog.findViewById(R.id.loyalty_amount);
                        TextView total = (TextView) dialog.findViewById(R.id.totalold);

                        TextView compname = (TextView) dialog.findViewById(R.id.compname);
                        TextView compadd1 = (TextView) dialog.findViewById(R.id.address1);
                        TextView compadd2 = (TextView) dialog.findViewById(R.id.address2);
                        TextView compadd3 = (TextView) dialog.findViewById(R.id.address3);
                        TextView compphnoo = (TextView) dialog.findViewById(R.id.phoneno);
                        TextView compemail = (TextView) dialog.findViewById(R.id.emailid);
                        TextView compwebsite = (TextView) dialog.findViewById(R.id.website);
                        TextView comptaxlicen = (TextView) dialog.findViewById(R.id.taxlineone);


                        TextView foo = (TextView) dialog.findViewById(R.id.footer);

                        TextView tableidd = (TextView) dialog.findViewById(R.id.tableid);
                        TextView paymenttypee = (TextView) dialog.findViewById(R.id.paymenttype);
                        TextView paymentmethodd = (TextView) dialog.findViewById(R.id.paymentmethod);

                        TableLayout tableLayoutt = (TableLayout) dialog.findViewById(R.id.lytpedidooo);
                        tableLayoutt.removeAllViews();

                        Cursor all = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
                        if (all.moveToFirst()) {
                            String tab_id = all.getString(15);
                            String billtype = all.getString(16);
                            String cashcard = all.getString(17);

                            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tab_id + "'", null);
                            if (vbnm.moveToFirst()) {
                                assa1 = vbnm.getString(1);
                                assa2 = vbnm.getString(2);
                            }
                            vbnm.close();
                            TextView cx = new TextView(Customer_Info_Activity.this);
                            cx.setText(assa1);
                            if (cx.getText().toString().equals("")) {
                                tableidd.setText(assa2);
                            } else {
                                tableidd.setText(assa1);
                            }

                            paymenttypee.setText(billtype);
                            paymentmethodd.setText(cashcard);
                        }
                        all.close();

                        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
                        if (cursor3.moveToFirst()) {
                            sub = cursor3.getString(7);
                            subtotoalam.setText(sub);
                        }
                        cursor3.close();

                        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
                        if (cursor4.moveToFirst()) {
                            String taxpe = cursor4.getString(5);
                            discpercent.setText(taxpe);
                        }
                        cursor4.close();

                        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
                        if (cursor5.moveToFirst()) {
                            String dsirs = cursor5.getString(7);
                            float dsirsq = Float.parseFloat(dsirs);
                            String rop = String.format("%.2f", dsirsq);
                            discval.setText(rop);
                        }
                        cursor5.close();

                        Cursor cursor51 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE bill_no = '" + billnum_click + "' AND disc_thereornot = 'yes'", null);
                        if (cursor51.moveToFirst()) {
                            float dsirsq = cursor51.getFloat(0);
                            String rop = String.format("%.2f", dsirsq);
                            savingsval.setText(rop);
                        }
                        cursor51.close();

                        Cursor cursor6 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
                        if (cursor6.moveToFirst()) {
                            String sub = cursor6.getString(8);
                            if (sub.equals("")) {
                                taxvalue.setText("0.0");
                            } else {
                                float vv = Float.parseFloat(sub);
                                taxvalue.setText(String.format("%.2f", vv));
                            }

                        }
                        cursor6.close();

                        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
                        if (cursor7.moveToFirst()) {
                            String sub = cursor7.getString(9);
                            String point = cursor7.getString(16);
                            String amount = cursor7.getString(17);
                            roundedoffvalue.setText(sub);
                            loyalty_points.setText(point);
                            loyalty_amount.setText(amount);
                        }
                        cursor7.close();

                        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
                        if (cursor8.moveToFirst()) {
                            String sub = cursor8.getString(2);
                            total.setText(sub);
                        }
                        cursor8.close();

                        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursorr.moveToFirst()) {

                            do {

                                String nbg = ccursorr.getString(0);
                                String name = ccursorr.getString(1);
                                String value = ccursorr.getString(2);
                                String pq = ccursorr.getString(5);
                                String itna = ccursorr.getString(2);
                                String pricee = ccursorr.getString(3);
                                String tototot = ccursorr.getString(4);

                                final String newid = ccursorr.getString(20);


                                if (pq.equals("Item")) {
                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                                    final TableRow row1 = new TableRow(Customer_Info_Activity.this);
                                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                                    final TableRow row2 = new TableRow(Customer_Info_Activity.this);
                                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT));

                                    //TableLayout.LayoutParams tableLayoutParams = new TableLayout.LayoutParams();
                                    final TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);
                                    final TableLayout tableLayout_disc = new TableLayout(Customer_Info_Activity.this);

                                    TableRow.LayoutParams lp, lp1, lp2;

                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.70f));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                                    //tv.setTextSize(18);
                                    //tv.setTypeface(Typeface.MONOSPACE);
                                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    //tv.setPadding(0, 0, 0, 0);
                                    //text = ccursorr.getString(1);
                                    tv.setText(value);
                                    row.addView(tv);

                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.6f));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    //tv1.setTypeface(Typeface.MONOSPACE);
                                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    //tv1.setTextSize(15);
                                    //tv.setPadding(0, 0, 0, 0);
                                    //text = ccursorr.getString(1);
                                    tv1.setText(name);
                                    String value1 = tv1.getText().toString();
                                    row.addView(tv1);

                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                                    //lp = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 4.5f);
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.0f));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    //tv2.append(value + "% " + name);
                                    tv2.setText(pricee);
                                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    //tv2.setTextColor(R.color.black);
                                    row.addView(tv2);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                                    //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    //tv3.setPadding(5, 0, 0, 0);
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    //tv2.setPadding(0, 0, 1, 0);
                                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    tv3.setText(tototot);
                                    //tv3.setTextColor(R.color.black);
                                    //row.addView(tv3);


                                    String value2 = tv3.getText().toString();

                                    //tableLayoutt.addView(row);

                                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                                    if (modcursor.moveToFirst()) {
                                        do {

                                            final String modiname = modcursor.getString(1);
                                            final String modiquan = modcursor.getString(2);
                                            String modiprice = modcursor.getString(3);
                                            String moditotal = modcursor.getString(4);
                                            final String modiid = modcursor.getString(0);

                                            final TableRow tableRow11 = new TableRow(Customer_Info_Activity.this);
                                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                                    TableRow.LayoutParams.MATCH_PARENT,
                                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                                            final TextView tvv = new TextView(Customer_Info_Activity.this);
                                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                                            tvv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.70f));
                                            //tv.setBackgroundResource(R.drawable.cell_shape);
                                            //tv.setGravity(Gravity.CENTER);
                                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                            //tvv.setTypeface(Typeface.MONOSPACE);
                                            tvv.setText("");
                                            tableRow11.addView(tvv);

                                            TextView tv4 = new TextView(Customer_Info_Activity.this);
                                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                            tv4.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.6f));
                                            //tv3.setPadding(5, 0, 0, 0);
                                            //tv.setBackgroundResource(R.drawable.cell_shape);
                                            tv4.setText(modiname);
                                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                            //tv4.setTypeface(Typeface.MONOSPACE);
                                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                            //tv3.setTextColor(R.color.black);
                                            tableRow11.addView(tv4);

                                            TextView tv5 = new TextView(Customer_Info_Activity.this);
                                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                            tv5.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.0f));
                                            //tv3.setPadding(5, 0, 0, 0);
                                            //tv.setBackgroundResource(R.drawable.cell_shape);
                                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                            //tv5.setTypeface(Typeface.MONOSPACE);
                                            //tv2.setPadding(0, 0, 1, 0);
                                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                            tv5.setText(String.valueOf(Float.parseFloat(modiprice)));
                                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                            //tv3.setTextColor(R.color.black);
                                            tableRow11.addView(tv5);

                                            TextView tv6 = new TextView(Customer_Info_Activity.this);
                                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                            tv6.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                            //tv3.setPadding(5, 0, 0, 0);
                                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                            //tv6.setTypeface(Typeface.MONOSPACE);
                                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                            //tv.setBackgroundResource(R.drawable.cell_shape);
                                            tv6.setText("");
                                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                            //tv3.setTextColor(R.color.black);
                                            tableRow11.addView(tv6);


                                            final TextView tv7 = new TextView(Customer_Info_Activity.this);
                                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                            tv7.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                            //tv7.setTypeface(Typeface.MONOSPACE);
                                            //tv3.setPadding(0,0,10,0);
                                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);

                                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                                            final String number = tv.getText().toString();
                                            float newmul = Float.parseFloat(number);
                                            //final float in = Float.parseFloat(cursor.getString(4));
                                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                            //newmul = Integer.parseInt(multiply);
                                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                                            //row.addView(tv3);


                                            row.removeView(tv8);

                                            Cursor cursor41 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnum_click + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                                            if (cursor41.moveToFirst()) {
                                                int sub2a = cursor41.getInt(0);
                                                String sub2a1 = String.valueOf(sub2a);
                                                ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot);
                                                ss1 = String.valueOf(ss);
                                                //Toast.makeText(getActivity(), "2 "+ss1, Toast.LENGTH_SHORT).show();
                                            }
                                            cursor41.close();

                                            tv8 = new TextView(Customer_Info_Activity.this);
                                            tv8.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                            //tv.setBackgroundResource(R.drawable.cell_shape);
                                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                            //tv3.setPadding(0, 0, 10, 0);
                                            //tv8.setTypeface(Typeface.MONOSPACE);
                                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);

                                            final String numberr = tv.getText().toString();
                                            float newmulr = Float.parseFloat(numberr);
                                            //final float in = Float.parseFloat(cursor.getString(4));
                                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                                            //newmul = Integer.parseInt(multiply);
                                            tv8.setText(ss1);
                                            row.addView(tv8);


                                            tableLayout1.addView(tableRow11);
                                        } while (modcursor.moveToNext());

                                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                                        if (disc_cursor.moveToFirst()) {
                                            do {
                                                String disc_vv = disc_cursor.getString(12);
                                                String disc_there = disc_cursor.getString(30);
                                                if (disc_there.toString().equals("no")) {

                                                } else {
                                                    ///Toast.makeText(Customer_Info_Activity.this, "aaa " +disc_vv, Toast.LENGTH_SHORT).show();

                                                    final TableRow row_disc = new TableRow(Customer_Info_Activity.this);
                                                    row_disc.setLayoutParams(new TableLayout.LayoutParams(
                                                            TableRow.LayoutParams.MATCH_PARENT,
                                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
                                                    //row_disc.setPadding(padding_in_px, padding_in_px1, padding_in_px, padding_in_px1);

                                                    TextView textView2 = new TextView(Customer_Info_Activity.this);
                                                    textView2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 3.44f));
                                                    textView2.setText("");
                                                    row_disc.addView(textView2);

                                                    disc_tv = new TextView(Customer_Info_Activity.this);
                                                    disc_tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.60f));
                                                    disc_tv.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                                    disc_tv.setText("-" + disc_cursor.getString(31));
                                                    disc_tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                                    row_disc.addView(disc_tv);

                                                    tableLayout_disc.addView(row_disc);
                                                }
                                            } while (disc_cursor.moveToNext());
                                        }
                                        disc_cursor.close();

                                    } else {
                                        tv8 = new TextView(Customer_Info_Activity.this);
                                        tv8.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                        //tv.setBackgroundResource(R.drawable.cell_shape);
                                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                        //tv3.setPadding(0, 0, 10, 0);
                                        //tv8.setTypeface(Typeface.MONOSPACE);
                                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);

                                        final String number = tv.getText().toString();
                                        float newmul = Float.parseFloat(number);
                                        //final float in = Float.parseFloat(cursor.getString(4));
                                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                        float multiply_new = Float.parseFloat(multiply);
                                        //newmul = Integer.parseInt(multiply);
                                        tv8.setText(String.format("%.2f", multiply_new));
                                        row.addView(tv8);

                                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                                        if (disc_cursor.moveToFirst()) {
                                            do {
                                                String disc_vv = disc_cursor.getString(12);
                                                String disc_there = disc_cursor.getString(30);
                                                if (disc_there.toString().equals("no")) {

                                                } else {
                                                    ///Toast.makeText(Customer_Info_Activity.this, "aaa " +disc_vv, Toast.LENGTH_SHORT).show();

                                                    final TableRow row_disc = new TableRow(Customer_Info_Activity.this);
                                                    row_disc.setLayoutParams(new TableLayout.LayoutParams(
                                                            TableRow.LayoutParams.MATCH_PARENT,
                                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
                                                    //row_disc.setPadding(padding_in_px, padding_in_px1, padding_in_px, padding_in_px1);

                                                    TextView textView2 = new TextView(Customer_Info_Activity.this);
                                                    textView2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 3.44f));
                                                    textView2.setText("");
                                                    row_disc.addView(textView2);

                                                    disc_tv = new TextView(Customer_Info_Activity.this);
                                                    disc_tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.60f));
                                                    disc_tv.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                                    disc_tv.setText("-" + disc_cursor.getString(31));
                                                    disc_tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                                    row_disc.addView(disc_tv);

                                                    tableLayout_disc.addView(row_disc);
                                                }
                                            } while (disc_cursor.moveToNext());
                                        }
                                        disc_cursor.close();

                                    }
                                    modcursor.close();

                                    tableLayoutt.addView(row);

                                    tableLayoutt.addView(tableLayout1);

                                    tableLayoutt.addView(tableLayout_disc);

                                }

                            } while (ccursorr.moveToNext());
                        }
                        ccursorr.close();

                        TableLayout tableLayout1 = (TableLayout) dialog.findViewById(R.id.lytpedidoo);
                        tableLayout1.removeAllViews();

                        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor.moveToFirst()) {

                            do {

                                String name = ccursor.getString(10);
                                String value = ccursor.getString(9);
                                String pq = ccursor.getString(50);
                                String itna = ccursor.getString(1);

                                TextView name_1 = new TextView(Customer_Info_Activity.this);
                                name_1.setText(name);

                                TextView value_1 = new TextView(Customer_Info_Activity.this);
                                value_1.setText(value);

                                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None")
                                        || value_1.getText().toString().equals("") || name_1.getText().toString().equals("")) {

                                } else {

//                    final TableRow row = new TableRow(getActivity());
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(getActivity());
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                                    TextView tvv = new TextView(Customer_Info_Activity.this);
                                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tvv.setGravity(Gravity.START);
                                    tvv.setTextSize(16);
                                    //tvv.setTypeface(Typeface.MONOSPACE);
                                    tvv.setText(name);

                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv1.setGravity(Gravity.START);
                                    //tv1.setTypeface(Typeface.MONOSPACE);
                                    float vbn = Float.parseFloat(value);
                                    String bvn = String.format("%.2f", vbn);
                                    tv1.setText(value);
                                    String value1 = tv1.getText().toString();

                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                                    tv2.append(name);
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    tv2.setPadding(0, 0, 20, 0);
                                    tv2.setTextSize(16);
                                    //tv2.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv2);

                                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                                    textView1.setTextSize(16);
                                    row.addView(textView1);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    tv3.setGravity(Gravity.END);
                                    float mul = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                                    float tota = mul;
                                    String tota1 = String.format("%.2f", tota);
                                    //tv3.setPadding(0,0,10,0);
                                    tv3.setText(String.valueOf(tota1));
                                    //tv3.setTypeface(Typeface.MONOSPACE);
                                    //tv3.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv3);


                                    tv3.setTextSize(16);
                                    String value2 = tv3.getText().toString();

                                    tableLayout1.addView(row);
                                }


                            } while (ccursor.moveToNext());
                        }
                        ccursor.close();

                        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor2.moveToFirst()) {

                            do {

                                String name = ccursor2.getString(35);
                                String value = ccursor2.getString(36);
                                String pq = ccursor2.getString(50);
                                String itna = ccursor2.getString(1);

                                TextView name_1 = new TextView(Customer_Info_Activity.this);
                                name_1.setText(name);

                                TextView value_1 = new TextView(Customer_Info_Activity.this);
                                value_1.setText(value);

                                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None")
                                        || value_1.getText().toString().equals("") || name_1.getText().toString().equals("")) {

                                } else {

//                    final TableRow row = new TableRow(getActivity());
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(getActivity());
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                                    TextView tvv = new TextView(Customer_Info_Activity.this);
                                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tvv.setGravity(Gravity.START);
                                    tvv.setTextSize(16);
                                    //tvv.setTypeface(Typeface.MONOSPACE);
                                    tvv.setText(name);

                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv1.setGravity(Gravity.START);
                                    //tv1.setTypeface(Typeface.MONOSPACE);
                                    float vbn = Float.parseFloat(value);
                                    String bvn = String.format("%.2f", vbn);
                                    tv1.setText(value);
                                    String value1 = tv1.getText().toString();

                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                                    tv2.append(name);
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    tv2.setPadding(0, 0, 20, 0);
                                    tv2.setTextSize(16);
                                    //tv2.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv2);

                                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                                    textView1.setTextSize(16);
                                    row.addView(textView1);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    tv3.setGravity(Gravity.END);
                                    float mul = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                                    float tota = mul;
                                    String tota1 = String.format("%.2f", tota);
                                    //tv3.setPadding(0,0,10,0);
                                    tv3.setText(String.valueOf(tota1));
                                    //tv3.setTypeface(Typeface.MONOSPACE);
                                    //tv3.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv3);


                                    tv3.setTextSize(16);
                                    String value2 = tv3.getText().toString();

                                    tableLayout1.addView(row);
                                }


                            } while (ccursor2.moveToNext());
                        }
                        ccursor2.close();

                        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor3.moveToFirst()) {

                            do {

                                String name = ccursor3.getString(37);
                                String value = ccursor3.getString(38);
                                String pq = ccursor3.getString(50);
                                String itna = ccursor3.getString(1);

                                TextView name_1 = new TextView(Customer_Info_Activity.this);
                                name_1.setText(name);

                                TextView value_1 = new TextView(Customer_Info_Activity.this);
                                value_1.setText(value);

                                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None")
                                        || value_1.getText().toString().equals("") || name_1.getText().toString().equals("")) {

                                } else {

//                    final TableRow row = new TableRow(getActivity());
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(getActivity());
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                                    TextView tvv = new TextView(Customer_Info_Activity.this);
                                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tvv.setGravity(Gravity.START);
                                    tvv.setTextSize(16);
                                    //tvv.setTypeface(Typeface.MONOSPACE);
                                    tvv.setText(name);

                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv1.setGravity(Gravity.START);
                                    //tv1.setTypeface(Typeface.MONOSPACE);
                                    float vbn = Float.parseFloat(value);
                                    String bvn = String.format("%.2f", vbn);
                                    tv1.setText(value);
                                    String value1 = tv1.getText().toString();

                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                                    tv2.append(name);
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    tv2.setPadding(0, 0, 20, 0);
                                    tv2.setTextSize(16);
                                    //tv2.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv2);

                                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                                    textView1.setTextSize(16);
                                    row.addView(textView1);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    tv3.setGravity(Gravity.END);
                                    float mul = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                                    float tota = mul;
                                    String tota1 = String.format("%.2f", tota);
                                    //tv3.setPadding(0,0,10,0);
                                    tv3.setText(String.valueOf(tota1));
                                    //tv3.setTypeface(Typeface.MONOSPACE);
                                    //tv3.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv3);


                                    tv3.setTextSize(16);
                                    String value2 = tv3.getText().toString();

                                    tableLayout1.addView(row);
                                }


                            } while (ccursor3.moveToNext());
                        }
                        ccursor3.close();

                        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor4.moveToFirst()) {

                            do {

                                String name = ccursor4.getString(39);
                                String value = ccursor4.getString(40);
                                String pq = ccursor4.getString(50);
                                String itna = ccursor4.getString(1);

                                TextView name_1 = new TextView(Customer_Info_Activity.this);
                                name_1.setText(name);

                                TextView value_1 = new TextView(Customer_Info_Activity.this);
                                value_1.setText(value);

                                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None")
                                        || value_1.getText().toString().equals("") || name_1.getText().toString().equals("")) {

                                } else {

//                    final TableRow row = new TableRow(getActivity());
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(getActivity());
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                                    TextView tvv = new TextView(Customer_Info_Activity.this);
                                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tvv.setGravity(Gravity.START);
                                    tvv.setTextSize(16);
                                    //tvv.setTypeface(Typeface.MONOSPACE);
                                    tvv.setText(name);

                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv1.setGravity(Gravity.START);
                                    //tv1.setTypeface(Typeface.MONOSPACE);
                                    float vbn = Float.parseFloat(value);
                                    String bvn = String.format("%.2f", vbn);
                                    tv1.setText(value);
                                    String value1 = tv1.getText().toString();

                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                                    tv2.append(name);
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    tv2.setPadding(0, 0, 20, 0);
                                    tv2.setTextSize(16);
                                    //tv2.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv2);

                                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                                    textView1.setTextSize(16);
                                    row.addView(textView1);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    tv3.setGravity(Gravity.END);
                                    float mul = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                                    float tota = mul;
                                    String tota1 = String.format("%.2f", tota);
                                    //tv3.setPadding(0,0,10,0);
                                    tv3.setText(String.valueOf(tota1));
                                    //tv3.setTypeface(Typeface.MONOSPACE);
                                    //tv3.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv3);


                                    tv3.setTextSize(16);
                                    String value2 = tv3.getText().toString();

                                    tableLayout1.addView(row);
                                }


                            } while (ccursor4.moveToNext());
                        }
                        ccursor4.close();

                        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor5.moveToFirst()) {

                            do {

                                String name = ccursor5.getString(41);
                                String value = ccursor5.getString(42);
                                String pq = ccursor5.getString(50);
                                String itna = ccursor5.getString(1);

                                TextView name_1 = new TextView(Customer_Info_Activity.this);
                                name_1.setText(name);

                                TextView value_1 = new TextView(Customer_Info_Activity.this);
                                value_1.setText(value);

                                if (value_1.getText().toString().equals("0") || name_1.getText().toString().equals("NONE") || name_1.getText().toString().equals("None")
                                        || value_1.getText().toString().equals("") || name_1.getText().toString().equals("")) {

                                } else {

//                    final TableRow row = new TableRow(getActivity());
//                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
//                            TableRow.LayoutParams.WRAP_CONTENT));
//                    row.setGravity(Gravity.CENTER);

                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                    TableRow.LayoutParams lp, lp1, lp2;

//                                    final TextView tv = new TextView(getActivity());
//                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                    tv.setTextSize(16);
//                                    tv.setTypeface(Typeface.MONOSPACE);
//                                    row.addView(tv);

                                    TextView tvv = new TextView(Customer_Info_Activity.this);
                                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tvv.setGravity(Gravity.START);
                                    tvv.setTextSize(16);
                                    //tvv.setTypeface(Typeface.MONOSPACE);
                                    tvv.setText(name);

                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv1.setGravity(Gravity.START);
                                    //tv1.setTypeface(Typeface.MONOSPACE);
                                    float vbn = Float.parseFloat(value);
                                    String bvn = String.format("%.2f", vbn);
                                    tv1.setText(value);
                                    String value1 = tv1.getText().toString();

                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
//                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                    tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                                    tv2.append(name);
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    tv2.setPadding(0, 0, 20, 0);
                                    tv2.setTextSize(16);
                                    //tv2.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv2);

                                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                                    textView1.setTextSize(16);
                                    row.addView(textView1);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
                                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                                    tv3.setGravity(Gravity.END);
                                    float mul = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                                    float tota = mul;
                                    String tota1 = String.format("%.2f", tota);
                                    //tv3.setPadding(0,0,10,0);
                                    tv3.setText(String.valueOf(tota1));
                                    //tv3.setTypeface(Typeface.MONOSPACE);
                                    //tv3.setTextColor(Color.parseColor("#000000"));
                                    row.addView(tv3);


                                    tv3.setTextSize(16);
                                    String value2 = tv3.getText().toString();

                                    tableLayout1.addView(row);
                                }


                            } while (ccursor5.moveToNext());
                        }
                        ccursor5.close();

                        String phon = "0";
                        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
                        if (caddress1.moveToFirst()) {
                            phon = caddress1.getString(2);
                        }
                        caddress1.close();

                        TextView tvvs = new TextView(Customer_Info_Activity.this);
                        tvvs.setText(phon);

                        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
                        if (us_name1.moveToLast()) {
//                        Toast.makeText(Customer_Info_Activity.this, "user id there", Toast.LENGTH_LONG).show();
                            String na53 = us_name1.getString(53);
                            String na38 = us_name1.getString(38);
                            String na39 = us_name1.getString(39);
                            String na40 = us_name1.getString(40);
                            String na41 = us_name1.getString(41);
                            String na42 = us_name1.getString(42);
                            String na43 = us_name1.getString(43);
                            String na44 = us_name1.getString(44);
                            String na45 = us_name1.getString(45);
                            String na46 = us_name1.getString(46);
                            String na47 = us_name1.getString(47);
                            String na48 = us_name1.getString(48);
                            String na49 = us_name1.getString(49);
                            String na50 = us_name1.getString(50);
                            String na51 = us_name1.getString(51);
                            String na52 = us_name1.getString(52);
                            String na38_value = us_name1.getString(54);
                            String na39_value = us_name1.getString(55);
                            String na40_value = us_name1.getString(56);
                            String na41_value = us_name1.getString(57);
                            String na42_value = us_name1.getString(58);
                            String na43_value = us_name1.getString(59);
                            String na44_value = us_name1.getString(60);
                            String na45_value = us_name1.getString(61);
                            String na46_value = us_name1.getString(62);
                            String na47_value = us_name1.getString(63);
                            String na48_value = us_name1.getString(64);
                            String na49_value = us_name1.getString(65);
                            String na50_value = us_name1.getString(66);
                            String na51_value = us_name1.getString(67);
                            String na52_value = us_name1.getString(68);

                            String proc = us_name1.getString(69);

                            TextView hid = new TextView(Customer_Info_Activity.this);
                            hid.setText(proc);

                            if (hid.getText().toString().equals("off")) {
                                Cursor cursorr = null;
                                if (paymenttypee.getText().toString().equals("  Dine-in") || paymenttypee.getText().toString().equals("  General") || paymenttypee.getText().toString().equals("  Others")) {
                                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                }
                                if (paymenttypee.getText().toString().equals("  Takeaway") || paymenttypee.getText().toString().equals("  Main")) {
                                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                }
                                if (paymenttypee.getText().toString().equals("  Home delivery")) {
                                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                                if (cursorr.moveToFirst()) {

                                    do {

                                        String name = cursorr.getString(1);
                                        String value = cursorr.getString(2);

                                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                                        row.setLayoutParams(new TableLayout.LayoutParams(
                                                TableRow.LayoutParams.MATCH_PARENT,
                                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                        TableRow.LayoutParams lp, lp1, lp2;

                                        TextView tvv = new TextView(Customer_Info_Activity.this);
                                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                        //tv.setBackgroundResource(R.drawable.cell_shape);
                                        tvv.setGravity(Gravity.START);
                                        tvv.setTextSize(16);
                                        //tvv.setTypeface(Typeface.MONOSPACE);
                                        tvv.setText(name);

                                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                        tv1.setGravity(Gravity.START);
                                        //tv1.setTypeface(Typeface.MONOSPACE);
                                        float vbn = Float.parseFloat(value);
                                        String bvn = String.format("%.2f", vbn);
                                        tv1.setText(value);
                                        String value1 = tv1.getText().toString();

                                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                                        //tv2.setLayoutParams(lp);
                                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                        //tv2.setTypeface(Typeface.MONOSPACE);
                                        tv2.setGravity(Gravity.LEFT);
                                        tv2.append(name);
                                        tv2.setPadding(0, 0, 20, 0);
                                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                        row.addView(tv2);

                                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                                        textView1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.5f));
                                        textView1.setTextSize(16);
                                        row.addView(textView1);

                                        TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.4f));
                                        //tv3.setPadding(0,0,10,0);
                                        //tv3.setTypeface(Typeface.MONOSPACE);
                                        tv3.setGravity(Gravity.END);
                                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);;
                                        float mul = Float.parseFloat(tv1.getText().toString()) * Float.parseFloat(sub) / 100;
                                        float tota = mul;
                                        String tota1 = String.format("%.2f", tota);
                                        tv3.setText(String.valueOf(tota1));
                                        row.addView(tv3);


                                        tv3.setTextSize(16);
                                        String value2 = tv3.getText().toString();

                                        tableLayout1.addView(row);


                                    } while (cursorr.moveToNext());
                                }
                                cursorr.close();
                            } else {
                                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                                    int i1 = 0;
                                    if (i2 == 38) {
                                        i1 = 54;
                                    }
                                    if (i2 == 39) {
                                        i1 = 55;
                                    }
                                    if (i2 == 40) {
                                        i1 = 56;
                                    }
                                    if (i2 == 41) {
                                        i1 = 57;
                                    }
                                    if (i2 == 42) {
                                        i1 = 58;
                                    }
                                    if (i2 == 43) {
                                        i1 = 59;
                                    }
                                    if (i2 == 44) {
                                        i1 = 60;
                                    }
                                    if (i2 == 45) {
                                        i1 = 61;
                                    }
                                    if (i2 == 46) {
                                        i1 = 62;
                                    }
                                    if (i2 == 47) {
                                        i1 = 63;
                                    }
                                    if (i2 == 48) {
                                        i1 = 64;
                                    }
                                    if (i2 == 49) {
                                        i1 = 65;
                                    }
                                    if (i2 == 50) {
                                        i1 = 66;
                                    }
                                    if (i2 == 51) {
                                        i1 = 67;
                                    }
                                    if (i2 == 52) {
                                        i1 = 68;
                                    }


                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                    TableRow.LayoutParams lp, lp1, lp2;

                                    TextView tv = new TextView(Customer_Info_Activity.this);
                                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv.setGravity(Gravity.START);
                                    tv.setTextSize(15);
                                    //text = cursor.getString(1);
//                String v = na;

                                    tv.setText(us_name1.getString(i2));


                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv1.setGravity(Gravity.START);
                                    //text = cursor.getString(1);
                                    tv1.setText(us_name1.getString(i1));
                                    String value1 = "0";
                                    if (tv1.getText().toString().equals("")) {

                                    } else {
                                        value1 = tv1.getText().toString();
                                    }


                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                tv2.setGravity(Gravity.START);
                                System.out.println("us_name1 "+i2);
                                    tv2.setText(us_name1.getString(i2));
//                                tv2.setPadding(0, 0, 20, 0);
                                tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    row.addView(tv2);
//                    Toast.makeText(Customer_Info_Activity.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                                    textView1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.5f));
//                                textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                    row.addView(textView1);

//                    Toast.makeText(Customer_Info_Activity.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                                    TextView tv33 = new TextView(Customer_Info_Activity.this);
                                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.4f));
                                tv33.setGravity(Gravity.END);
                                    float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
                                    float tota = mul;
                                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    String tota1 = String.format("%.2f", tota);
                                    tv33.setText(String.valueOf(tota1));
                                    //tv3.setTextColor(Color.parseColor("#000000"));
                                    //row.addView(tv3);


                                    row.addView(tv33);

                                    String value2 = tv33.getText().toString();
//                                Toast.makeText(Customer_Info_Activity.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                                    } else {
                                        tableLayout1.addView(row);
                                    }

                                }
                            }

                        } else {
//                        Toast.makeText(Customer_Info_Activity.this, "user id not there", Toast.LENGTH_LONG).show();
                            Cursor cursorr = null;
                            if (paymenttypee.getText().toString().equals("  Dine-in") || paymenttypee.getText().toString().equals("  General") || paymenttypee.getText().toString().equals("  Others")) {
                                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            }
                            if (paymenttypee.getText().toString().equals("  Takeaway") || paymenttypee.getText().toString().equals("  Main")) {
                                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            }
                            if (paymenttypee.getText().toString().equals("  Home delivery")) {
                                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                            if (cursorr.moveToFirst()) {

                                do {

                                    String name = cursorr.getString(1);
                                    String value = cursorr.getString(2);

                                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                                    row.setLayoutParams(new TableLayout.LayoutParams(
                                            TableRow.LayoutParams.MATCH_PARENT,
                                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                    TableRow.LayoutParams lp, lp1, lp2;

                                    TextView tvv = new TextView(Customer_Info_Activity.this);
                                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    //tv.setBackgroundResource(R.drawable.cell_shape);
                                    tvv.setGravity(Gravity.START);
                                    tvv.setTextSize(16);
                                    //tvv.setTypeface(Typeface.MONOSPACE);
                                    tvv.setText(name);

                                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                                    tv1.setGravity(Gravity.START);
                                    //tv1.setTypeface(Typeface.MONOSPACE);
                                    float vbn = Float.parseFloat(value);
                                    String bvn = String.format("%.2f", vbn);
                                    tv1.setText(value);
                                    String value1 = tv1.getText().toString();

                                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                                    //tv2.setLayoutParams(lp);
                                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                                    //tv2.setTypeface(Typeface.MONOSPACE);
                                    tv2.setGravity(Gravity.START);
                                    tv2.append(name);
                                    tv2.setPadding(0, 0, 20, 0);
                                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    row.addView(tv2);

                                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                                    textView1.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.5f));
                                    textView1.setTextSize(16);
                                    row.addView(textView1);

                                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.4f));
                                    //tv3.setPadding(0,0,10,0);
                                    //tv3.setTypeface(Typeface.MONOSPACE);
                                    tv3.setGravity(Gravity.END);
                                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 15);
                                    float mul = Float.parseFloat(tv1.getText().toString()) * Float.parseFloat(sub) / 100;
                                    float tota = mul;
                                    String tota1 = String.format("%.2f", tota);
                                    tv3.setText(String.valueOf(tota1));
                                    row.addView(tv3);


                                    tv3.setTextSize(16);
                                    String value2 = tv3.getText().toString();

                                    tableLayout1.addView(row);


                                } while (cursorr.moveToNext());
                            }
                            cursorr.close();
                        }
                        us_name1.close();

//                    ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
//                    if (ccursor.moveToFirst()) {
//
//                        do {
//
//                            String name = ccursor.getString(1);
//                            String value = ccursor.getString(2);
//
//                            final TableRow row = new TableRow(Customer_Info_Activity.this);
//                            row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
//                                    TableRow.LayoutParams.WRAP_CONTENT));
//                            row.setGravity(Gravity.CENTER);
//
//                            TableRow.LayoutParams lp, lp1, lp2;
//
//                            TextView tvv = new TextView(Customer_Info_Activity.this);
//                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                            //tv.setBackgroundResource(R.drawable.cell_shape);
//                            tvv.setGravity(Gravity.START);
//                            tvv.setTextSize(16);
//                            //tvv.setTypeface(Typeface.MONOSPACE);
//                            tvv.setText(name);
//
//                            TextView tv1 = new TextView(Customer_Info_Activity.this);
//                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                            tv1.setGravity(Gravity.START);
//                            //tv1.setTypeface(Typeface.MONOSPACE);
//                            float vbn = Float.parseFloat(value);
//                            String bvn = String.format("%.2f", vbn);
//                            tv1.setText(value);
//                            String value1 = tv1.getText().toString();
//
//                            TextView tv2 = new TextView(Customer_Info_Activity.this);
//                            //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
//                            //tv2.setLayoutParams(lp);
//                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                            //tv2.setTypeface(Typeface.MONOSPACE);
//                            tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
//                            tv2.append(name + " @ " + bvn + "%");
//                            tv2.setPadding(0, 0, 20, 0);
//                            tv2.setTextSize(16);
//                            row.addView(tv2);
//
//                            TextView textView1 = new TextView(Customer_Info_Activity.this);
//                            textView1.setTextSize(16);
//                            row.addView(textView1);
//
//                            TextView tv3 = new TextView(Customer_Info_Activity.this);
////                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
////                tv3.setLayoutParams(lp2);
//                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                            //tv3.setPadding(0,0,10,0);
//                            //tv3.setTypeface(Typeface.MONOSPACE);
//                            tv3.setGravity(Gravity.END);
//                            float mul = Float.parseFloat(tv1.getText().toString()) * Float.parseFloat(sub) / 100;
//                            float tota = mul;
//                            String tota1 = String.format("%.2f", tota);
//                            tv3.setText(String.valueOf(tota1));
//                            row.addView(tv3);
//
//
//                            tv3.setTextSize(16);
//                            String value2 = tv3.getText().toString();
//
//                            tableLayout1.addView(row);
//
//
//                        } while (ccursor.moveToNext());
//                    }
                    }else {
                        AlertDialog.Builder builder1 = new AlertDialog.Builder(Customer_Info_Activity.this);

                        builder1.setMessage(Html.fromHtml("Bill not available in device. Please check IVEPOS Back office or Dashboard<br><a href=\"http://www.ivepos.com\">www.ivepos.com</a>"));

                        builder1.setCancelable(false);
                        builder1.setPositiveButton("ok", new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                            }
                        });

                        AlertDialog Alert1 = builder1.create();
                        Alert1 .show();
                        ((TextView)Alert1.findViewById(android.R.id.message)).setMovementMethod(LinkMovementMethod.getInstance());
                    }
                }

            }
        });



        LinearLayout write_off_but = (LinearLayout) findViewById(R.id.write_off_but);
        write_off_but.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {

                if (Float.parseFloat(total_balance.getText().toString()) <= 0){
                    Toast.makeText(Customer_Info_Activity.this, "Write Off not possible", Toast.LENGTH_SHORT).show();
                }else {
                    final Dialog dialog_write_off = new Dialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);
                    dialog_write_off.setContentView(R.layout.dialog_customer_management_write_off);
                    dialog_write_off.getWindow().setSoftInputMode(WindowManager.LayoutParams.SOFT_INPUT_STATE_ALWAYS_HIDDEN);
                    dialog_write_off.show();

                TextView inn = (TextView) dialog_write_off.findViewById(R.id.inn);
                inn.setText(insert1_rs);

                    final EditText write_off_value = (EditText) dialog_write_off.findViewById(R.id.write_off_value);
                    write_off_value.setText(total_balance.getText().toString());

                    ImageButton btncancel = (ImageButton) dialog_write_off.findViewById(R.id.btncancel);
                    btncancel.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            dialog_write_off.dismiss();
                        }
                    });

                    ImageButton btnsave = (ImageButton) dialog_write_off.findViewById(R.id.btnsave);
                    btnsave.setOnClickListener(new View.OnClickListener() {
                        @Override
                        public void onClick(View view) {
                            if (Float.parseFloat(write_off_value.getText().toString()) > Float.parseFloat(total_balance.getText().toString())) {
                                write_off_value.setError("Enter less than credit amount");
                            } else {

                                SimpleDateFormat sdf2 = new SimpleDateFormat("yyyy MM dd");
                                final String currentDateandTime1 = sdf2.format(new Date());

                                SimpleDateFormat sdf3 = new SimpleDateFormat("dd MMM yyyy");
                                final String currentDateandTime2 = sdf3.format(new Date());

                                Date dt = new Date();
                                SimpleDateFormat sdf1 = new SimpleDateFormat("hh:mm:ss aa");
                                final String time1 = sdf1.format(dt);

                                ContentValues contentValues = new ContentValues();
                                contentValues.put("name", cust_name.getText().toString());
                                contentValues.put("phoneno", pho_num.getText().toString());
                                contentValues.put("emailid", ema_add.getText().toString());
                                contentValues.put("address", add_r.getText().toString());
                                contentValues.put("pincode", pinc_r.getText().toString());
                                contentValues.put("deposit", "0");
                                contentValues.put("write_off", write_off_value.getText().toString());
                                contentValues.put("total_amount", "0");
                                contentValues.put("cashout", "0");
                                contentValues.put("credit", "0");
                                contentValues.put("charges", "0");
                                contentValues.put("refunds", "0");
                                contentValues.put("date1", currentDateandTime2);
                                contentValues.put("time1", time1);
                                contentValues.put("date", currentDateandTime1);
                                contentValues.put("notes", "");
                                Cursor c_tax = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                if (c_tax.moveToLast()) {
                                    String tax1 = c_tax.getString(38);
                                    String tax2 = c_tax.getString(39);
                                    String tax3 = c_tax.getString(40);
                                    String tax4 = c_tax.getString(41);
                                    String tax5 = c_tax.getString(42);
                                    String tax6 = c_tax.getString(43);
                                    String tax7 = c_tax.getString(44);
                                    String tax8 = c_tax.getString(45);
                                    String tax9 = c_tax.getString(46);
                                    String tax10 = c_tax.getString(47);
                                    String tax11 = c_tax.getString(48);
                                    String tax12 = c_tax.getString(49);
                                    String tax13 = c_tax.getString(50);
                                    String tax14 = c_tax.getString(51);
                                    String tax15 = c_tax.getString(52);
                                    String tax_sele = c_tax.getString(53);
                                    String tax1_value = c_tax.getString(54);
                                    String tax2_value = c_tax.getString(55);
                                    String tax3_value = c_tax.getString(56);
                                    String tax4_value = c_tax.getString(57);
                                    String tax5_value = c_tax.getString(58);
                                    String tax6_value = c_tax.getString(59);
                                    String tax7_value = c_tax.getString(60);
                                    String tax8_value = c_tax.getString(61);
                                    String tax9_value = c_tax.getString(62);
                                    String tax10_value = c_tax.getString(63);
                                    String tax11_value = c_tax.getString(64);
                                    String tax12_value = c_tax.getString(65);
                                    String tax13_value = c_tax.getString(66);
                                    String tax14_value = c_tax.getString(67);
                                    String tax15_value = c_tax.getString(68);

                                    String proc = c_tax.getString(69);
                                    String lim_st = c_tax.getString(80);
                                    String lim_val = c_tax.getString(81);
                                    String lim_pre_val = c_tax.getString(82);

                                    contentValues.put("tax1", tax1);
                                    contentValues.put("tax2", tax2);
                                    contentValues.put("tax3", tax3);
                                    contentValues.put("tax4", tax4);
                                    contentValues.put("tax5", tax5);
                                    contentValues.put("tax6", tax6);
                                    contentValues.put("tax7", tax7);
                                    contentValues.put("tax8", tax8);
                                    contentValues.put("tax9", tax9);
                                    contentValues.put("tax10", tax10);
                                    contentValues.put("tax11", tax11);
                                    contentValues.put("tax12", tax12);
                                    contentValues.put("tax13", tax13);
                                    contentValues.put("tax14", tax14);
                                    contentValues.put("tax15", tax15);
                                    contentValues.put("tax_selection", tax_sele);
                                    contentValues.put("tax1_value", tax1_value);
                                    contentValues.put("tax2_value", tax2_value);
                                    contentValues.put("tax3_value", tax3_value);
                                    contentValues.put("tax4_value", tax4_value);
                                    contentValues.put("tax5_value", tax5_value);
                                    contentValues.put("tax6_value", tax6_value);
                                    contentValues.put("tax7_value", tax7_value);
                                    contentValues.put("tax8_value", tax8_value);
                                    contentValues.put("tax9_value", tax9_value);
                                    contentValues.put("tax10_value", tax10_value);
                                    contentValues.put("tax11_value", tax11_value);
                                    contentValues.put("tax12_value", tax12_value);
                                    contentValues.put("tax13_value", tax13_value);
                                    contentValues.put("tax14_value", tax14_value);
                                    contentValues.put("tax15_value", tax15_value);

                                    contentValues.put("proceedings", proc);
                                    contentValues.put("limit_status", lim_st);
                                    contentValues.put("limit_value", lim_val);
                                    contentValues.put("limit_present_value", lim_pre_val);
                                }
                                c_tax.close();

                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                resultUri = getContentResolver().insert(contentUri, contentValues);
                                getContentResolver().notifyChange(resultUri, null);


                                //                   db.insert("Customerdetails", null, contentValues);
//                            dialog.dismiss();
                                dialog_write_off.dismiss();


                                Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                if (cursor1.moveToFirst()) {
                                    String pin5 = cursor1.getString(15);
                                    String dob = cursor1.getString(17);
                                    String cre_def = cursor1.getString(21);
                                    String pin_statu = cursor1.getString(25);
                                    String dob_alarm = cursor1.getString(26);
                                    String dis_sta = cursor1.getString(27);
                                    String dis_amou = cursor1.getString(28);
                                    String dis_val = cursor1.getString(29);
                                    String dis_typ = cursor1.getString(30);
                                    String usr_id = cursor1.getString(37);
                                    Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                                    if (cursor11.moveToFirst()) {
                                        do {
                                            String id = cursor11.getString(0);
                                            ContentValues contentValues5 = new ContentValues();
                                            contentValues5.put("authentication_pin", pin5);
                                            contentValues5.put("dob", dob);
                                            contentValues5.put("user_id", usr_id);
                                            contentValues5.put("credit_default", cre_def);
                                            contentValues5.put("authentication_pin_status", pin_statu);
                                            contentValues5.put("dob_alaram", dob_alarm);
                                            contentValues5.put("default_discount_status", dis_sta);
                                            contentValues5.put("default_discount_amount", dis_amou);
                                            contentValues5.put("default_discount_value", dis_val);
                                            contentValues5.put("default_discount_type", dis_typ);
                                            String where = "_id = '" + id + "'";

                                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                                            getContentResolver().update(contentUri, contentValues5, where, new String[]{});
                                            resultUri = new Uri.Builder()
                                                    .scheme("content")
                                                    .authority(StubProvider.AUTHORITY)
                                                    .path("Customerdetails")
                                                    .appendQueryParameter("operation", "update")
                                                    .appendQueryParameter("_id", id)
                                                    .build();
                                            getContentResolver().notifyChange(resultUri, null);

                                            Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + name + "'", null);
                                            if (set21w.moveToFirst()) {
                                                dis_val = set21w.getString(29);
                                                dis_status = set21w.getString(27);
                                                dis_ty = set21w.getString(30);

                                                TextView one = new TextView(Customer_Info_Activity.this);
                                                one.setText(dis_val);

                                                TextView two = new TextView(Customer_Info_Activity.this);
                                                two.setText(dis_ty);

                                                if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                                    disc_val_def.setText("0");
                                                }else {
                                                    disc_val_def.setText(dis_val);
                                                }
                                                if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                                    disc_per_def.setText("%");
                                                }else {
                                                    disc_per_def.setText(dis_ty);
                                                }

                                            }
                                            set21w.close();

                                            //          db.update("Customerdetails", contentValues5, where, new String[]{});
                                        } while (cursor11.moveToNext());
                                    }
                                    cursor11.close();

                                }
                                cursor1.close();


                                TextView total_sales = (TextView) findViewById(R.id.sale_value);

                                Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                if (cursor_sales.moveToFirst()) {
                                    float dsirsq = cursor_sales.getFloat(0);
                                    String rop = String.format("%.1f", dsirsq);
                                    total_sales.setText(rop);
                                }
                                cursor_sales.close();


                                TextView total_credit = (TextView) findViewById(R.id.credit_value);

                                Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "' ", null);
                                if (cursor_credit.moveToFirst()) {
                                    float dsirsq = cursor_credit.getFloat(0);
                                    String rop = String.format("%.1f", dsirsq);
                                    total_credit.setText(rop);
                                }
                                cursor_credit.close();


                                RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
                                RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
                                RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);

                                TextView refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
                                TextView charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
                                TextView deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);

                                Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (cursor_refunds_tot_val.moveToFirst()) {
                                    refunds_tot.setVisibility(View.VISIBLE);
                                    float dsirsq = cursor_refunds_tot_val.getFloat(0);
                                    String rop = String.format("%.1f", dsirsq);
                                    refunds_tot_val.setText(rop);
                                } else {
                                    refunds_tot.setVisibility(View.GONE);
                                }
                                cursor_refunds_tot_val.close();

                                Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (cursor_charges_tot_val.moveToFirst()) {
                                    charges_tot.setVisibility(View.VISIBLE);
                                    float dsirsq = cursor_charges_tot_val.getFloat(0);
                                    String rop = String.format("%.1f", dsirsq);
                                    charges_tot_val.setText(rop);
                                } else {
                                    charges_tot.setVisibility(View.GONE);
                                }
                                cursor_charges_tot_val.close();

                                Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (cursor_deposits_tot_val.moveToFirst()) {
                                    deposits_tot.setVisibility(View.VISIBLE);
                                    float dsirsq = cursor_deposits_tot_val.getFloat(0);
                                    String rop = String.format("%.1f", dsirsq);
                                    deposits_tot_val.setText(rop);
                                } else {
                                    deposits_tot.setVisibility(View.GONE);
                                }
                                cursor_deposits_tot_val.close();


                                ListView listView = (ListView) findViewById(R.id.listView);

//                                                    Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
//                                                    String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                                                    // the XML defined views which the data will be bound to
//                                                    int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                                                    Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                                    Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                                                    listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
                                if (cursor_country1.moveToFirst()){
                                    str_country = cursor_country1.getString(1);
                                }
                                Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
                                String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
                                // the XML defined views which the data will be bound to
                                int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                                Log.e("Checamos que hay id", String.valueOf(R.id.name));
                                final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
//                                                                listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error
                                dataAdapterr.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
                                    @Override
                                    public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
                                        if (view.getId() == R.id.rs_sale1 || view.getId() == R.id.rs_credit1 || view.getId() == R.id.rs_refunds_val || view.getId() == R.id.rs_charges_val || view.getId() == R.id.rs_deposits_val || view.getId() == R.id.rs_write_off_val || view.getId() == R.id.rs_cashout_val) {
                                            final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
                                            TextView dateTextView = (TextView) view;
                                            if (tadl_id.toString().equals("India") || tadl_id.toString().equals("Rupee")){
                                                dateTextView.setText(insert1_cc);
                                            }else {
                                                dateTextView.setText(insert1_cc);
                                            }
                                            return true;
                                        }
                                        return false;
                                    }
                                });
                                listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                                Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (sales_t.moveToFirst()) {
                                    dsirsq1 = sales_t.getFloat(0);
                                }
                                sales_t.close();

                                Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (credit_t.moveToFirst()) {
                                    dsirsq2 = credit_t.getFloat(0);
                                }
                                credit_t.close();

                                Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (deposi_t.moveToFirst()) {
                                    dsirsq3 = deposi_t.getFloat(0);
                                }
                                deposi_t.close();

                                Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (cashout_t.moveToFirst()) {
                                    dsirsq4 = cashout_t.getFloat(0);
                                }
                                cashout_t.close();

                                Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'", null);
                                if (write_off_t.moveToFirst()) {
                                    dsirsq5 = write_off_t.getFloat(0);
                                }
                                write_off_t.close();

                                final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

                                TextView total_balance = (TextView) findViewById(R.id.total_balance);
                                total_balance.setText(String.format("%.1f", cal_sale));

                                Cursor vb = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date1 IS NOT NULL", null);
                                if (vb.moveToFirst()) {
                                    name_name = vb.getString(1);
                                    date_first = vb.getString(7);
                                    date_first_hide = vb.getString(9);
//                                                        Toast.makeText(Customer_Info_Activity.this, "1 "+date_first, Toast.LENGTH_SHORT).show();
                                } else {
//                                                        Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
                                }
                                vb.close();

                                date1 = (TextView) findViewById(R.id.date1_visible);
                                date1.setText(date_first);

                                date2 = (TextView) findViewById(R.id.date2_visible);
                                Cursor cd = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date1 IS NOT NULL", null);
                                int coud = cd.getCount();
                                if (coud > 0) {
                                    date2.setVisibility(View.VISIBLE);
                                    date2.setText(currentDateandTime2);
//                                                        Toast.makeText(Customer_Info_Activity.this, "3 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
                                } else {
//                                                        Toast.makeText(Customer_Info_Activity.this, "4 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
                                    date2.setVisibility(View.GONE);
                                }

                            }
                        }
                    });
                }

            }
        });


        LinearLayout print_but = (LinearLayout) findViewById(R.id.print_but);
        print_but.setOnClickListener(new View.OnClickListener() {
            @Override
            public void onClick(View view) {

                Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
                if (connnet.moveToFirst()) {
                    ipnameget = connnet.getString(1);
                    portget = connnet.getString(2);
                    statusnet = connnet.getString(3);
                }
                connnet.close();

                Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
                if (connnet_counter.moveToFirst()) {
                    ipnameget_counter = connnet_counter.getString(1);
                    portget_counter = connnet_counter.getString(2);
                    statusnet_counter = connnet_counter.getString(3);
                }
                connnet_counter.close();

                Cursor conn = db1.rawQuery("SELECT * FROM BTConn", null);
                if (conn.moveToFirst()) {
                    nameget = conn.getString(1);
                    addget = conn.getString(2);
                    statussusb = conn.getString(3);
                }
                conn.close();

                if (statusnet.toString().equals("ok") || statusnet_counter.toString().equals("ok") || statussusb.toString().equals("ok")) {

                    final ListView listView = (ListView) findViewById(R.id.listView);

//                    Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
//                    String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                    // the XML defined views which the data will be bound to
//                    int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                    Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                    final Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                    listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                    Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
                    String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
                    // the XML defined views which the data will be bound to
                    int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
                    Log.e("Checamos que hay id", String.valueOf(R.id.name));
                    final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
                    listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

                    if (dataAdapterr.isEmpty()){
//                        Toast.makeText(Customer_Info_Activity.this, "no ", Toast.LENGTH_SHORT).show();
                    }else {
                        printministatement();
                    }
                    //dialog.dismiss();


                }else {
                    Toast.makeText(Customer_Info_Activity.this, "printer not connected", Toast.LENGTH_SHORT).show();
                }
            }
        });


    }

    @Override
    public void onBackPressed() {
        super.onBackPressed();
        Intent intent = new Intent(Customer_Info_Activity.this, MultiFragCustomerActivity.class);
        intent.setFlags(Intent.FLAG_ACTIVITY_CLEAR_TOP);
        startActivity(intent);

        Cursor cursorf = db.rawQuery("SELECT * FROM Clicked_cust_name", null);
        if (cursorf.moveToFirst()){
            String idff = cursorf.getString(0);
            ContentValues contentValues = new ContentValues();
            contentValues.put("name", "");
            String wherecu = "_id = '" + idff + "'";



            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Clicked_cust_name");
            getContentResolver().update(contentUri, contentValues,wherecu,new String[]{});
            resultUri = new Uri.Builder()
                    .scheme("content")
                    .authority(StubProvider.AUTHORITY)
                    .path("Clicked_cust_name")
                    .appendQueryParameter("operation", "update")
                    .appendQueryParameter("_id",idff)
                    .build();
            getContentResolver().notifyChange(resultUri, null);


      //      db.update("Clicked_cust_name", contentValues, wherecu, new String[]{});

        }
        cursorf.close();
    }

    public void printministatement(){
        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }
        connnet.close();

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }
        connusb.close();

        //Toast.makeText(Customer_Info_Activity.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }
        print_ty.close();

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    if (str_print_ty.equals("Generic") || str_print_ty.equals("Epson/others")) {
                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                        setHT321 = new byte[]{0x1b, 0x44, 0x18, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x29, 0x00};//4 tabs 3"
                        nPaperWidth = 576;
                        charlength = 23;
                        charlength1 = 46;
                        charlength2 = 69;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "------------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.equals("POS")) {
                            setHT32 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                            setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x10, 0x15, 0x00};//4 tabs 3"
                            nPaperWidth = 576;
                            charlength = 23;
                            charlength1 = 46;
                            charlength2 = 69;
                            quanlentha = 4;
                            HT1 = new byte[]{0x2F};
                            str_line = "------------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------------".getBytes(), LF

                            };
                        }
                    }
                }
                else {
                    if (str_print_ty.equals("Generic")) {
//                        Toast.makeText(Customer_Info_Activity.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.equals("Epson/others")) {
//                        Toast.makeText(Customer_Info_Activity.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 16;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        }else {
                            if (str_print_ty.equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x08, 0x09, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 11;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 4;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }
                }
            }while(cc.moveToNext());
        }
        cc.close();

        String dd = "";
        TextView qazcvb = new TextView(Customer_Info_Activity.this);
        Cursor cvonnusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (cvonnusb.moveToFirst()) {
            addgets = cvonnusb.getString(1);
            namegets = cvonnusb.getString(2);
            statussusbs = cvonnusb.getString(3);
            dd = cvonnusb.getString(4);
        }
        cvonnusb.close();
        qazcvb.setText(dd);
        if (qazcvb.getText().toString().equals("usb") && statussusbs.toString().equals("ok")) {
            runPrintCouponSequence_minireceipt_all();
        }else {
            allbuf1 = new byte[][]{
                    bold, un, "Mini Statement".getBytes(), LF

            };
            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(un);    //
                BT_Write("Mini Statement");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(un);    //
                    wifiSocket2.WIFI_Write("Mini Statement");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(un);    //
                        wifiSocket.WIFI_Write("Mini Statement");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }
            getcom.close();

            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(bold);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strcompanyname);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(bold);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strcompanyname);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(bold);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strcompanyname);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress1);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress1);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress1);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress2);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress2);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress2);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(straddress3);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(straddress3);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(straddress3);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(pp);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(pp);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(pp);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(stremailid);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(stremailid);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(stremailid);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strwebsite);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strwebsite);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strwebsite);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strtaxone);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strtaxone);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strtaxone);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

////////////////////

            Cursor cursor_cust_details = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY date", null);
            if (cursor_cust_details.moveToFirst()) {
                String emailid = cursor_cust_details.getString(3);
                String address = cursor_cust_details.getString(4);
                String pincode = cursor_cust_details.getString(79);

                tvkot.setText(cust_name.getText().toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, cust_name.getText().toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BT_Write(cust_name.getText().toString());
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(cust_name.getText().toString());
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(cust_name.getText().toString());
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                }

                tvkot.setText(pho_num.getText().toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, pho_num.getText().toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BT_Write(pho_num.getText().toString());
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(pho_num.getText().toString());
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(pho_num.getText().toString());
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                }

                tvkot.setText(emailid.toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, emailid.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BT_Write(emailid.toString());
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(emailid.toString());
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(emailid.toString());
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                }

                tvkot.setText(address.toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, address.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BT_Write(address.toString());
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(address.toString());
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(address.toString());
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                }
            }
            cursor_cust_details.close();

//////////////////////////

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

/////////////////////////


            allbufbillno = new byte[][]{
                    setHT32, un1, date1.getText().toString().getBytes(), "-->".getBytes(), date2.getText().toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT32);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(date1.getText().toString() + "-->" + date2.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(un1);    //
                    wifiSocket2.WIFI_Write(date1.getText().toString() + "-->" + date2.getText().toString());
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(date2.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(un1);    //
                        wifiSocket.WIFI_Write(date1.getText().toString() + "-->" + date2.getText().toString());
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(date2.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

////////////////////////////////////

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

/////////////////////////////////
            allbufbillno = new byte[][]{
                    setHT32, un1, "Sale :".getBytes(), total_sales.getText().toString().getBytes(), "   ".getBytes(), "Pay Later :".getBytes(), total_credit.getText().toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT32);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write("Sale :" + total_sales.getText().toString());
                BT_Write("   ");
                BT_Write("Pay Later :" + total_credit.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT32);    //
                    wifiSocket2.WIFI_Write(un1);    //
                    wifiSocket2.WIFI_Write("Sale :" + total_sales.getText().toString());
                    wifiSocket2.WIFI_Write("   ");    //
                    wifiSocket2.WIFI_Write("Pay Later :" + total_credit.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT32);    //
                        wifiSocket.WIFI_Write(un1);    //
                        wifiSocket.WIFI_Write("Sale :" + total_sales.getText().toString());
                        wifiSocket.WIFI_Write("   ");    //
                        wifiSocket.WIFI_Write("Pay Later :" + total_credit.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }


            TextView casho_p = new TextView(Customer_Info_Activity.this);
            TextView casho_m = new TextView(Customer_Info_Activity.this);

            casho_p.setText(cashout_product_total.getText().toString());
            casho_m.setText(cashout_money_total.getText().toString());
            if (casho_p.getText().toString().equals("0.0") && casho_m.getText().toString().equals("0.0")) {

            } else {
                if (!casho_p.getText().toString().equals("0.0") && !casho_m.getText().toString().equals("0.0")) {
                    allbufbillno = new byte[][]{
                            setHT32, un1, "Cashout :".getBytes(), cashout_product_total.getText().toString().getBytes(), " P".getBytes(), "   ".getBytes(), cashout_money_total.getText().toString().getBytes(), " M".getBytes(), LF
                    };
                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT32);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write("Cashout :" + cashout_product_total.getText().toString());
                        BT_Write(" P");
                        BT_Write("   ");
                        BT_Write(cashout_money_total.getText().toString());
                        BT_Write(" M");
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT32);    //
                            wifiSocket2.WIFI_Write(un1);    //
                            wifiSocket2.WIFI_Write("Cashout :" + cashout_product_total.getText().toString());
                            wifiSocket2.WIFI_Write(" P");
                            wifiSocket2.WIFI_Write("   ");
                            wifiSocket2.WIFI_Write(cashout_money_total.getText().toString());
                            wifiSocket2.WIFI_Write(" M");
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT32);    //
                                wifiSocket.WIFI_Write(un1);    //
                                wifiSocket.WIFI_Write("Cashout :" + cashout_product_total.getText().toString());
                                wifiSocket.WIFI_Write(" P");
                                wifiSocket.WIFI_Write("   ");
                                wifiSocket.WIFI_Write(cashout_money_total.getText().toString());
                                wifiSocket.WIFI_Write(" M");
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {
                    if (casho_p.getText().toString().equals("0.0")) {
                        allbufbillno = new byte[][]{
                                setHT32, un1, "Cashout :".getBytes(), cashout_money_total.getText().toString().getBytes(), " M".getBytes(), LF
                        };
                        if (statussusbs.equals("ok")) {
                            BluetoothPrintDriver.BT_Write(setHT32);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write("Cashout :" + cashout_money_total.getText().toString());
                            BT_Write(" M");
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.equals("ok")) {
                                wifiSocket2.WIFI_Write(setHT32);    //
                                wifiSocket2.WIFI_Write(un1);    //
                                wifiSocket2.WIFI_Write("Cashout :" + cashout_product_total.getText().toString());
                                wifiSocket2.WIFI_Write(" M");
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.equals("ok")) {
                                    wifiSocket.WIFI_Write(setHT32);    //
                                    wifiSocket.WIFI_Write(un1);    //
                                    wifiSocket.WIFI_Write("Cashout :" + cashout_product_total.getText().toString());
                                    wifiSocket.WIFI_Write(" M");
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }
                    }
                    if (casho_m.getText().toString().equals("0.0")) {
                        allbufbillno = new byte[][]{
                                setHT32, un1, "Cashout :".getBytes(), cashout_product_total.getText().toString().getBytes(), " P".getBytes(), LF
                        };
                        if (statussusbs.equals("ok")) {
                            BluetoothPrintDriver.BT_Write(setHT32);    //
                            BluetoothPrintDriver.BT_Write(un1);    //
                            BT_Write("Cashout :" + cashout_product_total.getText().toString());
                            BT_Write(" P");
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.equals("ok")) {
                                wifiSocket2.WIFI_Write(setHT32);    //
                                wifiSocket2.WIFI_Write(un1);    //
                                wifiSocket2.WIFI_Write("Cashout :" + cashout_product_total.getText().toString());
                                wifiSocket2.WIFI_Write(" P");
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.equals("ok")) {
                                    wifiSocket.WIFI_Write(setHT32);    //
                                    wifiSocket.WIFI_Write(un1);    //
                                    wifiSocket.WIFI_Write("Cashout :" + cashout_product_total.getText().toString());
                                    wifiSocket.WIFI_Write(" P");
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }
                    }
                }
            }


            allbufbillno = new byte[][]{
                    setHT32, un1, "Refunds :".getBytes(), refunds_tot_val.getText().toString().getBytes(), "   ".getBytes(), "Charges :".getBytes(), charges_tot_val.getText().toString().getBytes(), LF
            };


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT32);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write("Refunds :" + refunds_tot_val.getText().toString());
                BT_Write("   ");
                BT_Write("Charges :" + charges_tot_val.getText().toString());
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT32);    //
                    wifiSocket2.WIFI_Write(un1);    //
                    wifiSocket2.WIFI_Write("Refunds :" + refunds_tot_val.getText().toString());
                    wifiSocket2.WIFI_Write("   ");
                    wifiSocket2.WIFI_Write("Charges :" + charges_tot_val.getText().toString());
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT32);    //
                        wifiSocket.WIFI_Write(un1);    //
                        wifiSocket.WIFI_Write("Refunds :" + refunds_tot_val.getText().toString());
                        wifiSocket.WIFI_Write("   ");
                        wifiSocket.WIFI_Write("Charges :" + charges_tot_val.getText().toString());
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }


            allbufbillno = new byte[][]{
                    setHT32, un1, "Deposit :".getBytes(), deposits_tot_val.getText().toString().getBytes(), "   ".getBytes(), LF
            };


            if (statussusbs.toString().equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT32);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write("Deposit :" + deposits_tot_val.getText().toString());
                BT_Write("   ");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT32);    //
                    wifiSocket2.WIFI_Write(un1);    //
                    wifiSocket2.WIFI_Write("Deposit :" + deposits_tot_val.getText().toString());
                    wifiSocket2.WIFI_Write("   ");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(setHT32);    //
                        wifiSocket.WIFI_Write(un1);    //
                        wifiSocket.WIFI_Write("Deposit :" + deposits_tot_val.getText().toString());
                        wifiSocket.WIFI_Write("   ");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            allbufbillno = new byte[][]{
                    setHT32, un1, "Balance :".getBytes(), total_balance.getText().toString().getBytes(), "   ".getBytes(), LF
            };


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT32);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write("Balance :" + total_balance.getText().toString());
                BT_Write("   ");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT32);    //
                    wifiSocket2.WIFI_Write(un1);    //
                    wifiSocket2.WIFI_Write("Balance :" + total_balance.getText().toString());
                    wifiSocket2.WIFI_Write("   ");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT32);    //
                        wifiSocket.WIFI_Write(un1);    //
                        wifiSocket.WIFI_Write("Balance :" + total_balance.getText().toString());
                        wifiSocket.WIFI_Write("   ");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

//////////////////////////////////

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

/////////////////////////////////////////////

            allbufqty = new byte[][]{
                    setHT33, normal, "Date".getBytes(), HT, "Sale".getBytes(), HT, "Refunds".getBytes(), HT, left, LF
            };
            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT33);    //
                BluetoothPrintDriver.BT_Write(normal);    //
                BT_Write("Date");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Sale");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Refunds");
                BluetoothPrintDriver.BT_Write(HT);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT33);    //
                    wifiSocket2.WIFI_Write(normal);    //
                    wifiSocket2.WIFI_Write("Date");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Sale");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Refunds");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT33);    //
                        wifiSocket.WIFI_Write(normal);    //
                        wifiSocket.WIFI_Write("Date");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Sale");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Refunds");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            allbufqty = new byte[][]{
                    setHT33, normal, "Time".getBytes(), HT, "Pay Later".getBytes(), HT, "Charges".getBytes(), HT, left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT33);    //
                BluetoothPrintDriver.BT_Write(normal);    //
                BT_Write("Time");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Pay Later");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Charges");
                BluetoothPrintDriver.BT_Write(HT);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT33);    //
                    wifiSocket2.WIFI_Write(normal);    //
                    wifiSocket2.WIFI_Write("Time");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Pay Later");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Charges");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT33);    //
                        wifiSocket.WIFI_Write(normal);    //
                        wifiSocket.WIFI_Write("Time");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Pay Later");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Charges");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            allbufqty = new byte[][]{
                    setHT33, normal, "Bill no.".getBytes(), HT, "Cashout".getBytes(), HT, "Deposit".getBytes(), HT, left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT33);    //
                BluetoothPrintDriver.BT_Write(normal);    //
                BT_Write("Bill no.");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Cashout");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Deposit");
                BluetoothPrintDriver.BT_Write(HT);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT33);    //
                    wifiSocket2.WIFI_Write(normal);    //
                    wifiSocket2.WIFI_Write("Bill no.");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Cashout");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Deposit");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT33);    //
                        wifiSocket.WIFI_Write(normal);    //
                        wifiSocket.WIFI_Write("Bill no.");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Cashout");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Deposit");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

///////////////////////////////////////////

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }


            Cursor mini_details = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date1 is not null", null);
            if (mini_details.moveToFirst()) {
                do {

                    String date = mini_details.getString(7);
                    String time = mini_details.getString(8);
                    String bill_no = mini_details.getString(6);

                    String sale = mini_details.getString(19);
                    String credit = mini_details.getString(13);
                    String cashout = mini_details.getString(12);
                    String cashout_type = mini_details.getString(20);

                    String refunds = mini_details.getString(18);
                    String charges = mini_details.getString(14);
                    String deposit = mini_details.getString(11);

                    TextView sa = new TextView(Customer_Info_Activity.this);
                    sa.setText(sale);
                    if (sa.getText().toString().equals("")) {
                        sa.setText("-");
                    } else {
                        sa.setText(sale);
                    }

                    TextView re = new TextView(Customer_Info_Activity.this);
                    re.setText(refunds);
                    if (re.getText().toString().equals("")) {
                        re.setText("-");
                    } else {
                        re.setText(refunds);
                    }

                    TextView da = new TextView(Customer_Info_Activity.this);
                    da.setText(date);
                    if (da.getText().toString().equals("")) {
                        da.setText("-");
                    } else {
                        da.setText(date);
                    }

                    allbufqty = new byte[][]{
                            setHT33, normal, da.getText().toString().getBytes(), HT, sa.getText().toString().getBytes(), HT, re.getText().toString().getBytes(), HT, left, LF
                    };

                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT33);    //
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BT_Write(da.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(sa.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(re.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT33);    //
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(da.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(sa.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(re.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT33);    //
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(da.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(sa.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(re.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }


                    TextView cr = new TextView(Customer_Info_Activity.this);
                    cr.setText(credit);
                    if (cr.getText().toString().equals("")) {
                        cr.setText("-");
                    } else {
                        cr.setText(credit);
                    }

                    TextView ch = new TextView(Customer_Info_Activity.this);
                    ch.setText(charges);
                    if (ch.getText().toString().equals("")) {
                        ch.setText("-");
                    } else {
                        ch.setText(charges);
                    }

                    TextView ti = new TextView(Customer_Info_Activity.this);
                    ti.setText(time);
                    if (ti.getText().toString().equals("")) {
                        ti.setText("-");
                    } else {
                        ti.setText(time);
                    }

                    allbufqty = new byte[][]{
                            setHT33, normal, ti.getText().toString().getBytes(), HT, cr.getText().toString().getBytes(), HT, ch.getText().toString().getBytes(), HT, left, LF
                    };

                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT33);    //
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BT_Write(ti.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(cr.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(ch.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT33);    //
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(ti.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(cr.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(ch.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT33);    //
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(ti.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(cr.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(ch.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    TextView bi = new TextView(Customer_Info_Activity.this);
                    bi.setText(bill_no);
                    if (bi.getText().toString().equals("")) {
                        bi.setText("-");
                    } else {
                        bi.setText(bill_no);
                    }

                    TextView ca = new TextView(Customer_Info_Activity.this);
                    ca.setText(cashout);
                    if (ca.getText().toString().equals("")) {
                        ca.setText("-");
                    } else {
                        ca.setText(cashout);
                    }

                    TextView ca_ty = new TextView(Customer_Info_Activity.this);
                    ca_ty.setText(cashout_type);

                    TextView ca_ty1 = new TextView(Customer_Info_Activity.this);
                    ca_ty1.setText("");

                    TextView dep = new TextView(Customer_Info_Activity.this);
                    dep.setText(deposit);
                    if (dep.getText().toString().equals("")) {
                        dep.setText("-");
                    } else {
                        dep.setText(deposit);
                    }

                    TextView dep1 = new TextView(Customer_Info_Activity.this);
                    dep1.setText("");
                    if (dep.getText().toString().equals("-")) {

                    } else {
                        dep1.setText("D");
                    }
                    if (ca_ty.getText().toString().equals("")) {

                    } else {
                        if (ca_ty.getText().toString().equals("Money")) {
                            ca_ty1.setText("M");
                        } else {
                            ca_ty1.setText("P");
                        }
                    }
                    allbufqty = new byte[][]{
                            setHT33, normal, bi.getText().toString().getBytes(), HT, ca.getText().toString().getBytes(), ca_ty1.getText().toString().getBytes(), HT, dep.getText().toString().getBytes(), dep1.getText().toString().getBytes(), HT, left, LF,
                    };

                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT33);    //
                        BluetoothPrintDriver.BT_Write(normal);    //
                        BT_Write(bi.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(ca.getText().toString() + "" + ca_ty1.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(dep.getText().toString() + "" + dep1.getText().toString());
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT33);    //
                            wifiSocket2.WIFI_Write(normal);    //
                            wifiSocket2.WIFI_Write(bi.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(ca.getText().toString() + "" + ca_ty1.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(dep.getText().toString() + "" + dep1.getText().toString());
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT33);    //
                                wifiSocket.WIFI_Write(normal);    //
                                wifiSocket.WIFI_Write(bi.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(ca.getText().toString() + "" + ca_ty1.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(dep.getText().toString() + "" + dep1.getText().toString());
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                        BT_Write(str_line);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(left);	//
                            wifiSocket2.WIFI_Write(un1);	//
                            wifiSocket2.WIFI_Write(str_line);
                            wifiSocket2.WIFI_Write(LF);	//
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(left);	//
                                wifiSocket.WIFI_Write(un1);	//
                                wifiSocket.WIFI_Write(str_line);
                                wifiSocket.WIFI_Write(LF);	//
                            }
                        }
                    }

                } while (mini_details.moveToNext());
            }
            mini_details.close();
//        Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
//        if (cursor10.moveToFirst()){
//            billtypea = cursor10.getString(5);
//            paymmethoda = cursor10.getString(6);
//        }
//        if (billtypea.toString().equals("  Cash")){
//            billtypeaa = "Cash";
//        }else {
//            billtypeaa = "Card";
//        }

            //String bill_no = billnum.getText().toString();
//        allbufbillno = new byte[][]{
//                setHT32,un1,"20161221-00011".getBytes(), HT,"10000".getBytes(),HT,"10000".getBytes(),HT, "10000".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//        };

//        allbufqty = new byte[][]{
//                setHT34, fontsizesmall, "20161221-00011".getBytes(),HT,"10000".getBytes(),HT, "10000".getBytes(),HT, "10000".getBytes(),LF
//        };
//
//
//        if (statussusbs.toString().equals("ok")) {
//            byte[] buf = DataUtils.byteArraysToBytes(allbufqty);
//            Bundle data = new Bundle();
//            //data.putByteArray(Global.BYTESPARA1, buf1);
//            data.putByteArray(Global.BYTESPARA1, buf);
//            data.putInt(Global.INTPARA1, 0);
//            //data.putInt(Global.INTPARA2, buf1.length);
//            data.putInt(Global.INTPARA2, buf.length);
//            DrawerService.workThread.handleCmd(Global.CMD_POS_WRITE, data);
//        } else {
//            if (statusnets.toString().equals("ok")) {
//                byte[] buf = DataUtils1.byteArraysToBytes(allbufqty);
//                Bundle data = new Bundle();
//                //data.putByteArray(Global.BYTESPARA1, buf1);
//                data.putByteArray(Global1.BYTESPARA1, buf);
//                data.putInt(Global1.INTPARA1, 0);
//                //data.putInt(Global.INTPARA2, buf1.length);
//                data.putInt(Global1.INTPARA2, buf.length);
//                DrawerService1.workThread.handleCmd(Global1.CMD_POS_WRITE1, data);
//            }
//        }

            footer();
        }

    }


    public static void printByteData(byte[] buf) {
        BT_Write(buf);
        BT_Write(new byte[]{10});
    }

    public void printByteData_wifi(byte[] buf) {
        wifiSocket.WIFI_Write(buf);
        wifiSocket.WIFI_Write(new byte[]{10});
    }

    public void printByteData_wifi_counter(byte[] buf) {
        wifiSocket2.WIFI_Write(buf);
        wifiSocket2.WIFI_Write(new byte[]{10});
    }

    public  byte[] neoprintbillcopy1(Dialog dialog) {


        Typeface tf = Typeface.SERIF;
        ByteArrayOutputStream baos = new ByteArrayOutputStream();
        ReceiptBitmap receiptBitmap = new ReceiptBitmap().getInstance();
        int cont=5;
        Cursor cursor34 = db.rawQuery("Select count(*) from All_Sales WHERE bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (cursor34.moveToFirst()) {
            cont=cursor34.getInt(0);

        }
        Log.e("count:",cont+"");
        cursor34.close();
        receiptBitmap.init(700+(cont*50));
        receiptBitmap.setTextSize(25);
        receiptBitmap.setTypeface(Typeface.create(tf, Typeface.NORMAL));


        charlength = 10;
        charlength1 = 20;
        charlength2 = 30;
        quanlentha = 5;

        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcom.moveToFirst()) {
            strcompanyname = getcom.getString(1);
            strbillone = getcom.getString(12);
        }
        getcom.close();

        tvkot.setText(strcompanyname);
        if (tvkot.getText().toString().equals("")) {

        } else {
            // Print.StartPrinting(strcompanyname ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
            receiptBitmap.drawCenterText(strcompanyname);
        }

        receiptBitmap.drawCenterText("Bill copy");


        String str_line="----------------------";
        receiptBitmap.drawLeftText(str_line);



        //   Print.StartPrinting(NAme111+"   "+tablen,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        receiptBitmap.drawLeftText("Bill id."+bill_coun);
        receiptBitmap.drawLeftText("Bill no." + billnum_click);

        Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor10.moveToFirst()) {
            billtypea = cursor10.getString(5);
            paymmethoda = cursor10.getString(6);
        }
        cursor10.close();

        TextView ttv = new TextView(Customer_Info_Activity.this);
        ttv.setText(billtypea);

        TextView ttv1 = new TextView(Customer_Info_Activity.this);
        ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

        if (ttv.getText().toString().equals("  Cash")) {
            billtypeaa = "Cash"; //0
        }
        if (ttv.getText().toString().equals("  Card")) {
            billtypeaa = "Card"; //0
        }
        if (ttv.getText().toString().equals("  Paytm")) {
            billtypeaa = "Paytm"; //0
        }
        if (ttv.getText().toString().equals("  Mobikwik")) {
            billtypeaa = "Mobikwik"; //0
        }
        if (ttv.getText().toString().equals("  Freecharge")) {
            billtypeaa = "Freecharge"; //0
        }
        if (ttv.getText().toString().equals("  Pay Later")) {
            billtypeaa = "Pay Later"; //0
        }
        if (ttv.getText().toString().equals("  Cheque")) {
            billtypeaa = "Cheque"; //0
        }
        if (ttv.getText().toString().equals("  Sodexo")) {
            billtypeaa = "Sodexo"; //0
        }
        if (ttv.getText().toString().equals("  Zeta")) {
            billtypeaa = "Zeta"; //0
        }
        if (ttv.getText().toString().equals("  Ticket")) {
            billtypeaa = "Ticket"; //0
        }
        if (ttv.getText().toString().equals("  Upiqr")) {
            billtypeaa = "Upiqr"; //0
        }

        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals("  General") || ttv1.getText().toString().equals("  Others")) {
            paymmethodaa = "Dine-in";
            //billtypee.setText("Dine-in");
        } else {
            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                paymmethodaa = "Takeaway";
                //billtypee.setText("Takeaway");
            } else {
                paymmethodaa = "Home delivery";
                //billtypee.setText("Home delivery");
            }
        }

        Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (date.moveToFirst()) {
            datee = date.getString(25);
            timee = date.getString(12);
        }
        date.close();


        receiptBitmap.drawLeftText(paymmethodaa+"   "+datee);

        Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (cursor9.moveToFirst()) {
            tableida = cursor9.getString(15);
            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
            if (vbnm.moveToFirst()) {
                assa1 = vbnm.getString(1);
                assa2 = vbnm.getString(2);
            }
            vbnm.close();
            TextView cx = new TextView(Customer_Info_Activity.this);
            cx.setText(assa1);

            if (cx.getText().toString().equals("")) {
                tableidaa = "Tab" + assa2;
            } else {
                tableidaa = "Tab" + assa1;
            }

        }
        cursor9.close();

        receiptBitmap.drawLeftText(tableidaa+"   "+timee);

        Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (cursor9_1.moveToFirst()) {
            u_name = cursor9_1.getString(45);
        }
        cursor9_1.close();

        TextView tv_u_name = new TextView(Customer_Info_Activity.this);
        tv_u_name.setText(u_name);

        receiptBitmap.drawLeftText("Counter person  : "+u_name);

        receiptBitmap.drawLeftText(str_line);

        Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
        if (caddress.moveToFirst()) {
            String nam = caddress.getString(1);
            String addr = caddress.getString(4);
            String phon = caddress.getString(2);
            String emai = caddress.getString(3);

            if (nam.length() > 0 || addr.length() > 0 ||
                    phon.length() > 0 || emai.length() > 0) {

                receiptBitmap.drawLeftText("Customer:");

            } else {

            }

            if (nam.length() > 0) {
                receiptBitmap.drawLeftText(nam);
            } else {

            }

            if (addr.length() > 0) {
                receiptBitmap.drawLeftText(addr);
            } else {

            }

            if (phon.length() > 0) {
                String cust_ph = "Ph. " + phon;
                receiptBitmap.drawLeftText(cust_ph);
            } else {

            }

            if (emai.length() > 0) {
                receiptBitmap.drawLeftText(emai);
            } else {

            }

            receiptBitmap.drawLeftText(str_line);

        }
        caddress.close();

        receiptBitmap.drawLeftText("Qty"+"  "+"Item"+"  "+"Price"+"  "+"Amount");
        receiptBitmap.drawLeftText(str_line);



        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursorr.moveToFirst()) {

            do {

                String nbg = ccursorr.getString(0);
                String name = ccursorr.getString(1);
                String value = ccursorr.getString(2);
                String pq = ccursorr.getString(5);
                String itna = ccursorr.getString(2);
                String pricee = ccursorr.getString(3);
                String tototot = ccursorr.getString(4);

                final String newid = ccursorr.getString(20);
                int padding_in_px;

                int padding_in_dp = 30;  // 34 dps
                final float scale1 = getResources().getDisplayMetrics().density;
                padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                if (pq.equals("Item")) {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                    final TableRow row1 = new TableRow(Customer_Info_Activity.this);
                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                    final TableRow row2 = new TableRow(Customer_Info_Activity.this);
                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));

                    final TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Customer_Info_Activity.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv.setText(value);
                    row.addView(tv);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(name);
                    String value1 = tv1.getText().toString();
                    row.addView(tv1);

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setText(pricee);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(0, padding_in_px, 1.2f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv3.setText(tototot);

                    String value2 = tv3.getText().toString();

                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                    if (modcursor.moveToFirst()) {

                        Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnum_click + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                        if (cursor4.moveToFirst()) {
                            float sub2a = cursor4.getFloat(0);
                            String sub2a1 = String.valueOf(sub2a);
                            ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot);
                            ss1 = String.valueOf(ss);
                        }
                        cursor4.close();

                        if (name.length() > charlength) {
                            int print1 = 0;
//                                Toast.makeText(Customer_Info_Activity.this, "1", Toast.LENGTH_SHORT).show();

                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0){
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "3", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0){
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText("      "+string2);
                                    print1 = 1;
                                }

                            }

                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "4", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0){
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2+"      "+string3);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "5", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if(print1 == 0){
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+ss1);
                                    receiptBitmap.drawLeftText("      "+string2+"      "+string3);
                                    print1 = 1;
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    receiptBitmap.drawLeftText("HSN "+hsn);
                                }
                            }

                        } else {
//                                Toast.makeText(Customer_Info_Activity.this, "6", Toast.LENGTH_SHORT).show();
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Customer_Info_Activity.this, "7", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);

                                receiptBitmap.drawLeftText(string1quan+"  "+name+"  "+pricee+"  "+ss1);
                                receiptBitmap.drawLeftText(string2quan);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            } else {
//                                    Toast.makeText(Customer_Info_Activity.this, "8", Toast.LENGTH_SHORT).show();
                                receiptBitmap.drawLeftText(value+"  "+name+"  "+pricee+"  "+ss1);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            }

                        }

                        do {

                            final String modiname = modcursor.getString(1);
                            final String modiquan = modcursor.getString(2);
                            String modiprice = modcursor.getString(3);
                            String moditotal = modcursor.getString(4);
                            final String modiid = modcursor.getString(0);

                            float modprice1 = Float.parseFloat(modiprice);
                            String modpricestr = String.valueOf(modprice1);

                            if (modiname.length() > charlength) {
                                if (modiname.length() > charlength) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength);

                                    receiptBitmap.drawLeftText(""+"  "+">"+string1+"  "+modpricestr);
                                    receiptBitmap.drawLeftText("    "+string2);

                                }
                                if (modiname.length() > charlength1) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength, charlength1);
                                    String string3 = modiname.substring(charlength1);

                                    receiptBitmap.drawLeftText(""+"  "+">"+string1+"  "+modpricestr);
                                    receiptBitmap.drawLeftText("    "+string2+"    "+string3);

                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            } else {

                                receiptBitmap.drawLeftText(""+"  "+">"+modiname+"  "+modpricestr);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        receiptBitmap.drawLeftText("HSN "+hsn);
                                    }
                                }

                            }

                            final TableRow tableRow11 = new TableRow(Customer_Info_Activity.this);
                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            final TextView tvv = new TextView(Customer_Info_Activity.this);
                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                            tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv.setGravity(Gravity.CENTER);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText("");
                            tableRow11.addView(tvv);

                            TextView tv4 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv4.setText(modiname);
                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv4);

                            TextView tv5 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv2.setPadding(0, 0, 1, 0);
                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv5.setText(modiprice);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv5);

                            TextView tv6 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv6.setText("");
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv6);


                            final TextView tv7 = new TextView(Customer_Info_Activity.this);
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv3.setPadding(0,0,10,0);
                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                            //row.addView(tv3);

                            row.removeView(tv8);


                            tv8 = new TextView(Customer_Info_Activity.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String numberr = tv.getText().toString();
                            float newmulr = Float.parseFloat(numberr);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(ss));
                            row.addView(tv8);


                            tableLayout1.addView(tableRow11);
                        } while (modcursor.moveToNext());

                        //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    receiptBitmap.drawLeftText(""+"  "+""+"  "+""+"  "+"("+"-"+total_disc_print_q+")");

                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();

                    } else {

                        if (name.length() > charlength) {
//                                Toast.makeText(Customer_Info_Activity.this, "10", Toast.LENGTH_SHORT).show();
                            int print1 = 0;
                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "11", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "12", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText("      "+string2);
                                    print1 = 1;
                                }

                            }
////////////////////////////////////////////////
                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "13", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(string1quan+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText(string2quan+"  "+string2);
                                    receiptBitmap.drawLeftText("      "+string3);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "14", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0) {
                                    receiptBitmap.drawLeftText(value+"  "+string1+"  "+pricee+"  "+tototot);
                                    receiptBitmap.drawLeftText("      "+string2);
                                    receiptBitmap.drawLeftText("      "+string3);
                                    print1 = 1;
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    receiptBitmap.drawLeftText("HSN "+hsn);
                                }
                            }

                        } else {
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Customer_Info_Activity.this, "15", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);

                                receiptBitmap.drawLeftText(string1quan+"  "+name+"  "+pricee+"  "+tototot);
                                receiptBitmap.drawLeftText(string2quan);

                            } else {
//                                    Toast.makeText(Customer_Info_Activity.this, "16", Toast.LENGTH_SHORT).show();
                                receiptBitmap.drawLeftText(value+"  "+name+"  "+pricee+"  "+tototot);
                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    receiptBitmap.drawLeftText("HSN "+hsn);
                                }
                            }


                        }

                        tv8 = new TextView(Customer_Info_Activity.this);
                        tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        //tv3.setPadding(0, 0, 10, 0);
                        tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                        final String number = tv.getText().toString();
                        float newmul = Float.parseFloat(number);
                        //final float in = Float.parseFloat(cursor.getString(4));
                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                        //newmul = Integer.parseInt(multiply);
                        tv8.setText(String.valueOf(multiply));
                        row.addView(tv8);

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    receiptBitmap.drawLeftText(""+"  "+""+"  "+""+"  "+"("+"-"+total_disc_print_q+")");
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();
                    }
                    modcursor.close();
                }


            } while (ccursorr.moveToNext());
        }
        ccursorr.close();



        receiptBitmap.drawLeftText(str_line);


////////////////////////////////////sub total
        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor3.moveToFirst()) {
            sub = cursor3.getString(7);
        }
        cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
        float to = Float.parseFloat(sub);
        String tot = String.valueOf(to);

        receiptBitmap.drawLeftText("Sub total"+"                       "+tot);

/////////////////////////tax




///////////////////////////////// discount

        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
        if (cursor4.moveToFirst()) {
            taxpe = cursor4.getString(5);
        } else {
            taxpe = "0";
        }
        cursor4.close();

        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
        if (cursor5.moveToFirst()) {
            dsirs = cursor5.getString(7);
        } else {
            dsirs = "0";
        }
        cursor5.close();

        String alldiscinperc1 = "Discount(" + taxpe + "%)";
        receiptBitmap.drawLeftText(alldiscinperc1+"                       "+dsirs);

        float newe;
//////////////////////////////////////////////

        Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnum_click + "'", null);
        if (cursor113.moveToFirst()) {
            float level = cursor113.getFloat(0);
            total = String.valueOf(level);
            float total1 = Float.parseFloat(total);
            total_disc_print_q = String.format(Locale.US,"%.2f", total1);

            receiptBitmap.drawLeftText("Savings"+"                       "+total_disc_print_q);

            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor.moveToFirst()){
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                TextView tv = new TextView(Customer_Info_Activity.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {

                    receiptBitmap.drawLeftText("Loyalty(" + t_total_points + ")"+"                       "+v_tq);

                }
            }



        }
        cursor113.close();

//////////////////////////////////////Rounded off

        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor7.moveToFirst()) {
            subro = cursor7.getString(9);
        }
        cursor7.close();

        receiptBitmap.drawLeftText("Rounded"+"                       "+subro);

        receiptBitmap.drawLeftText(str_line);

//////////////Total main

        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor8.moveToFirst()) {
            alltotal1 = cursor8.getString(2);
        }
        cursor8.close();

        float all = Float.parseFloat(alltotal1);
        String newf = String.valueOf(all);

        receiptBitmap.drawLeftText("Total"+"                       "+"Rs "+newf);

        receiptBitmap.drawLeftText(str_line);

        /////////////////ttax
        TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);
        tableLayout1.removeAllViews();

        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor.moveToFirst()) {

            do {
                String name = ccursor.getString(10);
                String value = ccursor.getString(9);
                String pq = ccursor.getString(50);
                String itna = ccursor.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor.moveToNext());
        }
        ccursor.close();

        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor2.moveToFirst()) {

            do {
                String name = ccursor2.getString(35);
                String value = ccursor2.getString(36);
                String pq = ccursor2.getString(50);
                String itna = ccursor2.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor2.moveToNext());
        }
        ccursor2.close();

        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor3.moveToFirst()) {

            do {
                String name = ccursor3.getString(37);
                String value = ccursor3.getString(38);
                String pq = ccursor3.getString(50);
                String itna = ccursor3.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor3.moveToNext());
        }
        ccursor3.close();

        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor4.moveToFirst()) {

            do {
                String name = ccursor4.getString(39);
                String value = ccursor4.getString(40);
                String pq = ccursor4.getString(50);
                String itna = ccursor4.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor4.moveToNext());
        }
        ccursor4.close();

        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor5.moveToFirst()) {

            do {
                String name = ccursor5.getString(41);
                String value = ccursor5.getString(42);
                String pq = ccursor5.getString(50);
                String itna = ccursor5.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor5.moveToNext());
        }
        ccursor5.close();


        ArrayList<String> groupList = new ArrayList<String>();

        float sum_p = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(BeveragesMenuFragment.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

            if (groupList.contains(mTextView.getText().toString())) {

            }else {
                sum_p = 0;
                for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                    TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                    mTextView1 = (TextView) mRow1.getChildAt(0);
                    mTextView2 = (TextView) mRow1.getChildAt(2);
                    if (groupList.contains(mTextView.getText().toString())) {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    } else {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            groupList.add(mTextView.getText().toString());
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    }
                }
//                    Toast.makeText(Customer_Info_Activity.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                String mod1 = mTextView.getText().toString() + "---" + String.format("%.2f", sum_p);

                receiptBitmap.drawLeftText(mod1);

                String match = "@";
                int position = mTextView.getText().toString().indexOf(match);
                String mod2 = mTextView.getText().toString().substring(0, position);//keep toastmessage
//                    Toast.makeText(Customer_Info_Activity.this, " "+mod2, Toast.LENGTH_LONG).show();
                Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor6.moveToFirst()) {
                    String hsn = ccursor6.getString(34);

                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                    hsn_hsn.setText(hsn);

                    if (hsn_hsn.getText().toString().equals("")) {
                    } else {
                        receiptBitmap.drawLeftText("HSN " + hsn);
                    }
                }

            }
        }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Customer_Info_Activity.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Customer_Info_Activity.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Customer_Info_Activity.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format(Locale.US,"%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Customer_Info_Activity.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Customer_Info_Activity.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Customer_Info_Activity.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
////                        float tota = mul;
//                        String tota1 = String.format(Locale.US,"%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                        } else {
//                            if (statusnets.equals("ok")) {
//                                wifiSocket.WIFI_Write(left);    //
//                                wifiSocket.WIFI_Write(normal);
//                                wifiSocket.WIFI_Write(mod1);
//                                wifiSocket.WIFI_Write(HT);    //
//                                wifiSocket.WIFI_Write(LF);    //
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }
//            ccursor.close();


        String phon = "0";
        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
        if (caddress1.moveToFirst()) {
            phon = caddress1.getString(2);
        }
        caddress1.close();

        TextView tvvs = new TextView(Customer_Info_Activity.this);
        tvvs.setText(phon);

        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
        if (us_name1.moveToLast()) {
//            Toast.makeText(Customer_Info_Activity.this, "user id there", Toast.LENGTH_LONG).show();
            String na53 = us_name1.getString(53);
            String na38 = us_name1.getString(38);
            String na39 = us_name1.getString(39);
            String na40 = us_name1.getString(40);
            String na41 = us_name1.getString(41);
            String na42 = us_name1.getString(42);
            String na43 = us_name1.getString(43);
            String na44 = us_name1.getString(44);
            String na45 = us_name1.getString(45);
            String na46 = us_name1.getString(46);
            String na47 = us_name1.getString(47);
            String na48 = us_name1.getString(48);
            String na49 = us_name1.getString(49);
            String na50 = us_name1.getString(50);
            String na51 = us_name1.getString(51);
            String na52 = us_name1.getString(52);
            String na38_value = us_name1.getString(54);
            String na39_value = us_name1.getString(55);
            String na40_value = us_name1.getString(56);
            String na41_value = us_name1.getString(57);
            String na42_value = us_name1.getString(58);
            String na43_value = us_name1.getString(59);
            String na44_value = us_name1.getString(60);
            String na45_value = us_name1.getString(61);
            String na46_value = us_name1.getString(62);
            String na47_value = us_name1.getString(63);
            String na48_value = us_name1.getString(64);
            String na49_value = us_name1.getString(65);
            String na50_value = us_name1.getString(66);
            String na51_value = us_name1.getString(67);
            String na52_value = us_name1.getString(68);

            String proc = us_name1.getString(69);

            TextView hid = new TextView(Customer_Info_Activity.this);
            hid.setText(proc);

            if (hid.getText().toString().equals("off")) {
                Cursor cursorr = null;
                if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                            float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        receiptBitmap.drawLeftText(mod1);

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            } else {

                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                    int i1 = 0;
                    if (i2 == 38) {
                        i1 = 54;
                    }
                    if (i2 == 39) {
                        i1 = 55;
                    }
                    if (i2 == 40) {
                        i1 = 56;
                    }
                    if (i2 == 41) {
                        i1 = 57;
                    }
                    if (i2 == 42) {
                        i1 = 58;
                    }
                    if (i2 == 43) {
                        i1 = 59;
                    }
                    if (i2 == 44) {
                        i1 = 60;
                    }
                    if (i2 == 45) {
                        i1 = 61;
                    }
                    if (i2 == 46) {
                        i1 = 62;
                    }
                    if (i2 == 47) {
                        i1 = 63;
                    }
                    if (i2 == 48) {
                        i1 = 64;
                    }
                    if (i2 == 49) {
                        i1 = 65;
                    }
                    if (i2 == 50) {
                        i1 = 66;
                    }
                    if (i2 == 51) {
                        i1 = 67;
                    }
                    if (i2 == 52) {
                        i1 = 68;
                    }


                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(BeveragesMenuFragment.this);;
                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Customer_Info_Activity.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv.setGravity(Gravity.START);
                    tv.setTextSize(15);
                    //text = cursor.getString(1);
//                String v = na;

                    tv.setText(us_name1.getString(i2));


                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    //text = cursor.getString(1);
                    tv1.setText(us_name1.getString(i1));
                    String value1 = "0";
                    if (tv1.getText().toString().equals("")) {

                    } else {
                        value1 = tv1.getText().toString();
                    }


                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);
//                    Toast.makeText(BeveragesMenuFragment.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

//                    Toast.makeText(BeveragesMenuFragment.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                    TextView tv33 = new TextView(Customer_Info_Activity.this);
                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv33.setText(String.valueOf(tota));
                    tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv33);

                    String value2 = tv33.getText().toString();
//                    Toast.makeText(Customer_Info_Activity.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                    } else {
                        tableLayout1.addView(row);
//                        Toast.makeText(Customer_Info_Activity.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                        String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                        receiptBitmap.drawLeftText(mod1);

                    }

                }
            }

        } else {
//            Toast.makeText(Customer_Info_Activity.this, "user id not there", Toast.LENGTH_LONG).show();
            Cursor cursorr = null;
            if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Home delivery")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
            if (cursorr.moveToFirst()) {

                do {

                    String name = cursorr.getString(1);
                    String value = cursorr.getString(2);

                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                    //tv2.setLayoutParams(lp);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @ " + bvn + "%");
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    //tv3.setPadding(0,0,10,0);
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);

                    String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                    receiptBitmap.drawLeftText(mod1);

                } while (cursorr.moveToNext());
            }
            cursorr.close();
        }
        us_name1.close();

        float sum = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(2);
            sum = sum
                    + Float.parseFloat(mTextView.getText().toString());
        }


        String newsum = String.format(Locale.US,"%.2f", sum);

        if (sum == 0 || sum == 0.0 || sum == 0.00) {

        } else {
            receiptBitmap.drawLeftText("Tax"+"                       "+newsum);
        }
        /////////////////ttax

        receiptBitmap.drawLeftText("       ");

        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            // Print.StartPrinting(strcompanyname ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
            receiptBitmap.drawCenterText(strbillone);
        }

        receiptBitmap.drawLeftText("       ");
        receiptBitmap.drawLeftText("       ");

        Bitmap canvasbitmap = receiptBitmap.getReceiptBitmap();

        if(ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,"getHeight: " + canvasbitmap.getHeight(),true,true);

        if(ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,"getReceiptHeight: " + receiptBitmap.getReceiptHeight(),true,true);

        Bitmap croppedBmp = Bitmap.createBitmap(canvasbitmap, 0, 0, canvasbitmap.getWidth(), canvasbitmap.getHeight());

        byte[] imageCommand = mMSWisepadDeviceController.getPrintData(croppedBmp, 150);

        baos.write(imageCommand, 0, imageCommand.length);

        if(ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,"end of reciept",true,true);

        return baos.toByteArray();

    }

    public void wiseposprintbillcopy1(Dialog dialog) {


        charlength = 10;
        charlength1 = 20;
        charlength2 = 30;
        quanlentha = 5;

//        Toast.makeText(Customer_Info_Activity.this, "printbill", Toast.LENGTH_SHORT).show();

        imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
        mView = dialog.findViewById(R.id.f_vieww1);

        ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
        imageViewPicture.getLayoutParams().height = 94;
        imageViewPicture.getLayoutParams().width = 384;
        imageButton.getLayoutParams().height = 94;
        imageButton.getLayoutParams().width = 384;


        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            do {
                byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
                final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);

                imageButton.setImageBitmap(b1);

                mView.setDrawingCacheEnabled(true);
                mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
                        View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
                mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
                mView.buildDrawingCache(true);

                Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
                //mView.setDrawingCacheEnabled(false);
                ByteArrayOutputStream bytes = new ByteArrayOutputStream();
                b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);

                imageViewPicture.setImageBitmap(b);

                Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
                        .getBitmap();

                Print.StartPrintingImage(mBitmap, Align.CENTER);
            } while (c.moveToNext());
        } else {
            imageButton.setVisibility(View.GONE);
        }
        c.close();

        Print.StartPrinting("Bill Copy" , FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);

        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcom.moveToFirst()) {
            do {
                strcompanyname = getcom.getString(1);
                straddress1 = getcom.getString(14);
                straddress2 = getcom.getString(17);
                straddress3 = getcom.getString(18);
                strphone = getcom.getString(9);
                stremailid = getcom.getString(15);
                strwebsite = getcom.getString(16);
                strtaxone = getcom.getString(10);
                strbillone = getcom.getString(12);
            } while (getcom.moveToNext());
        }
        getcom.close();
//        Toast.makeText(getApplicationContext(), "saving4", Toast.LENGTH_LONG).show();
        tvkot.setText(strcompanyname);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(strcompanyname , FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
/////////
        tvkot.setText(straddress1);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(straddress1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
///////////////////////////////
        tvkot.setText(straddress2);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(straddress2 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
////////////////////////////////
        tvkot.setText(straddress3);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(straddress3 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
//////////////////////////
        tvkot.setText(strphone);
        String pp = "Ph. " + strphone;
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(pp ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
////////////////////////////////////
        tvkot.setText(stremailid);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(stremailid ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
////////////////////////////////////////
        tvkot.setText(strwebsite);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(strwebsite ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
///////////////////////////////////////
        tvkot.setText(strtaxone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            Print.StartPrinting(strtaxone ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
        Print.StartPrinting("----------------------" ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);

        Print.StartPrinting("Bill id."+bill_coun,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor10.moveToFirst()) {
            billtypea = cursor10.getString(5);
            paymmethoda = cursor10.getString(6);
        }
        cursor10.close();

        TextView ttv = new TextView(Customer_Info_Activity.this);
        ttv.setText(billtypea);

        TextView ttv1 = new TextView(Customer_Info_Activity.this);
        ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

        if (ttv.getText().toString().equals("  Cash")) {
            billtypeaa = "Cash"; //0
        }
        if (ttv.getText().toString().equals("  Card")) {
            billtypeaa = "Card"; //0
        }
        if (ttv.getText().toString().equals("  Paytm")) {
            billtypeaa = "Paytm"; //0
        }
        if (ttv.getText().toString().equals("  Mobikwik")) {
            billtypeaa = "Mobikwik"; //0
        }
        if (ttv.getText().toString().equals("  Freecharge")) {
            billtypeaa = "Freecharge"; //0
        }
        if (ttv.getText().toString().equals("  Pay Later")) {
            billtypeaa = "Pay Later"; //0
        }
        if (ttv.getText().toString().equals("  Cheque")) {
            billtypeaa = "Cheque"; //0
        }
        if (ttv.getText().toString().equals("  Sodexo")) {
            billtypeaa = "Sodexo"; //0
        }
        if (ttv.getText().toString().equals("  Zeta")) {
            billtypeaa = "Zeta"; //0
        }
        if (ttv.getText().toString().equals("  Ticket")) {
            billtypeaa = "Ticket"; //0
        }
        if (ttv.getText().toString().equals("  Upiqr")) {
            billtypeaa = "Upiqr"; //0
        }

        String bill_no = billnum_click;



        //  Print.StartPrinting(strtaxone ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        String b="Bill no." + bill_no+""+billtypeaa;
        int length1=b.length();
        int splength=32-length1;
        String input="Bill no." + bill_no;
        for(int i=0;i<splength;i++){
            input=input+" ";
        }
        input=input+billtypeaa;
        Print.StartPrinting(input ,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        // Print.StartPrinting(rr2 ,FontLattice.SIXTEEN, false, Align.RIGHT, true);



        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals("  General") || ttv1.getText().toString().equals("  Others")) {
            paymmethodaa = "Dine-in";
            //billtypee.setText("Dine-in");
        } else {
            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                paymmethodaa = "Takeaway";
                //billtypee.setText("Takeaway");
            } else {
                paymmethodaa = "Home delivery";
                //billtypee.setText("Home delivery");
            }
        }

        Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (date.moveToFirst()) {
            datee = date.getString(25);
            timee = date.getString(12);
        }
        date.close();
        //  Print.StartPrinting(rr1 +"          "+normal1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);


        String b1=paymmethodaa+ datee;
        int length11=b1.length();
        int splength1=32-length11;
        String input1=paymmethodaa;
        for(int i=0;i<splength1;i++){
            input1=input1+" ";
        }
        input1=input1+datee;

        Print.StartPrinting(input1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        //  Print.StartPrinting(normal1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.RIGHT, true);



        Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (cursor9.moveToFirst()) {
            tableida = cursor9.getString(15);
            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
            if (vbnm.moveToFirst()) {
                assa1 = vbnm.getString(1);
                assa2 = vbnm.getString(2);
            }
            vbnm.close();
            TextView cx = new TextView(Customer_Info_Activity.this);
            cx.setText(assa1);

            if (cx.getText().toString().equals("")) {
                tableidaa = "Tab" + assa2;
            } else {
                tableidaa = "Tab" + assa1;
            }

        }
        cursor9.close();


        String b2=tableidaa+""+timee;
        int length12=b2.length();
        int splength2=32-length12;
        String input2=tableidaa;
        for(int i=0;i<splength2;i++){
            input2=input2+" ";
        }
        input2=input2+timee;

        Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (cursor9_1.moveToFirst()) {
            u_name = cursor9_1.getString(45);
        }
        cursor9_1.close();

        TextView tv_u_name = new TextView(Customer_Info_Activity.this);
        tv_u_name.setText(u_name);

        Print.StartPrinting(input2 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        // Print.StartPrinting( time1 ,FontLattice.TWENTY_FOUR, mswipe_text, Align.RIGHT, true);
        Print.StartPrinting("Counter person: "+u_name,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        String str_line = "-----------------------------";
        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);


        TextView custph = new TextView(Customer_Info_Activity.this);

        Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
        if (caddress.moveToFirst()) {
            String nam = caddress.getString(1);
            String addr = caddress.getString(4);
            String phon = caddress.getString(2);
            String emai = caddress.getString(3);

            if (nam.length() > 0 || addr.length() > 0 ||
                    phon.length() > 0 || emai.length() > 0) {
                Print.StartPrinting("Customer:",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (nam.length() > 0) {
                Print.StartPrinting(nam,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (addr.length() > 0) {
                Print.StartPrinting(addr,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (phon.length() > 0) {
                String cust_ph = "Ph. " + phon;
                Print.StartPrinting(cust_ph,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            if (emai.length() > 0) {
                Print.StartPrinting(emai,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
            } else {

            }

            Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
        }
        caddress.close();

        Print.StartPrinting("Qty"+"  "+"Item"+"        "+"Price"+"  "+"Amount",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//           Print.StartPrinting("  "+"Item",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//           Print.StartPrinting("  "+"Price",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//           Print.StartPrinting("  "+"Amount",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);


        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursorr.moveToFirst()) {

            do {

                String nbg = ccursorr.getString(0);
                String name = ccursorr.getString(1);
                String value = ccursorr.getString(2);
                String pq = ccursorr.getString(5);
                String itna = ccursorr.getString(2);
                String pricee = ccursorr.getString(3);
                String tototot = ccursorr.getString(4);

                final String newid = ccursorr.getString(20);
                int padding_in_px;

                int padding_in_dp = 30;  // 34 dps
                final float scale1 = getResources().getDisplayMetrics().density;
                padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                if (pq.equals("Item")) {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                    final TableRow row1 = new TableRow(Customer_Info_Activity.this);
                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                    final TableRow row2 = new TableRow(Customer_Info_Activity.this);
                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));

                    final TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Customer_Info_Activity.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv.setText(value);
                    row.addView(tv);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(name);
                    String value1 = tv1.getText().toString();
                    row.addView(tv1);

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setText(pricee);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(0, padding_in_px, 1.2f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv3.setText(tototot);

                    String value2 = tv3.getText().toString();

                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                    if (modcursor.moveToFirst()) {

                        Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnum_click + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                        if (cursor4.moveToFirst()) {
                            float sub2a = cursor4.getFloat(0);
                            String sub2a1 = String.valueOf(sub2a);
                            ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot);
                            ss1 = String.valueOf(ss);
                        }
                        cursor4.close();

                        if (name.length() > charlength) {
                            int print1 = 0;
//                                Toast.makeText(Customer_Info_Activity.this, "1", Toast.LENGTH_SHORT).show();

                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                Print.StartPrinting(string1quan+string1+"    "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                Print.StartPrinting(string2quan+"  "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,false);
//                                    Print.StartPrinting(string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,false);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                print1 = 1;
                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "3", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);
                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+"  "+itemName+"    "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("  "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting("     ",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, false);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }

                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "4", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                if (print1 == 0) {
                                    String itemName=string1;
                                    if(string1.length()<11){
                                        for(int i=0;i<(11-string1.length());i++){
                                            itemName=itemName+"";
                                        }
                                    }

                                    Print.StartPrinting(string1quan+" "+itemName+"   "+pricee+" "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting(string2quan+" "+string2+" "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
                                    print1 = 1;

                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "5", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+" "+itemName+"   "+pricee+" "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting(" "+string2+" "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT,  true);
//                                    Print.StartPrinting(aqq2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
                                }
                            }

                        } else {
//                                Toast.makeText(Customer_Info_Activity.this, "6", Toast.LENGTH_SHORT).show();
                            String itemName=name;
                            if(name.length()<11) {
                                for (int i = 0; i < (11 - name.length()); i++) {
                                    itemName = itemName + "";
                                }
                            }
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Customer_Info_Activity.this, "7", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);

                                Print.StartPrinting(string1quan+" "+itemName+"    "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                Print.StartPrinting(" "+string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
                                    }
                                }

                            } else {
//                                    Toast.makeText(Customer_Info_Activity.this, "8", Toast.LENGTH_SHORT).show();
                                Print.StartPrinting(value+" "+name+"     "+pricee+"  "+ss1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
                                    }
                                }

                            }

                        }

                        do {

                            final String modiname = modcursor.getString(1);
                            final String modiquan = modcursor.getString(2);
                            String modiprice = modcursor.getString(3);
                            String moditotal = modcursor.getString(4);
                            final String modiid = modcursor.getString(0);

                            float modprice1 = Float.parseFloat(modiprice);
                            String modpricestr = String.valueOf(modprice1);

                            if (modiname.length() > charlength) {
                                if (modiname.length() > charlength) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength);
                                    Print.StartPrinting(""+">"+string1+" "+modpricestr+"",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("    "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                                if (modiname.length() > charlength1) {
                                    String string1 = modiname.substring(0, charlength);
                                    String string2 = modiname.substring(charlength, charlength1);
                                    String string3 = modiname.substring(charlength1);
                                    Print.StartPrinting(""+">"+string1+" "+modpricestr+"",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("    "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("    "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    }
                                }

                            } else {

                                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
                                Print.StartPrinting(""+">"+modiname+" "+modpricestr+""+"",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    }
                                }

                            }

                            final TableRow tableRow11 = new TableRow(Customer_Info_Activity.this);
                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            final TextView tvv = new TextView(Customer_Info_Activity.this);
                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                            tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv.setGravity(Gravity.CENTER);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText("");
                            tableRow11.addView(tvv);

                            TextView tv4 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv4.setText(modiname);
                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv4);

                            TextView tv5 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv2.setPadding(0, 0, 1, 0);
                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv5.setText(modiprice);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv5);

                            TextView tv6 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv6.setText("");
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv6);


                            final TextView tv7 = new TextView(Customer_Info_Activity.this);
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv3.setPadding(0,0,10,0);
                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                            //row.addView(tv3);

                            row.removeView(tv8);


                            tv8 = new TextView(Customer_Info_Activity.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String numberr = tv.getText().toString();
                            float newmulr = Float.parseFloat(numberr);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(ss));
                            row.addView(tv8);


                            tableLayout1.addView(tableRow11);
                        } while (modcursor.moveToNext());

                        //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);
                                    Print.StartPrinting(""+""+""+"("+"-"+total_disc_print_q+")",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();

                    } else {

                        if (name.length() > charlength) {
//                                Toast.makeText(Customer_Info_Activity.this, "10", Toast.LENGTH_SHORT).show();
                            int print1 = 0;
                            if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "11", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);
                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }

                                //  Print.StartPrinting(string2quan+"  "+string2+""+price+"  "+pr1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                                if (print1 == 0) {
                                    Print.StartPrinting(string1quan+" "+itemName+" "+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting(" "+string2quan+" "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "12", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("      "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(total,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(price,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(pr1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting("      ",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
//                                    Print.StartPrinting(string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }
////////////////////////////////////////////////
                            if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "13", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(string1quan+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("  "+string2quan+" "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("      "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }
                            if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "14", Toast.LENGTH_SHORT).show();
                                String string1 = name.substring(0, charlength);
                                String string2 = name.substring(charlength, charlength1);
                                String string3 = name.substring(charlength1);

                                String itemName=string1;
                                if(string1.length()<11){
                                    for(int i=0;i<(11-string1.length());i++){
                                        itemName=itemName+"";
                                    }
                                }
                                if (print1 == 0) {
                                    Print.StartPrinting(value+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("  "+string2,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    Print.StartPrinting("      "+string3,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                    print1 = 1;
                                }

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                            }

                        } else {
                            String itemName=name;
                            if(name.length()<11){
                                for(int i=0;i<(11-name.length());i++){
                                    itemName=itemName+"";
                                }
                            }
                            if (value.length() > quanlentha) {
//                                    Toast.makeText(Customer_Info_Activity.this, "15", Toast.LENGTH_SHORT).show();
                                String string1quan = value.substring(0, quanlentha);
                                String string2quan = value.substring(quanlentha);
                                Print.StartPrinting(string1quan+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                Print.StartPrinting("  "+string2quan,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                            } else {
//                                    Toast.makeText(Customer_Info_Activity.this, "16", Toast.LENGTH_SHORT).show();
                                Print.StartPrinting(value+" "+itemName+"    "+pricee+"  "+tototot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                            }


                        }

                        tv8 = new TextView(Customer_Info_Activity.this);
                        tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        //tv3.setPadding(0, 0, 10, 0);
                        tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                        final String number = tv.getText().toString();
                        float newmul = Float.parseFloat(number);
                        //final float in = Float.parseFloat(cursor.getString(4));
                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                        //newmul = Integer.parseInt(multiply);
                        tv8.setText(String.valueOf(multiply));
                        row.addView(tv8);

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);
                                    Print.StartPrinting(name+""+""+""+"("+"-"+total_disc_print_q+")",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();
                    }
                    modcursor.close();
                }


            } while (ccursorr.moveToNext());
        }
        ccursorr.close();
        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
////////////////////////////////////sub total
        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor3.moveToFirst()) {
            sub = cursor3.getString(7);
        }
        cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
        float to = Float.parseFloat(sub);
        String tot = String.valueOf(to);

        Print.StartPrinting("Sub total"+"              "+tot,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
/////////////////////////tax




///////////////////////////////// discount

        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
        if (cursor4.moveToFirst()) {
            taxpe = cursor4.getString(5);
        } else {
            taxpe = "0";
        }
        cursor4.close();

        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
        if (cursor5.moveToFirst()) {
            dsirs = cursor5.getString(7);
        } else {
            dsirs = "0";
        }
        cursor5.close();

        String alldiscinperc1 = "Discount(" + taxpe + "%)";

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
        Print.StartPrinting(alldiscinperc1+"              "+dsirs,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        float newe;
//////////////////////////////////////////////

        Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnum_click + "'", null);
        if (cursor113.moveToFirst()) {
            float level = cursor113.getFloat(0);
            total = String.valueOf(level);
            float total1 = Float.parseFloat(total);
            total_disc_print_q = String.format(Locale.US,"%.2f", total1);

            Print.StartPrinting("Savings"+"              "+total_disc_print_q,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);


            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor.moveToFirst()){
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                TextView tv = new TextView(Customer_Info_Activity.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {
                    Print.StartPrinting("Loyalty"+"              "+v_tq,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                }
            }



        }
        cursor113.close();

//////////////////////////////////////Rounded off

        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor7.moveToFirst()) {
            subro = cursor7.getString(9);
        }
        cursor7.close();

        Print.StartPrinting("Rounded"+"              "+subro,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

//////////////Total main

        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor8.moveToFirst()) {
            alltotal1 = cursor8.getString(2);
        }
        cursor8.close();

        float all = Float.parseFloat(alltotal1);
        String newf = String.valueOf(all);

        Print.StartPrinting("Total"+"              "+insert1_rs+newf,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        Print.StartPrinting(str_line,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        ////////////////ttax
        TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);
        tableLayout1.removeAllViews();

        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor.moveToFirst()) {

            do {
                String name = ccursor.getString(10);
                String value = ccursor.getString(9);
                String pq = ccursor.getString(50);
                String itna = ccursor.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor.moveToNext());
        }
        ccursor.close();

        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor2.moveToFirst()) {

            do {
                String name = ccursor2.getString(35);
                String value = ccursor2.getString(36);
                String pq = ccursor2.getString(50);
                String itna = ccursor2.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor2.moveToNext());
        }
        ccursor2.close();

        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor3.moveToFirst()) {

            do {
                String name = ccursor3.getString(37);
                String value = ccursor3.getString(38);
                String pq = ccursor3.getString(50);
                String itna = ccursor3.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor3.moveToNext());
        }
        ccursor3.close();

        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor4.moveToFirst()) {

            do {
                String name = ccursor4.getString(39);
                String value = ccursor4.getString(40);
                String pq = ccursor4.getString(50);
                String itna = ccursor4.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor4.moveToNext());
        }
        ccursor4.close();

        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor5.moveToFirst()) {

            do {
                String name = ccursor5.getString(41);
                String value = ccursor5.getString(42);
                String pq = ccursor5.getString(50);
                String itna = ccursor5.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + "@" + bvn + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor5.moveToNext());
        }
        ccursor5.close();


        ArrayList<String> groupList = new ArrayList<String>();

        float sum_p = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(BeveragesMenuFragment.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

            if (groupList.contains(mTextView.getText().toString())) {

            }else {
                sum_p = 0;
                for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                    TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                    mTextView1 = (TextView) mRow1.getChildAt(0);
                    mTextView2 = (TextView) mRow1.getChildAt(2);
                    if (groupList.contains(mTextView.getText().toString())) {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    } else {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            groupList.add(mTextView.getText().toString());
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(BeveragesMenuFragment.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    }
                }
//                    Toast.makeText(Customer_Info_Activity.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                String mod1 = mTextView.getText().toString() + "---" + String.format("%.2f", sum_p);

                Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                String match = "@";
                int position = mTextView.getText().toString().indexOf(match);
                String mod2 = mTextView.getText().toString().substring(0, position);//keep toastmessage
//                    Toast.makeText(Customer_Info_Activity.this, " "+mod2, Toast.LENGTH_LONG).show();
                Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor6.moveToFirst()) {
                    String hsn = ccursor6.getString(34);

                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                    hsn_hsn.setText(hsn);

                    if (hsn_hsn.getText().toString().equals("")) {
                    } else {
                        Print.StartPrinting("HSN " + hsn,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
                    }
                }

            }
        }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Customer_Info_Activity.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Customer_Info_Activity.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Customer_Info_Activity.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format(Locale.US,"%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Customer_Info_Activity.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Customer_Info_Activity.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Customer_Info_Activity.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
////                        float tota = mul;
//                        String tota1 = String.format(Locale.US,"%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                        } else {
//                            if (statusnets.equals("ok")) {
//                                wifiSocket.WIFI_Write(left);    //
//                                wifiSocket.WIFI_Write(normal);
//                                wifiSocket.WIFI_Write(mod1);
//                                wifiSocket.WIFI_Write(HT);    //
//                                wifiSocket.WIFI_Write(LF);    //
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }
//            ccursor.close();


        String phon = "0";
        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
        if (caddress1.moveToFirst()) {
            phon = caddress1.getString(2);
        }
        caddress1.close();

        TextView tvvs = new TextView(Customer_Info_Activity.this);
        tvvs.setText(phon);

        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
        if (us_name1.moveToLast()) {
//            Toast.makeText(Customer_Info_Activity.this, "user id there", Toast.LENGTH_LONG).show();
            String na53 = us_name1.getString(53);
            String na38 = us_name1.getString(38);
            String na39 = us_name1.getString(39);
            String na40 = us_name1.getString(40);
            String na41 = us_name1.getString(41);
            String na42 = us_name1.getString(42);
            String na43 = us_name1.getString(43);
            String na44 = us_name1.getString(44);
            String na45 = us_name1.getString(45);
            String na46 = us_name1.getString(46);
            String na47 = us_name1.getString(47);
            String na48 = us_name1.getString(48);
            String na49 = us_name1.getString(49);
            String na50 = us_name1.getString(50);
            String na51 = us_name1.getString(51);
            String na52 = us_name1.getString(52);
            String na38_value = us_name1.getString(54);
            String na39_value = us_name1.getString(55);
            String na40_value = us_name1.getString(56);
            String na41_value = us_name1.getString(57);
            String na42_value = us_name1.getString(58);
            String na43_value = us_name1.getString(59);
            String na44_value = us_name1.getString(60);
            String na45_value = us_name1.getString(61);
            String na46_value = us_name1.getString(62);
            String na47_value = us_name1.getString(63);
            String na48_value = us_name1.getString(64);
            String na49_value = us_name1.getString(65);
            String na50_value = us_name1.getString(66);
            String na51_value = us_name1.getString(67);
            String na52_value = us_name1.getString(68);

            String proc = us_name1.getString(69);

            TextView hid = new TextView(Customer_Info_Activity.this);
            hid.setText(proc);

            if (hid.getText().toString().equals("off")) {
                Cursor cursorr = null;
                if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                            float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            } else {

                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                    int i1 = 0;
                    if (i2 == 38) {
                        i1 = 54;
                    }
                    if (i2 == 39) {
                        i1 = 55;
                    }
                    if (i2 == 40) {
                        i1 = 56;
                    }
                    if (i2 == 41) {
                        i1 = 57;
                    }
                    if (i2 == 42) {
                        i1 = 58;
                    }
                    if (i2 == 43) {
                        i1 = 59;
                    }
                    if (i2 == 44) {
                        i1 = 60;
                    }
                    if (i2 == 45) {
                        i1 = 61;
                    }
                    if (i2 == 46) {
                        i1 = 62;
                    }
                    if (i2 == 47) {
                        i1 = 63;
                    }
                    if (i2 == 48) {
                        i1 = 64;
                    }
                    if (i2 == 49) {
                        i1 = 65;
                    }
                    if (i2 == 50) {
                        i1 = 66;
                    }
                    if (i2 == 51) {
                        i1 = 67;
                    }
                    if (i2 == 52) {
                        i1 = 68;
                    }


                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(BeveragesMenuFragment.this);;
                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Customer_Info_Activity.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv.setGravity(Gravity.START);
                    tv.setTextSize(15);
                    //text = cursor.getString(1);
//                String v = na;

                    tv.setText(us_name1.getString(i2));


                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    //text = cursor.getString(1);
                    tv1.setText(us_name1.getString(i1));
                    String value1 = "0";
                    if (tv1.getText().toString().equals("")) {

                    } else {
                        value1 = tv1.getText().toString();
                    }


                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);
//                    Toast.makeText(BeveragesMenuFragment.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

//                    Toast.makeText(BeveragesMenuFragment.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                    TextView tv33 = new TextView(Customer_Info_Activity.this);
                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv33.setText(String.valueOf(tota));
                    tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv33);

                    String value2 = tv33.getText().toString();
//                    Toast.makeText(Customer_Info_Activity.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                    } else {
                        tableLayout1.addView(row);
//                        Toast.makeText(Customer_Info_Activity.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                        String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                        Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                    }

                }
            }

        } else {
//            Toast.makeText(Customer_Info_Activity.this, "user id not there", Toast.LENGTH_LONG).show();
            Cursor cursorr = null;
            if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Home delivery")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
            if (cursorr.moveToFirst()) {

                do {

                    String name = cursorr.getString(1);
                    String value = cursorr.getString(2);

                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                    //tv2.setLayoutParams(lp);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @ " + bvn + "%");
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    //tv3.setPadding(0,0,10,0);
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);

                    String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                    Print.StartPrinting(mod1,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

                } while (cursorr.moveToNext());
            }
            cursorr.close();
        }
        us_name1.close();

        float sum = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(2);
            sum = sum
                    + Float.parseFloat(mTextView.getText().toString());
        }


        String newsum = String.format(Locale.US,"%.2f", sum);



        if (sum == 0 || sum == 0.0 || sum == 0.00) {

        } else {
            Print.StartPrinting("Tax"+"              "+newsum,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        }
        ////////////////ttax

        Print.StartPrinting("",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            // Print.StartPrinting(strcompanyname ,FontLattice.TWENTY_FOUR, mswipe_text, Align.CENTER, true);
            Print.StartPrinting(strbillone,FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        }
        Print.StartPrinting("",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);
        Print.StartPrinting("",FontLattice.TWENTY_FOUR, mswipe_text, Align.LEFT, true);

        //footer();
    }


    public  void printbillcopy1(Dialog dialog){
        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }
        connnet.close();

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }
        connusb.close();

        //Toast.makeText(Customer_Info_Activity.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};

        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }
        print_ty.close();

        Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if (cc.moveToFirst()) {
            cc.moveToFirst();
            do {
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    if (str_print_ty.toString().equals("Generic") || str_print_ty.toString().equals("Epson/others")) {
                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                        setHT32122 = new byte[]{0x1b, 0x44, 0x24, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x28, 0x00};//4 tabs 3"
                        nPaperWidth = 576;
                        charlength = 22;
                        charlength1 = 46;
                        charlength2 = 69;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "------------------------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "------------------------------------------------".getBytes(), LF
                        };
                    } else {
                        if (str_print_ty.toString().equals("POS")) {
                            setHT32 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT321 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x10, 0x00};//2 tabs 3"
                            setHT32122 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                            setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x10, 0x14, 0x00};//4 tabs 3"
                            nPaperWidth = 576;
                            charlength = 22;
                            charlength1 = 46;
                            charlength2 = 69;
                            quanlentha = 4;
                            HT1 = new byte[]{0x2F};
                            str_line = "------------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------------".getBytes(), LF

                            };
                        }
                    }
                } else {
                    if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(BeveragesMenuFragment_Dine.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT32122 = new byte[]{0x1b, 0x44, 0x14, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x10, 0x18, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 8;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    } else {
                        if (str_print_ty.toString().equals("Epson/others")) {
//                            Toast.makeText(BeveragesMenuFragment_Dine.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT32122 = new byte[]{0x1b, 0x44, 0x20, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x17, 0x20, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 14;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        } else {
                            if (str_print_ty.toString().equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT32122 = new byte[]{0x1b, 0x44, 0x08, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x06, 0x08, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 9;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 3;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }

                }
            } while (cc.moveToNext());
        }
        cc.close();


        String dd = "";
        TextView qazcvb = new TextView(Customer_Info_Activity.this);
        Cursor cvonnusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (cvonnusb.moveToFirst()) {
            addgets = cvonnusb.getString(1);
            namegets = cvonnusb.getString(2);
            statussusbs = cvonnusb.getString(3);
            dd = cvonnusb.getString(4);
        }
        cvonnusb.close();
        qazcvb.setText(dd);
        if (qazcvb.getText().toString().equals("usb") && statussusbs.toString().equals("ok")) {
//            runPrintCouponSequence(dialog);
            print_printbillcopy1(dialog);
        }else {
            imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
            mView = dialog.findViewById(R.id.f_vieww1);


            allbuf1 = new byte[][]{
                    bold, un, "Bill copy".getBytes(), LF

            };
            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(un);    //
                BT_Write("Bill copy");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(un);    //
                    wifiSocket2.WIFI_Write("Bill copy");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(un);    //
                        wifiSocket.WIFI_Write("Bill copy");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
            if (NAME.equals("3 inch")) {
//            Toast.makeText(Customer_Info_Activity.this, "3 inch", Toast.LENGTH_SHORT).show();
                imageViewPicture.getLayoutParams().height = 94;
                imageViewPicture.getLayoutParams().width = 576;
                imageButton.getLayoutParams().height = 94;
                imageButton.getLayoutParams().width = 576;
            } else {
//            Toast.makeText(Customer_Info_Activity.this, "2 inch", Toast.LENGTH_SHORT).show();
                imageViewPicture.getLayoutParams().height = 94;
                imageViewPicture.getLayoutParams().width = 384;
                imageButton.getLayoutParams().height = 94;
                imageButton.getLayoutParams().width = 384;
            }
            //LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(116, 95);
            //imageButton.setLayoutParams(layoutParams);
            //imageButton.setLayoutParams(116, 95);
            String[] col = {"companylogo"};
            Cursor c = db1.query("Logo", col, null, null, null, null, null);
            if (c.moveToFirst()) {
                do {
                    byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
                    final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);

                    imageButton.setImageBitmap(b1);


                    mView.setDrawingCacheEnabled(true);
                    mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
                            View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
                    mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
                    mView.buildDrawingCache(true);

                    Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
                    //mView.setDrawingCacheEnabled(false);
                    ByteArrayOutputStream bytes = new ByteArrayOutputStream();
                    b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);

                    imageViewPicture.setImageBitmap(b);

                    Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
                            .getBitmap();


                    //if (mBitmap != null) {
                    if (statussusbs.equals("ok")) {
                        if (mBitmap != null) {
                            byte[] command = Utils.decodeBitmap(mBitmap);
                            printByteData(command);
                        } else {
                            Log.e("Print Photo error", "the file isn't exists");
                        }
                        Bundle data = new Bundle();
                        //data.putParcelable(Global.OBJECT1, mBitmap);
                        data.putParcelable(Global.PARCE1, mBitmap);
                        data.putInt(Global.INTPARA1, nPaperWidth);
                        data.putInt(Global.INTPARA2, 0);
//                        DrawerService.workThread.handleCmd(
//                                Global.CMD_POS_PRINTBWPICTURE, data);
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            if (mBitmap != null) {
                                byte[] command = Utils.decodeBitmap(mBitmap);
                                printByteData_wifi_counter(command);
                            } else {
                                Log.e("Print Photo error", "the file isn't exists");
                            }
                            Bundle data = new Bundle();
                            data.putParcelable(Global1.PARCE1, mBitmap);
                            data.putInt(Global1.INTPARA1, nPaperWidth);
                            data.putInt(Global1.INTPARA2, 0);
                        }else {
                            if (statusnets.equals("ok")) {
                                if (mBitmap != null) {
                                    byte[] command = Utils.decodeBitmap(mBitmap);
                                    printByteData_wifi(command);
                                } else {
                                    Log.e("Print Photo error", "the file isn't exists");
                                }
                                Bundle data = new Bundle();
                                data.putParcelable(Global1.PARCE1, mBitmap);
                                data.putInt(Global1.INTPARA1, nPaperWidth);
                                data.putInt(Global1.INTPARA2, 0);
                            }
                        }
                    }
                    //}
                } while (c.moveToNext());
            } else {
                imageButton.setVisibility(View.GONE);
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }
            getcom.close();

            tvkot = new TextView(Customer_Info_Activity.this);

            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(bold);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BluetoothPrintDriver.BT_Write(cen);    //
                    BT_Write(strcompanyname);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(bold);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write(cen);    //
                        wifiSocket2.WIFI_Write(strcompanyname);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(bold);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write(cen);    //
                            wifiSocket.WIFI_Write(strcompanyname);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(straddress1);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(straddress1);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(straddress1);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(straddress2);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(straddress2);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(straddress2);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(straddress3);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(straddress3);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(straddress3);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(pp);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(pp);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(pp);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(stremailid);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(stremailid);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(stremailid);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(strwebsite);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(strwebsite);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(strwebsite);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BT_Write(strtaxone);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(strtaxone);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(strtaxone);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }



            Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor10.moveToFirst()) {
                billtypea = cursor10.getString(5);
                paymmethoda = cursor10.getString(6);
            }
            if (cursor10.moveToFirst()) {
                billtypea = cursor10.getString(5);
                paymmethoda = cursor10.getString(6);
            }
            cursor10.close();

            TextView ttv = new TextView(Customer_Info_Activity.this);
            ttv.setText(billtypea);

            TextView ttv1 = new TextView(Customer_Info_Activity.this);
            ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

            if (ttv.getText().toString().equals("  Cash")) {
                billtypeaa = "Cash"; //0
            }
            if (ttv.getText().toString().equals("  Card")) {
                billtypeaa = "Card"; //0
            }
            if (ttv.getText().toString().equals("  Paytm")) {
                billtypeaa = "Paytm"; //0
            }
            if (ttv.getText().toString().equals("  Mobikwik")) {
                billtypeaa = "Mobikwik"; //0
            }
            if (ttv.getText().toString().equals("  Freecharge")) {
                billtypeaa = "Freecharge"; //0
            }
            if (ttv.getText().toString().equals("  Pay Later")) {
                billtypeaa = "Pay Later"; //0
            }
            if (ttv.getText().toString().equals("  Cheque")) {
                billtypeaa = "Cheque"; //0
            }
            if (ttv.getText().toString().equals("  Sodexo")) {
                billtypeaa = "Sodexo"; //0
            }
            if (ttv.getText().toString().equals("  Zeta")) {
                billtypeaa = "Zeta"; //0
            }
            if (ttv.getText().toString().equals("  Ticket")) {
                billtypeaa = "Ticket"; //0
            }
            if (ttv.getText().toString().equals(" Upiqr")) {
                billtypeaa = "upiqr"; //0
            }
            if (ttv.getText().toString().equals("  Upiqr")) {
                billtypeaa = "Upiqr"; //0
            }
            billtypeaa = ttv.getText().toString().replace(" ", "");

            //String bill_no = billnum.getText().toString();
            allbufbillno = new byte[][]{
                    setHT32, un1, billnum_click.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            if (str_print_ty.equals("POS")) {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT321);    //
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BT_Write("Bill no." + billnum_click);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT321);    //
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write("Bill no." + billnum_click);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT321);    //
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write("Bill no." + billnum_click);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }else {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT32);    //
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BT_Write("Bill no."+billnum_click);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT32);    //
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(un1);    //
                        wifiSocket2.WIFI_Write("Bill no."+billnum_click);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT32);    //
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(un1);    //
                            wifiSocket.WIFI_Write("Bill no."+billnum_click);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            if (str_print_ty.equals("POS")) {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT321);    //
                    BT_Write(billtypeaa);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT321);    //
                        wifiSocket2.WIFI_Write("   ");
                        wifiSocket2.WIFI_Write(billtypeaa);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT321);    //
                            wifiSocket.WIFI_Write(billtypeaa);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }else {
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT32);    //
                    BT_Write(billtypeaa);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT32);    //
                        wifiSocket2.WIFI_Write(billtypeaa);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT32);    //
                            wifiSocket.WIFI_Write(billtypeaa);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals("  General") || paymmethoda.toString().equals("  Others")) {
//                paymmethodaa = "General";
                //billtypee.setText("Dine-in");
                if (account_selection.toString().equals("Dine") || account_selection.toString().equals("Qsr")) {
                    paymmethodaa = "Dine-in";
                }else {
                    paymmethodaa = "General";
                }
            } else {
                if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                    paymmethodaa = "Takeaway";
                    //billtypee.setText("Takeaway");
                } else {
                    paymmethodaa = "Home delivery";
                    //billtypee.setText("Home delivery");
                }
            }

            Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);
            if (date.moveToFirst()) {
                datee = date.getString(25);
                timee = date.getString(12);
            }
            date.close();

            allbuf10 = new byte[][]{
                    setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), datee.getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(paymmethodaa);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  " + datee);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(paymmethodaa);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  " + datee);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(paymmethodaa);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  " + datee);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
            if (cursor9.moveToFirst()) {
                tableida = cursor9.getString(15);
                Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
                if (vbnm.moveToFirst()) {
                    assa1 = vbnm.getString(1);
                    assa2 = vbnm.getString(2);
                }
                vbnm.close();
                TextView cx = new TextView(Customer_Info_Activity.this);
                cx.setText(assa1);

                if (cx.getText().toString().equals("")) {
                    tableidaa = "Tab" + assa2;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                } else {
                    tableidaa = "Tab" + assa1;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                }

            }
            cursor9.close();

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT321);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(tableidaa);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  " + timee);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT321);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(tableidaa);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  " + timee);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT321);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(tableidaa);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  " + timee);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            String u_name = "";
            Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
            if (cursor9_1.moveToFirst()) {
                u_name = cursor9_1.getString(45);
            }
            cursor9_1.close();

            TextView tv_u_name = new TextView(Customer_Info_Activity.this);
            tv_u_name.setText(u_name);

            if (tv_u_name.getText().toString().equals("")){

            }else {
                allbuf11 = new byte[][]{
                        left, setHT321, "Counter person ".getBytes(), LF
                };
                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(left);    //
                    BluetoothPrintDriver.BT_Write(setHT321);    //
                    BT_Write("Counter person: " + tv_u_name.getText().toString());
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write(setHT321);    //
                        wifiSocket2.WIFI_Write("Counter person: " + tv_u_name.getText().toString());
                        wifiSocket2.WIFI_Write(LF);    //
                    } else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write(setHT321);    //
                            wifiSocket.WIFI_Write("Counter person: " + tv_u_name.getText().toString());
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

            Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
            if (caddress.moveToFirst()) {
                String nam = caddress.getString(1);
                String addr = caddress.getString(4);
                String phon = caddress.getString(2);
                String emai = caddress.getString(3);

                if (nam.length() > 0 || addr.length() > 0 ||
                        phon.length() > 0 || emai.length() > 0) {
                    allbufcust = new byte[][]{
                            left, un, "Customer:".getBytes(), LF, un1,
                    };

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(left);    //
                        BluetoothPrintDriver.BT_Write(un);    //
                        BT_Write("Customer:");
                        BluetoothPrintDriver.BT_Write(LF);    //
                        BluetoothPrintDriver.BT_Write(un1);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write(un);    //
                            wifiSocket2.WIFI_Write("Customer:");
                            wifiSocket2.WIFI_Write(LF);    //
                            wifiSocket2.WIFI_Write(un1);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write(un);    //
                                wifiSocket.WIFI_Write("Customer:");
                                wifiSocket.WIFI_Write(LF);    //
                                wifiSocket.WIFI_Write(un1);    //
                            }
                        }
                    }
                } else {

                }

                if (nam.length() > 0) {
                    allbufcustname = new byte[][]{
                            nam.getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(nam);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(nam);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(nam);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (addr.length() > 0) {
                    allbufcustadd = new byte[][]{
                            addr.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(addr);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(addr);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(addr);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (phon.length() > 0) {
                    String cust_ph = "Ph. " + phon;
                    allbufcustph = new byte[][]{
                            cust_ph.getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(cust_ph);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(cust_ph);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(cust_ph);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (emai.length() > 0) {
                    allbufcustemail = new byte[][]{
                            emai.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BT_Write(emai);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(emai);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(emai);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                } else {

                }

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(left);    //
                    BluetoothPrintDriver.BT_Write(un1);    //
                    BT_Write(str_line);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(left);	//
                        wifiSocket2.WIFI_Write(un1);	//
                        wifiSocket2.WIFI_Write(str_line);
                        wifiSocket2.WIFI_Write(LF);	//
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(left);	//
                            wifiSocket.WIFI_Write(un1);	//
                            wifiSocket.WIFI_Write(str_line);
                            wifiSocket.WIFI_Write(LF);	//
                        }
                    }
                }
            }
            caddress.close();

            allbufqty = new byte[][]{
                    setHT34, normal, "Qty".getBytes(), HT, "Item".getBytes(), HT, "Price".getBytes(), HT, "Amount".getBytes(), left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT34);    //
                BluetoothPrintDriver.BT_Write(normal);    //
                BT_Write("Qty");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("Item");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write("  Price");
                BluetoothPrintDriver.BT_Write(HT1);    //
                BT_Write("  Amount");
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT34);    //
                    wifiSocket2.WIFI_Write(normal);    //
                    wifiSocket2.WIFI_Write("Qty");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("Item");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write("  Price");
                    wifiSocket2.WIFI_Write(HT1);    //
                    wifiSocket2.WIFI_Write("  Amount");
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT34);    //
                        wifiSocket.WIFI_Write(normal);    //
                        wifiSocket.WIFI_Write("Qty");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("Item");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write("  Price");
                        wifiSocket.WIFI_Write(HT1);    //
                        wifiSocket.WIFI_Write("  Amount");
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }


            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.toString().equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.toString().equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

            Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursorr.moveToFirst()) {

                do {

                    String nbg = ccursorr.getString(0);
                    String name = ccursorr.getString(1);
                    String value = ccursorr.getString(2);
                    String pq = ccursorr.getString(5);
                    String itna = ccursorr.getString(2);
                    String pricee = ccursorr.getString(3);
                    String tototot = ccursorr.getString(4);
                    String tototot1 = ccursorr.getString(4);

                    if (pricee.length() > 7) {
//                        price = " "+price;
                    }
                    if (pricee.length() == 6) {
                        pricee = " "+pricee;
                    }
                    if (pricee.length() == 5) {
                        pricee = "  "+pricee;
                    }
                    if (pricee.length() == 4) {
                        pricee = "   "+pricee;
                    }
                    if (pricee.length() == 3) {
                        pricee = "    "+pricee;
                    }

                    if (tototot.length() >= 8) {

                    }
                    if (tototot.length() == 7) {
                        tototot = " "+tototot;
                    }
                    if (tototot.length() == 6) {
                        tototot = "  "+tototot;
                    }
                    if (tototot.length() == 5) {
                        tototot = "   "+tototot;
                    }
                    if (tototot.length() == 4) {
                        tototot = "    "+tototot;
                    }
                    if (tototot.length() == 3) {
                        tototot = "     "+tototot;
                    }

                    final String newid = ccursorr.getString(20);
                    int padding_in_px;

                    int padding_in_dp = 30;  // 34 dps
                    final float scale1 = getResources().getDisplayMetrics().density;
                    padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                    if (pq.equals("Item")) {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                        final TableRow row1 = new TableRow(Customer_Info_Activity.this);
                        row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                        final TableRow row2 = new TableRow(Customer_Info_Activity.this);
                        row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));

                        final TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Customer_Info_Activity.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                        tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv.setText(value);
                        row.addView(tv);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setGravity(Gravity.CENTER_VERTICAL);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(name);
                        String value1 = tv1.getText().toString();
                        row.addView(tv1);

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setText(pricee);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv3.setText(tototot1);

                        String value2 = tv3.getText().toString();

                        Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                        if (modcursor.moveToFirst()) {

                            Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnum_click + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                            if (cursor4.moveToFirst()) {
                                float sub2a = cursor4.getFloat(0);
                                String sub2a1 = String.valueOf(sub2a);
                                ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot1);
                                ss1 = String.valueOf(ss);

                                if (ss1.length() >= 8) {

                                }
                                if (ss1.length() == 7) {
                                    ss1 = " "+ss1;
                                }
                                if (ss1.length() == 6) {
                                    ss1 = "  "+ss1;
                                }
                                if (ss1.length() == 5) {
                                    ss1 = "   "+ss1;
                                }
                                if (ss1.length() == 4) {
                                    ss1 = "    "+ss1;
                                }
                                if (ss1.length() == 3) {
                                    ss1 = "     "+ss1;
                                }

                            }
                            cursor4.close();

                            if (name.length() > charlength) {
                                int print1 = 0;
//                                Toast.makeText(Customer_Info_Activity.this, "1", Toast.LENGTH_SHORT).show();

                                if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "3", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }

                                if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "4", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "5", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };

                                    if(print1 == 0){
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(ss1);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(ss1);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(ss1);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("HSN "+hsn);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("HSN "+hsn);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("HSN "+hsn);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                }

                            } else {
//                                Toast.makeText(Customer_Info_Activity.this, "6", Toast.LENGTH_SHORT).show();
                                if (value.length() > quanlentha) {
//                                    Toast.makeText(Customer_Info_Activity.this, "7", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(string1quan);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(ss1);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                        BT_Write(string2quan);
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(string1quan);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(ss1);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                            wifiSocket2.WIFI_Write(string2quan);
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(string1quan);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(ss1);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                                wifiSocket.WIFI_Write(string2quan);
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                } else {
//                                    Toast.makeText(Customer_Info_Activity.this, "8", Toast.LENGTH_SHORT).show();
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, ss1.getBytes(), left, LF,
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(value);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(ss1);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(value);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(ss1);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(value);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(ss1);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                }

                            }

                            do {

                                final String modiname = modcursor.getString(1);
                                final String modiquan = modcursor.getString(2);
                                String modiprice = modcursor.getString(3);
                                String moditotal = modcursor.getString(4);
                                final String modiid = modcursor.getString(0);

                                float modprice1 = Float.parseFloat(modiprice);
                                String modpricestr = String.valueOf(modprice1);

                                if (modiname.length() > charlength) {
                                    if (modiname.length() > charlength) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT1, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(">");
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(modpricestr);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("    ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(">");
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(modpricestr);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("    ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(">");
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(modpricestr);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("    ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                    if (modiname.length() > charlength1) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength, charlength1);
                                        String string3 = modiname.substring(charlength1);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT1, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF, "    ".getBytes(), string3.getBytes(), left, LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(">");
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(modpricestr);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("    ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("    ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(">");
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(modpricestr);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("    ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("    ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(">");
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(modpricestr);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("    ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("    ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                } else {
                                    allbufmodifiers = new byte[][]{
                                            setHT34, normal, "".getBytes(), HT, ">".getBytes(), modiname.getBytes(), HT, modpricestr.getBytes(), HT1, "".getBytes(), left, LF
                                            //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                    };
                                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write("");
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(">");
                                        BT_Write(modiname);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(modpricestr);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write("");
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write("");
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(">");
                                            wifiSocket2.WIFI_Write(modiname);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(modpricestr);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write("");
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write("");
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(">");
                                                wifiSocket.WIFI_Write(modiname);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(modpricestr);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write("");
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.equals("ok")) {
                                                BluetoothPrintDriver.BT_Write(left);    //
                                                BluetoothPrintDriver.BT_Write(normal);    //
                                                BT_Write("HSN "+hsn);
                                                BluetoothPrintDriver.BT_Write(HT);    //
                                                BluetoothPrintDriver.BT_Write(LF);    //
                                            } else {
                                                if (statusnets_counter.equals("ok")) {
                                                    wifiSocket2.WIFI_Write(left);    //
                                                    wifiSocket2.WIFI_Write(normal);    //
                                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                                    wifiSocket2.WIFI_Write(HT);    //
                                                    wifiSocket2.WIFI_Write(LF);    //
                                                }else {
                                                    if (statusnets.equals("ok")) {
                                                        wifiSocket.WIFI_Write(left);    //
                                                        wifiSocket.WIFI_Write(normal);    //
                                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                                        wifiSocket.WIFI_Write(HT);    //
                                                        wifiSocket.WIFI_Write(LF);    //
                                                    }
                                                }
                                            }
                                        }
                                    }

                                }

                                final TableRow tableRow11 = new TableRow(Customer_Info_Activity.this);
                                tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                        TableRow.LayoutParams.MATCH_PARENT,
                                        TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                final TextView tvv = new TextView(Customer_Info_Activity.this);
                                // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                                tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                //tv.setGravity(Gravity.CENTER);
                                tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tvv.setText("");
                                tableRow11.addView(tvv);

                                TextView tv4 = new TextView(Customer_Info_Activity.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv4.setText(modiname);
                                tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv4.setGravity(Gravity.CENTER_VERTICAL);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv4);

                                TextView tv5 = new TextView(Customer_Info_Activity.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv2.setPadding(0, 0, 1, 0);
                                tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv5.setText(modiprice);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv5);

                                TextView tv6 = new TextView(Customer_Info_Activity.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setPadding(5, 0, 0, 0);
                                tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv6.setText("");
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv6);


                                final TextView tv7 = new TextView(Customer_Info_Activity.this);
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv3.setPadding(0,0,10,0);
                                tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                                final String number = tv.getText().toString();
                                float newmul = Float.parseFloat(number);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                                //row.addView(tv3);

                                row.removeView(tv8);


                                tv8 = new TextView(Customer_Info_Activity.this);
                                tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                //tv3.setPadding(0, 0, 10, 0);
                                tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                final String numberr = tv.getText().toString();
                                float newmulr = Float.parseFloat(numberr);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                tv8.setText(String.valueOf(ss));
                                row.addView(tv8);


                                tableLayout1.addView(tableRow11);
                            } while (modcursor.moveToNext());

                            //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.equals("no")) {

                                    } else {

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT1, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("(");
                                            BT_Write("-");
                                            BT_Write(total_disc_print_q);
                                            BT_Write(")");
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("(");
                                                wifiSocket2.WIFI_Write("-");
                                                wifiSocket2.WIFI_Write(total_disc_print_q);
                                                wifiSocket2.WIFI_Write(")");
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("(");
                                                    wifiSocket.WIFI_Write("-");
                                                    wifiSocket.WIFI_Write(total_disc_print_q);
                                                    wifiSocket.WIFI_Write(")");
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }
                            disc_cursor.close();

                        } else {

                            if (name.length() > charlength) {
//                                Toast.makeText(Customer_Info_Activity.this, "10", Toast.LENGTH_SHORT).show();
                                int print1 = 0;
                                if (value.length() > quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "11", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength) {
//                                    Toast.makeText(Customer_Info_Activity.this, "12", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
////////////////////////////////////////////////
                                if (value.length() > quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "13", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(string1quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write(string2quan);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(string1quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write(string2quan);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(string1quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write(string2quan);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }
                                if (value.length() <= quanlentha && name.length() > charlength1) {
//                                    Toast.makeText(Customer_Info_Activity.this, "14", Toast.LENGTH_SHORT).show();
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write(value);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write(string1);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BT_Write(pricee);
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write(tototot);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string2);
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            BT_Write("      ");
                                            BT_Write(string3);
                                            BluetoothPrintDriver.BT_Write(right);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                            print1 = 1;
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write(value);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(string1);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(pricee);
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write(tototot);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string2);
                                                wifiSocket2.WIFI_Write(LF);    //
                                                wifiSocket2.WIFI_Write("      ");
                                                wifiSocket2.WIFI_Write(string3);
                                                wifiSocket2.WIFI_Write(right);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                                print1 = 1;
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write(value);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(string1);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(pricee);
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write(tototot);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string2);
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    wifiSocket.WIFI_Write("      ");
                                                    wifiSocket.WIFI_Write(string3);
                                                    wifiSocket.WIFI_Write(right);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                    print1 = 1;
                                                }
                                            }
                                        }
                                    }

                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("HSN "+hsn);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("HSN "+hsn);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("HSN "+hsn);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                }

                            } else {
                                if (value.length() > quanlentha) {
//                                    Toast.makeText(Customer_Info_Activity.this, "15", Toast.LENGTH_SHORT).show();
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(string1quan);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(tototot);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                        BT_Write(string2quan);
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(string1quan);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(tototot);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                            wifiSocket2.WIFI_Write(string2quan);
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(string1quan);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(tototot);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                                wifiSocket.WIFI_Write(string2quan);
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }
                                } else {
//                                    Toast.makeText(Customer_Info_Activity.this, "16", Toast.LENGTH_SHORT).show();
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT1, tototot.getBytes(), left, LF,
                                    };
                                    if (statussusbs.equals("ok")) {
                                        BluetoothPrintDriver.BT_Write(setHT34);    //
                                        BluetoothPrintDriver.BT_Write(normal);    //
                                        BT_Write(value);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BT_Write(name);
                                        BluetoothPrintDriver.BT_Write(HT);    //
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BT_Write(pricee);
                                        BluetoothPrintDriver.BT_Write(HT1);    //
                                        BT_Write(tototot);
                                        BluetoothPrintDriver.BT_Write(right);    //
                                        BluetoothPrintDriver.BT_Write(LF);    //
                                    } else {
                                        if (statusnets_counter.equals("ok")) {
                                            wifiSocket2.WIFI_Write(setHT34);    //
                                            wifiSocket2.WIFI_Write(normal);    //
                                            wifiSocket2.WIFI_Write(value);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(name);
                                            wifiSocket2.WIFI_Write(HT);    //
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(pricee);
                                            wifiSocket2.WIFI_Write(HT1);    //
                                            wifiSocket2.WIFI_Write(tototot);
                                            wifiSocket2.WIFI_Write(right);    //
                                            wifiSocket2.WIFI_Write(LF);    //
                                        }else {
                                            if (statusnets.equals("ok")) {
                                                wifiSocket.WIFI_Write(setHT34);    //
                                                wifiSocket.WIFI_Write(normal);    //
                                                wifiSocket.WIFI_Write(value);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(name);
                                                wifiSocket.WIFI_Write(HT);    //
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(pricee);
                                                wifiSocket.WIFI_Write(HT1);    //
                                                wifiSocket.WIFI_Write(tototot);
                                                wifiSocket.WIFI_Write(right);    //
                                                wifiSocket.WIFI_Write(LF);    //
                                            }
                                        }
                                    }
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("HSN "+hsn);
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("HSN "+hsn);
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("HSN "+hsn);
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                }


                            }

                            tv8 = new TextView(Customer_Info_Activity.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String pricee1 = ccursorr.getString(3);
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee1));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(multiply));
                            row.addView(tv8);

                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.equals("no")) {

                                    } else {

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT1, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.equals("ok")) {
                                            BluetoothPrintDriver.BT_Write(setHT34);    //
                                            BluetoothPrintDriver.BT_Write(normal);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT);    //
                                            BT_Write("");
                                            BluetoothPrintDriver.BT_Write(HT1);    //
                                            BT_Write("(");
                                            BT_Write("-");
                                            BT_Write(total_disc_print_q);
                                            BT_Write(")");
                                            BluetoothPrintDriver.BT_Write(left);    //
                                            BluetoothPrintDriver.BT_Write(LF);    //
                                        } else {
                                            if (statusnets_counter.equals("ok")) {
                                                wifiSocket2.WIFI_Write(setHT34);    //
                                                wifiSocket2.WIFI_Write(normal);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT);    //
                                                wifiSocket2.WIFI_Write("");
                                                wifiSocket2.WIFI_Write(HT1);    //
                                                wifiSocket2.WIFI_Write("(");
                                                wifiSocket2.WIFI_Write("-");
                                                wifiSocket2.WIFI_Write(total_disc_print_q);
                                                wifiSocket2.WIFI_Write(")");
                                                wifiSocket2.WIFI_Write(left);    //
                                                wifiSocket2.WIFI_Write(LF);    //
                                            }else {
                                                if (statusnets.equals("ok")) {
                                                    wifiSocket.WIFI_Write(setHT34);    //
                                                    wifiSocket.WIFI_Write(normal);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT);    //
                                                    wifiSocket.WIFI_Write("");
                                                    wifiSocket.WIFI_Write(HT1);    //
                                                    wifiSocket.WIFI_Write("(");
                                                    wifiSocket.WIFI_Write("-");
                                                    wifiSocket.WIFI_Write(total_disc_print_q);
                                                    wifiSocket.WIFI_Write(")");
                                                    wifiSocket.WIFI_Write(left);    //
                                                    wifiSocket.WIFI_Write(LF);    //
                                                }
                                            }
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }
                            disc_cursor.close();
                        }
                        modcursor.close();
                    }


                } while (ccursorr.moveToNext());
            }
            ccursorr.close();

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }
////////////////////////////////////sub total
            Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor3.moveToFirst()) {
                sub = cursor3.getString(7);
            }
            cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
            float to = Float.parseFloat(sub);
            String tot = String.format("%.2f", to);

            if (tot.length() >= 11) {

            }
            if (tot.length() == 10) {
                tot = " "+tot;
            }
            if (tot.length() == 9) {
                tot = "  "+tot;
            }
            if (tot.length() == 8) {
                tot = "   "+tot;
            }
            if (tot.length() == 7) {
                tot = "    "+tot;
            }
            if (tot.length() == 6) {
                tot = "     "+tot;
            }
            if (tot.length() == 5) {
                tot = "      "+tot;
            }
            if (tot.length() == 4) {
                tot = "       "+tot;
            }
            allbufsubtot = new byte[][]{
                    setHT3212, left, "Sub total".getBytes(), HT, tot.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT3212);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write("Sub total");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write(tot);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT3212);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write("Sub total");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(tot);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT3212);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write("Sub total");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(tot);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }
/////////////////////////tax




///////////////////////////////// discount

            Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
            if (cursor4.moveToFirst()) {
                taxpe = cursor4.getString(5);
            } else {
                taxpe = "0.00";
            }
            cursor4.close();

            Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
            if (cursor5.moveToFirst()) {
                dsirs = cursor5.getString(7);
            } else {
                dsirs = "0.00";
            }
            cursor5.close();

            String alldiscinperc1 = "Discount(" + taxpe + "%)";
            allbufdisc = new byte[][]{
                    setHT32, left, alldiscinperc1.getBytes(), HT, dsirs.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            if (dsirs.length() >= 11) {

            }
            if (dsirs.length() == 10) {
                dsirs = " "+dsirs;
            }
            if (dsirs.length() == 9) {
                dsirs = "  "+dsirs;
            }
            if (dsirs.length() == 8) {
                dsirs = "   "+dsirs;
            }
            if (dsirs.length() == 7) {
                dsirs = "    "+dsirs;
            }
            if (dsirs.length() == 6) {
                dsirs = "     "+dsirs;
            }
            if (dsirs.length() == 5) {
                dsirs = "      "+dsirs;
            }
            if (dsirs.length() == 4) {
                dsirs = "       "+dsirs;
            }

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT3212);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write(alldiscinperc1);
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write(dsirs);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT3212);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write(alldiscinperc1);
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(dsirs);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT3212);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write(alldiscinperc1);
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(dsirs);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }
            float newe;
//////////////////////////////////////////////

            Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnum_click + "'", null);
            if (cursor113.moveToFirst()) {
                float level = cursor113.getFloat(0);
                total = String.valueOf(level);
                float total1 = Float.parseFloat(total);
                total_disc_print_q = String.format("%.2f", total1);

                if (total_disc_print_q.length() >= 11) {

                }
                if (total_disc_print_q.length() == 10) {
                    total_disc_print_q = " "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 9) {
                    total_disc_print_q = "  "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 8) {
                    total_disc_print_q = "   "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 7) {
                    total_disc_print_q = "    "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 6) {
                    total_disc_print_q = "     "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 5) {
                    total_disc_print_q = "      "+total_disc_print_q;
                }
                if (total_disc_print_q.length() == 4) {
                    total_disc_print_q = "       "+total_disc_print_q;
                }

                allbufrounded = new byte[][]{
                        setHT3212, left, "Savings".getBytes(), HT, total_disc_print_q.getBytes(), LF
                };

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT3212);    //
                    BluetoothPrintDriver.BT_Write(left);    //
                    BT_Write("Savings");
                    BluetoothPrintDriver.BT_Write(HT);    //
                    BT_Write(total_disc_print_q);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT3212);    //
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write("Savings");
                        wifiSocket2.WIFI_Write(HT);    //
                        wifiSocket2.WIFI_Write(total_disc_print_q);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT3212);    //
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write("Savings");
                            wifiSocket.WIFI_Write(HT);    //
                            wifiSocket.WIFI_Write(total_disc_print_q);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }

            }
            cursor113.close();
////////////////////////////////

            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor.moveToFirst()){
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                String v_tq_loy = String.format("%.2f", v_tq);

                if (v_tq_loy.length() >= 11) {

                }
                if (v_tq_loy.length() == 10) {
                    v_tq_loy = " "+v_tq_loy;
                }
                if (v_tq_loy.length() == 9) {
                    v_tq_loy = "  "+v_tq_loy;
                }
                if (v_tq_loy.length() == 8) {
                    v_tq_loy = "   "+v_tq_loy;
                }
                if (v_tq_loy.length() == 7) {
                    v_tq_loy = "    "+v_tq_loy;
                }
                if (v_tq_loy.length() == 6) {
                    v_tq_loy = "     "+v_tq_loy;
                }
                if (v_tq_loy.length() == 5) {
                    v_tq_loy = "      "+v_tq_loy;
                }
                if (v_tq_loy.length() == 4) {
                    v_tq_loy = "       "+v_tq_loy;
                }

                TextView tv = new TextView(Customer_Info_Activity.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {
                    allbufrounded = new byte[][]{
                            setHT3212, left, "Loyalty".getBytes(), HT, v_tq.getBytes(), LF
                    };

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT3212);    //
                        BluetoothPrintDriver.BT_Write(left);    //
                        BT_Write("Loyalty(" + t_total_points + ")");
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(v_tq_loy);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT3212);    //
                            wifiSocket2.WIFI_Write(left);    //
                            wifiSocket2.WIFI_Write("Loyalty(" + t_total_points + ")");
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(v_tq_loy);
                            wifiSocket2.WIFI_Write(LF);    //
                        } else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT3212);    //
                                wifiSocket.WIFI_Write(left);    //
                                wifiSocket.WIFI_Write("Loyalty(" + t_total_points + ")");
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(v_tq_loy);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }
                }
            }

//////////////////////////////////////Rounded off

            Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor7.moveToFirst()) {
                subro = cursor7.getString(9);
            }
            cursor7.close();

//            float subro1 = Float.parseFloat(subro);
//            subro = String.format("%.2f", subro1);

            if (subro.length() >= 11) {

            }
            if (subro.length() == 10) {
                subro = " "+subro;
            }
            if (subro.length() == 9) {
                subro = "  "+subro;
            }
            if (subro.length() == 8) {
                subro = "   "+subro;
            }
            if (subro.length() == 7) {
                subro = "    "+subro;
            }
            if (subro.length() == 6) {
                subro = "     "+subro;
            }
            if (subro.length() == 5) {
                subro = "      "+subro;
            }
            if (subro.length() == 4) {
                subro = "       "+subro;
            }

            allbufrounded = new byte[][]{
                    setHT3212, left, "Rounded".getBytes(), HT, subro.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT3212);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write("Rounded");
                BluetoothPrintDriver.BT_Write(HT);    //
                BT_Write(subro);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT3212);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write("Rounded");
                    wifiSocket2.WIFI_Write(HT);    //
                    wifiSocket2.WIFI_Write(subro);
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT3212);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write("Rounded");
                        wifiSocket.WIFI_Write(HT);    //
                        wifiSocket.WIFI_Write(subro);
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }
//////////////Total main

            Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor8.moveToFirst()) {
                alltotal1 = cursor8.getString(2);
            }
            cursor8.close();

            float all = Float.parseFloat(alltotal1);
            String newf = String.format("%.2f", all);

            allbufrounded = new byte[][]{
                    setHT32122, left, "Total".getBytes(), HT, "Rs ".getBytes(), newf.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };
            String allt = insert1_rs+""+newf;
            if (allt.length() >= 12) {

            }
            if (allt.length() == 11) {
                allt = " "+allt;
            }
            if (allt.length() == 10) {
                allt = "  "+allt;
            }
            if (allt.length() == 9) {
                allt = "   "+allt;
            }
            if (allt.length() == 8) {
                allt = "    "+allt;
            }
            if (allt.length() == 7) {
                allt = "     "+allt;
            }
            if (allt.length() == 6) {
                allt = "      "+allt;
            }
            if (allt.length() == 5) {
                allt = "       "+allt;
            }
            if (allt.length() == 4) {
                allt = "        "+allt;
            }

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(setHT32122);    //
                BluetoothPrintDriver.BT_Write(bold);    //
                BluetoothPrintDriver.BT_Write(left);    //
                BT_Write("Total");
                BluetoothPrintDriver.BT_Write(HT);    //
//                BT_Write(insert1_rs);
//                BT_Write(newf);
                BT_Write(allt);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(setHT32122);    //
                    wifiSocket2.WIFI_Write(bold);    //
                    wifiSocket2.WIFI_Write(left);    //
                    wifiSocket2.WIFI_Write("Total");
                    wifiSocket2.WIFI_Write(HT);    //
//                    wifiSocket2.WIFI_Write(insert1_rs);
//                    wifiSocket2.WIFI_Write(newf);
                    wifiSocket2.WIFI_Write(allt);    //
                    wifiSocket2.WIFI_Write(LF);    //
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(setHT32122);    //
                        wifiSocket.WIFI_Write(bold);    //
                        wifiSocket.WIFI_Write(left);    //
                        wifiSocket.WIFI_Write("Total");
                        wifiSocket.WIFI_Write(HT);    //
//                        wifiSocket.WIFI_Write(insert1_rs);
//                        wifiSocket.WIFI_Write(newf);
                        wifiSocket.WIFI_Write(allt);    //
                        wifiSocket.WIFI_Write(LF);    //
                    }
                }
            }

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(left);    //
                BluetoothPrintDriver.BT_Write(normal);    //
                BluetoothPrintDriver.BT_Write(un1);    //
                BT_Write(str_line);
                BluetoothPrintDriver.BT_Write(LF);    //
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(left);	//
                    wifiSocket2.WIFI_Write(normal);	//
                    wifiSocket2.WIFI_Write(un1);	//
                    wifiSocket2.WIFI_Write(str_line);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(left);	//
                        wifiSocket.WIFI_Write(normal);	//
                        wifiSocket.WIFI_Write(un1);	//
                        wifiSocket.WIFI_Write(str_line);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }

            //////////////ttax
            TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);
            tableLayout1.removeAllViews();

            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor.moveToFirst()) {

                do {
                    String name = ccursor.getString(10);
                    String value = ccursor.getString(9);
                    String pq = ccursor.getString(50);
                    String itna = ccursor.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor.moveToNext());
            }
            ccursor.close();

            Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor2.moveToFirst()) {

                do {
                    String name = ccursor2.getString(35);
                    String value = ccursor2.getString(36);
                    String pq = ccursor2.getString(50);
                    String itna = ccursor2.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor2.moveToNext());
            }
            ccursor2.close();

            Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor3.moveToFirst()) {

                do {
                    String name = ccursor3.getString(37);
                    String value = ccursor3.getString(38);
                    String pq = ccursor3.getString(50);
                    String itna = ccursor3.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor3.moveToNext());
            }
            ccursor3.close();

            Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor4.moveToFirst()) {

                do {
                    String name = ccursor4.getString(39);
                    String value = ccursor4.getString(40);
                    String pq = ccursor4.getString(50);
                    String itna = ccursor4.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor4.moveToNext());
            }
            ccursor4.close();

            Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor5.moveToFirst()) {

                do {
                    String name = ccursor5.getString(41);
                    String value = ccursor5.getString(42);
                    String pq = ccursor5.getString(50);
                    String itna = ccursor5.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor5.moveToNext());
            }
            ccursor5.close();


            ArrayList<String> groupList = new ArrayList<String>();

            float sum_p = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(Customer_Info_Activity.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

                if (groupList.contains(mTextView.getText().toString())) {

                }else {
                    sum_p = 0;
                    for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                        TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                        mTextView1 = (TextView) mRow1.getChildAt(0);
                        mTextView2 = (TextView) mRow1.getChildAt(2);
                        if (groupList.contains(mTextView.getText().toString())) {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Customer_Info_Activity.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        } else {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                groupList.add(mTextView.getText().toString());
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Customer_Info_Activity.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        }
                    }
//                    Toast.makeText(Customer_Info_Activity.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                    String mod1 = mTextView.getText().toString() + "" + String.format("%.2f", sum_p);
                    String mod12 = mTextView.getText().toString();
                    String sum_p_float = String.format("%.2f", sum_p);

                    if (sum_p_float.length() >= 11) {

                    }
                    if (sum_p_float.length() == 10) {
                        sum_p_float = " "+sum_p_float;
                    }
                    if (sum_p_float.length() == 9) {
                        sum_p_float = "  "+sum_p_float;
                    }
                    if (sum_p_float.length() == 8) {
                        sum_p_float = "   "+sum_p_float;
                    }
                    if (sum_p_float.length() == 7) {
                        sum_p_float = "    "+sum_p_float;
                    }
                    if (sum_p_float.length() == 6) {
                        sum_p_float = "     "+sum_p_float;
                    }
                    if (sum_p_float.length() == 5) {
                        sum_p_float = "      "+sum_p_float;
                    }
                    if (sum_p_float.length() == 4) {
                        sum_p_float = "       "+sum_p_float;
                    }

                    allbuftaxestype1 = new byte[][]{
                            left, normal, mod12.getBytes(), HT, LF
                            //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.equals("ok")) {
                        BluetoothPrintDriver.BT_Write(setHT3212);    //
                        BT_Write(normal);
                        BT_Write(mod12);
                        BluetoothPrintDriver.BT_Write(HT);    //
                        BT_Write(sum_p_float);
                        BluetoothPrintDriver.BT_Write(LF);    //
                    } else {
                        if (statusnets_counter.equals("ok")) {
                            wifiSocket2.WIFI_Write(setHT3212);    //
                            wifiSocket2.WIFI_Write(normal);
                            wifiSocket2.WIFI_Write(mod12);
                            wifiSocket2.WIFI_Write(HT);    //
                            wifiSocket2.WIFI_Write(sum_p_float);
                            wifiSocket2.WIFI_Write(LF);    //
                        }else {
                            if (statusnets.equals("ok")) {
                                wifiSocket.WIFI_Write(setHT3212);    //
                                wifiSocket.WIFI_Write(normal);
                                wifiSocket.WIFI_Write(mod12);
                                wifiSocket.WIFI_Write(HT);    //
                                wifiSocket.WIFI_Write(sum_p_float);
                                wifiSocket.WIFI_Write(LF);    //
                            }
                        }
                    }

//                    String match = "@";
//                    int position = mTextView.getText().toString().indexOf(match);
                    String mod2 = mTextView.getText().toString();
                    Toast.makeText(Customer_Info_Activity.this, " "+mod2, Toast.LENGTH_LONG).show();
                    Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    if (ccursor6.moveToFirst()) {
                        String hsn = ccursor6.getString(34);

                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                        hsn_hsn.setText(hsn);

                        if (hsn_hsn.getText().toString().equals("")) {
                        } else {
                            allbuftaxestype1 = new byte[][]{
                                    left, normal, hsn.getBytes(), HT, LF
                            };
                            if (statussusbs.equals("ok")) {
                                BluetoothPrintDriver.BT_Write(left);    //
                                BT_Write(normal);
                                BT_Write("HSN "+hsn);
                                BluetoothPrintDriver.BT_Write(HT);    //
                                BluetoothPrintDriver.BT_Write(LF);    //
                            } else {
                                if (statusnets_counter.equals("ok")) {
                                    wifiSocket2.WIFI_Write(left);    //
                                    wifiSocket2.WIFI_Write(normal);
                                    wifiSocket2.WIFI_Write("HSN "+hsn);
                                    wifiSocket2.WIFI_Write(HT);    //
                                    wifiSocket2.WIFI_Write(LF);    //
                                }else {
                                    if (statusnets.equals("ok")) {
                                        wifiSocket.WIFI_Write(left);    //
                                        wifiSocket.WIFI_Write(normal);
                                        wifiSocket.WIFI_Write("HSN "+hsn);
                                        wifiSocket.WIFI_Write(HT);    //
                                        wifiSocket.WIFI_Write(LF);    //
                                    }
                                }
                            }
                        }
                    }
                    ccursor6.close();

                }
            }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.toString().equals("0") || name.toString().equals("NONE") || name.toString().equals("None") || value.toString().equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Customer_Info_Activity.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Customer_Info_Activity.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Customer_Info_Activity.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format("%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Customer_Info_Activity.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Customer_Info_Activity.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Customer_Info_Activity.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float mul = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
//                        float tota = mul;
//                        String tota1 = String.format("%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.toString().equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                            byte[] bufmodi = DataUtils.byteArraysToBytes(allbuftaxestype1);
//                            Bundle data = new Bundle();
//                            //data.putByteArray(Global.BYTESPARA1, buf1);
//                            data.putByteArray(Global.BYTESPARA1, bufmodi);
//                            data.putInt(Global.INTPARA1, 0);
//                            //data.putInt(Global.INTPARA2, buf1.length);
//                            data.putInt(Global.INTPARA2, bufmodi.length);
//                            DrawerService.workThread.handleCmd(Global.CMD_POS_WRITE, data);
//                        } else {
//                            if (statusnets.toString().equals("ok")) {
//                                byte[] bufmodi = DataUtils1.byteArraysToBytes(allbuftaxestype1);
//                                Bundle data = new Bundle();
//                                //data.putByteArray(Global.BYTESPARA1, buf1);
//                                data.putByteArray(Global1.BYTESPARA1, bufmodi);
//                                data.putInt(Global1.INTPARA1, 0);
//                                //data.putInt(Global.INTPARA2, buf1.length);
//                                data.putInt(Global1.INTPARA2, bufmodi.length);
//                                DrawerService1.workThread.handleCmd(Global1.CMD_POS_WRITE1, data);
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }

            String phon = "0";
            Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
            if (caddress1.moveToFirst()) {
                phon = caddress1.getString(2);
            }
            caddress1.close();

            TextView tvvs = new TextView(Customer_Info_Activity.this);
            tvvs.setText(phon);

            Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
            if (us_name1.moveToLast()) {
//            Toast.makeText(Customer_Info_Activity.this, "user id there", Toast.LENGTH_LONG).show();
                String na53 = us_name1.getString(53);
                String na38 = us_name1.getString(38);
                String na39 = us_name1.getString(39);
                String na40 = us_name1.getString(40);
                String na41 = us_name1.getString(41);
                String na42 = us_name1.getString(42);
                String na43 = us_name1.getString(43);
                String na44 = us_name1.getString(44);
                String na45 = us_name1.getString(45);
                String na46 = us_name1.getString(46);
                String na47 = us_name1.getString(47);
                String na48 = us_name1.getString(48);
                String na49 = us_name1.getString(49);
                String na50 = us_name1.getString(50);
                String na51 = us_name1.getString(51);
                String na52 = us_name1.getString(52);
                String na38_value = us_name1.getString(54);
                String na39_value = us_name1.getString(55);
                String na40_value = us_name1.getString(56);
                String na41_value = us_name1.getString(57);
                String na42_value = us_name1.getString(58);
                String na43_value = us_name1.getString(59);
                String na44_value = us_name1.getString(60);
                String na45_value = us_name1.getString(61);
                String na46_value = us_name1.getString(62);
                String na47_value = us_name1.getString(63);
                String na48_value = us_name1.getString(64);
                String na49_value = us_name1.getString(65);
                String na50_value = us_name1.getString(66);
                String na51_value = us_name1.getString(67);
                String na52_value = us_name1.getString(68);

                String proc = us_name1.getString(69);

                TextView hid = new TextView(Customer_Info_Activity.this);
                hid.setText(proc);

                if (hid.getText().toString().equals("off")) {
                    Cursor cursorr = null;
                    if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals("  General") || paymmethoda.toString().equals("  Others")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.toString().equals("  Home delivery")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                    if (cursorr.moveToFirst()) {

                        do {

                            String name = cursorr.getString(1);
                            String value = cursorr.getString(2);

                            final TableRow row = new TableRow(Customer_Info_Activity.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT));
                            row.setGravity(Gravity.CENTER);

                            TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                            TextView tvv = new TextView(Customer_Info_Activity.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText(name);

                            TextView tv1 = new TextView(Customer_Info_Activity.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv1.setText(value);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format("%.2f", vbn);
                            tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Customer_Info_Activity.this);
                            //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                            //tv2.setLayoutParams(lp);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                            tv2.append(name + " @ " + bvn + "%");
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Customer_Info_Activity.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            //tv3.setPadding(0,0,10,0);
                            tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
                            float tota = mul;
                            String tota1 = String.format("%.2f", tota);
                            tv3.setText(String.valueOf(tota));
                            //row.addView(tv3);


                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value2 = tv3.getText().toString();
                            row.addView(tv3);

                            tableLayout1.addView(row);

                            String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                            String mod1_1 = name + "" + String.valueOf(tota1);
                            String mod12 = name;
                            String sum_p_float = String.valueOf(tota1);

                            if (sum_p_float.length() >= 11) {

                            }
                            if (sum_p_float.length() == 10) {
                                sum_p_float = " "+sum_p_float;
                            }
                            if (sum_p_float.length() == 9) {
                                sum_p_float = "  "+sum_p_float;
                            }
                            if (sum_p_float.length() == 8) {
                                sum_p_float = "   "+sum_p_float;
                            }
                            if (sum_p_float.length() == 7) {
                                sum_p_float = "    "+sum_p_float;
                            }
                            if (sum_p_float.length() == 6) {
                                sum_p_float = "     "+sum_p_float;
                            }
                            if (sum_p_float.length() == 5) {
                                sum_p_float = "      "+sum_p_float;
                            }
                            if (sum_p_float.length() == 4) {
                                sum_p_float = "       "+sum_p_float;
                            }

                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                                    //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                            };
                            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                            if (statussusbs.equals("ok")) {
//                                BluetoothPrintDriver.BT_Write(left);    //
//                                BT_Write(normal);
//                                BT_Write(mod1);
//                                BluetoothPrintDriver.BT_Write(HT);    //
//                                BluetoothPrintDriver.BT_Write(LF);    //
                                BluetoothPrintDriver.BT_Write(setHT3212);    //
                                BT_Write(normal);
                                BT_Write(mod12);
                                BluetoothPrintDriver.BT_Write(HT);    //
                                BT_Write(sum_p_float);
                                BluetoothPrintDriver.BT_Write(LF);    //
                            } else {
                                if (statusnets_counter.equals("ok")) {
                                    wifiSocket2.WIFI_Write(setHT3212);    //
                                    wifiSocket2.WIFI_Write(normal);
                                    wifiSocket2.WIFI_Write(mod12);
                                    wifiSocket2.WIFI_Write(HT);    //
                                    wifiSocket2.WIFI_Write(sum_p_float);
                                    wifiSocket2.WIFI_Write(LF);    //
                                }else {
                                    if (statusnets.equals("ok")) {
                                        wifiSocket.WIFI_Write(setHT3212);    //
                                        wifiSocket.WIFI_Write(normal);
                                        wifiSocket.WIFI_Write(mod12);
                                        wifiSocket.WIFI_Write(HT);    //
                                        wifiSocket.WIFI_Write(sum_p_float);
                                        wifiSocket.WIFI_Write(LF);    //
                                    }
                                }
                            }

                        } while (cursorr.moveToNext());
                    }
                    cursorr.close();
                } else {
                    for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                        int i1 = 0;
                        if (i2 == 38) {
                            i1 = 54;
                        }
                        if (i2 == 39) {
                            i1 = 55;
                        }
                        if (i2 == 40) {
                            i1 = 56;
                        }
                        if (i2 == 41) {
                            i1 = 57;
                        }
                        if (i2 == 42) {
                            i1 = 58;
                        }
                        if (i2 == 43) {
                            i1 = 59;
                        }
                        if (i2 == 44) {
                            i1 = 60;
                        }
                        if (i2 == 45) {
                            i1 = 61;
                        }
                        if (i2 == 46) {
                            i1 = 62;
                        }
                        if (i2 == 47) {
                            i1 = 63;
                        }
                        if (i2 == 48) {
                            i1 = 64;
                        }
                        if (i2 == 49) {
                            i1 = 65;
                        }
                        if (i2 == 50) {
                            i1 = 66;
                        }
                        if (i2 == 51) {
                            i1 = 67;
                        }
                        if (i2 == 52) {
                            i1 = 68;
                        }


                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Customer_Info_Activity.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv.setGravity(Gravity.START);
                        tv.setTextSize(15);
                        //text = cursor.getString(1);
//                String v = na;

                        tv.setText(us_name1.getString(i2));


                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        //text = cursor.getString(1);
                        tv1.setText(us_name1.getString(i1));
                        String value1 = "0";
                        if (tv1.getText().toString().equals("")) {

                        } else {
                            value1 = tv1.getText().toString();
                        }


                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                        tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);
//                    Toast.makeText(Customer_Info_Activity.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

//                    Toast.makeText(Customer_Info_Activity.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                        TextView tv33 = new TextView(Customer_Info_Activity.this);
                        tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
                        float tota = mul;
                        String tota1 = String.format("%.2f", tota);
                        tv33.setText(String.valueOf(tota));
                        tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv3.setTextColor(Color.parseColor("#000000"));
                        //row.addView(tv3);


                        tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv33);

                        String value2 = tv33.getText().toString();
//                    Toast.makeText(Customer_Info_Activity.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                        if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                                || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                        } else {
                            tableLayout1.addView(row);
                            String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                            String mod1_1 = us_name1.getString(i2) + "" + String.valueOf(tota1);
                            String mod12 = us_name1.getString(i2);
                            String sum_p_float = String.valueOf(tota1);

                            if (sum_p_float.length() >= 11) {

                            }
                            if (sum_p_float.length() == 10) {
                                sum_p_float = " "+sum_p_float;
                            }
                            if (sum_p_float.length() == 9) {
                                sum_p_float = "  "+sum_p_float;
                            }
                            if (sum_p_float.length() == 8) {
                                sum_p_float = "   "+sum_p_float;
                            }
                            if (sum_p_float.length() == 7) {
                                sum_p_float = "    "+sum_p_float;
                            }
                            if (sum_p_float.length() == 6) {
                                sum_p_float = "     "+sum_p_float;
                            }
                            if (sum_p_float.length() == 5) {
                                sum_p_float = "      "+sum_p_float;
                            }
                            if (sum_p_float.length() == 4) {
                                sum_p_float = "       "+sum_p_float;
                            }

                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                            };

                            if (statussusbs.equals("ok")) {
//                                BluetoothPrintDriver.BT_Write(left);    //
//                                BT_Write(normal);
//                                BT_Write(mod1);
//                                BluetoothPrintDriver.BT_Write(HT);    //
//                                BluetoothPrintDriver.BT_Write(LF);    //
                                BluetoothPrintDriver.BT_Write(setHT3212);    //
                                BT_Write(normal);
                                BT_Write(mod12);
                                BluetoothPrintDriver.BT_Write(HT);    //
                                BT_Write(sum_p_float);
                                BluetoothPrintDriver.BT_Write(LF);    //
                            } else {
                                if (statusnets_counter.equals("ok")) {
                                    wifiSocket2.WIFI_Write(setHT3212);    //
                                    wifiSocket2.WIFI_Write(normal);
                                    wifiSocket2.WIFI_Write(mod12);
                                    wifiSocket2.WIFI_Write(HT);    //
                                    wifiSocket2.WIFI_Write(sum_p_float);
                                    wifiSocket2.WIFI_Write(LF);    //
                                }else {
                                    if (statusnets.equals("ok")) {
                                        wifiSocket.WIFI_Write(setHT3212);    //
                                        wifiSocket.WIFI_Write(normal);
                                        wifiSocket.WIFI_Write(mod12);
                                        wifiSocket.WIFI_Write(HT);    //
                                        wifiSocket.WIFI_Write(sum_p_float);
                                        wifiSocket.WIFI_Write(LF);    //
                                    }
                                }
                            }
                        }

                    }
                }

            } else {
//            Toast.makeText(Customer_Info_Activity.this, "user id not there", Toast.LENGTH_LONG).show();
                Cursor cursorr = null;
                if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals("  General") || paymmethoda.toString().equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.toString().equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format("%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
                        float tota = mul;
                        String tota1 = String.format("%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        String mod1_1 = name + "" + String.valueOf(tota1);
                        String mod12 = name;
                        String sum_p_float = String.valueOf(tota1);

                        if (sum_p_float.length() >= 11) {

                        }
                        if (sum_p_float.length() == 10) {
                            sum_p_float = " "+sum_p_float;
                        }
                        if (sum_p_float.length() == 9) {
                            sum_p_float = "  "+sum_p_float;
                        }
                        if (sum_p_float.length() == 8) {
                            sum_p_float = "   "+sum_p_float;
                        }
                        if (sum_p_float.length() == 7) {
                            sum_p_float = "    "+sum_p_float;
                        }
                        if (sum_p_float.length() == 6) {
                            sum_p_float = "     "+sum_p_float;
                        }
                        if (sum_p_float.length() == 5) {
                            sum_p_float = "      "+sum_p_float;
                        }
                        if (sum_p_float.length() == 4) {
                            sum_p_float = "       "+sum_p_float;
                        }

                        allbuftaxestype2 = new byte[][]{
                                left, normal, mod1.getBytes(), HT, LF
                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
                            BluetoothPrintDriver.BT_Write(setHT3212);    //
                            BT_Write(normal);
                            BT_Write(mod12);
                            BluetoothPrintDriver.BT_Write(HT);    //
                            BT_Write(sum_p_float);
                            BluetoothPrintDriver.BT_Write(LF);    //
                        } else {
                            if (statusnets_counter.equals("ok")) {
                                wifiSocket2.WIFI_Write(setHT3212);    //
                                wifiSocket2.WIFI_Write(normal);
                                wifiSocket2.WIFI_Write(mod12);
                                wifiSocket2.WIFI_Write(HT);    //
                                wifiSocket2.WIFI_Write(sum_p_float);
                                wifiSocket2.WIFI_Write(LF);    //
                            }else {
                                if (statusnets.equals("ok")) {
                                    wifiSocket.WIFI_Write(setHT3212);    //
                                    wifiSocket.WIFI_Write(normal);
                                    wifiSocket.WIFI_Write(mod12);
                                    wifiSocket.WIFI_Write(HT);    //
                                    wifiSocket.WIFI_Write(sum_p_float);
                                    wifiSocket.WIFI_Write(LF);    //
                                }
                            }
                        }

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            }
            us_name1.close();

            float sum = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(2);
                sum = sum
                        + Float.parseFloat(mTextView.getText().toString());
            }


            String newsum = String.format("%.2f", sum);

            if (newsum.length() >= 11) {

            }
            if (newsum.length() == 10) {
                newsum = " "+newsum;
            }
            if (newsum.length() == 9) {
                newsum = "  "+newsum;
            }
            if (newsum.length() == 8) {
                newsum = "   "+newsum;
            }
            if (newsum.length() == 7) {
                newsum = "    "+newsum;
            }
            if (newsum.length() == 6) {
                newsum = "     "+newsum;
            }
            if (newsum.length() == 5) {
                newsum = "      "+newsum;
            }
            if (newsum.length() == 4) {
                newsum = "       "+newsum;
            }

            if (sum == 0 || sum == 0.0 || sum == 0.00) {

            } else {
                allbuftax = new byte[][]{
                        setHT3212, left, "Tax".getBytes(), HT, newsum.getBytes(), LF
                };

                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(setHT3212);    //
                    BluetoothPrintDriver.BT_Write(left);    //
                    BT_Write("Tax");
                    BluetoothPrintDriver.BT_Write(HT);    //
                    BT_Write(newsum);
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(setHT3212);    //
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write("Tax");
                        wifiSocket2.WIFI_Write(HT);    //
                        wifiSocket2.WIFI_Write(newsum);
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(setHT3212);    //
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write("Tax");
                            wifiSocket.WIFI_Write(HT);    //
                            wifiSocket.WIFI_Write(newsum);
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }
            //////////////ttax

            tvkot.setText(bill_coun);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, bill_coun.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    BluetoothPrintDriver.BT_Write(normal);    //
                    BluetoothPrintDriver.BT_Write(left);    //
                    BT_Write("Bill id.");
                    BT_Write(bill_coun);
                    BluetoothPrintDriver.BT_Write(LF);    //
                    BluetoothPrintDriver.BT_Write(LF);    //
                } else {
                    if (statusnets_counter.equals("ok")) {
                        wifiSocket2.WIFI_Write(normal);    //
                        wifiSocket2.WIFI_Write(left);    //
                        wifiSocket2.WIFI_Write("Bill id.");
                        wifiSocket2.WIFI_Write(bill_coun);
                        wifiSocket2.WIFI_Write(LF);    //
                        wifiSocket2.WIFI_Write(LF);    //
                    }else {
                        if (statusnets.equals("ok")) {
                            wifiSocket.WIFI_Write(normal);    //
                            wifiSocket.WIFI_Write(left);    //
                            wifiSocket.WIFI_Write("Bill id.");
                            wifiSocket.WIFI_Write(bill_coun);
                            wifiSocket.WIFI_Write(LF);    //
                            wifiSocket.WIFI_Write(LF);    //
                        }
                    }
                }
            }

            footer();
        }
    }

    public void footer(){

        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }
        connnet.close();

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }
        connusb.close();

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x27, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x08,0x17,0x27,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    allbufline = new byte[][]{
                            left, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    setHT32 = new byte[]{0x1b,0x44,0x19,0x00};//2 tabs 2"
                    setHT321 = new byte[]{0x1b,0x44,0x13,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x15,0x00};//2 tabs 3"
                    setHT33 = new byte[] {0x1b,0x44,0x09,0x19,0x00};//3 tabs 2"
                    setHT34 = new byte[]{0x1b,0x44,0x04,0x12,0x19,0x00};//4 tabs 2"
                    nPaperWidth = 384;
                    allbufline = new byte[][]{
                            left, "--------------------------------".getBytes(), LF

                    };
                }
            }while(cc.moveToNext());
        }
        cc.close();

//        allbuf2 = new byte[][]{
//                normal, "Thank you! visit again.".getBytes(), LF, LF
//
//        };
//        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//        if (statussusbs.equals("ok")) {
//            BluetoothPrintDriver.BT_Write(normal);	//
//            BT_Write("Thank you! visit again.");
//            BluetoothPrintDriver.BT_Write(LF);	//
//            BluetoothPrintDriver.BT_Write(LF);	//
//        } else {
//            if (statusnets_counter.equals("ok")) {
//                wifiSocket2.WIFI_Write(normal);	//
//                wifiSocket2.WIFI_Write("Thank you! visit again.");
//                wifiSocket2.WIFI_Write(LF);	//
//                wifiSocket2.WIFI_Write(LF);	//
//            }else {
//                if (statusnets.equals("ok")) {
//                    wifiSocket.WIFI_Write(normal);	//
//                    wifiSocket.WIFI_Write("Thank you! visit again.");
//                    wifiSocket.WIFI_Write(LF);	//
//                    wifiSocket.WIFI_Write(LF);	//
//                }
//            }
//        }

        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")){

        }else {
            allbuf2 = new byte[][]{
                    normal, strbillone.getBytes(), LF

            };
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(normal);	//
                BluetoothPrintDriver.BT_Write(cen);	//
                BT_Write(strbillone);
                BluetoothPrintDriver.BT_Write(LF);	//
            } else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(normal);	//
                    wifiSocket2.WIFI_Write(cen);	//
                    wifiSocket2.WIFI_Write(strbillone);
                    wifiSocket2.WIFI_Write(LF);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(normal);	//
                        wifiSocket.WIFI_Write(cen);	//
                        wifiSocket.WIFI_Write(strbillone);
                        wifiSocket.WIFI_Write(LF);	//
                    }
                }
            }
        }

        feedcut();

    }

    public void feedcut(){
        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                }
                else {
                    feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                }
            }while(cc.moveToNext());
        }
        cc.close();

        byte[][] allbuf = new byte[][]{
                feedcut2
        };
        if (statussusbs.equals("ok")) {
            BluetoothPrintDriver.BT_Write(feedcut2);	//
        }else {
            if (statusnets_counter.equals("ok")) {
                wifiSocket2.WIFI_Write(feedcut2);	//
            }else {
                if (statusnets.equals("ok")) {
                    wifiSocket.WIFI_Write(feedcut2);	//
                }
            }
        }

        if (str_print_ty.equals("POS")) {
            if (statussusbs.equals("ok")) {
                BluetoothPrintDriver.BT_Write(feedcut2);	//
            }else {
                if (statusnets_counter.equals("ok")) {
                    wifiSocket2.WIFI_Write(feedcut2);	//
                }else {
                    if (statusnets.equals("ok")) {
                        wifiSocket.WIFI_Write(feedcut2);	//
                    }
                }
            }
        }
    }

    public void print_printbillcopy1(Dialog dialog) {

        fmt = new Formatter();

        Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
        if (connnet.moveToFirst()) {
            ipnamegets = connnet.getString(1);
            portgets = connnet.getString(2);
            statusnets = connnet.getString(3);
        }
        connnet.close();

        Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
        if (connnet_counter.moveToFirst()) {
            ipnamegets_counter = connnet_counter.getString(1);
            portgets_counter = connnet_counter.getString(2);
            statusnets_counter = connnet_counter.getString(3);
        }
        connnet_counter.close();

        Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
        if (connusb.moveToFirst()) {
            addgets = connusb.getString(1);
            namegets = connusb.getString(2);
            statussusbs = connusb.getString(3);
        }
        connusb.close();

        byte[] LF1 = {0x0d,0x0a};

        allbufline = new byte[][]{
                " ".getBytes(),LF1
        };

        //Toast.makeText(Customer_Info_Activity.this, "printbillonly one ", Toast.LENGTH_SHORT).show();
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};

        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }
        print_ty.close();


        imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
        mView = dialog.findViewById(R.id.f_vieww1);

        fmt.format("Bill copy"+"\n");

        ImageView imageButton = (ImageView) mView.findViewById(R.id.viewImagee);
        //LinearLayout.LayoutParams layoutParams = new LinearLayout.LayoutParams(116, 95);
        //imageButton.setLayoutParams(layoutParams);
        //imageButton.setLayoutParams(116, 95);

        if (NAME.equals("3 inch")) {
//            Toast.makeText(Customer_Info_Activity.this, "3 inch", Toast.LENGTH_SHORT).show();
            imageViewPicture.getLayoutParams().height = 94;
            imageViewPicture.getLayoutParams().width = 576;
            imageButton.getLayoutParams().height = 94;
            imageButton.getLayoutParams().width = 576;
        } else {
//            Toast.makeText(Customer_Info_Activity.this, "2 inch", Toast.LENGTH_SHORT).show();
            imageViewPicture.getLayoutParams().height = 94;
            imageViewPicture.getLayoutParams().width = 384;
            imageButton.getLayoutParams().height = 94;
            imageButton.getLayoutParams().width = 384;
        }

        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
//        if (c.moveToFirst()) {
//            do {
//                byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
//                final Bitmap b1 = BitmapFactory.decodeByteArray(img, 0, img.length);
//
//                imageButton.setImageBitmap(b1);
//
//
//                mView.setDrawingCacheEnabled(true);
//                mView.measure(View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED),
//                        View.MeasureSpec.makeMeasureSpec(0, View.MeasureSpec.UNSPECIFIED));
//                mView.layout(0, 0, mView.getMeasuredWidth(), mView.getMeasuredHeight());
//                mView.buildDrawingCache(true);
//
//                Bitmap b = Bitmap.createBitmap(mView.getDrawingCache());
//                //mView.setDrawingCacheEnabled(false);
//                ByteArrayOutputStream bytes = new ByteArrayOutputStream();
//                b.compress(Bitmap.CompressFormat.JPEG, 100, bytes);
//
//                imageViewPicture.setImageBitmap(b);
//
//                Bitmap mBitmap = ((BitmapDrawable) imageViewPicture.getDrawable())
//                        .getBitmap();
//
//
//                //if (mBitmap != null) {
//                if (statussusbs.equals("ok")) {
//                    if (mBitmap != null) {
//                        byte[] command = Utils.decodeBitmap(mBitmap);
//                        printByteData(command);
//                    } else {
//                        Log.e("Print Photo error", "the file isn't exists");
//                    }
//                    Bundle data = new Bundle();
//                    //data.putParcelable(Global.OBJECT1, mBitmap);
//                    data.putParcelable(Global.PARCE1, mBitmap);
//                    data.putInt(Global.INTPARA1, nPaperWidth);
//                    data.putInt(Global.INTPARA2, 0);
////                        DrawerService.workThread.handleCmd(
////                                Global.CMD_POS_PRINTBWPICTURE, data);
//                } else {
//                    if (statusnets_counter.equals("ok")) {
//                        if (mBitmap != null) {
//                            byte[] command = Utils.decodeBitmap(mBitmap);
//                            printByteData_wifi_counter(command);
//                        } else {
//                            Log.e("Print Photo error", "the file isn't exists");
//                        }
//                        Bundle data = new Bundle();
//                        data.putParcelable(Global1.PARCE1, mBitmap);
//                        data.putInt(Global1.INTPARA1, nPaperWidth);
//                        data.putInt(Global1.INTPARA2, 0);
//                    }else {
//                        if (statusnets.equals("ok")) {
//                            if (mBitmap != null) {
//                                byte[] command = Utils.decodeBitmap(mBitmap);
//                                printByteData_wifi(command);
//                            } else {
//                                Log.e("Print Photo error", "the file isn't exists");
//                            }
//                            Bundle data = new Bundle();
//                            data.putParcelable(Global1.PARCE1, mBitmap);
//                            data.putInt(Global1.INTPARA1, nPaperWidth);
//                            data.putInt(Global1.INTPARA2, 0);
//                        }
//                    }
//                }
//                //}
//            } while (c.moveToNext());
//        } else {
//            imageButton.setVisibility(View.GONE);
//        }
//        c.close();

        Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
        if (getcom.moveToFirst()) {
            do {
                strcompanyname = getcom.getString(1);
                straddress1 = getcom.getString(14);
                straddress2 = getcom.getString(17);
                straddress3 = getcom.getString(18);
                strphone = getcom.getString(2);
                stremailid = getcom.getString(15);
                strwebsite = getcom.getString(16);
                strtaxone = getcom.getString(10);
                strbillone = getcom.getString(12);
            } while (getcom.moveToNext());
        }
        getcom.close();


        tvkot.setText(strcompanyname);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strcompanyname+"\n");
        }

/////////
        tvkot.setText(straddress1);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(straddress1+"\n");
        }


        tvkot.setText(straddress2);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(straddress2+"\n");
        }


        tvkot.setText(strphone);
        String pp = "Ph. " + strphone;
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strphone+"\n");
        }


        tvkot.setText(stremailid);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(stremailid+"\n");
        }


        tvkot.setText(strwebsite);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strwebsite+"\n");
        }


        tvkot.setText(strtaxone);
        if (tvkot.getText().toString().equals("")) {

        } else {
            fmt.format(strtaxone+"\n");
        }

        fmt.format("------------------------------------------------", " ");


        Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor10.moveToFirst()) {
            billtypea = cursor10.getString(5);
            paymmethoda = cursor10.getString(6);
        }
        cursor10.close();

        TextView ttv = new TextView(Customer_Info_Activity.this);
        ttv.setText(billtypea);

        TextView ttv1 = new TextView(Customer_Info_Activity.this);
        ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

        if (ttv.getText().toString().equals("  Cash")) {
            billtypeaa = "Cash"; //0
        }
        if (ttv.getText().toString().equals("  Card")) {
            billtypeaa = "Card"; //0
        }
        if (ttv.getText().toString().equals("  Paytm")) {
            billtypeaa = "Paytm"; //0
        }
        if (ttv.getText().toString().equals("  Mobikwik")) {
            billtypeaa = "Mobikwik"; //0
        }
        if (ttv.getText().toString().equals("  Freecharge")) {
            billtypeaa = "Freecharge"; //0
        }
        if (ttv.getText().toString().equals("  Pay Later")) {
            billtypeaa = "Pay Later"; //0
        }
        if (ttv.getText().toString().equals("  Cheque")) {
            billtypeaa = "Cheque"; //0
        }
        if (ttv.getText().toString().equals("  Sodexo")) {
            billtypeaa = "Sodexo"; //0
        }
        if (ttv.getText().toString().equals("  Zeta")) {
            billtypeaa = "Zeta"; //0
        }
        if (ttv.getText().toString().equals("  Ticket")) {
            billtypeaa = "Ticket"; //0
        }
        if (ttv.getText().toString().equals(" Upiqr")) {
            billtypeaa = "upiqr"; //0
        }
        if (ttv.getText().toString().equals("  Upiqr")) {
            billtypeaa = "Upiqr"; //0
        }
        billtypeaa = ttv.getText().toString().replace(" ", "");

        //String bill_no = billnum.getText().toString();

//        fmt.format("%-34s %13s\n", "Bill no." + billnum_click, "");
        fmt.format("Bill no." + billnum_click+"\n");

//        fmt.format("%-34s %13s\n", billtypeaa, "");
        fmt.format(billtypeaa+"\n");

        if (ttv1.getText().toString().equals("  Dine-in") || ttv1.getText().toString().equals("  General") || ttv1.getText().toString().equals("  Others")) {
//                paymmethodaa = "Dine-in";
            //billtypee.setText("Dine-in");
            if (account_selection.toString().equals("Dine") || account_selection.toString().equals("Qsr")) {
                paymmethodaa = "Dine-in";
            }else {
                paymmethodaa = "General";
            }
        } else {
            if (ttv1.getText().toString().equals("  Takeaway") || ttv1.getText().toString().equals("  Main")) {
                paymmethodaa = "Takeaway";
                //billtypee.setText("Takeaway");
            } else {
                paymmethodaa = "Home delivery";
                //billtypee.setText("Home delivery");
            }
        }

        Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (date.moveToFirst()) {
            datee = date.getString(25);
            timee = date.getString(12);
        }
        date.close();

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
        fmt.format("%-34s %13s\n", paymmethodaa, datee);

        Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (cursor9.moveToFirst()) {
            tableida = cursor9.getString(15);
            Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
            if (vbnm.moveToFirst()) {
                assa1 = vbnm.getString(1);
                assa2 = vbnm.getString(2);
            }
            vbnm.close();
            TextView cx = new TextView(Customer_Info_Activity.this);
            cx.setText(assa1);

            if (cx.getText().toString().equals("")) {
                tableidaa = "Tab" + assa2;
            } else {
                tableidaa = "Tab" + assa1;
            }

        }
        cursor9.close();

        fmt.format("%-34s %13s\n", tableidaa, timee);

        Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
        if (cursor9_1.moveToFirst()) {
            u_name = cursor9_1.getString(45);
        }
        cursor9_1.close();

        TextView tv_u_name = new TextView(Customer_Info_Activity.this);
        tv_u_name.setText(u_name);

        if (tv_u_name.getText().toString().equals("")){

        }else {
            fmt.format("Counter person: " + tv_u_name.getText().toString()+"\n");
        }

        fmt.format("------------------------------------------------", " ");

        Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
        if (caddress.moveToFirst()) {
            String nam = caddress.getString(1);
            String addr = caddress.getString(4);
            String phon = caddress.getString(2);
            String emai = caddress.getString(3);

            if (nam.length() > 0 || addr.length() > 0 ||
                    phon.length() > 0 || emai.length() > 0) {
                fmt.format("Customer:"+"\n");
            } else {

            }

            if (nam.length() > 0) {
                fmt.format(nam+"\n");
            } else {

            }

            if (addr.length() > 0) {
                fmt.format(addr+"\n");
            } else {

            }

            if (phon.length() > 0) {
                String cust_ph = "Ph. " + phon;
                fmt.format(cust_ph+"\n");
            } else {

            }

            if (emai.length() > 0) {
                fmt.format(emai+"\n");
            } else {

            }

            fmt.format("------------------------------------------------", " ");
        }
        caddress.close();

        fmt.format("%-5s %-25s %7s %7s\n", "Qty", "Item", "Price", "Amount");

        fmt.format("------------------------------------------------", " ");

        Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursorr.moveToFirst()) {

            do {

                String nbg = ccursorr.getString(0);
                String name = ccursorr.getString(1);
                String value = ccursorr.getString(2);
                String pq = ccursorr.getString(5);
                String itna = ccursorr.getString(2);
                String pricee = ccursorr.getString(3);
                String tototot = ccursorr.getString(4);
                String tototot1 = ccursorr.getString(4);

//                if (pricee.length() > 7) {
////                        price = " "+price;
//                }
//                if (pricee.length() == 6) {
//                    pricee = " "+pricee;
//                }
//                if (pricee.length() == 5) {
//                    pricee = "  "+pricee;
//                }
//                if (pricee.length() == 4) {
//                    pricee = "   "+pricee;
//                }
//                if (pricee.length() == 3) {
//                    pricee = "    "+pricee;
//                }
//
//                if (tototot.length() >= 8) {
//
//                }
//                if (tototot.length() == 7) {
//                    tototot = " "+tototot;
//                }
//                if (tototot.length() == 6) {
//                    tototot = "  "+tototot;
//                }
//                if (tototot.length() == 5) {
//                    tototot = "   "+tototot;
//                }
//                if (tototot.length() == 4) {
//                    tototot = "    "+tototot;
//                }
//                if (tototot.length() == 3) {
//                    tototot = "     "+tototot;
//                }

                final String newid = ccursorr.getString(20);
                int padding_in_px;

                int padding_in_dp = 30;  // 34 dps
                final float scale1 = getResources().getDisplayMetrics().density;
                padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                if (pq.equals("Item")) {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                    final TableRow row1 = new TableRow(Customer_Info_Activity.this);
                    row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                    final TableRow row2 = new TableRow(Customer_Info_Activity.this);
                    row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));

                    final TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Customer_Info_Activity.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                    tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv.setText(value);
                    row.addView(tv);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setGravity(Gravity.CENTER_VERTICAL);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(name);
                    String value1 = tv1.getText().toString();
                    row.addView(tv1);

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setText(pricee);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                    tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv3.setText(tototot1);

                    String value2 = tv3.getText().toString();

                    Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                    if (modcursor.moveToFirst()) {

                        Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnum_click + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                        if (cursor4.moveToFirst()) {
                            float sub2a = cursor4.getFloat(0);
                            String sub2a1 = String.valueOf(sub2a);
                            ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot1);
                            ss1 = String.valueOf(ss);

//                            if (ss1.length() >= 8) {
//
//                            }
//                            if (ss1.length() == 7) {
//                                ss1 = " "+ss1;
//                            }
//                            if (ss1.length() == 6) {
//                                ss1 = "  "+ss1;
//                            }
//                            if (ss1.length() == 5) {
//                                ss1 = "   "+ss1;
//                            }
//                            if (ss1.length() == 4) {
//                                ss1 = "    "+ss1;
//                            }
//                            if (ss1.length() == 3) {
//                                ss1 = "     "+ss1;
//                            }

                        }
                        cursor4.close();

                        String[][] items_array = {{value, name, pricee, ss1}};

                        for (int i = 0; i < items_array.length; i++) {
                            List<String> item_split_qty = new ArrayList<>();
                            List<String> item_split_item = new ArrayList<>();
                            List<String> item_split_price = new ArrayList<>();
                            List<String> item_split_amount = new ArrayList<>();

                            for (int j = 0; j < items_array[i][0].length(); j += 5) {
                                item_split_qty.add(items_array[i][0].substring(j, Math.min(items_array[i][0].length(), j + 5)));
                            }
                            for (int j = 0; j < items_array[i][1].length(); j += 25) {
                                item_split_item.add(items_array[i][1].substring(j, Math.min(items_array[i][1].length(), j + 25)));
                            }
                            for (int j = 0; j < items_array[i][2].length(); j += 7) {
                                item_split_price.add(items_array[i][2].substring(j, Math.min(items_array[i][2].length(), j + 7)));
                            }
                            for (int j = 0; j < items_array[i][3].length(); j += 7) {
                                item_split_amount.add(items_array[i][3].substring(j, Math.min(items_array[i][3].length(), j + 7)));
                            }

                            Log.d("DATA_QTY", String.valueOf(item_split_qty));
                            Log.d("DATA_ITEM", String.valueOf(item_split_item));
                            Log.d("DATA_PRICE", String.valueOf(item_split_price));
                            Log.d("DATA_Amount", String.valueOf(item_split_amount));

                            List<Integer> maxListValue = new ArrayList<>();
                            maxListValue.add(item_split_qty.size());
                            maxListValue.add(item_split_item.size());
                            maxListValue.add(item_split_price.size());
                            maxListValue.add(item_split_amount.size());

                            int maxValue = maxListValue.get(0);

                            for (int x = 1; x < maxListValue.size(); x++) {
                                if (maxValue < maxListValue.get(x)) {
                                    maxValue = maxListValue.get(x);
                                }
                            }

                            Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                            for (int k = 0; k < maxValue; k++) {

                                String qty,item,price_new,amount = "";

                                boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                boolean item_check = (k >= 0) && (k < item_split_item.size());
                                boolean price_check = (k >= 0) && (k < item_split_price.size());
                                boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                if(qty_check == true){
                                    qty = item_split_qty.get(k);
                                }
                                else {
                                    qty = " ";
                                }
                                if(item_check == true){
                                    item = item_split_item.get(k);
                                }
                                else {
                                    item = " ";
                                }
                                if(price_check == true){
                                    price_new = item_split_price.get(k);
                                }
                                else {
                                    price_new = " ";
                                }
                                if(amount_check == true){
                                    amount = item_split_amount.get(k);
                                }
                                else {
                                    amount = " ";
                                }

                                fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                            }
                            item_split_qty.removeAll(item_split_qty);
                            item_split_item.removeAll(item_split_item);
                            item_split_price.removeAll(item_split_price);
                            item_split_amount.removeAll(item_split_amount);

                        }

                        do {

                            final String modiname = modcursor.getString(1);
                            final String modiquan = modcursor.getString(2);
                            String modiprice = modcursor.getString(3);
                            String moditotal = modcursor.getString(4);
                            final String modiid = modcursor.getString(0);

                            float modprice1 = Float.parseFloat(modiprice);
                            String modpricestr = String.valueOf(modprice1);

                            String[][] items_array1 = {{"", ">", modiname, modpricestr}};

                            for (int i = 0; i < items_array1.length; i++) {
                                List<String> item_split_qty = new ArrayList<>();
                                List<String> item_split_item = new ArrayList<>();
                                List<String> item_split_price = new ArrayList<>();
                                List<String> item_split_amount = new ArrayList<>();

                                for (int j = 0; j < items_array1[i][0].length(); j += 5) {
                                    item_split_qty.add(items_array1[i][0].substring(j, Math.min(items_array1[i][0].length(), j + 5)));
                                }
                                for (int j = 0; j < items_array1[i][1].length(); j += 25) {
                                    item_split_item.add(items_array1[i][1].substring(j, Math.min(items_array1[i][1].length(), j + 25)));
                                }
                                for (int j = 0; j < items_array1[i][2].length(); j += 7) {
                                    item_split_price.add(items_array1[i][2].substring(j, Math.min(items_array1[i][2].length(), j + 7)));
                                }
                                for (int j = 0; j < items_array1[i][3].length(); j += 7) {
                                    item_split_amount.add(items_array1[i][3].substring(j, Math.min(items_array1[i][3].length(), j + 7)));
                                }

                                Log.d("DATA_QTY", String.valueOf(item_split_qty));
                                Log.d("DATA_ITEM", String.valueOf(item_split_item));
                                Log.d("DATA_PRICE", String.valueOf(item_split_price));
                                Log.d("DATA_Amount", String.valueOf(item_split_amount));

                                List<Integer> maxListValue = new ArrayList<>();
                                maxListValue.add(item_split_qty.size());
                                maxListValue.add(item_split_item.size());
                                maxListValue.add(item_split_price.size());
                                maxListValue.add(item_split_amount.size());

                                int maxValue = maxListValue.get(0);

                                for (int x = 1; x < maxListValue.size(); x++) {
                                    if (maxValue < maxListValue.get(x)) {
                                        maxValue = maxListValue.get(x);
                                    }
                                }

                                Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                                for (int k = 0; k < maxValue; k++) {

                                    String qty,item,price_new,amount = "";

                                    boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                    boolean item_check = (k >= 0) && (k < item_split_item.size());
                                    boolean price_check = (k >= 0) && (k < item_split_price.size());
                                    boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                    if(qty_check == true){
                                        qty = item_split_qty.get(k);
                                    }
                                    else {
                                        qty = " ";
                                    }
                                    if(item_check == true){
                                        item = item_split_item.get(k);
                                    }
                                    else {
                                        item = " ";
                                    }
                                    if(price_check == true){
                                        price_new = item_split_price.get(k);
                                    }
                                    else {
                                        price_new = " ";
                                    }
                                    if(amount_check == true){
                                        amount = item_split_amount.get(k);
                                    }
                                    else {
                                        amount = " ";
                                    }

                                    fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                                }
                                item_split_qty.removeAll(item_split_qty);
                                item_split_item.removeAll(item_split_item);
                                item_split_price.removeAll(item_split_price);
                                item_split_amount.removeAll(item_split_amount);

                            }

                            Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                            if (ccursor.moveToFirst()) {
                                String hsn = ccursor.getString(34);

                                TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                hsn_hsn.setText(hsn);

                                if (hsn_hsn.getText().toString().equals("")) {
                                } else {
                                    fmt.format("HSN "+hsn, " ");
                                }
                            }

                            final TableRow tableRow11 = new TableRow(Customer_Info_Activity.this);
                            tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                    TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                            final TextView tvv = new TextView(Customer_Info_Activity.this);
                            // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                            tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            //tv.setGravity(Gravity.CENTER);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText("");
                            tableRow11.addView(tvv);

                            TextView tv4 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv4.setText(modiname);
                            tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv4.setGravity(Gravity.CENTER_VERTICAL);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv4);

                            TextView tv5 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                            //tv3.setPadding(5, 0, 0, 0);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv2.setPadding(0, 0, 1, 0);
                            tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tv5.setText(modiprice);
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv5);

                            TextView tv6 = new TextView(Customer_Info_Activity.this);
                            //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                            tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setPadding(5, 0, 0, 0);
                            tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv6.setText("");
                            //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                            //tv3.setTextColor(R.color.black);
                            tableRow11.addView(tv6);


                            final TextView tv7 = new TextView(Customer_Info_Activity.this);
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            //tv3.setPadding(0,0,10,0);
                            tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                            //row.addView(tv3);

                            row.removeView(tv8);


                            tv8 = new TextView(Customer_Info_Activity.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String numberr = tv.getText().toString();
                            float newmulr = Float.parseFloat(numberr);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(ss));
                            row.addView(tv8);


                            tableLayout1.addView(tableRow11);
                        } while (modcursor.moveToNext());

                        //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    String[][] items_array1 = {{"", "", "", "("+"-"+total_disc_print_q+")"}};

                                    for (int i = 0; i < items_array1.length; i++) {
                                        List<String> item_split_qty = new ArrayList<>();
                                        List<String> item_split_item = new ArrayList<>();
                                        List<String> item_split_price = new ArrayList<>();
                                        List<String> item_split_amount = new ArrayList<>();

                                        for (int j = 0; j < items_array1[i][0].length(); j += 5) {
                                            item_split_qty.add(items_array1[i][0].substring(j, Math.min(items_array1[i][0].length(), j + 5)));
                                        }
                                        for (int j = 0; j < items_array1[i][1].length(); j += 25) {
                                            item_split_item.add(items_array1[i][1].substring(j, Math.min(items_array1[i][1].length(), j + 25)));
                                        }
                                        for (int j = 0; j < items_array1[i][2].length(); j += 7) {
                                            item_split_price.add(items_array1[i][2].substring(j, Math.min(items_array1[i][2].length(), j + 7)));
                                        }
                                        for (int j = 0; j < items_array1[i][3].length(); j += 7) {
                                            item_split_amount.add(items_array1[i][3].substring(j, Math.min(items_array1[i][3].length(), j + 7)));
                                        }

                                        Log.d("DATA_QTY", String.valueOf(item_split_qty));
                                        Log.d("DATA_ITEM", String.valueOf(item_split_item));
                                        Log.d("DATA_PRICE", String.valueOf(item_split_price));
                                        Log.d("DATA_Amount", String.valueOf(item_split_amount));

                                        List<Integer> maxListValue = new ArrayList<>();
                                        maxListValue.add(item_split_qty.size());
                                        maxListValue.add(item_split_item.size());
                                        maxListValue.add(item_split_price.size());
                                        maxListValue.add(item_split_amount.size());

                                        int maxValue = maxListValue.get(0);

                                        for (int x = 1; x < maxListValue.size(); x++) {
                                            if (maxValue < maxListValue.get(x)) {
                                                maxValue = maxListValue.get(x);
                                            }
                                        }

                                        Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                                        for (int k = 0; k < maxValue; k++) {

                                            String qty,item,price_new,amount = "";

                                            boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                            boolean item_check = (k >= 0) && (k < item_split_item.size());
                                            boolean price_check = (k >= 0) && (k < item_split_price.size());
                                            boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                            if(qty_check == true){
                                                qty = item_split_qty.get(k);
                                            }
                                            else {
                                                qty = " ";
                                            }
                                            if(item_check == true){
                                                item = item_split_item.get(k);
                                            }
                                            else {
                                                item = " ";
                                            }
                                            if(price_check == true){
                                                price_new = item_split_price.get(k);
                                            }
                                            else {
                                                price_new = " ";
                                            }
                                            if(amount_check == true){
                                                amount = item_split_amount.get(k);
                                            }
                                            else {
                                                amount = " ";
                                            }

                                            fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                                        }
                                        item_split_qty.removeAll(item_split_qty);
                                        item_split_item.removeAll(item_split_item);
                                        item_split_price.removeAll(item_split_price);
                                        item_split_amount.removeAll(item_split_amount);

                                    }
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();

                    } else {

                        String[][] items_array = {{value, name, pricee, tototot}};

                        for (int i = 0; i < items_array.length; i++) {
                            List<String> item_split_qty = new ArrayList<>();
                            List<String> item_split_item = new ArrayList<>();
                            List<String> item_split_price = new ArrayList<>();
                            List<String> item_split_amount = new ArrayList<>();

                            for (int j = 0; j < items_array[i][0].length(); j += 5) {
                                item_split_qty.add(items_array[i][0].substring(j, Math.min(items_array[i][0].length(), j + 5)));
                            }
                            for (int j = 0; j < items_array[i][1].length(); j += 25) {
                                item_split_item.add(items_array[i][1].substring(j, Math.min(items_array[i][1].length(), j + 25)));
                            }
                            for (int j = 0; j < items_array[i][2].length(); j += 7) {
                                item_split_price.add(items_array[i][2].substring(j, Math.min(items_array[i][2].length(), j + 7)));
                            }
                            for (int j = 0; j < items_array[i][3].length(); j += 7) {
                                item_split_amount.add(items_array[i][3].substring(j, Math.min(items_array[i][3].length(), j + 7)));
                            }

                            Log.d("DATA_QTY", String.valueOf(item_split_qty));
                            Log.d("DATA_ITEM", String.valueOf(item_split_item));
                            Log.d("DATA_PRICE", String.valueOf(item_split_price));
                            Log.d("DATA_Amount", String.valueOf(item_split_amount));

                            List<Integer> maxListValue = new ArrayList<>();
                            maxListValue.add(item_split_qty.size());
                            maxListValue.add(item_split_item.size());
                            maxListValue.add(item_split_price.size());
                            maxListValue.add(item_split_amount.size());

                            int maxValue = maxListValue.get(0);

                            for (int x = 1; x < maxListValue.size(); x++) {
                                if (maxValue < maxListValue.get(x)) {
                                    maxValue = maxListValue.get(x);
                                }
                            }

                            Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                            for (int k = 0; k < maxValue; k++) {

                                String qty,item,price_new,amount = "";

                                boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                boolean item_check = (k >= 0) && (k < item_split_item.size());
                                boolean price_check = (k >= 0) && (k < item_split_price.size());
                                boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                if(qty_check == true){
                                    qty = item_split_qty.get(k);
                                }
                                else {
                                    qty = " ";
                                }
                                if(item_check == true){
                                    item = item_split_item.get(k);
                                }
                                else {
                                    item = " ";
                                }
                                if(price_check == true){
                                    price_new = item_split_price.get(k);
                                }
                                else {
                                    price_new = " ";
                                }
                                if(amount_check == true){
                                    amount = item_split_amount.get(k);
                                }
                                else {
                                    amount = " ";
                                }

                                fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                            }
                            item_split_qty.removeAll(item_split_qty);
                            item_split_item.removeAll(item_split_item);
                            item_split_price.removeAll(item_split_price);
                            item_split_amount.removeAll(item_split_amount);

                        }

                        Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                        if (ccursor.moveToFirst()) {
                            String hsn = ccursor.getString(34);

                            TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                            hsn_hsn.setText(hsn);

                            if (hsn_hsn.getText().toString().equals("")) {
                            } else {
                                fmt.format("%-48s\n", "HSN " + hsn);
                            }
                        }

                        tv8 = new TextView(Customer_Info_Activity.this);
                        tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                        //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        //tv3.setPadding(0, 0, 10, 0);
                        tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                        final String number = tv.getText().toString();
                        float newmul = Float.parseFloat(number);
                        //final float in = Float.parseFloat(cursor.getString(4));
                        String pricee1 = ccursorr.getString(3);
                        String multiply = String.valueOf(newmul * Float.parseFloat(pricee1));
                        //newmul = Integer.parseInt(multiply);
                        tv8.setText(String.valueOf(multiply));
                        row.addView(tv8);

                        Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                        if (disc_cursor.moveToFirst()) {
                            do {
                                String disc_vv = disc_cursor.getString(12);
                                String disc_there = disc_cursor.getString(30);
                                float vtq = disc_cursor.getFloat(31);
                                if (disc_there.equals("no")) {

                                } else {

                                    total_disc_print_q = String.valueOf(vtq);

                                    String[][] items_array1 = {{"", "", "", "("+"-"+total_disc_print_q+")"}};

                                    for (int i = 0; i < items_array1.length; i++) {
                                        List<String> item_split_qty = new ArrayList<>();
                                        List<String> item_split_item = new ArrayList<>();
                                        List<String> item_split_price = new ArrayList<>();
                                        List<String> item_split_amount = new ArrayList<>();

                                        for (int j = 0; j < items_array1[i][0].length(); j += 5) {
                                            item_split_qty.add(items_array1[i][0].substring(j, Math.min(items_array1[i][0].length(), j + 5)));
                                        }
                                        for (int j = 0; j < items_array1[i][1].length(); j += 25) {
                                            item_split_item.add(items_array1[i][1].substring(j, Math.min(items_array1[i][1].length(), j + 25)));
                                        }
                                        for (int j = 0; j < items_array1[i][2].length(); j += 7) {
                                            item_split_price.add(items_array1[i][2].substring(j, Math.min(items_array1[i][2].length(), j + 7)));
                                        }
                                        for (int j = 0; j < items_array1[i][3].length(); j += 7) {
                                            item_split_amount.add(items_array1[i][3].substring(j, Math.min(items_array1[i][3].length(), j + 7)));
                                        }

                                        Log.d("DATA_QTY", String.valueOf(item_split_qty));
                                        Log.d("DATA_ITEM", String.valueOf(item_split_item));
                                        Log.d("DATA_PRICE", String.valueOf(item_split_price));
                                        Log.d("DATA_Amount", String.valueOf(item_split_amount));

                                        List<Integer> maxListValue = new ArrayList<>();
                                        maxListValue.add(item_split_qty.size());
                                        maxListValue.add(item_split_item.size());
                                        maxListValue.add(item_split_price.size());
                                        maxListValue.add(item_split_amount.size());

                                        int maxValue = maxListValue.get(0);

                                        for (int x = 1; x < maxListValue.size(); x++) {
                                            if (maxValue < maxListValue.get(x)) {
                                                maxValue = maxListValue.get(x);
                                            }
                                        }

                                        Log.d("DATA_MAXVALUE", String.valueOf(maxValue));

                                        for (int k = 0; k < maxValue; k++) {

                                            String qty,item,price_new,amount = "";

                                            boolean qty_check = (k >= 0) && (k < item_split_qty.size());
                                            boolean item_check = (k >= 0) && (k < item_split_item.size());
                                            boolean price_check = (k >= 0) && (k < item_split_price.size());
                                            boolean amount_check = (k >= 0) && (k < item_split_amount.size());

                                            if(qty_check == true){
                                                qty = item_split_qty.get(k);
                                            }
                                            else {
                                                qty = " ";
                                            }
                                            if(item_check == true){
                                                item = item_split_item.get(k);
                                            }
                                            else {
                                                item = " ";
                                            }
                                            if(price_check == true){
                                                price_new = item_split_price.get(k);
                                            }
                                            else {
                                                price_new = " ";
                                            }
                                            if(amount_check == true){
                                                amount = item_split_amount.get(k);
                                            }
                                            else {
                                                amount = " ";
                                            }

                                            fmt.format("%-5s %-25s %7s %7s\n",qty,item,price_new,amount);

                                        }
                                        item_split_qty.removeAll(item_split_qty);
                                        item_split_item.removeAll(item_split_item);
                                        item_split_price.removeAll(item_split_price);
                                        item_split_amount.removeAll(item_split_amount);

                                    }
                                }
                            } while (disc_cursor.moveToNext());
                        }
                        disc_cursor.close();
                    }
                    modcursor.close();
                }


            } while (ccursorr.moveToNext());
        }
        ccursorr.close();

        fmt.format("------------------------------------------------", " ");

////////////////////////////////////sub total
        Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor3.moveToFirst()) {
            sub = cursor3.getString(7);
        }
        cursor3.close();


//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
        float to = Float.parseFloat(sub);
        String tot = String.format("%.2f", to);

//        if (tot.length() >= 11) {
//
//        }
//        if (tot.length() == 10) {
//            tot = " "+tot;
//        }
//        if (tot.length() == 9) {
//            tot = "  "+tot;
//        }
//        if (tot.length() == 8) {
//            tot = "   "+tot;
//        }
//        if (tot.length() == 7) {
//            tot = "    "+tot;
//        }
//        if (tot.length() == 6) {
//            tot = "     "+tot;
//        }
//        if (tot.length() == 5) {
//            tot = "      "+tot;
//        }
//        if (tot.length() == 4) {
//            tot = "       "+tot;
//        }

        fmt.format("%-38s %9s\n", "Sub total", tot);

/////////////////////////tax




///////////////////////////////// discount

        Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
        if (cursor4.moveToFirst()) {
            taxpe = cursor4.getString(5);
        } else {
            taxpe = "0.00";
        }
        cursor4.close();

        Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
        if (cursor5.moveToFirst()) {
            dsirs = cursor5.getString(7);
        } else {
            dsirs = "0.00";
        }
        cursor5.close();

        String alldiscinperc1 = "Discount(" + taxpe + "%)";

//        if (dsirs.length() >= 11) {
//
//        }
//        if (dsirs.length() == 10) {
//            dsirs = " "+dsirs;
//        }
//        if (dsirs.length() == 9) {
//            dsirs = "  "+dsirs;
//        }
//        if (dsirs.length() == 8) {
//            dsirs = "   "+dsirs;
//        }
//        if (dsirs.length() == 7) {
//            dsirs = "    "+dsirs;
//        }
//        if (dsirs.length() == 6) {
//            dsirs = "     "+dsirs;
//        }
//        if (dsirs.length() == 5) {
//            dsirs = "      "+dsirs;
//        }
//        if (dsirs.length() == 4) {
//            dsirs = "       "+dsirs;
//        }
        fmt.format("%-38s %9s\n", alldiscinperc1, dsirs);
        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

        float newe;
//////////////////////////////////////////////

        Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnum_click + "'", null);
        if (cursor113.moveToFirst()) {
            float level = cursor113.getFloat(0);
            total = String.valueOf(level);
            float total1 = Float.parseFloat(total);
            total_disc_print_q = String.format(Locale.US,"%.2f", total1);

//            if (total_disc_print_q.length() >= 11) {
//
//            }
//            if (total_disc_print_q.length() == 10) {
//                total_disc_print_q = " "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 9) {
//                total_disc_print_q = "  "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 8) {
//                total_disc_print_q = "   "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 7) {
//                total_disc_print_q = "    "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 6) {
//                total_disc_print_q = "     "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 5) {
//                total_disc_print_q = "      "+total_disc_print_q;
//            }
//            if (total_disc_print_q.length() == 4) {
//                total_disc_print_q = "       "+total_disc_print_q;
//            }

            fmt.format("%-38s %9s\n", "Savings", total_disc_print_q);

        }
        cursor113.close();
////////////////////////////////

        Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor.moveToFirst()){
            String t_total_points = cursor.getString(16);
            String v_tq = cursor.getString(17);

            String v_tq_loy = String.format("%.2f", v_tq);

//            if (v_tq_loy.length() >= 11) {
//
//            }
//            if (v_tq_loy.length() == 10) {
//                v_tq_loy = " "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 9) {
//                v_tq_loy = "  "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 8) {
//                v_tq_loy = "   "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 7) {
//                v_tq_loy = "    "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 6) {
//                v_tq_loy = "     "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 5) {
//                v_tq_loy = "      "+v_tq_loy;
//            }
//            if (v_tq_loy.length() == 4) {
//                v_tq_loy = "       "+v_tq_loy;
//            }

            TextView tv = new TextView(Customer_Info_Activity.this);
            tv.setText(t_total_points);

            if (tv.getText().toString().equals("")){

            }else {

                fmt.format("%-38s %9s\n", "Loyalty(" + t_total_points + ")", v_tq_loy);

            }
        }

//////////////////////////////////////Rounded off

        Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor7.moveToFirst()) {
            subro = cursor7.getString(9);
        }
        cursor7.close();

//            float subro1 = Float.parseFloat(subro);
//            subro = String.format("%.2f", subro1);

//        if (subro.length() >= 11) {
//
//        }
//        if (subro.length() == 10) {
//            subro = " "+subro;
//        }
//        if (subro.length() == 9) {
//            subro = "  "+subro;
//        }
//        if (subro.length() == 8) {
//            subro = "   "+subro;
//        }
//        if (subro.length() == 7) {
//            subro = "    "+subro;
//        }
//        if (subro.length() == 6) {
//            subro = "     "+subro;
//        }
//        if (subro.length() == 5) {
//            subro = "      "+subro;
//        }
//        if (subro.length() == 4) {
//            subro = "       "+subro;
//        }

        fmt.format("%-38s %9s\n", "Rounded", subro);

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

        fmt.format("------------------------------------------------", " ");
//////////////Total main

        Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
        if (cursor8.moveToFirst()) {
            alltotal1 = cursor8.getString(2);
        }
        cursor8.close();

        float all = Float.parseFloat(alltotal1);
        String newf = String.format("%.2f", all);

        String allt = insert1_rs+""+newf;
//        if (allt.length() >= 12) {
//
//        }
//        if (allt.length() == 11) {
//            allt = " "+allt;
//        }
//        if (allt.length() == 10) {
//            allt = "  "+allt;
//        }
//        if (allt.length() == 9) {
//            allt = "   "+allt;
//        }
//        if (allt.length() == 8) {
//            allt = "    "+allt;
//        }
//        if (allt.length() == 7) {
//            allt = "     "+allt;
//        }
//        if (allt.length() == 6) {
//            allt = "      "+allt;
//        }
//        if (allt.length() == 5) {
//            allt = "       "+allt;
//        }
//        if (allt.length() == 4) {
//            allt = "        "+allt;
//        }

        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

        fmt.format("%-34s %13s\n", "Total", allt);

        fmt.format("------------------------------------------------", " ");
        fmt.format("\n", " ");

        //////////////////ttax
        TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);
        tableLayout1.removeAllViews();

        Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor.moveToFirst()) {

            do {
                String name = ccursor.getString(10);
                String value = ccursor.getString(9);
                String pq = ccursor.getString(50);
                String itna = ccursor.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor.moveToNext());
        }
        ccursor.close();

        Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor2.moveToFirst()) {

            do {
                String name = ccursor2.getString(35);
                String value = ccursor2.getString(36);
                String pq = ccursor2.getString(50);
                String itna = ccursor2.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor2.moveToNext());
        }
        ccursor2.close();

        Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor3.moveToFirst()) {

            do {
                String name = ccursor3.getString(37);
                String value = ccursor3.getString(38);
                String pq = ccursor3.getString(50);
                String itna = ccursor3.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor3.moveToNext());
        }
        ccursor3.close();

        Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor4.moveToFirst()) {

            do {
                String name = ccursor4.getString(39);
                String value = ccursor4.getString(40);
                String pq = ccursor4.getString(50);
                String itna = ccursor4.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor4.moveToNext());
        }
        ccursor4.close();

        Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
        if (ccursor5.moveToFirst()) {

            do {
                String name = ccursor5.getString(41);
                String value = ccursor5.getString(42);
                String pq = ccursor5.getString(50);
                String itna = ccursor5.getString(1);

                TextView v = new TextView(Customer_Info_Activity.this);
                v.setText(value);

                TextView v1 = new TextView(Customer_Info_Activity.this);
                v1.setText(name);
                if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                        || v.getText().toString().equals("") || v1.getText().toString().equals("") || v.getText().toString().equals("0.00")) {

                } else {
                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name);
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    //tv2.setTextColor(Color.parseColor("#000000"));
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);
                }
            } while (ccursor5.moveToNext());
        }
        ccursor5.close();


        ArrayList<String> groupList = new ArrayList<String>();

        float sum_p = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(Customer_Info_Activity.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

            if (groupList.contains(mTextView.getText().toString())) {

            }else {
                sum_p = 0;
                for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                    TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                    mTextView1 = (TextView) mRow1.getChildAt(0);
                    mTextView2 = (TextView) mRow1.getChildAt(2);
                    if (groupList.contains(mTextView.getText().toString())) {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Customer_Info_Activity.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    } else {
                        if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                            groupList.add(mTextView.getText().toString());
                            sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Customer_Info_Activity.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                        }
                    }
                }
//                    Toast.makeText(Customer_Info_Activity.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                String mod1 = mTextView.getText().toString() + "" + String.format("%.2f", sum_p);
                String mod12 = mTextView.getText().toString();
                String sum_p_float = String.format("%.2f", sum_p);

//                if (sum_p_float.length() >= 11) {
//
//                }
//                if (sum_p_float.length() == 10) {
//                    sum_p_float = " "+sum_p_float;
//                }
//                if (sum_p_float.length() == 9) {
//                    sum_p_float = "  "+sum_p_float;
//                }
//                if (sum_p_float.length() == 8) {
//                    sum_p_float = "   "+sum_p_float;
//                }
//                if (sum_p_float.length() == 7) {
//                    sum_p_float = "    "+sum_p_float;
//                }
//                if (sum_p_float.length() == 6) {
//                    sum_p_float = "     "+sum_p_float;
//                }
//                if (sum_p_float.length() == 5) {
//                    sum_p_float = "      "+sum_p_float;
//                }
//                if (sum_p_float.length() == 4) {
//                    sum_p_float = "       "+sum_p_float;
//                }

                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                fmt.format("%-38s %9s\n", mod12, sum_p_float);

//                    String match = "@";
//                    int position = mTextView.getText().toString().indexOf(match);
                String mod2 = mTextView.getText().toString();
//                    Toast.makeText(Customer_Info_Activity.this, " "+mod2, Toast.LENGTH_LONG).show();
                Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                if (ccursor6.moveToFirst()) {
                    String hsn = ccursor6.getString(34);

                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                    hsn_hsn.setText(hsn);

                    if (hsn_hsn.getText().toString().equals("")) {
                    } else {
                        fmt.format("%-48s\n", "HSN " + hsn);
                    }
                }

            }
        }

//            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
//            if (ccursor.moveToFirst()) {
//
//                do {
//
//                    String name = ccursor.getString(10);
//                    String value = ccursor.getString(9);
//                    String pq = ccursor.getString(4);
//                    String itna = ccursor.getString(1);
//
//                    if (value.equals("0") || name.equals("NONE") || name.equals("None") || value.equals("0.0")) {
//
//                    } else {
//
////                    final TableRow row = new TableRow(CancelActivity.this);
////                    row.setLayoutParams(new TableRow.LayoutParams(TableRow.LayoutParams.FILL_PARENT,
////                            TableRow.LayoutParams.WRAP_CONTENT));
////                    row.setGravity(Gravity.CENTER);
//
//                        final TableRow row = new TableRow(Customer_Info_Activity.this);
//                        row.setLayoutParams(new TableLayout.LayoutParams(
//                                TableRow.LayoutParams.MATCH_PARENT,
//                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//
//                        TableRow.LayoutParams lp, lp1, lp2;
//
////                                    final TextView tv = new TextView(CancelActivity.this);
////                                    //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                    tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                    tv.setTextSize(16);
////                                    tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                    row.addView(tv);
//
//                        TextView tvv = new TextView(Customer_Info_Activity.this);
//                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        //tv.setBackgroundResource(R.drawable.cell_shape);
//                        tvv.setGravity(Gravity.START);
//                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tvv.setText(name);
//
//                        TextView tv1 = new TextView(Customer_Info_Activity.this);
//                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                        tv1.setGravity(Gravity.START);
//                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        tv1.setText(value);
//                        float vbn = Float.parseFloat(value);
//                        String bvn = String.format(Locale.US,"%.2f", vbn);
//                        String value1 = tv1.getText().toString();
//
//                        TextView tv2 = new TextView(Customer_Info_Activity.this);
////                    tv2.setLayoutParams(new android.widget.TableRow.LayoutParams(145,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
//                        tv2.append(name + " @ " + bvn + "%" + "(" + itna + ")");
//                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        tv2.setPadding(0, 0, 20, 0);
//                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        //tv2.setTextColor(Color.parseColor("#000000"));
//                        row.addView(tv2);
//
//                        TextView textView1 = new TextView(Customer_Info_Activity.this);
//                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        row.addView(textView1);
//
//                        TextView tv3 = new TextView(Customer_Info_Activity.this);
////                    tv3.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
////                            android.widget.TableRow.LayoutParams.WRAP_CONTENT));
//                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
////                        float tota = mul;
//                        String tota1 = String.format(Locale.US,"%.2f", tota);
//                        //tv3.setPadding(0,0,10,0);
//                        tv3.setText(String.valueOf(tota));
//                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                        //tv3.setTextColor(Color.parseColor("#000000"));
//                        //row.addView(tv3);
//
//
//                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                        String value2 = tv3.getText().toString();
//                        row.addView(tv3);
//
//                        tableLayout1.addView(row);
//                        String mod1 = name + " @ " + bvn + "%" + "(" + itna + ")" + "---" + String.valueOf(tota1);
//                        allbuftaxestype1 = new byte[][]{
//                                left, normal, mod1.getBytes(), HT, LF
//                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                        };
//                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                        if (statussusbs.equals("ok")) {
//                            BluetoothPrintDriver.BT_Write(left);    //
//                            BT_Write(normal);
//                            BT_Write(mod1);
//                            BluetoothPrintDriver.BT_Write(HT);    //
//                            BluetoothPrintDriver.BT_Write(LF);    //
//                        } else {
//                            if (statusnets.equals("ok")) {
//                                wifiSocket.WIFI_Write(left);    //
//                                wifiSocket.WIFI_Write(normal);
//                                wifiSocket.WIFI_Write(mod1);
//                                wifiSocket.WIFI_Write(HT);    //
//                                wifiSocket.WIFI_Write(LF);    //
//                            }
//                        }
//                    }
//
//
//                } while (ccursor.moveToNext());
//            }
//            ccursor.close();


        String phon = "0";
        Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
        if (caddress1.moveToFirst()) {
            phon = caddress1.getString(2);
        }
        caddress1.close();

        TextView tvvs = new TextView(Customer_Info_Activity.this);
        tvvs.setText(phon);

        Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
        if (us_name1.moveToLast()) {
//            Toast.makeText(Customer_Info_Activity.this, "user id there", Toast.LENGTH_LONG).show();
            String na53 = us_name1.getString(53);
            String na38 = us_name1.getString(38);
            String na39 = us_name1.getString(39);
            String na40 = us_name1.getString(40);
            String na41 = us_name1.getString(41);
            String na42 = us_name1.getString(42);
            String na43 = us_name1.getString(43);
            String na44 = us_name1.getString(44);
            String na45 = us_name1.getString(45);
            String na46 = us_name1.getString(46);
            String na47 = us_name1.getString(47);
            String na48 = us_name1.getString(48);
            String na49 = us_name1.getString(49);
            String na50 = us_name1.getString(50);
            String na51 = us_name1.getString(51);
            String na52 = us_name1.getString(52);
            String na38_value = us_name1.getString(54);
            String na39_value = us_name1.getString(55);
            String na40_value = us_name1.getString(56);
            String na41_value = us_name1.getString(57);
            String na42_value = us_name1.getString(58);
            String na43_value = us_name1.getString(59);
            String na44_value = us_name1.getString(60);
            String na45_value = us_name1.getString(61);
            String na46_value = us_name1.getString(62);
            String na47_value = us_name1.getString(63);
            String na48_value = us_name1.getString(64);
            String na49_value = us_name1.getString(65);
            String na50_value = us_name1.getString(66);
            String na51_value = us_name1.getString(67);
            String na52_value = us_name1.getString(68);

            String proc = us_name1.getString(69);

            TextView hid = new TextView(Customer_Info_Activity.this);
            hid.setText(proc);

            if (hid.getText().toString().equals("off")) {
                Cursor cursorr = null;
                if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                            float tota = mul;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        String mod1_1 = name + "" + String.valueOf(tota1);
                        String mod12 = name;
                        String sum_p_float = String.valueOf(tota1);

//                        if (sum_p_float.length() >= 11) {
//
//                        }
//                        if (sum_p_float.length() == 10) {
//                            sum_p_float = " "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 9) {
//                            sum_p_float = "  "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 8) {
//                            sum_p_float = "   "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 7) {
//                            sum_p_float = "    "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 6) {
//                            sum_p_float = "     "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 5) {
//                            sum_p_float = "      "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 4) {
//                            sum_p_float = "       "+sum_p_float;
//                        }

                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        fmt.format("%-38s %9s\n", mod12, sum_p_float);

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            } else {

                for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                    int i1 = 0;
                    if (i2 == 38) {
                        i1 = 54;
                    }
                    if (i2 == 39) {
                        i1 = 55;
                    }
                    if (i2 == 40) {
                        i1 = 56;
                    }
                    if (i2 == 41) {
                        i1 = 57;
                    }
                    if (i2 == 42) {
                        i1 = 58;
                    }
                    if (i2 == 43) {
                        i1 = 59;
                    }
                    if (i2 == 44) {
                        i1 = 60;
                    }
                    if (i2 == 45) {
                        i1 = 61;
                    }
                    if (i2 == 46) {
                        i1 = 62;
                    }
                    if (i2 == 47) {
                        i1 = 63;
                    }
                    if (i2 == 48) {
                        i1 = 64;
                    }
                    if (i2 == 49) {
                        i1 = 65;
                    }
                    if (i2 == 50) {
                        i1 = 66;
                    }
                    if (i2 == 51) {
                        i1 = 67;
                    }
                    if (i2 == 52) {
                        i1 = 68;
                    }


                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(
                            TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT, 4.5f));
//                                    TextView tv33 = new TextView(Customer_Info_Activity.this);;
                    TableRow.LayoutParams lp, lp1, lp2;

                    TextView tv = new TextView(Customer_Info_Activity.this);
                    tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv.setGravity(Gravity.START);
                    tv.setTextSize(15);
                    //text = cursor.getString(1);
//                String v = na;

                    tv.setText(us_name1.getString(i2));


                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    //text = cursor.getString(1);
                    tv1.setText(us_name1.getString(i1));
                    String value1 = "0";
                    if (tv1.getText().toString().equals("")) {

                    } else {
                        value1 = tv1.getText().toString();
                    }


                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);
//                    Toast.makeText(Customer_Info_Activity.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

//                    Toast.makeText(Customer_Info_Activity.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                    TextView tv33 = new TextView(Customer_Info_Activity.this);
                    tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv33.setText(String.valueOf(tota));
                    tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    //tv3.setTextColor(Color.parseColor("#000000"));
                    //row.addView(tv3);


                    tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv33);

                    String value2 = tv33.getText().toString();
//                    Toast.makeText(Customer_Info_Activity.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                    if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                            || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                    } else {
                        tableLayout1.addView(row);
//                        Toast.makeText(Customer_Info_Activity.this, "22 " + us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1), Toast.LENGTH_LONG).show();
                        String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                        String mod1_1 = us_name1.getString(i2) + "" + String.valueOf(tota1);
                        String mod12 = us_name1.getString(i2);
                        String sum_p_float = String.valueOf(tota1);

//                        if (sum_p_float.length() >= 11) {
//
//                        }
//                        if (sum_p_float.length() == 10) {
//                            sum_p_float = " "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 9) {
//                            sum_p_float = "  "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 8) {
//                            sum_p_float = "   "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 7) {
//                            sum_p_float = "    "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 6) {
//                            sum_p_float = "     "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 5) {
//                            sum_p_float = "      "+sum_p_float;
//                        }
//                        if (sum_p_float.length() == 4) {
//                            sum_p_float = "       "+sum_p_float;
//                        }

                        fmt.format("%-38s %9s\n", mod12, sum_p_float);

                    }

                }
            }

        } else {
//            Toast.makeText(Customer_Info_Activity.this, "user id not there", Toast.LENGTH_LONG).show();
            Cursor cursorr = null;
            if (paymmethoda.equals("  Dine-in") || paymmethoda.equals("  General") || paymmethoda.equals("  Others")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Takeaway") || paymmethoda.equals("  Main")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
            if (paymmethoda.equals("  Home delivery")) {
                cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
            }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
            if (cursorr.moveToFirst()) {

                do {

                    String name = cursorr.getString(1);
                    String value = cursorr.getString(2);

                    final TableRow row = new TableRow(Customer_Info_Activity.this);
                    row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                            TableRow.LayoutParams.WRAP_CONTENT));
                    row.setGravity(Gravity.CENTER);

                    TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                    TextView tvv = new TextView(Customer_Info_Activity.this);
                    tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    //tv.setBackgroundResource(R.drawable.cell_shape);
                    tvv.setGravity(Gravity.START);
                    tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tvv.setText(name);

                    TextView tv1 = new TextView(Customer_Info_Activity.this);
                    tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                    tv1.setGravity(Gravity.START);
                    tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv1.setText(value);
                    float vbn = Float.parseFloat(value);
                    String bvn = String.format(Locale.US,"%.2f", vbn);
                    tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value1 = tv1.getText().toString();

                    TextView tv2 = new TextView(Customer_Info_Activity.this);
                    //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                    //tv2.setLayoutParams(lp);
                    tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                    tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                    tv2.append(name + " @ " + bvn + "%");
                    tv2.setPadding(0, 0, 20, 0);
                    tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(tv2);

                    TextView textView1 = new TextView(Customer_Info_Activity.this);
                    textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    row.addView(textView1);

                    TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                    tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                    //tv3.setPadding(0,0,10,0);
                    tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                    tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                    float tota = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                        float tota = mul;
                    String tota1 = String.format(Locale.US,"%.2f", tota);
                    tv3.setText(String.valueOf(tota));
                    //row.addView(tv3);


                    tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                    String value2 = tv3.getText().toString();
                    row.addView(tv3);

                    tableLayout1.addView(row);

                    String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                    String mod1_1 = name + "" + String.valueOf(tota1);
                    String mod12 = name;
                    String sum_p_float = String.valueOf(tota1);

//                    if (sum_p_float.length() >= 11) {
//
//                    }
//                    if (sum_p_float.length() == 10) {
//                        sum_p_float = " "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 9) {
//                        sum_p_float = "  "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 8) {
//                        sum_p_float = "   "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 7) {
//                        sum_p_float = "    "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 6) {
//                        sum_p_float = "     "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 5) {
//                        sum_p_float = "      "+sum_p_float;
//                    }
//                    if (sum_p_float.length() == 4) {
//                        sum_p_float = "       "+sum_p_float;
//                    }

                    fmt.format("%-38s %9s\n", mod12, sum_p_float);

                } while (cursorr.moveToNext());
            }
            cursorr.close();
        }
        us_name1.close();

        float sum = 0;
        for (int i = 0; i < tableLayout1.getChildCount(); i++) {
            TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
            TextView mTextView = (TextView) mRow.getChildAt(2);
            sum = sum
                    + Float.parseFloat(mTextView.getText().toString());
        }


        String newsum = String.format("%.2f", sum);

//        if (newsum.length() >= 11) {
//
//        }
//        if (newsum.length() == 10) {
//            newsum = " "+newsum;
//        }
//        if (newsum.length() == 9) {
//            newsum = "  "+newsum;
//        }
//        if (newsum.length() == 8) {
//            newsum = "   "+newsum;
//        }
//        if (newsum.length() == 7) {
//            newsum = "    "+newsum;
//        }
//        if (newsum.length() == 6) {
//            newsum = "     "+newsum;
//        }
//        if (newsum.length() == 5) {
//            newsum = "      "+newsum;
//        }
//        if (newsum.length() == 4) {
//            newsum = "       "+newsum;
//        }

        if (sum == 0 || sum == 0.0 || sum == 0.00) {

        } else {
            fmt.format("%-38s %9s\n", "Tax", newsum);
        }
        //////////////////ttax

        tvkot.setText(bill_coun);
        if (tvkot.getText().toString().equals("")) {

        } else {
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
            fmt.format("Bill id."+bill_coun);
        }


        tvkot.setText(strbillone);
        if (tvkot.getText().toString().equals("")){

        }else {
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
            fmt.format(strbillone);
        }

        fmt.format("\n", " ");

        testBytes = fmt.toString().getBytes();

        //Getting current device count to check if the printer is attached or not
        mUsbManager = (UsbManager) getSystemService(this.USB_SERVICE);
        mDeviceList = mUsbManager.getDeviceList();

        if (mDeviceList.size() > 0) {

            mDeviceIterator = mDeviceList.values().iterator();
            String usbDevice = "";
            while (mDeviceIterator.hasNext()) {
                UsbDevice usbDevice1 = mDeviceIterator.next();
                mDevice = usbDevice1;
            }

            mInterface = mDevice.getInterface(0);
            mEndPoint = mInterface.getEndpoint(1);// 0 IN and  1 OUT to printer.
            mConnection = mUsbManager.openDevice(mDevice);


            if (mInterface == null) {
                Toast.makeText(this, "INTERFACE IS NULL", Toast.LENGTH_SHORT).show();
            } else if (mConnection == null) {
                Toast.makeText(this, "CONNECTION IS NULL", Toast.LENGTH_SHORT).show();
            } else if (forceCLaim == null) {
                Toast.makeText(this, "FORCE CLAIM IS NULL", Toast.LENGTH_SHORT).show();
            } else {
                Toast.makeText(this, "Prepare print... ", Toast.LENGTH_SHORT).show();
                Thread thread = new Thread(new Runnable() {
                    @RequiresApi(api = Build.VERSION_CODES.KITKAT)
                    @Override
                    public void run() {
                        Log.e("u", "Printing.. ");
                        UsbInterface intf = mDevice.getInterface(0);
                        UsbEndpoint endpoint = intf.getEndpoint(0);
                        UsbDeviceConnection conn = mUsbManager.openDevice(mDevice);
                        conn.claimInterface(intf, true);

                        byte[] center = new byte[]{0x1b, 0x61, 0x00};
                        byte[] cut_paper = {0x1D, 0x56, 0x41, 0x10};

//                        try {
//                            Bitmap bmp = BitmapFactory.decodeResource(getResources(),
//                                    R.drawable.titto);
//                            if(bmp!=null){
//                                command = Utils.decodeBitmap(bmp);
//
//                            }else{
//                                Log.e("Print Photo error", "the file isn't exists");
//                            }
//                        } catch (Exception e) {
//                            e.printStackTrace();
//                            Log.e("PrintTools", "the file isn't exists");
//                        }

                        conn.bulkTransfer(endpoint,center,center.length,0);
//                        conn.bulkTransfer(endpoint, command, command.length, 0);
                        conn.bulkTransfer(endpoint, testBytes, testBytes.length, 0);
                        conn.bulkTransfer(endpoint, cut_paper, cut_paper.length, 0);
                    }
                });
                thread.run();
            }
        } else {
            Toast.makeText(this, "No Printer Attached ", Toast.LENGTH_SHORT).show();
        }

    }


    public static boolean SdIsPresent() {
        return Environment.getExternalStorageState().equals(
                Environment.MEDIA_MOUNTED);
    }


//    private void setAlarm(Calendar targetCal){
//
//        //Toast.makeText(getActivity(), " 1", Toast.LENGTH_SHORT).show();
//
//        Calendar cal = Calendar.getInstance();
//
//        cal.setTimeInMillis(System.currentTimeMillis());
//        cal.clear();
//        cal.set(2012,2,8,18,16);
//
//        AlarmManager alarmMgr = (AlarmManager)getSystemService(Context.ALARM_SERVICE);
//        Intent intent = new Intent(Customer_Info_Activity.this, AlarmReceiver1.class);
//        PendingIntent pendingIntent = PendingIntent.getBroadcast(Customer_Info_Activity.this, 0, intent, 0);
//        // cal.add(Calendar.SECOND, 5);
//        alarmMgr.set(AlarmManager.RTC_WAKEUP, cal.getTimeInMillis(), pendingIntent);
//
//
//        Intent intent = new Intent(Customer_Info_Activity.this, AlarmReceiver1.class);
//        PendingIntent pendingIntent = PendingIntent.getBroadcast(Customer_Info_Activity.this, RQS_1, intent, 0);
//        AlarmManager alarmManager = (AlarmManager) getSystemService(Context.ALARM_SERVICE);
//        alarmManager.setRepeating(AlarmManager.RTC_WAKEUP, targetCal.getTimeInMillis(), AlarmManager.INTERVAL_DAY, pendingIntent);
//
////        Intent intent = new Intent(getActivity(), AlarmReceiver1.class);
////        intent.setAction("packagename.ACTION");
////        PendingIntent pendingIntent = PendingIntent.getBroadcast(getActivity(),
////                0, intent, PendingIntent.FLAG_CANCEL_CURRENT);
////        Calendar calendar = Calendar.getInstance();
////        calendar.setTimeInMillis(System.currentTimeMillis());
////        AlarmManager alarm = (AlarmManager) getActivity().getSystemService(Context.ALARM_SERVICE);
////        alarm.cancel(pendingIntent);
////        alarm.setRepeating(AlarmManager.RTC_WAKEUP, calendar.getTimeInMillis(), AlarmManager.INTERVAL_DAY, pendingIntent);
//
//    }


    public Cursor fetchCountriesByName1(String inputtext) throws SQLException {

        Cursor mCursor = null;
        if (inputtext == null  ||  inputtext.length () == 0)  {
            mCursor = db1.rawQuery("SELECT * FROM Items", null);

        }
        else {
            mCursor = db1.rawQuery("SELECT * FROM Items WHERE itemname LIKE '%" + inputtext + "%'", null);
        }

        return mCursor;
    }



    private class MakeRequestTask extends AsyncTask<Void, Void, String> {
        private Gmail mService = null;
        private Exception mLastError = null;
//        private View view = sendFabButton;

        public MakeRequestTask(GoogleAccountCredential credential) {
            HttpTransport transport = AndroidHttp.newCompatibleTransport();
            JsonFactory jsonFactory = JacksonFactory.getDefaultInstance();
            mService = new Gmail.Builder(
                    transport, jsonFactory, credential)
                    .setApplicationName(getResources().getString(R.string.app_name))
                    .build();
        }

        @Override
        protected String doInBackground(Void... params) {
            try {
                return getDataFromApi();
            } catch (Exception e) {
                mLastError = e;
                cancel(true);
                return null;
            }
        }

        private String getDataFromApi() throws IOException {
            // getting Values for to Address, from Address, Subject and Body

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                } while (getcom.moveToNext());
            }
            getcom.close();

            String url = "www.intuitionsoftwares.com";

            String msg = "OTP is "+time1;

//            String msg = "Disclaimer: This information may be confidential and is intended only for the recipient. If you think this mail is not for you, please delete it.\n\n" +
//                    "You can open the attached file with apps like Microsoft excel, WPS office, Apple numbers and etc.,\n\n" +
//                    "Powered by: " + Uri.parse(url);

            Cursor last_four_no = db.rawQuery("SElECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
            if (last_four_no.moveToFirst()){
                String ph = last_four_no.getString(2);
                String ema_send = last_four_no.getString(3);
//                    String unn = cursor1.getString(3);
                TextView edtToAddress = new TextView(Customer_Info_Activity.this);
                edtToAddress.setText(ema_send);

                TextView edtSubject = new TextView(Customer_Info_Activity.this);
                edtSubject.setText(strcompanyname);

                TextView edtMessage = new TextView(Customer_Info_Activity.this);
                edtMessage.setText(msg);

                String user = "me";
                String to = Utils.getString(edtToAddress);
                String from = mCredential.getSelectedAccountName();
                Log.v("sender email", from);
                String subject = Utils.getString(edtSubject);
                String body = Utils.getString(edtMessage);
                MimeMessage mimeMessage;
                response = "";
                try {

//                        File exportDir1 = new File(Environment.getExternalStorageDirectory(), "/Download");

//                        String filename = Environment.getExternalStorageDirectory().toString()+"/Download/IvePOS_items_report"+currentDateandTimee1+"_"+timee1+".csv";

//                String filename = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_reports/IVEPOS_sales_report/IvePOS_sales_report"+"12May17"+"_"+"013048PM"+".csv";
//                String path = Environment.getExternalStorageDirectory().toString()+"/IVEPOS_backup/";


//                        File f = new File(filename);
//
//                        mimeMessage = createEmailWithAttachment(to, from, subject, body, f);



                    mimeMessage = createEmail(to, from, subject, body);
                    response = sendMessage(mService, user, mimeMessage);
                } catch (MessagingException e) {
                    e.printStackTrace();
                }

//                } while (cursor1.moveToNext());
            }
            last_four_no.close();
            return response;
        }

        // Method to send email
        private String sendMessage(Gmail service,
                                   String userId,
                                   MimeMessage email)
                throws MessagingException, IOException {
            com.google.api.services.gmail.model.Message message = createMessageWithEmail(email);
            // GMail's official method to send email with oauth2.0
            message = service.users().messages().send(userId, message).execute();

            System.out.println("user ID " + userId);

            System.out.println("Message id: " + message.getId());
            System.out.println(message.toPrettyString());
            return message.getId();
        }

        public MimeMessage createEmailWithAttachment(String to,
                                                     String from,
                                                     String subject,
                                                     String bodyText,
                                                     File file)
                throws MessagingException, IOException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);

            email.setFrom(new InternetAddress(from));
            email.addRecipient(javax.mail.Message.RecipientType.TO,
                    new InternetAddress(to));
            email.setSubject(subject);

            MimeBodyPart mimeBodyPart = new MimeBodyPart();
            mimeBodyPart.setContent(bodyText, "text/plain");

            Multipart multipart = new MimeMultipart();
            multipart.addBodyPart(mimeBodyPart);

            mimeBodyPart = new MimeBodyPart();
            DataSource source = new FileDataSource(file);

            mimeBodyPart.setDataHandler(new DataHandler(source));
            mimeBodyPart.setFileName(file.getName());

            multipart.addBodyPart(mimeBodyPart);
            email.setContent(multipart);

            return email;
        }

        // Method to create email Params
        private MimeMessage createEmail(String to,
                                        String from,
                                        String subject,
                                        String bodyText) throws MessagingException {
            Properties props = new Properties();
            Session session = Session.getDefaultInstance(props, null);

            MimeMessage email = new MimeMessage(session);
            InternetAddress tAddress = new InternetAddress(to);
            InternetAddress fAddress = new InternetAddress(from);


            System.out.println("From  " + from);
            System.out.println("To  " + to);


            email.setFrom(fAddress);
            email.addRecipient(javax.mail.Message.RecipientType.TO, tAddress);
            email.setSubject(subject);
            email.setText(bodyText);
            return email;
        }

        private com.google.api.services.gmail.model.Message createMessageWithEmail(MimeMessage email)
                throws MessagingException, IOException {
            ByteArrayOutputStream bytes = new ByteArrayOutputStream();
            email.writeTo(bytes);
            String encodedEmail = Base64.encodeBase64URLSafeString(bytes.toByteArray());
            com.google.api.services.gmail.model.Message message = new com.google.api.services.gmail.model.Message();
            message.setRaw(encodedEmail);
            return message;
        }

        @Override
        protected void onPreExecute() {
            mProgress.show();
        }

        @Override
        protected void onPostExecute(String output) {
            Log.d("post execute", "error");
            mProgress.hide();
            if (output == null || output.length() == 0) {
                Toast.makeText(Customer_Info_Activity.this, "not success", Toast.LENGTH_SHORT).show();
//                showMessage(view, "No results returned.");
            } else {
                Toast.makeText(Customer_Info_Activity.this, "success", Toast.LENGTH_SHORT).show();
//                showMessage(view, output);
            }
        }

        @Override
        protected void onCancelled() {
            mProgress.hide();
            if (mLastError != null) {
                Log.v("Errors3", mLastError.getMessage());
                if (mLastError instanceof GooglePlayServicesAvailabilityIOException) {
                    Log.v("Errors1", mLastError.getMessage());
                    showGooglePlayServicesAvailabilityErrorDialog(
                            ((GooglePlayServicesAvailabilityIOException) mLastError)
                                    .getConnectionStatusCode());
                } else if (mLastError instanceof UserRecoverableAuthIOException) {
                    Log.v("Errors2", mLastError.getMessage());
                    startActivityForResult(
                            ((UserRecoverableAuthIOException) mLastError).getIntent(),
                            Utils.REQUEST_AUTHORIZATION);
                } else {
//                    showMessage(view, "The following error occurred:\n" + mLastError.getMessage());
                    Log.v("Errors", mLastError.getMessage());
                }
            } else {
//                showMessage(view, "Request Cancelled.");
            }
        }
    }

    void showGooglePlayServicesAvailabilityErrorDialog(
            final int connectionStatusCode) {
        GoogleApiAvailability apiAvailability = GoogleApiAvailability.getInstance();
        Dialog dialog = apiAvailability.getErrorDialog(
                Customer_Info_Activity.this,
                connectionStatusCode,
                REQUEST_GOOGLE_PLAY_SERVICES);
        dialog.show();
    }

    private void getResultsFromApi() {

        Cursor cursorr = db1.rawQuery("SELECT * FROM Email_setup", null);
        if (cursorr.moveToFirst()) {
            String unn = cursorr.getString(1);
//            Toast.makeText(Customer_Info_Activity.this, "a4 " + unn, Toast.LENGTH_SHORT).show();

            TextView tvv = new TextView(Customer_Info_Activity.this);
            tvv.setText(unn);

            if (tvv.getText().toString().equals("")) {

            }else {
                mCredential.setSelectedAccountName(tvv.getText().toString());
            }
        }
        cursorr.close();

        if (! isGooglePlayServicesAvailable()) {
//            Toast.makeText(Customer_Info_Activity.this, "1", Toast.LENGTH_SHORT).show();
            acquireGooglePlayServices();
        } else if (mCredential.getSelectedAccountName() == null) {
//            Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
//            chooseAccount();
        } else if (! isDeviceOnline()) {
//            Toast.makeText(Customer_Info_Activity.this, "3", Toast.LENGTH_SHORT).show();
//            mOutputText.setText("No network connection available.");
        } else {
//            Toast.makeText(Customer_Info_Activity.this, "4", Toast.LENGTH_SHORT).show();
            new MakeRequestTask1(mCredential).execute();
        }
    }

    /**
     * Checks whether the device currently has a network connection.
     * @return true if the device has a network connection, false otherwise.
     */
    private boolean isDeviceOnline() {
        ConnectivityManager connMgr =
                (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
        NetworkInfo networkInfo = connMgr.getActiveNetworkInfo();
        return (networkInfo != null && networkInfo.isConnected());
    }

    /**
     * Check that Google Play services APK is installed and up to date.
     * @return true if Google Play Services is available and up to
     *     date on this device; false otherwise.
     */
    private boolean isGooglePlayServicesAvailable() {
        GoogleApiAvailability apiAvailability =
                GoogleApiAvailability.getInstance();
        final int connectionStatusCode =
                apiAvailability.isGooglePlayServicesAvailable(Customer_Info_Activity.this);
        return connectionStatusCode == ConnectionResult.SUCCESS;
    }

    /**
     * Attempt to resolve a missing, out-of-date, invalid or disabled Google
     * Play Services installation via a user dialog, if possible.
     */
    private void acquireGooglePlayServices() {
        GoogleApiAvailability apiAvailability =
                GoogleApiAvailability.getInstance();
        final int connectionStatusCode =
                apiAvailability.isGooglePlayServicesAvailable(Customer_Info_Activity.this);
        if (apiAvailability.isUserResolvableError(connectionStatusCode)) {
            showGooglePlayServicesAvailabilityErrorDialog(connectionStatusCode);
        }
    }


    /**
     * Attempts to set the account used with the API credentials. If an account
     * name was previously saved it will use that one; otherwise an account
     * picker dialog will be shown to the user. Note that the setting the
     * account to use with the credentials object requires the app to have the
     * GET_ACCOUNTS permission, which is requested here if it is not already
     * present. The AfterPermissionGranted annotation indicates that this
     * function will be rerun automatically whenever the GET_ACCOUNTS permission
     * is granted.
     */
    @AfterPermissionGranted(REQUEST_PERMISSION_GET_ACCOUNTS)
    private void chooseAccount() {
//        Toast.makeText(getActivity(), "s1", Toast.LENGTH_SHORT).show();
        if (EasyPermissions.hasPermissions(
                Customer_Info_Activity.this, Manifest.permission.GET_ACCOUNTS)) {
            String accountName = getPreferences(Context.MODE_PRIVATE)
                    .getString(PREF_ACCOUNT_NAME, null);
//            Toast.makeText(Customer_Info_Activity.this, "s2", Toast.LENGTH_SHORT).show();
//            if (accountName != null) {
//                mCredential.setSelectedAccountName(accountName);
//                Toast.makeText(getActivity(), "s3", Toast.LENGTH_SHORT).show();
//                getResultsFromApi();
//            } else {
            // Start a dialog from which the user can choose an account
            startActivityForResult(
                    mCredential.newChooseAccountIntent(),
                    REQUEST_ACCOUNT_PICKER);
//            Toast.makeText(Customer_Info_Activity.this, "s4", Toast.LENGTH_SHORT).show();
//            }
        } else {
            // Request the GET_ACCOUNTS permission via a user dialog
//            Toast.makeText(Customer_Info_Activity.this, "s5", Toast.LENGTH_SHORT).show();
            EasyPermissions.requestPermissions(
                    this,
                    "This app needs to access your Google account (via Contacts).",
                    REQUEST_PERMISSION_GET_ACCOUNTS,
                    Manifest.permission.GET_ACCOUNTS);
        }
    }

    private class MakeRequestTask1 extends AsyncTask<Void, Void, List<String>> {
        private Gmail mService = null;
        private Exception mLastError = null;

        MakeRequestTask1(GoogleAccountCredential credential) {
            HttpTransport transport = AndroidHttp.newCompatibleTransport();
            JsonFactory jsonFactory = JacksonFactory.getDefaultInstance();

            System.out.println("labels mservice11 " + mService);

            mService = new Gmail.Builder(
                    transport, jsonFactory, credential)
                    .setApplicationName("Gmail API Android Quickstart")
                    .build();
            Log.d("labels credential", String.valueOf(credential));

            System.out.println("labels mservice " + mService);
        }

        /**
         * Background task to call Gmail API.
         * @param params no parameters needed for this task.
         */
        @Override
        protected List<String> doInBackground(Void... params) {
            Log.d("hiiiiii11", "error");

            try {
                Log.d("hiiiiii111", "error");
                return getDataFromApi();
            } catch (Exception e) {
                mLastError = e;
                cancel(true);
                Log.d("hiiiiii1111", "error");
                return null;
            }
        }

        /**
         * Fetch a list of Gmail labels attached to the specified account.
         * @return List of Strings labels.
         * @throws IOException
         */
        private List<String> getDataFromApi() throws IOException {
            // Get the labels in the user's account.
            String user = "me";
            List<String> labels = new ArrayList<String>();
            ListLabelsResponse listResponse =
                    mService.users().labels().list(user).execute();
            System.out.println("ListLabelsResponse " + listResponse);
            for (Label label : listResponse.getLabels()) {
                labels.add(label.getName());

//                Log.d("labels", String.valueOf(labels));//will be displaying all the folders one by one by looping

//                System.out.println("user ID " + labels.add(label.getName()));
            }
            return labels;
        }


        @Override
        protected void onPreExecute() {
//            mOutputText.setText("");
            mProgress.show();
        }

        @Override
        protected void onPostExecute(List<String> output) {
//            System.out.println("labelsss " + output);//will be displaying details and folders in mail like inbox, sent, outbox, junk, etc
            mProgress.hide();
            if (output == null || output.size() == 0) {
//                mOutputText.setText("No results returned.");
            } else {
                output.add(0, "Data retrieved using the Gmail API:");
//                mOutputText.setText(TextUtils.join("\n", output));
            }
        }

        @Override
        protected void onCancelled() {
            mProgress.hide();
            if (mLastError != null) {
                if (mLastError instanceof GooglePlayServicesAvailabilityIOException) {
                    showGooglePlayServicesAvailabilityErrorDialog(
                            ((GooglePlayServicesAvailabilityIOException) mLastError)
                                    .getConnectionStatusCode());
                } else if (mLastError instanceof UserRecoverableAuthIOException) {
                    startActivityForResult(
                            ((UserRecoverableAuthIOException) mLastError).getIntent(),
                            EmailSetup_Google.REQUEST_AUTHORIZATION);
                } else {
//                    mOutputText.setText("The following error occurred:\n"
//                            + mLastError.getMessage());
                }
            } else {
//                mOutputText.setText("Request cancelled.");
            }
        }
    }

    private boolean initializeObject() {
        try {
            mPrinter = new Printer(((SpnModelsItem) mSpnSeries.getSelectedItem()).getModelConstant(),
                    ((SpnModelsItem) mSpnLang.getSelectedItem()).getModelConstant(),
                    mContext);
        } catch (Exception e) {
//            Toast.makeText(Customer_Info_Activity.this, "Here3", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "Printer", mContext);
            return false;
        }

        mPrinter.setReceiveEventListener(this);

        return true;
    }

    private void finalizeObject() {
        if (mPrinter == null) {
            return;
        }

        mPrinter.clearCommandBuffer();

        mPrinter.setReceiveEventListener(null);

        mPrinter = null;
    }

    @Override
    public void onPtrReceive(final Printer printerObj, final int code, final PrinterStatusInfo status, final String printJobId) {
        runOnUiThread(new Runnable() {
            @Override
            public synchronized void run() {
                ShowMsg.showResult(code, makeErrorMessage(status), mContext);

                dispPrinterWarnings(status);

//                updateButtonState(true);

                new Thread(new Runnable() {
                    @Override
                    public void run() {
                        disconnectPrinter();
                    }
                }).start();
            }
        });
    }

    private String makeErrorMessage(PrinterStatusInfo status) {
        String msg = "";

        if (status.getOnline() == Printer.FALSE) {
            msg += getString(R.string.handlingmsg_err_offline);
        }
        if (status.getConnection() == Printer.FALSE) {
            msg += getString(R.string.handlingmsg_err_no_response);
        }
        if (status.getCoverOpen() == Printer.TRUE) {
            msg += getString(R.string.handlingmsg_err_cover_open);
        }
        if (status.getPaper() == Printer.PAPER_EMPTY) {
            msg += getString(R.string.handlingmsg_err_receipt_end);
        }
        if (status.getPaperFeed() == Printer.TRUE || status.getPanelSwitch() == Printer.SWITCH_ON) {
            msg += getString(R.string.handlingmsg_err_paper_feed);
        }
        if (status.getErrorStatus() == Printer.MECHANICAL_ERR || status.getErrorStatus() == Printer.AUTOCUTTER_ERR) {
            msg += getString(R.string.handlingmsg_err_autocutter);
            msg += getString(R.string.handlingmsg_err_need_recover);
        }
        if (status.getErrorStatus() == Printer.UNRECOVER_ERR) {
            msg += getString(R.string.handlingmsg_err_unrecover);
        }
        if (status.getErrorStatus() == Printer.AUTORECOVER_ERR) {
            if (status.getAutoRecoverError() == Printer.HEAD_OVERHEAT) {
                msg += getString(R.string.handlingmsg_err_overheat);
                msg += getString(R.string.handlingmsg_err_head);
            }
            if (status.getAutoRecoverError() == Printer.MOTOR_OVERHEAT) {
                msg += getString(R.string.handlingmsg_err_overheat);
                msg += getString(R.string.handlingmsg_err_motor);
            }
            if (status.getAutoRecoverError() == Printer.BATTERY_OVERHEAT) {
                msg += getString(R.string.handlingmsg_err_overheat);
                msg += getString(R.string.handlingmsg_err_battery);
            }
            if (status.getAutoRecoverError() == Printer.WRONG_PAPER) {
                msg += getString(R.string.handlingmsg_err_wrong_paper);
            }
        }
        if (status.getBatteryLevel() == Printer.BATTERY_LEVEL_0) {
            msg += getString(R.string.handlingmsg_err_battery_real_end);
        }

        return msg;
    }

    private void dispPrinterWarnings(PrinterStatusInfo status) {
//        EditText edtWarnings = (EditText) findViewById(R.id.edtWarnings);
        String warningsMsg = "";

        if (status == null) {
            return;
        }

        if (status.getPaper() == Printer.PAPER_NEAR_END) {
            warningsMsg += getString(R.string.handlingmsg_warn_receipt_near_end);
        }

        if (status.getBatteryLevel() == Printer.BATTERY_LEVEL_1) {
            warningsMsg += getString(R.string.handlingmsg_warn_battery_near_end);
        }

//        edtWarnings.setText(warningsMsg);
    }

    private void disconnectPrinter() {
        if (mPrinter == null) {
            return;
        }

        try {
            mPrinter.endTransaction();
        } catch (final Exception e) {
            runOnUiThread(new Runnable() {
                @Override
                public synchronized void run() {
//                    Toast.makeText(Customer_Info_Activity.this, "Here6", Toast.LENGTH_SHORT).show();
                    ShowMsg.showException(e, "endTransaction", mContext);
                }
            });
        }

        try {
            mPrinter.disconnect();
        } catch (final Exception e) {
            runOnUiThread(new Runnable() {
                @Override
                public synchronized void run() {
//                    Toast.makeText(Customer_Info_Activity.this, "Here7", Toast.LENGTH_SHORT).show();
                    ShowMsg.showException(e, "disconnect", mContext);
                }
            });
        }

        finalizeObject();
    }

    private boolean printData() {
        if (mPrinter == null) {
            return false;
        }

        if (!connectPrinter()) {
            return false;
        }

        PrinterStatusInfo status = mPrinter.getStatus();

        dispPrinterWarnings(status);

        if (!isPrintable(status)) {
            ShowMsg.showMsg(makeErrorMessage(status), mContext);
            try {
                mPrinter.disconnect();
            } catch (Exception ex) {
//                Toast.makeText(Customer_Info_Activity.this, "Here9", Toast.LENGTH_SHORT).show();
                // Do nothing
            }
            return false;
        }

        try {
            mPrinter.sendData(Printer.PARAM_DEFAULT);
        } catch (Exception e) {
//            Toast.makeText(Customer_Info_Activity.this, "Here10", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "sendData", mContext);
            try {
                mPrinter.disconnect();
            } catch (Exception ex) {
//                Toast.makeText(Customer_Info_Activity.this, "Here11", Toast.LENGTH_SHORT).show();
                // Do nothing
            }
            return false;
        }

        return true;
    }

    private boolean isPrintable(PrinterStatusInfo status) {
        if (status == null) {
            return false;
        }

        if (status.getConnection() == Printer.FALSE) {
            return false;
        } else if (status.getOnline() == Printer.FALSE) {
            return false;
        } else {
            ;//print available
        }

        return true;
    }

    private boolean connectPrinter() {
        boolean isBeginTransaction = false;

        if (mPrinter == null) {
            return false;
        }

        try {
            mPrinter.connect(mEditTarget.getText().toString(), Printer.PARAM_DEFAULT);
        } catch (Exception e) {
//            Toast.makeText(Customer_Info_Activity.this, "Here4", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "connect", mContext);
            return false;
        }

        try {
            mPrinter.beginTransaction();
            isBeginTransaction = true;
        } catch (Exception e) {
//            Toast.makeText(Customer_Info_Activity.this, "Here12", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, "beginTransaction", mContext);
        }

        if (isBeginTransaction == false) {
            try {
                mPrinter.disconnect();
            } catch (Epos2Exception e) {
//                Toast.makeText(Customer_Info_Activity.this, "Here5", Toast.LENGTH_SHORT).show();
                // Do nothing
                return false;
            }
        }

        return true;
    }

    private boolean runPrintCouponSequence(Dialog dialog) {
        if (!initializeObject()) {
            return false;
        }

        if (!createCouponData(dialog)) {
            finalizeObject();
            return false;
        }

        if (!printData()) {
            finalizeObject();
            return false;
        }

        return true;
    }

    private boolean runPrintCouponSequence_minireceipt_all() {
        if (!initializeObject()) {
            return false;
        }

        if (!createCouponData_minireceipt_all()) {
            finalizeObject();
            return false;
        }

        if (!printData()) {
            finalizeObject();
            return false;
        }

        return true;
    }

    private boolean createCouponData(Dialog dialog) {

        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }
        print_ty.close();

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b,0x44,0x23,0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b,0x44,0x25,0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b,0x44,0x13,0x27,0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b,0x44,0x06,0x20,0x29,0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    charlength = 23;
                    charlength1 = 46;
                    charlength2 = 69;
                    quanlentha = 5;
                    HT1 = new byte[]{0x09};
                    str_line = "------------------------------------------------";
                    allbufline = new byte[][]{
                            left,un1, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    if (str_print_ty.equals("Generic")) {
//                        Toast.makeText(Customer_Info_Activity.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.equals("Epson/others")) {
//                        Toast.makeText(Customer_Info_Activity.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 16;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        }else {
                            if (str_print_ty.equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x08, 0x09, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 11;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 4;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }
                }
            }while(cc.moveToNext());
        }
        cc.close();

//        final int barcodeWidth = 2;
//        final int barcodeHeight = 64;
        final int pageAreaHeight = 384;
        final int pageAreaWidth = 384;
//        final int fontAHeight = 24;
//        final int fontAWidth = 12;
//        final int barcodeWidthPos = 110;
//        final int barcodeHeightPos = 70;

        ArrayList<byte[]> list = new ArrayList<byte[]>();
        String method = "";
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
            yourBitmap = BitmapFactory.decodeByteArray(img, 0, img.length);
        }

//        String method = "";
//        Bitmap coffeeData = BitmapFactory.decodeResource(getResources(), R.drawable.coffee);
//        Bitmap wmarkData = BitmapFactory.decodeResource(getResources(), R.drawable.wmark);

        if (mPrinter == null) {
            return false;
        }
        try{
//            method = "addPageBegin";
//            mPrinter.addPageBegin();

            method = "addPageArea";
            mPrinter.addPageArea(0, 0, nPaperWidth, pageAreaHeight);

            method = "addPageDirection";
            mPrinter.addPageDirection(Printer.DIRECTION_TOP_TO_BOTTOM);

            method = "addFeedLine";
            mPrinter.addFeedLine(1);
            method = "addPagePosition";
            mPrinter.addPagePosition(0, nPaperWidth);

//            // RECEIPT BODY//

            mPrinter.addCommand(LF);

//            method = "addPagePosition";
//            mPrinter.addPagePosition(0, wmarkData.getHeight());
//            mPrinter.addPagePosition(0, logoData.getScaledHeight(0));

//            method = "addImage";
//            mPrinter.addImage(wmarkData, 0, 0, wmarkData.getWidth(), wmarkData.getHeight(),
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
//Free coffee text

//            method = "addTextSize";
//            mPrinter.addTextSize(3, 3);
//            method = "addTextStyle";
//            mPrinter.addTextStyle(Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.TRUE, Printer.PARAM_DEFAULT);
//            method = "addTextSmooth";
//            mPrinter.addTextSmooth(Printer.TRUE);
//            method = "addText";
//            mPrinter.addText("FREE Coffee\n");

            Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
            if (connnet.moveToFirst()) {
                ipnamegets = connnet.getString(1);
                portgets = connnet.getString(2);
                statusnets = connnet.getString(3);
            }
            connnet.close();

            Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
            if (connnet_counter.moveToFirst()) {
                ipnamegets_counter = connnet_counter.getString(1);
                portgets_counter = connnet_counter.getString(2);
                statusnets_counter = connnet_counter.getString(3);
            }
            connnet_counter.close();

            Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
            if (connusb.moveToFirst()) {
                addgets = connusb.getString(1);
                namegets = connusb.getString(2);
                statussusbs = connusb.getString(3);
            }
            connusb.close();

            TextView textViewstatusnets = new TextView(Customer_Info_Activity.this);
            TextView textViewstatusnets_counter = new TextView(Customer_Info_Activity.this);
            TextView textViewstatussusbs = new TextView(Customer_Info_Activity.this);

            textViewstatusnets.setText(statusnets);
            textViewstatusnets_counter.setText(statusnets_counter);
            textViewstatussusbs.setText(statussusbs);

            imageViewPicture = (ImageView) dialog.findViewById(R.id.imageViewPicturew);
            mView = dialog.findViewById(R.id.f_vieww1);


            allbuf1 = new byte[][]{
                    bold, un, "Bill copy".getBytes(), LF

            };
            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(bold);
                mPrinter.addCommand(un);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Bill copy");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (c.moveToFirst()) {
                method = "addImage";

                if (NAME.equals("3 inch")) {
                    logoData = Bitmap.createScaledBitmap(yourBitmap, 576, 94, true);
                    mPrinter.addImage(logoData, 0, 0, logoData.getWidth(), logoData.getHeight(),
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
                } else {
                    logoData = Bitmap.createScaledBitmap(yourBitmap, 384, 94, true);
                    mPrinter.addImage(logoData, 0, 0, logoData.getWidth(), logoData.getHeight(),
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
                            Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
                }
            }


            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }
            getcom.close();

            tvkot = new TextView(Customer_Info_Activity.this);


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(bold);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strcompanyname);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress1);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress2);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress3);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(pp);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(stremailid);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strwebsite);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strtaxone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }



            Cursor cursor10 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor10.moveToFirst()) {
                billtypea = cursor10.getString(5);
                paymmethoda = cursor10.getString(6);
            }
            cursor10.close();

            TextView ttv = new TextView(Customer_Info_Activity.this);
            ttv.setText(billtypea);

            TextView ttv1 = new TextView(Customer_Info_Activity.this);
            ttv1.setText(paymmethoda);

//            if (ttv.getText().toString().equals("  Cash")) {
//                billtypeaa = "Cash";
//            } else {
//                billtypeaa = "Card";
//            }

            if (ttv.getText().toString().equals("  Cash")) {
                billtypeaa = "Cash"; //0
            }
            if (ttv.getText().toString().equals("  Card")) {
                billtypeaa = "Card"; //0
            }
            if (ttv.getText().toString().equals("  Paytm")) {
                billtypeaa = "Paytm"; //0
            }
            if (ttv.getText().toString().equals("  Mobikwik")) {
                billtypeaa = "Mobikwik"; //0
            }
            if (ttv.getText().toString().equals("  Freecharge")) {
                billtypeaa = "Freecharge"; //0
            }
            if (ttv.getText().toString().equals("  Pay Later")) {
                billtypeaa = "Pay Later"; //0
            }
            if (ttv.getText().toString().equals("  Cheque")) {
                billtypeaa = "Cheque"; //0
            }
            if (ttv.getText().toString().equals("  Sodexo")) {
                billtypeaa = "Sodexo"; //0
            }
            if (ttv.getText().toString().equals("  Zeta")) {
                billtypeaa = "Zeta"; //0
            }
            if (ttv.getText().toString().equals("  Ticket")) {
                billtypeaa = "Ticket"; //0
            }
            if (ttv.getText().toString().equals(" Upiqr")) {
                billtypeaa = "upiqr"; //0
            }
            if (ttv.getText().toString().equals("  Upiqr")) {
                billtypeaa = "Upiqr"; //0
            }
            billtypeaa = ttv.getText().toString().replace(" ", "");

            //String bill_no = billnum.getText().toString();
            allbufbillno = new byte[][]{
                    setHT32, un1, "Bill no.".getBytes(), billnum_click.getBytes(), HT, "   ".getBytes(), billtypeaa.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };


            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(normal);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Bill no."+billnum_click);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(setHT32);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(billtypeaa);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals("  General") || paymmethoda.toString().equals("  Others")) {
//                paymmethodaa = "General";
                //billtypee.setText("Dine-in");
                if (account_selection.toString().equals("Dine") || account_selection.toString().equals("Qsr")) {
                    paymmethodaa = "Dine-in";
                }else {
                    paymmethodaa = "General";
                }
            } else {
                if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                    paymmethodaa = "Takeaway";
                    //billtypee.setText("Takeaway");
                } else {
                    paymmethodaa = "Home delivery";
                    //billtypee.setText("Home delivery");
                }
            }

            Cursor date = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);
            if (date.moveToFirst()) {
                datee = date.getString(25);
                timee = date.getString(12);
            }
            date.close();

            allbuf10 = new byte[][]{
                    setHT321, left, paymmethodaa.getBytes(), HT, "  ".getBytes(), datee.getBytes(), LF
                    //setHT321,left,paymmethodaa.getBytes(),HT,datee.getBytes(),LF

            };
            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(paymmethodaa);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+datee);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor cursor9 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
            if (cursor9.moveToFirst()) {
                tableida = cursor9.getString(15);
                Cursor vbnm = db1.rawQuery("SELECT * FROM asd1 WHERE _id = '" + tableida + "'", null);
                if (vbnm.moveToFirst()) {
                    assa1 = vbnm.getString(1);
                    assa2 = vbnm.getString(2);
                }
                vbnm.close();
                TextView cx = new TextView(Customer_Info_Activity.this);
                cx.setText(assa1);

                if (cx.getText().toString().equals("")) {
                    tableidaa = "Tab" + assa2;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                } else {
                    tableidaa = "Tab" + assa1;
                    allbuftime = new byte[][]{
                            setHT321, left, tableidaa.getBytes(), HT, "  ".getBytes(), timee.getBytes(), LF
                    };
                }

            }
            cursor9.close();

            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(setHT321);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(tableidaa);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("  "+timee);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            String u_name = "";
            Cursor cursor9_1 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnum_click + "'", null);
            if (cursor9_1.moveToFirst()) {
                u_name = cursor9_1.getString(45);
            }
            cursor9_1.close();

            TextView tv_u_name = new TextView(Customer_Info_Activity.this);
            tv_u_name.setText(u_name);

            if (tv_u_name.getText().toString().equals("")){

            }else {
                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(left);    //
                    mPrinter.addCommand(setHT321);    //
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Counter person: "+tv_u_name.getText().toString());
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor caddress = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
            if (caddress.moveToFirst()) {
                String nam = caddress.getString(1);
                String addr = caddress.getString(4);
                String phon = caddress.getString(2);
                String emai = caddress.getString(3);

                if (nam.toString().length() > 0 || addr.toString().length() > 0 ||
                        phon.toString().length() > 0 || emai.toString().length() > 0) {
                    allbufcust = new byte[][]{
                            left, un, "Customer:".getBytes(), LF, un1,
                    };

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(un);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Customer:");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                        mPrinter.addCommand(un1); //LF
                    }
                } else {

                }

                if (nam.toString().length() > 0) {
                    allbufcustname = new byte[][]{
                            nam.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(nam);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (addr.toString().length() > 0) {
                    allbufcustadd = new byte[][]{
                            addr.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(addr);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (phon.toString().length() > 0) {
                    String cust_ph = "Ph. " + phon.toString();
                    allbufcustph = new byte[][]{
                            cust_ph.getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(cust_ph);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (emai.toString().length() > 0) {
                    allbufcustemail = new byte[][]{
                            emai.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(emai);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF);
                    }
                } else {

                }

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(left);
                    mPrinter.addCommand(un1);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(str_line);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }
            caddress.close();

            allbufqty = new byte[][]{
                    setHT34, normal, "Qty".getBytes(), HT, "Item".getBytes(), HT, "Price".getBytes(), HT, "Amount".getBytes(), left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT34);
                mPrinter.addCommand(normal);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Qty");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("Item");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData3 = new StringBuilder();
                textData3.append("  Price");
                mPrinter.addText(textData3.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData4 = new StringBuilder();
                textData4.append("  Amount");
                mPrinter.addText(textData4.toString());
                mPrinter.addCommand(left);
                mPrinter.addCommand(LF); //LF
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor ccursorr = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursorr.moveToFirst()) {

                do {

                    String nbg = ccursorr.getString(0);
                    String name = ccursorr.getString(1);
                    String value = ccursorr.getString(2);
                    String pq = ccursorr.getString(5);
                    String itna = ccursorr.getString(2);
                    String pricee = ccursorr.getString(3);
                    String tototot = ccursorr.getString(4);

                    final String newid = ccursorr.getString(20);
                    int padding_in_px;

                    int padding_in_dp = 30;  // 34 dps
                    final float scale1 = getResources().getDisplayMetrics().density;
                    padding_in_px = (int) (padding_in_dp * scale1 + 0.5f);


                    if (pq.equals("Item")) {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));


                        final TableRow row1 = new TableRow(Customer_Info_Activity.this);
                        row1.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.MATCH_PARENT));

                        final TableRow row2 = new TableRow(Customer_Info_Activity.this);
                        row2.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));

                        //TableLayout.LayoutParams tableLayoutParams = new TableLayout.LayoutParams();
                        final TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Customer_Info_Activity.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        //tv.setTextSize(18);
                        tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv.setPadding(0, 0, 0, 0);
                        //text = ccursorr.getString(1);
                        tv.setText(value);
                        row.addView(tv);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setGravity(Gravity.CENTER_VERTICAL);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv1.setTextSize(15);
                        //tv.setPadding(0, 0, 0, 0);
                        //text = ccursorr.getString(1);
                        tv1.setText(name);
                        String value1 = tv1.getText().toString();
                        row.addView(tv1);

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        //lp = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 4.5f);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv2.append(value + "% " + name);
                        tv2.setText(pricee);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(R.color.black);
                        row.addView(tv2);

//                                            TextView textView1 = new TextView(CancelActivity.this);
//                                            //lp1 = new TableRow.LayoutParams(0, TableRow.LayoutParams.WRAP_CONTENT, 1.5f);
//                                            textView1.setLayoutParams(new android.widget.TableRow.LayoutParams(android.widget.TableRow.LayoutParams.WRAP_CONTENT,
//                                                    android.widget.TableRow.LayoutParams.WRAP_CONTENT, 1.5f));
//                                            //tv.setBackgroundResource(R.drawable.cell_shape);
//                                            textView1.setGravity(Gravity.RIGHT | Gravity.CENTER_VERTICAL);
//                                            textView1.setText(R.string.Rs);
//                                            //textView1.setBackgroundResource(R.drawable.rs_border);
//                                            textView1.setPadding(0, 0, 5, 0);
//                                            //textView1.setTextColor(R.color.black);
//                                            textView1.setTextSize(14);
//                                            row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                        //tv3.setPadding(5, 0, 0, 0);
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tv2.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv2.setPadding(0, 0, 1, 0);
                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv3.setText(tototot);
                        //tv3.setTextColor(R.color.black);
                        //row.addView(tv3);


                        String value2 = tv3.getText().toString();

                        Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);

                        if (modcursor.moveToFirst()) {

                            Cursor cursor4 = db.rawQuery("SELECT SUM(total) FROM All_Sales WHERE bill_no = '" + billnum_click + "'AND parent = '" + name + "' AND parentid = '" + newid + "'", null);
                            if (cursor4.moveToFirst()) {
                                int sub2a = cursor4.getInt(0);
                                String sub2a1 = String.valueOf(sub2a);
                                ss = Float.parseFloat(sub2a1) + Float.parseFloat(tototot);
                                ss1 = String.valueOf(ss);
                            }
                            cursor4.close();

                            if (name.toString().length() > charlength) {
                                int print1 = 0;

                                if (value.length() > quanlentha && name.toString().length() > charlength) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }
//                            if (name.toString().length()>charlength){
//                                String string1 = name.substring(0, charlength);
//                                String string2 = name.substring(charlength);
//                                allbufitems = new byte[][]{
//                                        setHT34, normal,value.getBytes(),HT,string1.getBytes(),HT, pricee.getBytes(),HT, ss1.getBytes(),LF,"    ".getBytes(),string2.getBytes(),LF
//                                };
//                            }

                                if (value.length() > quanlentha && name.toString().length() > charlength1) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength1) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(ss1);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF); //LF
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF);
                                        print1 = 1;
                                    }
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }
                                ccursor.close();
                            } else {

                                if (value.toString().length() > quanlentha) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(string1quan);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(ss1);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF); //LF
                                    StringBuilder textData5 = new StringBuilder();
                                    textData5.append(string2quan);
                                    mPrinter.addText(textData5.toString());
                                    mPrinter.addCommand(LF);
                                } else {
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, ss1.getBytes(), left, LF,
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(value);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(ss1);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF); //LF
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }
                                ccursor.close();

                            }

                            do {

                                final String modiname = modcursor.getString(1);
                                final String modiquan = modcursor.getString(2);
                                String modiprice = modcursor.getString(3);
                                String moditotal = modcursor.getString(4);
                                final String modiid = modcursor.getString(0);

                                float modprice1 = Float.parseFloat(modiprice);
                                String modpricestr = String.valueOf(modprice1);

                                if (modiname.toString().length() > charlength) {
                                    if (modiname.toString().length() > charlength) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append("");
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(">");
                                        mPrinter.addText(textData2.toString());
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(string1);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(modpricestr);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("");
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append("    ");
                                        mPrinter.addText(textData6.toString());
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append(string2);
                                        mPrinter.addText(textData7.toString());
                                        mPrinter.addCommand(LF); //LF
                                    }
                                    if (modiname.toString().length() > charlength1) {
                                        String string1 = modiname.substring(0, charlength);
                                        String string2 = modiname.substring(charlength, charlength1);
                                        String string3 = modiname.substring(charlength1);
                                        allbufmodifiers = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, ">".getBytes(), string1.getBytes(), HT, modpricestr.getBytes(), HT, "".getBytes(), LF, "    ".getBytes(), string2.getBytes(), LF, "    ".getBytes(), string3.getBytes(), left, LF
                                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                        };
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append("");
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(">");
                                        mPrinter.addText(textData2.toString());
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(string1);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(modpricestr);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("");
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append("    ");
                                        mPrinter.addText(textData6.toString());
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append(string2);
                                        mPrinter.addText(textData7.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append("    ");
                                        mPrinter.addText(textData8.toString());
                                        StringBuilder textData9 = new StringBuilder();
                                        textData9.append(string3);
                                        mPrinter.addText(textData9.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.toString().equals("ok")) {
                                                mPrinter.addCommand(left);
                                                mPrinter.addCommand(normal);
                                                StringBuilder textData1 = new StringBuilder();
                                                textData1.append("HSN " + hsn);
                                                mPrinter.addText(textData1.toString());
                                                mPrinter.addCommand(HT);
                                                mPrinter.addCommand(LF);
                                            }
                                        }
                                    }
                                    ccursor.close();

                                } else {
                                    allbufmodifiers = new byte[][]{
                                            setHT34, normal, "".getBytes(), HT, ">".getBytes(), modiname.getBytes(), HT, modpricestr.getBytes(), HT, "".getBytes(), left, LF
                                            //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF

                                    };
                                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                                    if (statussusbs.toString().equals("ok")) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append("");
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(">");
                                        mPrinter.addText(textData2.toString());
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(modiname);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(modpricestr);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("");
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                    }

                                    Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                    if (ccursor.moveToFirst()) {
                                        String hsn = ccursor.getString(34);

                                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                        hsn_hsn.setText(hsn);

                                        if (hsn_hsn.getText().toString().equals("")) {
                                        } else {
                                            allbuftaxestype1 = new byte[][]{
                                                    left, normal, hsn.getBytes(), HT, LF
                                            };
                                            if (statussusbs.toString().equals("ok")) {
                                                mPrinter.addCommand(left);
                                                mPrinter.addCommand(normal);
                                                StringBuilder textData1 = new StringBuilder();
                                                textData1.append("HSN " + hsn);
                                                mPrinter.addText(textData1.toString());
                                                mPrinter.addCommand(HT);
                                                mPrinter.addCommand(LF);
                                            }
                                        }
                                    }
                                    ccursor.close();

                                }

                                final TableRow tableRow11 = new TableRow(Customer_Info_Activity.this);
                                tableRow11.setLayoutParams(new TableLayout.LayoutParams(
                                        TableRow.LayoutParams.MATCH_PARENT,
                                        TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                                final TextView tvv = new TextView(Customer_Info_Activity.this);
                                // tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
                                tvv.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 0.70f));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                //tv.setGravity(Gravity.CENTER);
                                tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tvv.setText("");
                                tableRow11.addView(tvv);

                                TextView tv4 = new TextView(Customer_Info_Activity.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv4.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.6f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv4.setText(modiname);
                                tv4.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv4.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv4.setGravity(Gravity.CENTER_VERTICAL);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv4);

                                TextView tv5 = new TextView(Customer_Info_Activity.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv5.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.0f));
                                //tv3.setPadding(5, 0, 0, 0);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv5.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv5.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv2.setPadding(0, 0, 1, 0);
                                tv5.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                tv5.setText(modiprice);
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv5);

                                TextView tv6 = new TextView(Customer_Info_Activity.this);
                                //lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
                                tv6.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setPadding(5, 0, 0, 0);
                                tv6.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv6.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv6.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv6.setText("");
                                //tv3.setBackgroundColor(getResources().getColor(R.color.six));
                                //tv3.setTextColor(R.color.black);
                                tableRow11.addView(tv6);


                                final TextView tv7 = new TextView(Customer_Info_Activity.this);
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                tv7.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                tv7.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                tv7.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                //tv3.setPadding(0,0,10,0);
                                tv7.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                //String modtotal = String.valueOf(Integer.parseInt(modiquan) * Integer.parseInt(modiprice));

                                final String number = tv.getText().toString();
                                float newmul = Float.parseFloat(number);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                //tv3.setText(String.valueOf(Float.parseFloat(multiply)+Float.parseFloat(modtotal)));
                                //row.addView(tv3);

                                row.removeView(tv8);


                                tv8 = new TextView(Customer_Info_Activity.this);
                                tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                                //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                                //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                                //tv.setBackgroundResource(R.drawable.cell_shape);
                                tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                                //tv3.setPadding(0, 0, 10, 0);
                                tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                                tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                                final String numberr = tv.getText().toString();
                                float newmulr = Float.parseFloat(numberr);
                                //final float in = Float.parseFloat(cursor.getString(4));
                                String multiplyr = String.valueOf(newmulr * Float.parseFloat(pricee));
                                //newmul = Integer.parseInt(multiply);
                                tv8.setText(String.valueOf(ss));
                                row.addView(tv8);


                                tableLayout1.addView(tableRow11);
                            } while (modcursor.moveToNext());

                            //Cursor modcursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnumb + "' AND parent = '" + name + "' AND parentid = '" + newid + "' ", null);
                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.toString().equals("no")) {

                                    } else {

//                                    Cursor cursor113 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "' AND disc_thereornot = 'yes' AND itemname = '" + name + "' AND _id = '" + nbg + "'", null);
//                                    if (cursor113.moveToFirst()) {
//                                        float vtq = cursor113.getFloat(31);
//                                        total_disc_print_q = String.valueOf(vtq);
//                                    }

//                                    allbufitems = new byte[][]{
//                                            setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, total_disc_print.getBytes(), left, LF,
//                                    };

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(setHT34);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("");
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData2 = new StringBuilder();
                                            textData2.append("");
                                            mPrinter.addText(textData2.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData3 = new StringBuilder();
                                            textData3.append("");
                                            mPrinter.addText(textData3.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData4 = new StringBuilder();
                                            textData4.append("(");
                                            mPrinter.addText(textData4.toString());
                                            StringBuilder textData5 = new StringBuilder();
                                            textData5.append("-");
                                            mPrinter.addText(textData5.toString());
                                            StringBuilder textData6 = new StringBuilder();
                                            textData6.append(total_disc_print_q);
                                            mPrinter.addText(textData6.toString());
                                            StringBuilder textData7 = new StringBuilder();
                                            textData7.append(")");
                                            mPrinter.addText(textData7.toString());
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(LF); //LF
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }
                            disc_cursor.close();
                        } else {

                            if (name.toString().length() > charlength) {
                                int print1 = 0;

                                if (value.length() > quanlentha && name.toString().length() > charlength) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }
//                            if (name.toString().length()>charlength){
//                                String string1 = name.substring(0, charlength);
//                                String string2 = name.substring(charlength);
//                                allbufitems = new byte[][]{
//                                        setHT34,normal,value.getBytes(),HT,string1.getBytes(),HT, pricee.getBytes(),HT, tototot.getBytes(),LF,"    ".getBytes(),string2.getBytes(),LF
//                                };
//                            }
////////////////////////////////////////////////
                                if (value.length() > quanlentha && name.toString().length() > charlength1) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, string2quan.getBytes(), HT, string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(string1quan);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append(string2quan);
                                        mPrinter.addText(textData5.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }
                                if (value.length() < quanlentha && name.toString().length() > charlength1) {
                                    String string1 = name.substring(0, charlength);
                                    String string2 = name.substring(charlength, charlength1);
                                    String string3 = name.substring(charlength1);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, string1.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), LF, "      ".getBytes(), string2.getBytes(), LF, "      ".getBytes(), string3.getBytes(), left, LF,
                                    };
                                    if (print1 == 0) {
                                        mPrinter.addCommand(setHT34);
                                        mPrinter.addCommand(normal);
                                        StringBuilder textData1 = new StringBuilder();
                                        textData1.append(value);
                                        mPrinter.addText(textData1.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData2 = new StringBuilder();
                                        textData2.append(string1);
                                        mPrinter.addText(textData2.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData3 = new StringBuilder();
                                        textData3.append(pricee);
                                        mPrinter.addText(textData3.toString());
                                        mPrinter.addCommand(HT);
                                        StringBuilder textData4 = new StringBuilder();
                                        textData4.append(tototot);
                                        mPrinter.addText(textData4.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData5 = new StringBuilder();
                                        textData5.append("      ");
                                        mPrinter.addText(textData5.toString());
                                        StringBuilder textData6 = new StringBuilder();
                                        textData6.append(string2);
                                        mPrinter.addText(textData6.toString());
                                        mPrinter.addCommand(LF);
                                        StringBuilder textData7 = new StringBuilder();
                                        textData7.append("      ");
                                        mPrinter.addText(textData7.toString());
                                        StringBuilder textData8 = new StringBuilder();
                                        textData8.append(string3);
                                        mPrinter.addText(textData8.toString());
                                        mPrinter.addCommand(left);
                                        mPrinter.addCommand(LF); //LF
                                        print1 = 1;
                                    }
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }
                                ccursor.close();

                            } else {
                                if (value.toString().length() > quanlentha) {
                                    String string1quan = value.substring(0, quanlentha);
                                    String string2quan = value.substring(quanlentha);
                                    allbufitems = new byte[][]{
                                            setHT34, normal, string1quan.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), left, LF, string2quan.getBytes(), LF
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(string1quan);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(tototot);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF);
                                    StringBuilder textData5 = new StringBuilder();
                                    textData5.append(string2quan);
                                    mPrinter.addText(textData5.toString());
                                    mPrinter.addCommand(LF); //LF
                                } else {
                                    allbufitems = new byte[][]{
                                            setHT34, normal, value.getBytes(), HT, name.getBytes(), HT, pricee.getBytes(), HT, tototot.getBytes(), left, LF,
                                    };
                                    mPrinter.addCommand(setHT34);
                                    mPrinter.addCommand(normal);
                                    StringBuilder textData1 = new StringBuilder();
                                    textData1.append(value);
                                    mPrinter.addText(textData1.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData2 = new StringBuilder();
                                    textData2.append(name);
                                    mPrinter.addText(textData2.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData3 = new StringBuilder();
                                    textData3.append(pricee);
                                    mPrinter.addText(textData3.toString());
                                    mPrinter.addCommand(HT);
                                    StringBuilder textData4 = new StringBuilder();
                                    textData4.append(tototot);
                                    mPrinter.addText(textData4.toString());
                                    mPrinter.addCommand(left);
                                    mPrinter.addCommand(LF); //LF
                                }

                                Cursor ccursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '"+name+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                                if (ccursor.moveToFirst()) {
                                    String hsn = ccursor.getString(34);

                                    TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                                    hsn_hsn.setText(hsn);

                                    if (hsn_hsn.getText().toString().equals("")) {
                                    } else {
                                        allbuftaxestype1 = new byte[][]{
                                                left, normal, hsn.getBytes(), HT, LF
                                        };
                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("HSN " + hsn);
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            mPrinter.addCommand(LF);
                                        }
                                    }
                                }
                                ccursor.close();

                            }

                            tv8 = new TextView(Customer_Info_Activity.this);
                            tv8.setLayoutParams(new TableRow.LayoutParams(0, padding_in_px, 1.2f));
                            //tv3.setLayoutParams(new TableRow.LayoutParams(90, TableRow.LayoutParams.MATCH_PARENT));
                            //tv3.setLayoutParams(new LinearLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tv8.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            //tv3.setPadding(0, 0, 10, 0);
                            tv8.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv8.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);

                            final String number = tv.getText().toString();
                            float newmul = Float.parseFloat(number);
                            //final float in = Float.parseFloat(cursor.getString(4));
                            String multiply = String.valueOf(newmul * Float.parseFloat(pricee));
                            //newmul = Integer.parseInt(multiply);
                            tv8.setText(String.valueOf(multiply));
                            row.addView(tv8);

                            Cursor disc_cursor = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND itemname = '" + name + "' AND _id = '" + nbg + "'  ", null);
                            if (disc_cursor.moveToFirst()) {
                                do {
                                    String disc_vv = disc_cursor.getString(12);
                                    String disc_there = disc_cursor.getString(30);
                                    float vtq = disc_cursor.getFloat(31);
                                    if (disc_there.toString().equals("no")) {

                                    } else {

//                                    Cursor cursor113 = db.rawQuery("SELECT * FROM All_Sales WHERE bill_no = '" + billnumb + "' AND disc_thereornot = 'yes' AND itemname = '" + name + "' AND _id = '" + nbg + "'", null);
//                                    if (cursor113.moveToFirst()) {
//                                        float vtq = cursor113.getFloat(31);
//                                        total_disc_print_q = String.valueOf(vtq);
//                                    }

//                                    allbufitems = new byte[][]{
//                                            setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, total_disc_print.getBytes(), left, LF,
//                                    };

                                        total_disc_print_q = String.valueOf(vtq);

                                        allbufrounded = new byte[][]{
                                                setHT34, normal, "".getBytes(), HT, "".getBytes(), HT, "".getBytes(), HT, "(".getBytes(), "-".getBytes(), total_disc_print_q.getBytes(), ")".getBytes(), left, LF,
                                        };

                                        if (statussusbs.toString().equals("ok")) {
                                            mPrinter.addCommand(setHT34);
                                            mPrinter.addCommand(normal);
                                            StringBuilder textData1 = new StringBuilder();
                                            textData1.append("");
                                            mPrinter.addText(textData1.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData2 = new StringBuilder();
                                            textData2.append("");
                                            mPrinter.addText(textData2.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData3 = new StringBuilder();
                                            textData3.append("");
                                            mPrinter.addText(textData3.toString());
                                            mPrinter.addCommand(HT);
                                            StringBuilder textData4 = new StringBuilder();
                                            textData4.append("(");
                                            mPrinter.addText(textData4.toString());
                                            StringBuilder textData5 = new StringBuilder();
                                            textData5.append("-");
                                            mPrinter.addText(textData5.toString());
                                            StringBuilder textData6 = new StringBuilder();
                                            textData6.append(total_disc_print_q);
                                            mPrinter.addText(textData6.toString());
                                            StringBuilder textData7 = new StringBuilder();
                                            textData7.append(")");
                                            mPrinter.addText(textData7.toString());
                                            mPrinter.addCommand(left);
                                            mPrinter.addCommand(LF); //LF
                                        }
                                    }
                                } while (disc_cursor.moveToNext());
                            }
                            disc_cursor.close();
                        }
                        modcursor.close();
                    }


                } while (ccursorr.moveToNext());
            }
            ccursorr.close();

            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }
////////////////////////////////////sub total
            Cursor cursor3 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor3.moveToFirst()) {
                sub = cursor3.getString(7);
            }
            cursor3.close();

//        int sub12 = sub1;
//        String total2 = String.valueOf(sub12);
            float to = Float.parseFloat(sub);
            String tot = String.format("%.2f", to);


            allbufsubtot = new byte[][]{
                    setHT32, left, "Sub total".getBytes(), HT, tot.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Sub total");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(tot);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }
/////////////////////////tax




///////////////////////////////// discount

            Cursor cursor4 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
            if (cursor4.moveToFirst()) {
                taxpe = cursor4.getString(5);
            } else {
                taxpe = "0";
            }
            cursor4.close();

            Cursor cursor5 = db.rawQuery("SELECT * FROM Discountdetails WHERE billno = '" + billnum_click + "'", null);
            if (cursor5.moveToFirst()) {
                dsirs = cursor5.getString(7);
            } else {
                dsirs = "0";
            }
            cursor5.close();

            String alldiscinperc1 = "Discount(" + taxpe + "%)";
            allbufdisc = new byte[][]{
                    setHT32, left, alldiscinperc1.getBytes(), HT, dsirs.getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(alldiscinperc1);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(dsirs);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }
            float newe;
//////////////////////////////////////////////

            Cursor cursor113 = db.rawQuery("SELECT SUM(disc_indiv_total) FROM All_Sales WHERE disc_thereornot = 'yes' AND bill_no = '" + billnum_click + "'", null);
            if (cursor113.moveToFirst()) {
                float level = cursor113.getFloat(0);
                total = String.valueOf(level);
                float total1 = Float.parseFloat(total);
                total_disc_print_q = String.format("%.2f", total1);

                allbufrounded = new byte[][]{
                        setHT32, left, "Savings".getBytes(), HT, total_disc_print_q.getBytes(), LF
                };

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(setHT32);
                    mPrinter.addCommand(left);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Savings");
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(HT);
                    StringBuilder textData2 = new StringBuilder();
                    textData2.append(total_disc_print_q);
                    mPrinter.addText(textData2.toString());
                    mPrinter.addCommand(LF); //LF
                }

            }
            cursor113.close();
////////////////////////////////

            Cursor cursor = db.rawQuery("SELECT * FROM billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor.moveToFirst()) {
                String t_total_points = cursor.getString(16);
                String v_tq = cursor.getString(17);

                TextView tv = new TextView(Customer_Info_Activity.this);
                tv.setText(t_total_points);

                if (tv.getText().toString().equals("")){

                }else {
                    allbufrounded = new byte[][]{
                            setHT32, left, "Loyalty".getBytes(), HT, v_tq.getBytes(), LF
                    };

                    if (statussusbs.equals("ok")) {
                        mPrinter.addCommand(setHT32);
                        mPrinter.addCommand(left);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Loyalty(" + t_total_points + ")");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append(v_tq);
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                }
            }

//////////////////////////////////////Rounded off

            Cursor cursor7 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor7.moveToFirst()) {
                subro = cursor7.getString(9);
            }
            cursor7.close();

            allbufrounded = new byte[][]{
                    setHT32, left, "Rounded".getBytes(), HT, subro.toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Rounded");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(subro);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }
//////////////Total main

            Cursor cursor8 = db.rawQuery("SELECT * FROM Billnumber WHERE billnumber = '" + billnum_click + "'", null);
            if (cursor8.moveToFirst()) {
                alltotal1 = cursor8.getString(2);
            }
            cursor8.close();

            float all = Float.parseFloat(alltotal1);
            String newf = String.format("%.2f", all);

            allbufrounded = new byte[][]{
                    setHT3212, left, "Total".getBytes(), HT, "Rs ".getBytes(), newf.toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT3212);
                mPrinter.addCommand(bold);
                mPrinter.addCommand(left);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Total");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append(insert1_rs+" "+newf);
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(normal);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            ////////////ttax
            TableLayout tableLayout1 = new TableLayout(Customer_Info_Activity.this);
            tableLayout1.removeAllViews();

            Cursor ccursor = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor.moveToFirst()) {

                do {
                    String name = ccursor.getString(10);
                    String value = ccursor.getString(9);
                    String pq = ccursor.getString(50);
                    String itna = ccursor.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor.moveToNext());
            }
            ccursor.close();

            Cursor ccursor2 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor2.moveToFirst()) {

                do {
                    String name = ccursor2.getString(35);
                    String value = ccursor2.getString(36);
                    String pq = ccursor2.getString(50);
                    String itna = ccursor2.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor2.moveToNext());
            }
            ccursor2.close();

            Cursor ccursor3 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor3.moveToFirst()) {

                do {
                    String name = ccursor3.getString(37);
                    String value = ccursor3.getString(38);
                    String pq = ccursor3.getString(50);
                    String itna = ccursor3.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor3.moveToNext());
            }
            ccursor3.close();

            Cursor ccursor4 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor4.moveToFirst()) {

                do {
                    String name = ccursor4.getString(39);
                    String value = ccursor4.getString(40);
                    String pq = ccursor4.getString(50);
                    String itna = ccursor4.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor4.moveToNext());
            }
            ccursor4.close();

            Cursor ccursor5 = db.rawQuery("Select * from All_Sales where bill_no = '" + billnum_click + "'", null);//replace to cursor = dbHelper.fetchAllHotels();
            if (ccursor5.moveToFirst()) {

                do {
                    String name = ccursor5.getString(41);
                    String value = ccursor5.getString(42);
                    String pq = ccursor5.getString(50);
                    String itna = ccursor5.getString(1);

                    TextView v = new TextView(Customer_Info_Activity.this);
                    v.setText(value);

                    TextView v1 = new TextView(Customer_Info_Activity.this);
                    v1.setText(name);
                    if (v.getText().toString().equals("0") || v1.getText().toString().equals("NONE") || v1.getText().toString().equals("None") || v.getText().toString().equals("0.0")
                            || v.getText().toString().equals("")) {

                    } else {
                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(
                                TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT, 4.5f));

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format(Locale.US,"%.2f", vbn);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.START | Gravity.CENTER_VERTICAL);
                        tv2.append(name);
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        //tv2.setTextColor(Color.parseColor("#000000"));
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float tota = Float.parseFloat(value1) * Float.parseFloat(pq) / 100;
                        String tota1 = String.format(Locale.US,"%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));

                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);
                    }
                } while (ccursor5.moveToNext());
            }
            ccursor5.close();


            ArrayList<String> groupList = new ArrayList<String>();

            float sum_p = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(0);
//                                Toast.makeText(Customer_Info_Activity.this, "a "+mTextView.getText().toString(), Toast.LENGTH_LONG).show();

                if (groupList.contains(mTextView.getText().toString())) {

                }else {
                    sum_p = 0;
                    for (int j = 0; j < tableLayout1.getChildCount(); j++) {
                        TableRow mRow1 = (TableRow) tableLayout1.getChildAt(j);
                        mTextView1 = (TextView) mRow1.getChildAt(0);
                        mTextView2 = (TextView) mRow1.getChildAt(2);
                        if (groupList.contains(mTextView.getText().toString())) {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Customer_Info_Activity.this, "b " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        } else {
                            if (mTextView.getText().toString().equals(mTextView1.getText().toString())) {
                                groupList.add(mTextView.getText().toString());
                                sum_p = sum_p+Float.parseFloat(mTextView2.getText().toString());
//                                                Toast.makeText(Customer_Info_Activity.this, "c " + mTextView2.getText().toString()+" "+sum, Toast.LENGTH_LONG).show();
                            }
                        }
                    }
//                    Toast.makeText(Customer_Info_Activity.this, "aa "+mTextView.getText().toString() +" "+sum_p, Toast.LENGTH_LONG).show();

                    String mod1 = mTextView.getText().toString() + "" + String.format("%.2f", sum_p);
                    String mod12 = mTextView.getText().toString();

                    allbuftaxestype1 = new byte[][]{
                            left, normal, mod12.getBytes(), HT, LF
                    };

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT32);
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(mod12);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append(String.format("%.2f", sum_p));
                        mPrinter.addCommand(LF); //LF
                    }

//                    String match = "@";
//                    int position = mTextView.getText().toString().indexOf(match);
                    String mod2 = mTextView.getText().toString();
                    Toast.makeText(Customer_Info_Activity.this, " "+mod2, Toast.LENGTH_LONG).show();
                    Cursor ccursor6 = db.rawQuery("Select * from All_Sales WHERE bill_no = '" + billnum_click + "' AND taxname = '"+mod2+"' OR taxname2 = '"+mod2+"' OR taxname3 = '"+mod2+"' OR taxname4 = '"+mod2+"' OR taxname5 = '"+mod2+"'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    if (ccursor6.moveToFirst()) {
                        String hsn = ccursor6.getString(34);

                        TextView hsn_hsn = new TextView(Customer_Info_Activity.this);
                        hsn_hsn.setText(hsn);

                        if (hsn_hsn.getText().toString().equals("")) {
                        } else {
                            allbuftaxestype1 = new byte[][]{
                                    left, normal, hsn.getBytes(), HT, LF
                            };
                            if (statussusbs.toString().equals("ok")) {
                                mPrinter.addCommand(left);
                                mPrinter.addCommand(normal);
                                StringBuilder textData1 = new StringBuilder();
                                textData1.append("HSN " + hsn);
                                mPrinter.addText(textData1.toString());
                                mPrinter.addCommand(HT);
                                mPrinter.addCommand(LF); //LF
                            }
                        }
                    }
                    ccursor6.close();
                }
            }

            String phon = "0";
            Cursor caddress1 = db.rawQuery("SELECT * FROM Customerdetails WHERE billnumber = '" + billnum_click + "'", null);
            if (caddress1.moveToFirst()) {
                phon = caddress1.getString(2);
            }
            caddress1.close();

            TextView tvvs = new TextView(Customer_Info_Activity.this);
            tvvs.setText(phon);

            Cursor us_name1 = db.rawQuery("Select * from Customerdetails WHERE phoneno = '" + tvvs.getText().toString() + "'", null);
            if (us_name1.moveToLast()) {
//            Toast.makeText(Customer_Info_Activity.this, "user id there", Toast.LENGTH_LONG).show();
                String na53 = us_name1.getString(53);
                String na38 = us_name1.getString(38);
                String na39 = us_name1.getString(39);
                String na40 = us_name1.getString(40);
                String na41 = us_name1.getString(41);
                String na42 = us_name1.getString(42);
                String na43 = us_name1.getString(43);
                String na44 = us_name1.getString(44);
                String na45 = us_name1.getString(45);
                String na46 = us_name1.getString(46);
                String na47 = us_name1.getString(47);
                String na48 = us_name1.getString(48);
                String na49 = us_name1.getString(49);
                String na50 = us_name1.getString(50);
                String na51 = us_name1.getString(51);
                String na52 = us_name1.getString(52);
                String na38_value = us_name1.getString(54);
                String na39_value = us_name1.getString(55);
                String na40_value = us_name1.getString(56);
                String na41_value = us_name1.getString(57);
                String na42_value = us_name1.getString(58);
                String na43_value = us_name1.getString(59);
                String na44_value = us_name1.getString(60);
                String na45_value = us_name1.getString(61);
                String na46_value = us_name1.getString(62);
                String na47_value = us_name1.getString(63);
                String na48_value = us_name1.getString(64);
                String na49_value = us_name1.getString(65);
                String na50_value = us_name1.getString(66);
                String na51_value = us_name1.getString(67);
                String na52_value = us_name1.getString(68);

                String proc = us_name1.getString(69);

                TextView hid = new TextView(Customer_Info_Activity.this);
                hid.setText(proc);

                if (hid.getText().toString().equals("off")) {
                    Cursor cursorr = null;
                    if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals("  General") || paymmethoda.toString().equals("  Others")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
                    if (paymmethoda.toString().equals("  Home delivery")) {
                        cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                    }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                    if (cursorr.moveToFirst()) {

                        do {

                            String name = cursorr.getString(1);
                            String value = cursorr.getString(2);

                            final TableRow row = new TableRow(Customer_Info_Activity.this);
                            row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                    TableRow.LayoutParams.WRAP_CONTENT));
                            row.setGravity(Gravity.CENTER);

                            TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                            TextView tvv = new TextView(Customer_Info_Activity.this);
                            tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            //tv.setBackgroundResource(R.drawable.cell_shape);
                            tvv.setGravity(Gravity.START);
                            tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tvv.setText(name);

                            TextView tv1 = new TextView(Customer_Info_Activity.this);
                            tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                            tv1.setGravity(Gravity.START);
                            tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv1.setText(value);
                            float vbn = Float.parseFloat(value);
                            String bvn = String.format("%.2f", vbn);
                            tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value1 = tv1.getText().toString();

                            TextView tv2 = new TextView(Customer_Info_Activity.this);
                            //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                            //tv2.setLayoutParams(lp);
                            tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                            tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                            tv2.append(name + " @ " + bvn + "%");
                            tv2.setPadding(0, 0, 20, 0);
                            tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(tv2);

                            TextView textView1 = new TextView(Customer_Info_Activity.this);
                            textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            row.addView(textView1);

                            TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                            tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                            //tv3.setPadding(0,0,10,0);
                            tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                            tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                            float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
                            float tota = mul;
                            String tota1 = String.format("%.2f", tota);
                            tv3.setText(String.valueOf(tota));
                            //row.addView(tv3);


                            tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                            String value2 = tv3.getText().toString();
                            row.addView(tv3);

                            tableLayout1.addView(row);

                            String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                                    //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                            };
                            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                            if (statussusbs.toString().equals("ok")) {
                                mPrinter.addCommand(left);
                                mPrinter.addCommand(normal);
                                StringBuilder textData1 = new StringBuilder();
                                textData1.append(mod1);
                                mPrinter.addText(textData1.toString());
                                mPrinter.addCommand(HT);
                                mPrinter.addCommand(LF); //LF
                            }

                        } while (cursorr.moveToNext());
                    }
                    cursorr.close();
                } else {
                    for (int i2 = 38; i2 < 53; i2++) {

//                                tv33.setText("0.0");
//                                for (int i1 = 54; i1<69; i1++) {
                        int i1 = 0;
                        if (i2 == 38) {
                            i1 = 54;
                        }
                        if (i2 == 39) {
                            i1 = 55;
                        }
                        if (i2 == 40) {
                            i1 = 56;
                        }
                        if (i2 == 41) {
                            i1 = 57;
                        }
                        if (i2 == 42) {
                            i1 = 58;
                        }
                        if (i2 == 43) {
                            i1 = 59;
                        }
                        if (i2 == 44) {
                            i1 = 60;
                        }
                        if (i2 == 45) {
                            i1 = 61;
                        }
                        if (i2 == 46) {
                            i1 = 62;
                        }
                        if (i2 == 47) {
                            i1 = 63;
                        }
                        if (i2 == 48) {
                            i1 = 64;
                        }
                        if (i2 == 49) {
                            i1 = 65;
                        }
                        if (i2 == 50) {
                            i1 = 66;
                        }
                        if (i2 == 51) {
                            i1 = 67;
                        }
                        if (i2 == 52) {
                            i1 = 68;
                        }


                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

                        TextView tv = new TextView(Customer_Info_Activity.this);
                        tv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv.setGravity(Gravity.START);
                        tv.setTextSize(15);
                        //text = cursor.getString(1);
//                String v = na;

                        tv.setText(us_name1.getString(i2));


                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        //text = cursor.getString(1);
                        tv1.setText(us_name1.getString(i1));
                        String value1 = "0";
                        if (tv1.getText().toString().equals("")) {

                        } else {
                            value1 = tv1.getText().toString();
                        }


                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                        tv2.append(us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%");
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);
//                    Toast.makeText(Customer_Info_Activity.this, "hiii "+na38 + " @ " + us_name1.getString(i1) + "%", Toast.LENGTH_LONG).show();

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

//                    Toast.makeText(Customer_Info_Activity.this, " "+i1 + " @ " + value1 + "%", Toast.LENGTH_LONG).show();

                        TextView tv33 = new TextView(Customer_Info_Activity.this);
                        tv33.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        tv33.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float mul = Float.parseFloat(value1) * Float.parseFloat(sub) / 100;
//                float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
//                float mul = ((Float.parseFloat(total2)+Float.parseFloat(total_disc_print)) / 100) * Float.parseFloat(value1);
//                    float mul = Float.parseFloat(value1) * (Float.parseFloat(total)+Float.parseFloat(total_disc)) / 100;
                        float tota = mul;
                        String tota1 = String.format("%.2f", tota);
                        tv33.setText(String.valueOf(tota));
                        tv33.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        //tv3.setTextColor(Color.parseColor("#000000"));
                        //row.addView(tv3);


                        tv33.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv33);

                        String value2 = tv33.getText().toString();
//                    Toast.makeText(Customer_Info_Activity.this, "11 " + String.valueOf(tota1), Toast.LENGTH_LONG).show();

                        if (tv33.getText().toString().equals("0") || tv33.getText().toString().equals("0.0") || tv33.getText().toString().equals("0.00")
                                || tv33.getText().toString().equals("") || tv.getText().toString().equals("")) {

                        } else {
                            tableLayout1.addView(row);
                            String mod1 = us_name1.getString(i2) + " @ " + us_name1.getString(i1) + "%" + "---" + String.valueOf(tota1);
                            allbuftaxestype2 = new byte[][]{
                                    left, normal, mod1.getBytes(), HT, LF
                                    //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                            };
                            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                            if (statussusbs.toString().equals("ok")) {
                                mPrinter.addCommand(left);
                                mPrinter.addCommand(normal);
                                StringBuilder textData1 = new StringBuilder();
                                textData1.append(mod1);
                                mPrinter.addText(textData1.toString());
                                mPrinter.addCommand(HT);
                                mPrinter.addCommand(LF); //LF
                            }
                        }

                    }
                }

            } else {
//            Toast.makeText(Customer_Info_Activity.this, "user id not there", Toast.LENGTH_LONG).show();
                Cursor cursorr = null;
                if (paymmethoda.toString().equals("  Dine-in") || paymmethoda.toString().equals("  General") || paymmethoda.toString().equals("  Others")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax1 = 'dine_in'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.toString().equals("  Takeaway") || paymmethoda.toString().equals("  Main")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax2 = 'takeaway'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
                if (paymmethoda.toString().equals("  Home delivery")) {
                    cursorr = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax' AND tax3 = 'homedelivery'", null);//replace to cursor = dbHelper.fetchAllHotels();
                }
//            ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
                if (cursorr.moveToFirst()) {

                    do {

                        String name = cursorr.getString(1);
                        String value = cursorr.getString(2);

                        final TableRow row = new TableRow(Customer_Info_Activity.this);
                        row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
                                TableRow.LayoutParams.WRAP_CONTENT));
                        row.setGravity(Gravity.CENTER);

                        TableRow.LayoutParams lp, lp1, lp2;

//                                final TextView tv = new TextView(CancelActivity.this);
//                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
//                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
//                                tv.setTextSize(16);
//                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                                row.addView(tv);

                        TextView tvv = new TextView(Customer_Info_Activity.this);
                        tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        //tv.setBackgroundResource(R.drawable.cell_shape);
                        tvv.setGravity(Gravity.START);
                        tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tvv.setText(name);

                        TextView tv1 = new TextView(Customer_Info_Activity.this);
                        tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
                        tv1.setGravity(Gravity.START);
                        tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv1.setText(value);
                        float vbn = Float.parseFloat(value);
                        String bvn = String.format("%.2f", vbn);
                        tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value1 = tv1.getText().toString();

                        TextView tv2 = new TextView(Customer_Info_Activity.this);
                        //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
                        //tv2.setLayoutParams(lp);
                        tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
                        tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
                        tv2.append(name + " @ " + bvn + "%");
                        tv2.setPadding(0, 0, 20, 0);
                        tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(tv2);

                        TextView textView1 = new TextView(Customer_Info_Activity.this);
                        textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        row.addView(textView1);

                        TextView tv3 = new TextView(Customer_Info_Activity.this);
//                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
//                tv3.setLayoutParams(lp2);
                        tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
                        //tv3.setPadding(0,0,10,0);
                        tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
                        tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
                        float mul = Float.parseFloat(value1) * Float.parseFloat(String.valueOf(to)) / 100;
                        float tota = mul;
                        String tota1 = String.format("%.2f", tota);
                        tv3.setText(String.valueOf(tota));
                        //row.addView(tv3);


                        tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
                        String value2 = tv3.getText().toString();
                        row.addView(tv3);

                        tableLayout1.addView(row);

                        String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
                        allbuftaxestype2 = new byte[][]{
                                left, normal, mod1.getBytes(), HT, LF
                                //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
                        };
                        //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                        if (statussusbs.toString().equals("ok")) {
                            mPrinter.addCommand(left);
                            mPrinter.addCommand(normal);
                            StringBuilder textData1 = new StringBuilder();
                            textData1.append(mod1);
                            mPrinter.addText(textData1.toString());
                            mPrinter.addCommand(HT);
                            mPrinter.addCommand(LF); //LF
                        }

                    } while (cursorr.moveToNext());
                }
                cursorr.close();
            }
            us_name1.close();


//        ccursor = db1.rawQuery("Select * from Taxes WHERE taxtype = 'Globaltax'", null);//replace to ccursor = dbHelper.fetchAllHotels();
//        if (ccursor.moveToFirst()) {
//
//            do {
//
//                String name = ccursor.getString(1);
//                String value = ccursor.getString(2);
//
//                final TableRow row = new TableRow(Customer_Info_Activity.this);
//                row.setLayoutParams(new TableLayout.LayoutParams(TableRow.LayoutParams.MATCH_PARENT,
//                        TableRow.LayoutParams.WRAP_CONTENT));
//                row.setGravity(Gravity.CENTER);
//
//                TableRow.LayoutParams lp, lp1, lp2;
//
////                                final TextView tv = new TextView(CancelActivity.this);
////                                //tv.setLayoutParams(new TableRow.LayoutParams(40, TableRow.LayoutParams.MATCH_PARENT));
////                                tv.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 0.7f));
////                                tv.setTextSize(16);
////                                tv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
////                                row.addView(tv);
//
//                TextView tvv = new TextView(Customer_Info_Activity.this);
//                tvv.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                //tv.setBackgroundResource(R.drawable.cell_shape);
//                tvv.setGravity(Gravity.START);
//                tvv.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                tvv.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                tvv.setText(name);
//
//                TextView tv1 = new TextView(Customer_Info_Activity.this);
//                tv1.setLayoutParams(new TableRow.LayoutParams(89, 34));
//                tv1.setGravity(Gravity.START);
//                tv1.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                tv1.setText(value);
//                float vbn = Float.parseFloat(value);
//                String bvn = String.format("%.2f", vbn);
//                tv1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                String value1 = tv1.getText().toString();
//
//                TextView tv2 = new TextView(Customer_Info_Activity.this);
//                //lp = new TableRow.LayoutParams(145, TableRow.LayoutParams.WRAP_CONTENT);
//                //tv2.setLayoutParams(lp);
//                tv2.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 2.6f));
//                tv2.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                tv2.setGravity(Gravity.LEFT | Gravity.CENTER_VERTICAL);
//                tv2.append(name + " @ " + bvn + "%");
//                tv2.setPadding(0, 0, 20, 0);
//                tv2.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                row.addView(tv2);
//
//                TextView textView1 = new TextView(Customer_Info_Activity.this);
//                textView1.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                row.addView(textView1);
//
//                TextView tv3 = new TextView(Customer_Info_Activity.this);
////                lp2 = new TableRow.LayoutParams(TableRow.LayoutParams.WRAP_CONTENT, TableRow.LayoutParams.WRAP_CONTENT);
////                tv3.setLayoutParams(lp2);
//                tv3.setLayoutParams(new TableRow.LayoutParams(0, TableRow.LayoutParams.MATCH_PARENT, 1.2f));
//                //tv3.setPadding(0,0,10,0);
//                tv3.setTypeface(Typeface.create("sans-serif-thin", Typeface.NORMAL));
//                tv3.setGravity(Gravity.END | Gravity.CENTER_VERTICAL);
//                float mul = Float.parseFloat(value1) * Float.parseFloat(String .valueOf(to)) / 100;
//                float tota = mul;
//                String tota1 = String.format("%.2f", tota);
//                tv3.setText(String.valueOf(tota));
//                //row.addView(tv3);
//
//
//                tv3.setTextSize(TypedValue.COMPLEX_UNIT_SP, 10);
//                String value2 = tv3.getText().toString();
//                row.addView(tv3);
//
//                tableLayout1.addView(row);
//
//                String mod1 = name + " @ " + bvn + "%" + "---" + String.valueOf(tota1);
//                allbuftaxestype2 = new byte[][]{
//                        left,normal,mod1.getBytes(), HT,LF
//                        //setHT34, normal,total.getBytes(),HT,modiname.getBytes(),HT, modiprice.getBytes(),HT, "125.0".getBytes(),LF
////						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
////						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
//                };
//                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//                if (statussusbs.toString().equals("ok")) {
//                    byte[] bufmodi = DataUtils.byteArraysToBytes(allbuftaxestype2);
//                    Bundle data = new Bundle();
//                    //data.putByteArray(Global.BYTESPARA1, buf1);
//                    data.putByteArray(Global.BYTESPARA1, bufmodi);
//                    data.putInt(Global.INTPARA1, 0);
//                    //data.putInt(Global.INTPARA2, buf1.length);
//                    data.putInt(Global.INTPARA2, bufmodi.length);
//                    DrawerService.workThread.handleCmd(Global.CMD_POS_WRITE, data);
//                }else {
//                    if (statusnets.toString().equals("ok")) {
//                        byte[] bufmodi = DataUtils1.byteArraysToBytes(allbuftaxestype2);
//                        Bundle data = new Bundle();
//                        //data.putByteArray(Global.BYTESPARA1, buf1);
//                        data.putByteArray(Global1.BYTESPARA1, bufmodi);
//                        data.putInt(Global1.INTPARA1, 0);
//                        //data.putInt(Global.INTPARA2, buf1.length);
//                        data.putInt(Global1.INTPARA2, bufmodi.length);
//                        DrawerService1.workThread.handleCmd(Global1.CMD_POS_WRITE1, data);
//                    }
//                }
//
//            } while (ccursor.moveToNext());
//        }

            float sum = 0;
            for (int i = 0; i < tableLayout1.getChildCount(); i++) {
                TableRow mRow = (TableRow) tableLayout1.getChildAt(i);
                TextView mTextView = (TextView) mRow.getChildAt(2);
                sum = sum
                        + Float.parseFloat(mTextView.getText().toString());
            }


            String newsum = String.format("%.2f", sum);

            if (sum == 0 || sum == 0.0 || sum == 0.00) {

            } else {
                allbuftax = new byte[][]{
                        setHT32, left, "Tax".getBytes(), HT, newsum.getBytes(), LF
                };

                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(setHT32);
                    mPrinter.addCommand(left);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Tax");
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(HT);
                    StringBuilder textData2 = new StringBuilder();
                    textData2.append(newsum);
                    mPrinter.addText(textData2.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }
            ////////////ttax

            tvkot.setText(bill_coun);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, bill_coun.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(left);
                    mPrinter.addCommand(un1);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Bill id."+bill_coun);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                    mPrinter.addCommand(LF); //LF
                }
            }

//            allbuf2 = new byte[][]{
//                    normal, "Thank you! visit again.".getBytes(), LF, LF
//
//            };
//            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//            if (textViewstatussusbs.getText().toString().equals("ok")) {
//                mPrinter.addCommand(normal);
//                StringBuilder textData1 = new StringBuilder();
//                textData1.append("Thank you! visit again.");
//                mPrinter.addText(textData1.toString());
//                mPrinter.addCommand(LF); //LF
//                mPrinter.addCommand(LF); //LF
//            }

            tvkot.setText(strbillone);
            if (tvkot.getText().toString().equals("")){

            }else {
                allbuf2 = new byte[][]{
                        normal, strbillone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (textViewstatussusbs.getText().toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strbillone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            Cursor acc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

            if(acc.moveToFirst()){
                acc.moveToFirst();
                do{
                    NAME = acc.getString(1);
                    if (NAME.equals("3 inch")) {
                        feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                    }
                    else {
                        feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                    }
                }while(acc.moveToNext());
            }
            acc.close();

            byte[][] allbuf = new byte[][]{
                    feedcut2
            };
            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(feedcut2);
            }

            if (str_print_ty.equals("POS")) {
                if (statussusbs.equals("ok")) {
                    mPrinter.addCommand(feedcut2);
                }
            }


//            method = "addCut";
//            mPrinter.addCut(Printer.CUT_FEED);
        } catch (Exception e) {
//            Toast.makeText(Customer_Info_Activity.this, "Here2", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, method, mContext);
            return false;
        }

        return true;
    }

    private boolean createCouponData_minireceipt_all() {

        tvkot = new TextView(Customer_Info_Activity.this);
        byte[] setHT34M = {0x1b,0x44,0x04,0x11,0x19,0x00};
        byte[] dotfeed = {0x1b,0x4a,0x10};
        byte[] HTRight = {0x1b,0x61, 0x02,0x09};
        byte[] HT = {0x09};
        byte[] HT1 = {0x09};
        byte[] LF = {0x0d,0x0a};

        byte[] left = {0x1b,0x61, 0x00};
        byte[] cen = {0x1b,0x61, 0x01};
        byte[] right = {0x1b,0x61, 0x02};
        byte[] bold = {0x1B,0x21,0x10};
        byte[] normal = {0x1d, 0x21, 0x00};
        byte[] horiz1 = {0x1b,0x44,0x19, 0x19, 0x00};
        byte[] horiz = {0x1b,0x44, 0x04, 0x06, 0x04, 0x04, 0x0A, 0x00, 0x09, 0x30, 0x09, 0x31, 0x09, 0x32, 0x09, 0x33, 0x09, 0x34, 0x0d,0x0a};

        byte[] un = {0x1b, 0x2d, 0x02};
        byte[] un1 = {0x1b, 0x2d, 0x00};
        String str_line = "";

        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
        if (print_ty.moveToFirst()){
            str_print_ty = print_ty.getString(1);
        }
        print_ty.close();

        Cursor cc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

        if(cc.moveToFirst()){
            cc.moveToFirst();
            do{
                NAME = cc.getString(1);
                if (NAME.equals("3 inch")) {
                    setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
                    setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
                    setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
                    setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
                    setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x20, 0x29, 0x00};//4 tabs 3"
                    nPaperWidth = 576;
                    charlength = 23;
                    charlength1 = 46;
                    charlength2 = 69;
                    quanlentha = 5;
                    HT1 = new byte[]{0x09};
                    str_line = "------------------------------------------------";
                    allbufline = new byte[][]{
                            left, un1, "------------------------------------------------".getBytes(), LF

                    };
                }
                else {
                    if (str_print_ty.equals("Generic")) {
//                        Toast.makeText(Customer_Info_Activity.this, "phi", Toast.LENGTH_SHORT).show();
                        setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
                        setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
                        setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
                        setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                        setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x12, 0x19, 0x00};//4 tabs 2"
                        nPaperWidth = 384;
                        charlength = 10;
                        charlength1 = 20;
                        charlength2 = 30;
                        quanlentha = 5;
                        HT1 = new byte[]{0x09};
                        str_line = "--------------------------------";
                        allbufline = new byte[][]{
                                left, un1, "--------------------------------".getBytes(), LF

                        };
                    }else {
                        if (str_print_ty.equals("Epson/others")) {
//                        Toast.makeText(Customer_Info_Activity.this, "epson", Toast.LENGTH_SHORT).show();
                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
                            nPaperWidth = 384;
                            charlength = 16;
                            charlength1 = 32;
                            charlength2 = 48;
                            quanlentha = 5;
                            HT1 = new byte[]{0x09};
                            str_line = "------------------------------------------";
                            allbufline = new byte[][]{
                                    left, un1, "------------------------------------------".getBytes(), LF
                            };
                        }else {
                            if (str_print_ty.equals("POS")) {
                                setHT32 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT321 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
                                setHT3212 = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 3"
                                setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x03, 0x12, 0x21, 0x00};//4 tabs 2"
//                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x05, 0x08, 0x00};//4 tabs 2"
                                setHT34 = new byte[]{0x1b, 0x44, 0x02, 0x08, 0x09, 0x00};//4 tabs 2"
                                nPaperWidth = 384;
                                charlength = 11;
                                charlength1 = 22;
                                charlength2 = 33;
                                quanlentha = 4;
                                HT1 = new byte[]{0x2F};
                                str_line = "--------------------------------";
                                allbufline = new byte[][]{
                                        left, un1, "--------------------------------".getBytes(), LF
                                };
                            }
                        }
                    }
                }
            }while(cc.moveToNext());
        }
        cc.close();

//        Cursor getprint_type = db1.rawQuery("SELECT * FROM Printer_text_size", null);
//        if (getprint_type.moveToFirst()) {
//            String type = getprint_type.getString(1);
//
//            Cursor cc = db1.rawQuery("SELECT * FROM Printerreceiptsize", null);
//
//            if (cc.moveToFirst()) {
//                cc.moveToFirst();
//                do {
//                    NAME = cc.getString(1);
//                    if (NAME.equals("3 inch")) {
//                        setHT32 = new byte[]{0x1b, 0x44, 0x29, 0x00};//2 tabs 3"
//                        setHT321 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 3"
//                        setHT3212 = new byte[]{0x1b, 0x44, 0x25, 0x00};//2 tabs 3"
//                        setHT33 = new byte[]{0x1b, 0x44, 0x13, 0x27, 0x00};//3 tabs 3"
//                        setHT34 = new byte[]{0x1b, 0x44, 0x08, 0x20, 0x29, 0x00};//4 tabs 3"
//                        setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 3"
//                        feedcut2 = new byte[]{0x1b, 0x64, 0x05, 0x1d, 0x56, 0x00};
//                        nPaperWidth = 576;
//                        charlength = 41;
//                        str_line = "------------------------------------------------";
//                        allbufline = new byte[][]{
//                                left, un1, "------------------------------------------------".getBytes(), LF
//
//                        };
//                    } else {
//
//                        Cursor print_ty = db1.rawQuery("SELECT * FROM Printer_type", null);
//                        if (print_ty.moveToFirst()){
//                            str_print_ty = print_ty.getString(1);
//                        }
//                        if (str_print_ty.toString().equals("Generic")) {
//                            Toast.makeText(Customer_Info_Activity.this, "phi", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x13, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x15, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x04, 0x12, 0x19, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x06, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 25;
//                            str_line = "--------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "--------------------------------".getBytes(), LF
//                            };
//                        }else {
//                            Toast.makeText(Customer_Info_Activity.this, "epson", Toast.LENGTH_SHORT).show();
//                            setHT32 = new byte[]{0x1b, 0x44, 0x23, 0x00};//2 tabs 2"
//                            setHT321 = new byte[]{0x1b, 0x44, 0x19, 0x00};//2 tabs 3"
//                            setHT3212 = new byte[]{0x1b, 0x44, 0x21, 0x00};//2 tabs 3"
//                            setHT33 = new byte[]{0x1b, 0x44, 0x09, 0x19, 0x00};//3 tabs 2"
//                            setHT34 = new byte[]{0x1b, 0x44, 0x06, 0x19, 0x21, 0x00};//4 tabs 2"
//                            setHTKOT = new byte[]{0x1b, 0x44, 0x09, 0x00};//2 tabs 2"
//                            feedcut2 = new byte[]{0x1b, 0x64, 0x03, 0x1d, 0x56, 0x00};
//                            nPaperWidth = 384;
//                            charlength = 28;
//                            str_line = "------------------------------------------";
//                            allbufline = new byte[][]{
//                                    left, un1, "------------------------------------------".getBytes(), LF
//                            };
//                        }
//                    }
//                } while (cc.moveToNext());
//            }
//
//        }

//        final int barcodeWidth = 2;
//        final int barcodeHeight = 64;
        final int pageAreaHeight = 384;
        final int pageAreaWidth = 384;
//        final int fontAHeight = 24;
//        final int fontAWidth = 12;
//        final int barcodeWidthPos = 110;
//        final int barcodeHeightPos = 70;

        ArrayList<byte[]> list = new ArrayList<byte[]>();
        String method = "";
        String[] col = {"companylogo"};
        Cursor c = db1.query("Logo", col, null, null, null, null, null);
        if (c.moveToFirst()) {
            byte[] img = c.getBlob(c.getColumnIndex("companylogo"));
            yourBitmap = BitmapFactory.decodeByteArray(img, 0, img.length);
        }

//        String method = "";
//        Bitmap coffeeData = BitmapFactory.decodeResource(getResources(), R.drawable.coffee);
//        Bitmap wmarkData = BitmapFactory.decodeResource(getResources(), R.drawable.wmark);

        if (mPrinter == null) {
            return false;
        }
        try{
//            method = "addPageBegin";
//            mPrinter.addPageBegin();

            method = "addPageArea";
            mPrinter.addPageArea(0, 0, nPaperWidth, pageAreaHeight);

            method = "addPageDirection";
            mPrinter.addPageDirection(Printer.DIRECTION_TOP_TO_BOTTOM);

            method = "addFeedLine";
            mPrinter.addFeedLine(1);
            method = "addPagePosition";
            mPrinter.addPagePosition(0, nPaperWidth);

//            // RECEIPT BODY//

            mPrinter.addCommand(LF);

//            method = "addPagePosition";
//            mPrinter.addPagePosition(0, wmarkData.getHeight());
//            mPrinter.addPagePosition(0, logoData.getScaledHeight(0));

//            method = "addImage";
//            mPrinter.addImage(wmarkData, 0, 0, wmarkData.getWidth(), wmarkData.getHeight(),
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT,
//                    Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT);
//Free coffee text

//            method = "addTextSize";
//            mPrinter.addTextSize(3, 3);
//            method = "addTextStyle";
//            mPrinter.addTextStyle(Printer.PARAM_DEFAULT, Printer.PARAM_DEFAULT, Printer.TRUE, Printer.PARAM_DEFAULT);
//            method = "addTextSmooth";
//            mPrinter.addTextSmooth(Printer.TRUE);
//            method = "addText";
//            mPrinter.addText("FREE Coffee\n");

            Cursor connnet = db1.rawQuery("SELECT * FROM IPConn", null);
            if (connnet.moveToFirst()) {
                ipnamegets = connnet.getString(1);
                portgets = connnet.getString(2);
                statusnets = connnet.getString(3);
            }
            connnet.close();

            Cursor connnet_counter = db1.rawQuery("SELECT * FROM IPConn_Counter", null);
            if (connnet_counter.moveToFirst()) {
                ipnamegets_counter = connnet_counter.getString(1);
                portgets_counter = connnet_counter.getString(2);
                statusnets_counter = connnet_counter.getString(3);
            }
            connnet_counter.close();

            Cursor connusb = db1.rawQuery("SELECT * FROM BTConn", null);
            if (connusb.moveToFirst()) {
                addgets = connusb.getString(1);
                namegets = connusb.getString(2);
                statussusbs = connusb.getString(3);
            }
            connusb.close();

            allbuf1 = new byte[][]{
                    bold, un, "Mini Statement".getBytes(), LF

            };
            if (statussusbs.equals("ok")) {
                mPrinter.addCommand(bold);
                mPrinter.addCommand(un);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Mini Statement");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            Cursor getcom = db1.rawQuery("SELECT * FROM Companydetailss", null);
            if (getcom.moveToFirst()) {
                do {
                    strcompanyname = getcom.getString(1);
                    straddress1 = getcom.getString(14);
                    straddress2 = getcom.getString(17);
                    straddress3 = getcom.getString(18);
                    strphone = getcom.getString(2);
                    stremailid = getcom.getString(15);
                    strwebsite = getcom.getString(16);
                    strtaxone = getcom.getString(10);
                    strbillone = getcom.getString(12);
                } while (getcom.moveToNext());
            }
            getcom.close();


            tvkot.setText(strcompanyname);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf1 = new byte[][]{
                        bold, un1, cen, strcompanyname.getBytes(), LF

                };
                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(bold);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strcompanyname);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

/////////
            tvkot.setText(straddress1);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf2 = new byte[][]{
                        normal, un1, cen, straddress1.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress1);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress2);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf3 = new byte[][]{
                        normal, un1, cen, straddress2.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress2);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            tvkot.setText(straddress3);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf4 = new byte[][]{
                        normal, un1, cen, straddress3.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(straddress3);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strphone);
            String pp = "Ph. " + strphone;
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf5 = new byte[][]{
                        normal, un1, cen, pp.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(pp);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(stremailid);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf6 = new byte[][]{
                        normal, un1, cen, stremailid.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(stremailid);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strwebsite);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf7 = new byte[][]{
                        normal, un1, cen, strwebsite.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strwebsite);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }

            tvkot.setText(strtaxone);
            if (tvkot.getText().toString().equals("")) {

            } else {
                allbuf8 = new byte[][]{
                        normal, un1, cen, strtaxone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    mPrinter.addCommand(un1);
                    mPrinter.addCommand(cen);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strtaxone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            Cursor cursor_cust_details = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date >= '" + date1_hide.getText().toString() + "' AND date <='" + date2_hide.getText().toString() + "'  ORDER BY date", null);
            if (cursor_cust_details.moveToFirst()) {
                String emailid = cursor_cust_details.getString(3);
                String address = cursor_cust_details.getString(4);

                tvkot.setText(cust_name.getText().toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, cust_name.getText().toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(cust_name.getText().toString());
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                }

                tvkot.setText(pho_num.getText().toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, pho_num.getText().toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(pho_num.getText().toString());
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                }

                tvkot.setText(emailid.toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, emailid.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(emailid);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                }

                tvkot.setText(address.toString());
                if (tvkot.getText().toString().equals("")) {

                } else {
                    allbuf7 = new byte[][]{
                            normal, address.toString().getBytes(), LF

                    };
                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(address);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                }
            }
            cursor_cust_details.close();

//////////////////////////

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

/////////////////////////


            allbufbillno = new byte[][]{
                    setHT32, un1, date1.getText().toString().getBytes(), "-->".getBytes(), date2.getText().toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(date1.getText().toString());
                mPrinter.addText(textData1.toString());
                StringBuilder textData2 = new StringBuilder();
                textData2.append("-->"+date2.getText().toString());
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(LF); //LF
            }

////////////////////////////////////

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

/////////////////////////////////
            allbufbillno = new byte[][]{
                    setHT32, un1, "Sale :".getBytes(), total_sales.getText().toString().getBytes(), "   ".getBytes(), "Pay Later :".getBytes(), total_credit.getText().toString().getBytes(), LF
//						left, normal, setHT22, "DECAF16".getBytes(), HT, right, "30".getBytes(), LF,
//						left, normal, setHT22, "BREVE".getBytes(), HT, right, "1000".getBytes(), LF,
            };


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Sale :"+total_sales.getText().toString()+"   "+"Pay Later :"+total_credit.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            TextView casho_p = new TextView(Customer_Info_Activity.this);
            TextView casho_m = new TextView(Customer_Info_Activity.this);

            casho_p.setText(cashout_product_total.getText().toString());
            casho_m.setText(cashout_money_total.getText().toString());
            if (casho_p.getText().toString().equals("0.0") && casho_m.getText().toString().equals("0.0")) {

            } else {
                if (!casho_p.getText().toString().equals("0.0") && !casho_m.getText().toString().equals("0.0")) {
                    allbufbillno = new byte[][]{
                            setHT32, un1, "Cashout :".getBytes(), cashout_product_total.getText().toString().getBytes(), " P".getBytes(), "   ".getBytes(), cashout_money_total.getText().toString().getBytes(), " M".getBytes(), LF
                    };
                    mPrinter.addCommand(setHT32);
                    mPrinter.addCommand(un1);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append("Cashout :"+cashout_product_total.getText().toString()+" P"+"   "+cashout_money_total.getText().toString()+" M");
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                } else {
                    if (casho_p.getText().toString().equals("0.0")) {
                        allbufbillno = new byte[][]{
                                setHT32, un1, "Cashout :".getBytes(), cashout_money_total.getText().toString().getBytes(), " M".getBytes(), LF
                        };
                        mPrinter.addCommand(setHT32);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Cashout :"+cashout_money_total.getText().toString()+" M");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                    if (casho_m.getText().toString().equals("0.0")) {
                        allbufbillno = new byte[][]{
                                setHT32, un1, "Cashout :".getBytes(), cashout_product_total.getText().toString().getBytes(), " P".getBytes(), LF
                        };
                        mPrinter.addCommand(setHT32);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append("Cashout :"+cashout_product_total.getText().toString()+" P");
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }
                }
            }


//        if (refunds_tot_val.getText().toString().equals("0.0") && charges_tot_val.getText().toString().equals("0.0")){
//
//        }else {
//            if (!refunds_tot_val.getText().toString().equals("0.0") && !charges_tot_val.getText().toString().equals("0.0")) {
//                allbufbillno = new byte[][]{
//                        setHT32,un1,"Refunds :".getBytes(),refunds_tot_val.getText().toString().getBytes(),"   ".getBytes(),"Charges :".getBytes(),charges_tot_val.getText().toString().getBytes(),LF
//                };
//            }else {
//                if (refunds_tot_val.getText().toString().equals("0.0")){
//                    allbufbillno = new byte[][]{
//                            setHT32, un1, "Refunds :".getBytes(), cashout_money_total.getText().toString().getBytes()," M".getBytes(),LF
//                    };
//                }
//                if (charges_tot_val.getText().toString().equals("0.0")){
//                    allbufbillno = new byte[][]{
//                            setHT32, un1, "Refunds :".getBytes(), cashout_product_total.getText().toString().getBytes()," P".getBytes(),LF
//                    };
//                }
//            }
//        }


            allbufbillno = new byte[][]{
                    setHT32, un1, "Refunds :".getBytes(), refunds_tot_val.getText().toString().getBytes(), "   ".getBytes(), "Charges :".getBytes(), charges_tot_val.getText().toString().getBytes(), LF
            };


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Refunds :"+refunds_tot_val.getText().toString()+"   "+"Charges :"+charges_tot_val.getText().toString());
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            allbufbillno = new byte[][]{
                    setHT32, un1, "Deposit :".getBytes(), deposits_tot_val.getText().toString().getBytes(), "   ".getBytes(), LF
            };


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Deposit :"+deposits_tot_val.getText().toString()+"   ");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

            allbufbillno = new byte[][]{
                    setHT32, un1, "Balance :".getBytes(), total_balance.getText().toString().getBytes(), "   ".getBytes(), LF
            };


            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT32);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Balance :"+total_balance.getText().toString()+"   ");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

//////////////////////////////////

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }

/////////////////////////////////////////////

            allbufqty = new byte[][]{
                    setHT33, normal, "Date".getBytes(), HT, "Sale".getBytes(), HT, "Refunds".getBytes(), HT, left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT33);
                mPrinter.addCommand(normal);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Date");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("Sale");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData3 = new StringBuilder();
                textData3.append("Refunds");
                mPrinter.addText(textData3.toString());
                mPrinter.addCommand(HT);
                mPrinter.addCommand(left);
                mPrinter.addCommand(LF); //LF
            }

            allbufqty = new byte[][]{
                    setHT33, normal, "Time".getBytes(), HT, "Pay Later".getBytes(), HT, "Charges".getBytes(), HT, left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT33);
                mPrinter.addCommand(normal);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Time");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("Pay Later");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData3 = new StringBuilder();
                textData3.append("Charges");
                mPrinter.addText(textData3.toString());
                mPrinter.addCommand(HT);
                mPrinter.addCommand(left);
                mPrinter.addCommand(LF); //LF
            }

            allbufqty = new byte[][]{
                    setHT33, normal, "Bill no.".getBytes(), HT, "Cashout".getBytes(), HT, "Deposit".getBytes(), HT, left, LF
            };

            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(setHT33);
                mPrinter.addCommand(normal);
                StringBuilder textData1 = new StringBuilder();
                textData1.append("Bill no.");
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData2 = new StringBuilder();
                textData2.append("Cashout");
                mPrinter.addText(textData2.toString());
                mPrinter.addCommand(HT);
                StringBuilder textData3 = new StringBuilder();
                textData3.append("Deposit");
                mPrinter.addText(textData3.toString());
                mPrinter.addCommand(HT);
                mPrinter.addCommand(left);
                mPrinter.addCommand(LF); //LF
            }

///////////////////////////////////////////

            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(left);
                mPrinter.addCommand(un1);
                StringBuilder textData1 = new StringBuilder();
                textData1.append(str_line);
                mPrinter.addText(textData1.toString());
                mPrinter.addCommand(LF); //LF
            }


            Cursor mini_details = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "' AND date1 is not null", null);
            if (mini_details.moveToFirst()) {
                do {

                    String date = mini_details.getString(7);
                    String time = mini_details.getString(8);
                    String bill_no = mini_details.getString(6);

                    String sale = mini_details.getString(19);
                    String credit = mini_details.getString(13);
                    String cashout = mini_details.getString(12);
                    String cashout_type = mini_details.getString(20);

                    String refunds = mini_details.getString(18);
                    String charges = mini_details.getString(14);
                    String deposit = mini_details.getString(11);

                    TextView sa = new TextView(Customer_Info_Activity.this);
                    sa.setText(sale);
                    if (sa.getText().toString().equals("")) {
                        sa.setText("-");
                    } else {
                        sa.setText(sale);
                    }

                    TextView re = new TextView(Customer_Info_Activity.this);
                    re.setText(refunds);
                    if (re.getText().toString().equals("")) {
                        re.setText("-");
                    } else {
                        re.setText(refunds);
                    }

                    TextView da = new TextView(Customer_Info_Activity.this);
                    da.setText(date);
                    if (da.getText().toString().equals("")) {
                        da.setText("-");
                    } else {
                        da.setText(date);
                    }

                    allbufqty = new byte[][]{
                            setHT33, normal, da.getText().toString().getBytes(), HT, sa.getText().toString().getBytes(), HT, re.getText().toString().getBytes(), HT, left, LF
                    };

                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT33);
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(da.getText().toString());
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append(sa.getText().toString());
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData3 = new StringBuilder();
                        textData3.append(re.getText().toString());
                        mPrinter.addText(textData3.toString());
                        mPrinter.addCommand(HT);
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(LF); //LF
                    }


                    TextView cr = new TextView(Customer_Info_Activity.this);
                    cr.setText(credit);
                    if (cr.getText().toString().equals("")) {
                        cr.setText("-");
                    } else {
                        cr.setText(credit);
                    }

                    TextView ch = new TextView(Customer_Info_Activity.this);
                    ch.setText(charges);
                    if (ch.getText().toString().equals("")) {
                        ch.setText("-");
                    } else {
                        ch.setText(charges);
                    }

                    TextView ti = new TextView(Customer_Info_Activity.this);
                    ti.setText(time);
                    if (ti.getText().toString().equals("")) {
                        ti.setText("-");
                    } else {
                        ti.setText(time);
                    }

                    allbufqty = new byte[][]{
                            setHT33, normal, ti.getText().toString().getBytes(), HT, cr.getText().toString().getBytes(), HT, ch.getText().toString().getBytes(), HT, left, LF
                    };

                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT33);
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(ti.getText().toString());
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append(cr.getText().toString());
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData3 = new StringBuilder();
                        textData3.append(ch.getText().toString());
                        mPrinter.addText(textData3.toString());
                        mPrinter.addCommand(HT);
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(LF); //LF
                    }

                    TextView bi = new TextView(Customer_Info_Activity.this);
                    bi.setText(bill_no);
                    if (bi.getText().toString().equals("")) {
                        bi.setText("-");
                    } else {
                        bi.setText(bill_no);
                    }

                    TextView ca = new TextView(Customer_Info_Activity.this);
                    ca.setText(cashout);
                    if (ca.getText().toString().equals("")) {
                        ca.setText("-");
                    } else {
                        ca.setText(cashout);
                    }

                    TextView ca_ty = new TextView(Customer_Info_Activity.this);
                    ca_ty.setText(cashout_type);

                    TextView ca_ty1 = new TextView(Customer_Info_Activity.this);
                    ca_ty1.setText("");

                    TextView dep = new TextView(Customer_Info_Activity.this);
                    dep.setText(deposit);
                    if (dep.getText().toString().equals("")) {
                        dep.setText("-");
                    } else {
                        dep.setText(deposit);
                    }

                    TextView dep1 = new TextView(Customer_Info_Activity.this);
                    dep1.setText("");
                    if (dep.getText().toString().equals("-")) {

                    } else {
                        dep1.setText("D");
                    }
                    if (ca_ty.getText().toString().equals("")) {

                    } else {
                        if (ca_ty.getText().toString().equals("Money")) {
                            ca_ty1.setText("M");
                        } else {
                            ca_ty1.setText("P");
                        }
                    }
                    allbufqty = new byte[][]{
                            setHT33, normal, bi.getText().toString().getBytes(), HT, ca.getText().toString().getBytes(), ca_ty1.getText().toString().getBytes(), HT, dep.getText().toString().getBytes(), dep1.getText().toString().getBytes(), HT, left, LF,
                    };

                    //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(setHT33);
                        mPrinter.addCommand(normal);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(bi.getText().toString());
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData2 = new StringBuilder();
                        textData2.append(ca.getText().toString()+ca_ty1.getText().toString());
                        mPrinter.addText(textData2.toString());
                        mPrinter.addCommand(HT);
                        StringBuilder textData3 = new StringBuilder();
                        textData3.append(dep.getText().toString()+dep1.getText().toString());
                        mPrinter.addText(textData3.toString());
                        mPrinter.addCommand(HT);
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(LF); //LF
                    }

                    if (statussusbs.toString().equals("ok")) {
                        mPrinter.addCommand(left);
                        mPrinter.addCommand(un1);
                        StringBuilder textData1 = new StringBuilder();
                        textData1.append(str_line);
                        mPrinter.addText(textData1.toString());
                        mPrinter.addCommand(LF); //LF
                    }

                } while (mini_details.moveToNext());
            }
            mini_details.close();


//            allbuf2 = new byte[][]{
//                    normal, "Thank you! visit again.".getBytes(), LF, LF
//
//            };
//            //byte[] buf1 = DataUtils.byteArraysToBytes(compname);
//
//            if (statussusbs.toString().equals("ok")) {
//                mPrinter.addCommand(normal);
//                StringBuilder textData1 = new StringBuilder();
//                textData1.append("Thank you! visit again.");
//                mPrinter.addText(textData1.toString());
//                mPrinter.addCommand(LF); //LF
//                mPrinter.addCommand(LF); //LF
//            }

            tvkot.setText(strbillone);
            if (tvkot.getText().toString().equals("")){

            }else {
                allbuf2 = new byte[][]{
                        normal, strbillone.getBytes(), LF

                };
                //byte[] buf1 = DataUtils.byteArraysToBytes(compname);

                if (statussusbs.toString().equals("ok")) {
                    mPrinter.addCommand(normal);
                    StringBuilder textData1 = new StringBuilder();
                    textData1.append(strbillone);
                    mPrinter.addText(textData1.toString());
                    mPrinter.addCommand(LF); //LF
                }
            }


            Cursor acc=db1.rawQuery("SELECT * FROM Printerreceiptsize", null);

            if(acc.moveToFirst()){
                acc.moveToFirst();
                do{
                    NAME = acc.getString(1);
                    if (NAME.equals("3 inch")) {
                        feedcut2 = new byte[]{0x1b,0x64,0x05, 0x1d,0x56,0x00};
                    }
                    else {
                        feedcut2 = new byte[]{0x1b,0x64,0x03, 0x1d,0x56,0x00};
                    }
                }while(acc.moveToNext());
            }
            acc.close();

            byte[][] allbuf = new byte[][]{
                    feedcut2
            };
            if (statussusbs.toString().equals("ok")) {
                mPrinter.addCommand(feedcut2);
            }


//            method = "addCut";
//            mPrinter.addCut(Printer.CUT_FEED);
        } catch (Exception e) {
//            Toast.makeText(Customer_Info_Activity.this, "Here2", Toast.LENGTH_SHORT).show();
            ShowMsg.showException(e, method, mContext);
            return false;
        }

        return true;
    }

    public void setAmazonS3Client1(CognitoCachingCredentialsProvider credentialsProvider1) {

        // Create an S3 client
        s3client1 = new AmazonS3Client(credentialsProvider1);

        // Set the region of your S3 bucket
        s3client1.setRegion(Region.getRegion(Regions.US_EAST_1));

    }

//    public static void sendSMSMessage(AmazonSNSClient snsClient, String message,
//                                      String phoneNumber, Map<String, MessageAttributeValue> smsAttributes) {
//        PublishResult result = snsClient.publish(new PublishRequest()
//                .withMessage(message)
//                .withPhoneNumber(phoneNumber)
//                .withMessageAttributes(smsAttributes));
//        System.out.println("sms123 "+result); // Prints the message ID.
//    }

    public void sendSMSMessage(AmazonSNSClient snsClient, String message,
                                      String phoneNumber, Map<String, MessageAttributeValue> smsAttributes) {
        RequestQueue queue= RequestSingleton.getInstance(Customer_Info_Activity.this).getInstance();

        StringRequest sr1 = new StringRequest(
                com.android.volley.Request.Method.POST,
                WebserviceUrl + "app_mobile.php",
                new com.android.volley.Response.Listener<String>() {
                    @Override
                    public void onResponse(String responseString) {

                    }
                },
                new com.android.volley.Response.ErrorListener() {
                    @Override
                    public void onErrorResponse(VolleyError error) {
                        Log.d("Signup confirm7", "Error: " + error.getMessage());
                    }
                }) {
            @Override
            protected Map<String, String> getParams() {
                Map<String, String> params = new HashMap<String, String>();
                params.put("message", message);
                params.put("phoneNumber", phoneNumber);
                return params;
            }
        };
        sr1.setRetryPolicy(new DefaultRetryPolicy(0, 0,
                DefaultRetryPolicy.DEFAULT_BACKOFF_MULT));
        queue.add(sr1);

    }


    public void total_loya(final String ph_no, final Dialog dialog_cust) {
        SharedPreferences prefs = getDefaultSharedPreferencesMultiProcess(Customer_Info_Activity.this);
        final String email = prefs.getString("emailid", "");
        final String companyname = prefs.getString("companyname", "");


        RequestQueue queue = Volley.newRequestQueue(Customer_Info_Activity.this);
        StringRequest sr = new StringRequest(
                com.android.volley.Request.Method.POST,
                WebserviceUrl+"loyalty_total.php",
                new com.android.volley.Response.Listener<String>() {
                    @Override
                    public void onResponse(String responseString) {
                        String response= "";
                        JSONObject jsonObject=null;
                        try {
                            jsonObject=new JSONObject(responseString);
                        } catch (JSONException e) {
                            e.printStackTrace();
                        }
                        try {
                            response = jsonObject.getString("status");
                        } catch (JSONException e) {
                            e.printStackTrace();
                        }
                        if(response.equalsIgnoreCase("success")){

//                            SimpleDateFormat sdf = new SimpleDateFormat("HH:mm a");
//                            String currentDateandTime = sdf.format(new Date());
//                            lastSynced=currentDateandTime.toString();
//                            last_synced.setText("Last synced :"+lastSynced);
//
                            parseJson(jsonObject, ph_no, dialog_cust);



                        }else{
                            Toast.makeText(Customer_Info_Activity.this, "Login failed", Toast.LENGTH_SHORT).show();
                        }

                    }
                },
                new com.android.volley.Response.ErrorListener() {
                    @Override
                    public void onErrorResponse(VolleyError error) {
                        Log.d("Signup confirm", "Error: " + error.getMessage());
                    }
                })  {
            @Override
            protected Map<String, String> getParams()
            {
                Map<String,String> params = new HashMap<String, String>();
                               /*     params.put("email", email + "");
                                    params.put("password", password + "");*/
                params.put("email",email);
                params.put("ph_no",ph_no);
                params.put("company",companyname);
                return params;
            }
        };
    /*    sr.setRetryPolicy(new DefaultRetryPolicy(DefaultRetryPolicy.DEFAULT_TIMEOUT_MS,
                DefaultRetryPolicy.DEFAULT_MAX_RETRIES,
                DefaultRetryPolicy.DEFAULT_BACKOFF_MULT));*/
        sr.setRetryPolicy(new DefaultRetryPolicy(0,-1,
                DefaultRetryPolicy.DEFAULT_BACKOFF_MULT));
        queue.add(sr);
    }


    private void parseJson(JSONObject jsonObject, String ph_no, Dialog dialog_cust) {

        try {
            String sumOfpoints = jsonObject.getString("total");
            System.out.println("sum of sales: "+sumOfpoints);

            Cursor cursor2 = db.rawQuery("SELECT * FROM customer_loyalty_points WHERE phoneno = '"+ph_no+"'", null);
            if (cursor2.moveToFirst()){
//                t_total_points = cursor2.getString(2);

                Cursor cursor_loyalty_points = db1.rawQuery("SELECT * FROM loyalty_points", null);
                if (cursor_loyalty_points.moveToFirst()){
                    String t_point2 = cursor_loyalty_points.getString(3);
                    String t_money2 = cursor_loyalty_points.getString(4);

                    v_tq = Float.parseFloat(sumOfpoints) * Float.parseFloat(t_money2);

                }
                cursor_loyalty_points.close();

            }

            final TextView total_points = (TextView) dialog_cust.findViewById(R.id.total_points);
            total_points.setText(sumOfpoints);

            final TextView total_amount = (TextView) dialog_cust.findViewById(R.id.total_amount);
            total_amount.setText(String.format("%.2f", v_tq));

        } catch (JSONException e) {
            e.printStackTrace();
        }

    }




    public void credit_sms_limit(String limit_value, String present_limit) {
        limit_value_get = limit_value;
        present_limit_get = present_limit;
        DownloadMusicfromInternet3 downloadMusicfromInternet = new DownloadMusicfromInternet3();
        downloadMusicfromInternet.execute();

    }

    class DownloadMusicfromInternet3 extends AsyncTask<Void, Integer, Void> {
        private ProgressDialog dialog = new ProgressDialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);

        @Override
        protected Void doInBackground(Void... params) {

            String textcompanyname = "", storeitem = "", deviceitem = "", compemailid = "";

            Cursor cursor_cred = db_inapp.rawQuery("SELECT * FROM credentialstime", null);
            if (cursor_cred.moveToFirst()) {
                textcompanyname = cursor_cred.getString(6);
                storeitem = cursor_cred.getString(7);
                deviceitem = cursor_cred.getString(8);
                compemailid = cursor_cred.getString(5);
            }
            cursor_cred.close();

            AmazonSNSClient snsClient = new AmazonSNSClient(credentialsProvider1);
//            String message = "Hi "+cust_name.getText().toString()+"\n Your credit limit of "+limit_value_get+" is down to "+present_limit_get+". Kindly repay the credit amount";
            String message = "Hi "+cust_name.getText().toString()+" you are receiving this message due to a recent outstanding amount of "+total_balance.getText().toString()+" from the outlet "+textcompanyname+" where you have a credit limit of "+limit_value_get+". Kindly repay the credit amount. Regards Intuition";
            String phoneNumber = "+91" + pho_num.getText().toString();
            Map<String, MessageAttributeValue> smsAttributes =
                    new HashMap<String, MessageAttributeValue>();
            //<set SMS attributes>
            sendSMSMessage(snsClient, message, phoneNumber, smsAttributes);

            Cursor cursor = db_inapp.rawQuery("SELECT * FROM Messaginglicense", null);
            if (cursor.moveToFirst()) {
                do {
                    String id = cursor.getString(0);
                    String countval = cursor.getString(2);

                    Cursor cursor1 = db_inapp.rawQuery("SELECT * FROM Messaginglicense WHERE Messagessent = '" + countval + "'", null);
                    if (cursor1.moveToFirst()) {
                        String id1 = cursor1.getString(0);
                        String limit = cursor1.getString(1);
                        String countv = cursor1.getString(2);
                        countlimit = Integer.parseInt(limit);
                        count = Integer.parseInt(countv);

                        SimpleDateFormat normal2 = new SimpleDateFormat("ddMMMyyyy");
                        final String normal1 = normal2.format(new Date());

                        Date dt = new Date();
                        SimpleDateFormat sdf1 = new SimpleDateFormat("hh:mm:ssaa");
                        final String time1 = sdf1.format(dt);


                        ContentValues contentValues = new ContentValues();
                        contentValues.put("Messagessent", count + 1);
                        contentValues.put("remainingmessages", countlimit - 1);
                        contentValues.put("time", time1);
                        contentValues.put("date", normal1);
                        String where = "_id = '" + id1 + "'";
                        db_inapp = openOrCreateDatabase("amazoninapp", Context.MODE_PRIVATE, null);
                        db_inapp.update("Messaginglicense", contentValues, where, new String[]{});

                        int bn = countlimit - 1;
                        remaining_msgs1(String.valueOf(bn));

                    }
                    cursor1.close();
                } while (cursor.moveToNext());
            }
            cursor.close();

            return null;
        }

        // Show Progress bar before downloading Music
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            // Shows Progress Bar Dialog and then call doInBackground method
            //showDialog(progress_bar_type);

            dialog.setMessage("Loading");
            dialog.setCanceledOnTouchOutside(false);
            dialog.setCancelable(false);

            dialog.setMax(1000);
            //Set the current progress to zero
            dialog.setProgress(0);
            dialog.show();
        }


        @Override
        protected void onPostExecute(Void result) {
            dialog.dismiss();
        }

    }

    class DownloadMusicfromInternet_Deposit extends AsyncTask<Void, Integer, Void> {
        private ProgressDialog dialog_1 = new ProgressDialog(Customer_Info_Activity.this, R.style.timepicker_date_dialog);

        @Override
        protected Void doInBackground(Void... params) {

            Cursor pin = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"'", null);
            if (pin.moveToFirst()){
                String pin1 = pin.getString(25);
                String pin_get = pin.getString(15);

                TextView tvb = new TextView(Customer_Info_Activity.this);
                tvb.setText(pin1);
                if (tvb.getText().toString().equals("on")){
                    if (enter_pint.getText().toString().equals("")){
                        pin_layout.setError("Enter 4 digit pin");
                    }else {
                        if (enter_pint.getText().toString().equals(pin_get)){
                            SimpleDateFormat sdf2 = new SimpleDateFormat("yyyy MM dd");
                            final String currentDateandTime1 = sdf2.format(new Date());

                            SimpleDateFormat sdf3 = new SimpleDateFormat("dd MMM yyyy");
                            currentDateandTime2 = sdf3.format(new Date());

                            Date dt = new Date();
                            SimpleDateFormat sdf1 = new SimpleDateFormat("hh:mm:ss aa");
                            final String time1 = sdf1.format(dt);

                            ContentValues contentValues = new ContentValues();
                            contentValues.put("name", cust_name.getText().toString());
                            contentValues.put("phoneno", pho_num.getText().toString());
                            contentValues.put("emailid", ema_add.getText().toString());
                            contentValues.put("address", add_r.getText().toString());
                            contentValues.put("pincode", pinc_r.getText().toString());
                            contentValues.put("deposit", deposit_value.getText().toString());
                            contentValues.put("total_amount", "0");
                            contentValues.put("cashout", "0");
                            contentValues.put("credit", "0");
                            contentValues.put("write_off", "0");
                            contentValues.put("charges", "0");
                            contentValues.put("refunds", "0");
                            contentValues.put("date1", currentDateandTime2);
                            contentValues.put("time1", time1);
                            contentValues.put("date", currentDateandTime1);
                            contentValues.put("date", currentDateandTime1);
                            contentValues.put("notes", deposit_notes.getText().toString());
                            Cursor c_tax = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                            if (c_tax.moveToLast()){
                                String tax1 = c_tax.getString(38);
                                String tax2 = c_tax.getString(39);
                                String tax3 = c_tax.getString(40);
                                String tax4 = c_tax.getString(41);
                                String tax5 = c_tax.getString(42);
                                String tax6 = c_tax.getString(43);
                                String tax7 = c_tax.getString(44);
                                String tax8 = c_tax.getString(45);
                                String tax9 = c_tax.getString(46);
                                String tax10 = c_tax.getString(47);
                                String tax11 = c_tax.getString(48);
                                String tax12 = c_tax.getString(49);
                                String tax13 = c_tax.getString(50);
                                String tax14 = c_tax.getString(51);
                                String tax15 = c_tax.getString(52);
                                String tax_sele = c_tax.getString(53);
                                String tax1_value = c_tax.getString(54);
                                String tax2_value = c_tax.getString(55);
                                String tax3_value = c_tax.getString(56);
                                String tax4_value = c_tax.getString(57);
                                String tax5_value = c_tax.getString(58);
                                String tax6_value = c_tax.getString(59);
                                String tax7_value = c_tax.getString(60);
                                String tax8_value = c_tax.getString(61);
                                String tax9_value = c_tax.getString(62);
                                String tax10_value = c_tax.getString(63);
                                String tax11_value = c_tax.getString(64);
                                String tax12_value = c_tax.getString(65);
                                String tax13_value = c_tax.getString(66);
                                String tax14_value = c_tax.getString(67);
                                String tax15_value = c_tax.getString(68);

                                String proc = c_tax.getString(69);
                                String lim_st = c_tax.getString(80);
                                String lim_val = c_tax.getString(81);
                                String lim_pre_val = c_tax.getString(82);

                                contentValues.put("tax1", tax1);
                                contentValues.put("tax2", tax2);
                                contentValues.put("tax3", tax3);
                                contentValues.put("tax4", tax4);
                                contentValues.put("tax5", tax5);
                                contentValues.put("tax6", tax6);
                                contentValues.put("tax7", tax7);
                                contentValues.put("tax8", tax8);
                                contentValues.put("tax9", tax9);
                                contentValues.put("tax10", tax10);
                                contentValues.put("tax11", tax11);
                                contentValues.put("tax12", tax12);
                                contentValues.put("tax13", tax13);
                                contentValues.put("tax14", tax14);
                                contentValues.put("tax15", tax15);
                                contentValues.put("tax_selection", tax_sele);
                                contentValues.put("tax1_value", tax1_value);
                                contentValues.put("tax2_value", tax2_value);
                                contentValues.put("tax3_value", tax3_value);
                                contentValues.put("tax4_value", tax4_value);
                                contentValues.put("tax5_value", tax5_value);
                                contentValues.put("tax6_value", tax6_value);
                                contentValues.put("tax7_value", tax7_value);
                                contentValues.put("tax8_value", tax8_value);
                                contentValues.put("tax9_value", tax9_value);
                                contentValues.put("tax10_value", tax10_value);
                                contentValues.put("tax11_value", tax11_value);
                                contentValues.put("tax12_value", tax12_value);
                                contentValues.put("tax13_value", tax13_value);
                                contentValues.put("tax14_value", tax14_value);
                                contentValues.put("tax15_value", tax15_value);

                                contentValues.put("proceedings", proc);
                                contentValues.put("limit_status", lim_st);
                                contentValues.put("limit_value", lim_val);
                                contentValues.put("limit_present_value", lim_pre_val);

                            }
                            c_tax.close();


                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                            resultUri = getContentResolver().insert(contentUri, contentValues);
                            getContentResolver().notifyChange(resultUri, null);


                            //   db.insert("Customerdetails", null, contentValues);
                            dialog.dismiss();
                            dialog_deposit.dismiss();


//                            Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
//                            if (cursor1.moveToFirst()) {
//                                String pin5 = cursor1.getString(15);
//                                String dob = cursor1.getString(17);
//                                String cre_def = cursor1.getString(21);
//                                String pin_statu = cursor1.getString(25);
//                                String dob_alarm = cursor1.getString(26);
//                                String dis_sta = cursor1.getString(27);
//                                String dis_amou = cursor1.getString(28);
//                                String dis_val = cursor1.getString(29);
//                                String dis_typ = cursor1.getString(30);
//                                String usr_id = cursor1.getString(37);
//                                Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
//                                if (cursor11.moveToFirst()){
//                                    do {
//                                        String id = cursor11.getString(0);
//                                        ContentValues contentValues5 = new ContentValues();
//                                        contentValues5.put("authentication_pin", pin5);
//                                        contentValues5.put("dob", dob);
//                                        contentValues5.put("user_id", usr_id);
//                                        contentValues5.put("credit_default", cre_def);
//                                        contentValues5.put("authentication_pin_status", pin_statu);
//                                        contentValues5.put("dob_alaram", dob_alarm);
//                                        contentValues5.put("default_discount_status", dis_sta);
//                                        contentValues5.put("default_discount_amount", dis_amou);
//                                        contentValues5.put("default_discount_value", dis_val);
//                                        contentValues5.put("default_discount_type", dis_typ);
//                                        String where = "_id = '" + id + "'";
//
//
//
//                                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
//                                        getContentResolver().update(contentUri, contentValues5,where,new String[]{});
//                                        resultUri = new Uri.Builder()
//                                                .scheme("content")
//                                                .authority(StubProvider.AUTHORITY)
//                                                .path("Customerdetails")
//                                                .appendQueryParameter("operation", "update")
//                                                .appendQueryParameter("_id",id)
//                                                .build();
//                                        getContentResolver().notifyChange(resultUri, null);
//
//
//
//
//                                        //      db.update("Customerdetails", contentValues5, where, new String[]{});
//                                    }while (cursor11.moveToNext());
//                                }
//                                cursor11.close();
//
//                            }
//                            cursor1.close();
//
//
//
//                            Cursor return_items = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
//                            if (return_items.moveToFirst()){
//                                do {
//                                    String id = return_items.getString(0);
//                                    String pre_qu = return_items.getString(3);
//                                    String add = return_items.getString(18);
//
//                                    float a = Float.parseFloat(pre_qu) + Float.parseFloat(add);
//
//                                    ContentValues con = new ContentValues();
//                                    con.put("stockquan", String.valueOf(a));
//                                    String where = "_id = '" + id + "'";
//                                    //       db1.update("Items", con, where, new String[]{});
//
//                                    String where1_v1 = "docid = '" + id + "'";
//                                    db1.update("Items_Virtual", con, where1_v1, new String[]{});
//
//                                    contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
//                                    getContentResolver().update(contentUri, con,where,new String[]{});
//                                    resultUri = new Uri.Builder()
//                                            .scheme("content")
//                                            .authority(StubProviderApp.AUTHORITY)
//                                            .path("Items")
//                                            .appendQueryParameter("operation", "update")
//                                            .appendQueryParameter("_id",id)
//                                            .build();
//                                    getContentResolver().notifyChange(resultUri, null);
//
//
//                                    //          db1.update("Items", con, where, new String[]{});
//                                }while (return_items.moveToNext());
//                            }
//                            return_items.close();
//
//                            Cursor cursor5 = db1.rawQuery("SELECT * FROM Items WHERE print_value != ''", null);
//                            if (cursor5.moveToFirst()) {
//                                do {
//                                    String id = cursor5.getString(0);
//                                    ContentValues contentValues1 = new ContentValues();
//                                    contentValues1.put("print_value", "");
//                                    contentValues1.put("checked", "");
//                                    String where1 = "_id = '" + id + "' ";
//                                    //          db1.update("Items", contentValues1, where1, new String[]{});
//
//                                    String where1_v1 = "docid = '" + id + "'";
//                                    db1.update("Items_Virtual", contentValues1, where1_v1, new String[]{});
//
//                                    contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
//                                    getContentResolver().update(contentUri, contentValues1,where1,new String[]{});
//                                    resultUri = new Uri.Builder()
//                                            .scheme("content")
//                                            .authority(StubProviderApp.AUTHORITY)
//                                            .path("Items")
//                                            .appendQueryParameter("operation", "update")
//                                            .appendQueryParameter("_id",id)
//                                            .build();
//                                    getContentResolver().notifyChange(resultUri, null);
//
//
//
//                                    //                db1.update("Items", contentValues1, where1, new String[]{});
//                                } while (cursor5.moveToNext());
//                            }
//                            cursor5.close();
//
//                            TextView total_sales = (TextView) findViewById(R.id.sale_value);
//
//                            Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
//                            if (cursor_sales.moveToFirst()){
//                                float dsirsq = cursor_sales.getFloat(0);
//                                String rop = String.format("%.1f", dsirsq);
//                                total_sales.setText(rop);
//                            }
//                            cursor_sales.close();
//
//
//                            TextView total_credit = (TextView) findViewById(R.id.credit_value);
//
//                            Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
//                            if (cursor_credit.moveToFirst()){
//                                float dsirsq = cursor_credit.getFloat(0);
//                                String rop = String.format("%.1f", dsirsq);
//                                total_credit.setText(rop);
//                            }
//                            cursor_credit.close();
//
//
//                            RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
//                            RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
//                            RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);
//
//                            TextView refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
//                            TextView charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
//                            TextView deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);
//
//                            Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (cursor_refunds_tot_val.moveToFirst()){
//                                refunds_tot.setVisibility(View.VISIBLE);
//                                float dsirsq = cursor_refunds_tot_val.getFloat(0);
//                                String rop = String.format("%.1f", dsirsq);
//                                refunds_tot_val.setText(rop);
//                            }else {
//                                refunds_tot.setVisibility(View.GONE);
//                            }
//                            cursor_refunds_tot_val.close();
//
//                            Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (cursor_charges_tot_val.moveToFirst()){
//                                charges_tot.setVisibility(View.VISIBLE);
//                                float dsirsq = cursor_charges_tot_val.getFloat(0);
//                                String rop = String.format("%.1f", dsirsq);
//                                charges_tot_val.setText(rop);
//                            }else {
//                                charges_tot.setVisibility(View.GONE);
//                            }
//                            cursor_charges_tot_val.close();
//
//                            Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (cursor_deposits_tot_val.moveToFirst()){
//                                deposits_tot.setVisibility(View.VISIBLE);
//                                float dsirsq = cursor_deposits_tot_val.getFloat(0);
//                                String rop = String.format("%.1f", dsirsq);
//                                deposits_tot_val.setText(rop);
//                            }else {
//                                deposits_tot.setVisibility(View.GONE);
//                            }
//                            cursor_deposits_tot_val.close();


//                            ListView listView = (ListView) findViewById(R.id.listView);
//
////                                                    Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
////                                                    String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
////                                                    // the XML defined views which the data will be bound to
////                                                    int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
////                                                    Log.e("Checamos que hay id", String.valueOf(R.id.name));
////                                                    Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
////                                                    listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error
//
//                            Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
//                            String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                            // the XML defined views which the data will be bound to
//                            int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                            Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                            final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
//                            listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error
//
//                            Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (sales_t.moveToFirst()){
//                                dsirsq1 = sales_t.getFloat(0);
//                            }
//                            sales_t.close();
//
//                            Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (credit_t.moveToFirst()){
//                                dsirsq2 = credit_t.getFloat(0);
//                            }
//                            credit_t.close();
//
//                            Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (deposi_t.moveToFirst()){
//                                dsirsq3 = deposi_t.getFloat(0);
//                            }
//                            deposi_t.close();
//
//                            Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (cashout_t.moveToFirst()){
//                                dsirsq4 = cashout_t.getFloat(0);
//                            }
//                            cashout_t.close();
//
//                            Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                            if (write_off_t.moveToFirst()){
//                                dsirsq5 = write_off_t.getFloat(0);
//                            }
//                            write_off_t.close();
//
//                            final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;
//
//                            TextView total_balance = (TextView) findViewById(R.id.total_balance);
//                            total_balance.setText(String.format("%.1f", cal_sale));
//
//                            Cursor vb = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date1 IS NOT NULL", null);
//                            if (vb.moveToFirst()){
//                                name_name = vb.getString(1);
//                                date_first = vb.getString(7);
//                                date_first_hide = vb.getString(9);
////                                                        Toast.makeText(Customer_Info_Activity.this, "1 "+date_first, Toast.LENGTH_SHORT).show();
//                            }else {
////                                                        Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
//                            }
//                            vb.close();
//
//                            date1 = (TextView) findViewById(R.id.date1_visible);
//                            date1.setText(date_first);
//
//                            date2 = (TextView) findViewById(R.id.date2_visible);
//                            Cursor cd = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date1 IS NOT NULL", null);
//                            int coud = cd.getCount();
//                            if (coud>0){
//                                date2.setVisibility(View.VISIBLE);
//                                date2.setText(currentDateandTime2);
////                                                        Toast.makeText(Customer_Info_Activity.this, "3 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
//                            }else {
////                                                        Toast.makeText(Customer_Info_Activity.this, "4 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
//                                date2.setVisibility(View.GONE);
//                            }
                        }else {
                            pin_layout.setError("Incorrect pin");
                        }

                    }

                }else {
                    SimpleDateFormat sdf2 = new SimpleDateFormat("yyyy MM dd");
                    final String currentDateandTime1 = sdf2.format(new Date());

                    SimpleDateFormat sdf3 = new SimpleDateFormat("dd MMM yyyy");
                    currentDateandTime2 = sdf3.format(new Date());

                    Date dt = new Date();
                    SimpleDateFormat sdf1 = new SimpleDateFormat("hh:mm:ss aa");
                    final String time1 = sdf1.format(dt);

                    ContentValues contentValues = new ContentValues();
                    contentValues.put("name", cust_name.getText().toString());
                    contentValues.put("phoneno", pho_num.getText().toString());
                    contentValues.put("emailid", ema_add.getText().toString());
                    contentValues.put("address", add_r.getText().toString());
                    contentValues.put("pincode", pinc_r.getText().toString());
                    contentValues.put("deposit", deposit_value.getText().toString());
                    contentValues.put("total_amount", "0");
                    contentValues.put("cashout", "0");
                    contentValues.put("credit", "0");
                    contentValues.put("write_off", "0");
                    contentValues.put("charges", "0");
                    contentValues.put("refunds", "0");
                    contentValues.put("date1", currentDateandTime2);
                    contentValues.put("time1", time1);
                    contentValues.put("date", currentDateandTime1);
                    contentValues.put("notes", deposit_notes.getText().toString());
                    Cursor c_tax = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                    if (c_tax.moveToLast()){
                        String tax1 = c_tax.getString(38);
                        String tax2 = c_tax.getString(39);
                        String tax3 = c_tax.getString(40);
                        String tax4 = c_tax.getString(41);
                        String tax5 = c_tax.getString(42);
                        String tax6 = c_tax.getString(43);
                        String tax7 = c_tax.getString(44);
                        String tax8 = c_tax.getString(45);
                        String tax9 = c_tax.getString(46);
                        String tax10 = c_tax.getString(47);
                        String tax11 = c_tax.getString(48);
                        String tax12 = c_tax.getString(49);
                        String tax13 = c_tax.getString(50);
                        String tax14 = c_tax.getString(51);
                        String tax15 = c_tax.getString(52);
                        String tax_sele = c_tax.getString(53);
                        String tax1_value = c_tax.getString(54);
                        String tax2_value = c_tax.getString(55);
                        String tax3_value = c_tax.getString(56);
                        String tax4_value = c_tax.getString(57);
                        String tax5_value = c_tax.getString(58);
                        String tax6_value = c_tax.getString(59);
                        String tax7_value = c_tax.getString(60);
                        String tax8_value = c_tax.getString(61);
                        String tax9_value = c_tax.getString(62);
                        String tax10_value = c_tax.getString(63);
                        String tax11_value = c_tax.getString(64);
                        String tax12_value = c_tax.getString(65);
                        String tax13_value = c_tax.getString(66);
                        String tax14_value = c_tax.getString(67);
                        String tax15_value = c_tax.getString(68);

                        String proc = c_tax.getString(69);
                        String lim_st = c_tax.getString(80);
                        String lim_val = c_tax.getString(81);
                        String lim_pre_val = c_tax.getString(82);

                        contentValues.put("tax1", tax1);
                        contentValues.put("tax2", tax2);
                        contentValues.put("tax3", tax3);
                        contentValues.put("tax4", tax4);
                        contentValues.put("tax5", tax5);
                        contentValues.put("tax6", tax6);
                        contentValues.put("tax7", tax7);
                        contentValues.put("tax8", tax8);
                        contentValues.put("tax9", tax9);
                        contentValues.put("tax10", tax10);
                        contentValues.put("tax11", tax11);
                        contentValues.put("tax12", tax12);
                        contentValues.put("tax13", tax13);
                        contentValues.put("tax14", tax14);
                        contentValues.put("tax15", tax15);
                        contentValues.put("tax_selection", tax_sele);
                        contentValues.put("tax1_value", tax1_value);
                        contentValues.put("tax2_value", tax2_value);
                        contentValues.put("tax3_value", tax3_value);
                        contentValues.put("tax4_value", tax4_value);
                        contentValues.put("tax5_value", tax5_value);
                        contentValues.put("tax6_value", tax6_value);
                        contentValues.put("tax7_value", tax7_value);
                        contentValues.put("tax8_value", tax8_value);
                        contentValues.put("tax9_value", tax9_value);
                        contentValues.put("tax10_value", tax10_value);
                        contentValues.put("tax11_value", tax11_value);
                        contentValues.put("tax12_value", tax12_value);
                        contentValues.put("tax13_value", tax13_value);
                        contentValues.put("tax14_value", tax14_value);
                        contentValues.put("tax15_value", tax15_value);

                        contentValues.put("proceedings", proc);
                        contentValues.put("limit_status", lim_st);
                        contentValues.put("limit_value", lim_val);
                        contentValues.put("limit_present_value", lim_pre_val);
                    }
                    c_tax.close();

                    contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                    resultUri = getContentResolver().insert(contentUri, contentValues);
                    getContentResolver().notifyChange(resultUri, null);


                    //                   db.insert("Customerdetails", null, contentValues);
                    dialog.dismiss();
                    dialog_deposit.dismiss();


//                    Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
//                    if (cursor1.moveToFirst()) {
//                        String pin5 = cursor1.getString(15);
//                        String dob = cursor1.getString(17);
//                        String cre_def = cursor1.getString(21);
//                        String pin_statu = cursor1.getString(25);
//                        String dob_alarm = cursor1.getString(26);
//                        String dis_sta = cursor1.getString(27);
//                        String dis_amou = cursor1.getString(28);
//                        String dis_val = cursor1.getString(29);
//                        String dis_typ = cursor1.getString(30);
//                        String usr_id = cursor1.getString(37);
//                        Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
//                        if (cursor11.moveToFirst()){
//                            do {
//                                String id = cursor11.getString(0);
//                                ContentValues contentValues5 = new ContentValues();
//                                contentValues5.put("authentication_pin", pin5);
//                                contentValues5.put("dob", dob);
//                                contentValues5.put("user_id", usr_id);
//                                contentValues5.put("credit_default", cre_def);
//                                contentValues5.put("authentication_pin_status", pin_statu);
//                                contentValues5.put("dob_alaram", dob_alarm);
//                                contentValues5.put("default_discount_status", dis_sta);
//                                contentValues5.put("default_discount_amount", dis_amou);
//                                contentValues5.put("default_discount_value", dis_val);
//                                contentValues5.put("default_discount_type", dis_typ);
//                                String where = "_id = '" + id + "'";
//
//                                contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
//                                getContentResolver().update(contentUri, contentValues5,where,new String[]{});
//                                resultUri = new Uri.Builder()
//                                        .scheme("content")
//                                        .authority(StubProvider.AUTHORITY)
//                                        .path("Customerdetails")
//                                        .appendQueryParameter("operation", "update")
//                                        .appendQueryParameter("_id",id)
//                                        .build();
//                                getContentResolver().notifyChange(resultUri, null);
//
//                                Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
//                                if (set21w.moveToFirst()){
//                                    dis_val = set21w.getString(29);
//                                    dis_status = set21w.getString(27);
//                                    dis_ty = set21w.getString(30);
//
//                                    TextView one = new TextView(Customer_Info_Activity.this);
//                                    one.setText(dis_val);
//
//                                    TextView two = new TextView(Customer_Info_Activity.this);
//                                    two.setText(dis_ty);
//
//                                    if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
//                                        disc_val_def.setText("0");
//                                    }else {
//                                        disc_val_def.setText(dis_val);
//                                    }
//                                    if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
//                                        disc_per_def.setText("%");
//                                    }else {
//                                        disc_per_def.setText(dis_ty);
//                                    }
//
//
//                                }
//                                set21w.close();
//
//                                //          db.update("Customerdetails", contentValues5, where, new String[]{});
//                            }while (cursor11.moveToNext());
//                        }
//                        cursor11.close();
//
//                    }
//                    cursor1.close();
//
//                    Cursor return_items = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
//                    if (return_items.moveToFirst()){
//                        do {
//                            String id = return_items.getString(0);
//                            String pre_qu = return_items.getString(3);
//                            String add = return_items.getString(18);
//
//                            float a = Float.parseFloat(pre_qu) + Float.parseFloat(add);
//
//                            ContentValues con = new ContentValues();
//                            con.put("stockquan", String.valueOf(a));
//                            String where = "_id = '" + id + "'";
//                            //      db1.update("Items", con, where, new String[]{});
//
//                            String where1_v1 = "docid = '" + id + "'";
//                            db1.update("Items_Virtual", con, where1_v1, new String[]{});
//
//                            contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
//                            getContentResolver().update(contentUri, con,where,new String[]{});
//                            resultUri = new Uri.Builder()
//                                    .scheme("content")
//                                    .authority(StubProviderApp.AUTHORITY)
//                                    .path("Items")
//                                    .appendQueryParameter("operation", "update")
//                                    .appendQueryParameter("_id",id)
//                                    .build();
//                            getContentResolver().notifyChange(resultUri, null);
//
//
//                            //                 db1.update("Items", con, where, new String[]{});
//                        }while (return_items.moveToNext());
//                    }
//                    return_items.close();
//
//                    TextView total_sales = (TextView) findViewById(R.id.sale_value);
//
//                    Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
//                    if (cursor_sales.moveToFirst()){
//                        float dsirsq = cursor_sales.getFloat(0);
//                        String rop = String.format("%.1f", dsirsq);
//                        total_sales.setText(rop);
//                    }
//                    cursor_sales.close();
//
//
//                    TextView total_credit = (TextView) findViewById(R.id.credit_value);
//
//                    Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
//                    if (cursor_credit.moveToFirst()){
//                        float dsirsq = cursor_credit.getFloat(0);
//                        String rop = String.format("%.1f", dsirsq);
//                        total_credit.setText(rop);
//                    }
//                    cursor_credit.close();
//
//
//                    RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
//                    RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
//                    RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);
//
//                    TextView refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
//                    TextView charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
//                    TextView deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);
//
//                    Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (cursor_refunds_tot_val.moveToFirst()){
//                        refunds_tot.setVisibility(View.VISIBLE);
//                        float dsirsq = cursor_refunds_tot_val.getFloat(0);
//                        String rop = String.format("%.1f", dsirsq);
//                        refunds_tot_val.setText(rop);
//                    }else {
//                        refunds_tot.setVisibility(View.GONE);
//                    }
//                    cursor_refunds_tot_val.close();
//
//                    Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (cursor_charges_tot_val.moveToFirst()){
//                        charges_tot.setVisibility(View.VISIBLE);
//                        float dsirsq = cursor_charges_tot_val.getFloat(0);
//                        String rop = String.format("%.1f", dsirsq);
//                        charges_tot_val.setText(rop);
//                    }else {
//                        charges_tot.setVisibility(View.GONE);
//                    }
//                    cursor_charges_tot_val.close();
//
//                    Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (cursor_deposits_tot_val.moveToFirst()){
//                        deposits_tot.setVisibility(View.VISIBLE);
//                        float dsirsq = cursor_deposits_tot_val.getFloat(0);
//                        String rop = String.format("%.1f", dsirsq);
//                        deposits_tot_val.setText(rop);
//                    }else {
//                        deposits_tot.setVisibility(View.GONE);
//                    }
//                    cursor_deposits_tot_val.close();


//                    ListView listView = (ListView) findViewById(R.id.listView);
//
////                                            Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
////                                            String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
////                                            // the XML defined views which the data will be bound to
////                                            int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
////                                            Log.e("Checamos que hay id", String.valueOf(R.id.name));
////                                            Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
////                                            listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error
//
//                    final Cursor cursor_country1 = db1.rawQuery("SELECT * FROM Country_Selection", null);
//                    if (cursor_country1.moveToFirst()){
//                        str_country = cursor_country1.getString(1);
//                    }
//                    Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
//                    String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                    // the XML defined views which the data will be bound to
//                    int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                    Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                    final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
////                                                                listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error
//                    dataAdapterr.setViewBinder(new SimpleCursorAdapter.ViewBinder() {
//                        @Override
//                        public boolean setViewValue(View view, Cursor cursor, int columnIndex) {
//                            if (view.getId() == R.id.rs_sale1 || view.getId() == R.id.rs_credit1 || view.getId() == R.id.rs_refunds_val || view.getId() == R.id.rs_charges_val || view.getId() == R.id.rs_deposits_val || view.getId() == R.id.rs_cashout_val) {
//                                final String tadl_id = cursor_country1.getString(cursor_country1.getColumnIndex("country"));
//                                TextView dateTextView = (TextView) view;
//                                if (tadl_id.toString().equals("India") || tadl_id.toString().equals("Rupee")){
//                                    dateTextView.setText(insert1_cc);
//                                }else {
//                                    dateTextView.setText(insert1_cc);
//                                }
//                                return true;
//                            }
//                            return false;
//                        }
//                    });
//                    listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error
//
//                    Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (sales_t.moveToFirst()){
//                        dsirsq1 = sales_t.getFloat(0);
//                    }
//                    sales_t.close();
//
//                    Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (credit_t.moveToFirst()){
//                        dsirsq2 = credit_t.getFloat(0);
//                    }
//                    credit_t.close();
//
//                    Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (deposi_t.moveToFirst()){
//                        dsirsq3 = deposi_t.getFloat(0);
//                    }
//                    deposi_t.close();
//
//                    Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (cashout_t.moveToFirst()){
//                        dsirsq4 = cashout_t.getFloat(0);
//                    }
//                    cashout_t.close();
//
//                    Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
//                    if (write_off_t.moveToFirst()){
//                        dsirsq5 = write_off_t.getFloat(0);
//                    }
//                    write_off_t.close();
//
//                    final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;
//
//                    TextView total_balance = (TextView) findViewById(R.id.total_balance);
//                    total_balance.setText(String.format("%.1f", cal_sale));
//
//                    Cursor vb = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date1 IS NOT NULL", null);
//                    if (vb.moveToFirst()){
//                        name_name = vb.getString(1);
//                        date_first = vb.getString(7);
//                        date_first_hide = vb.getString(9);
////                                                Toast.makeText(Customer_Info_Activity.this, "1 "+date_first, Toast.LENGTH_SHORT).show();
//                    }else {
////                                                Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
//                    }
//                    vb.close();
//
//                    date1 = (TextView) findViewById(R.id.date1_visible);
//                    date1.setText(date_first);
//
//                    date2 = (TextView) findViewById(R.id.date2_visible);
//                    Cursor cd = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date1 IS NOT NULL", null);
//                    int coud = cd.getCount();
//                    if (coud>0){
//                        date2.setVisibility(View.VISIBLE);
//                        date2.setText(currentDateandTime2);
////                                                Toast.makeText(Customer_Info_Activity.this, "3 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
//                    }else {
////                                                Toast.makeText(Customer_Info_Activity.this, "4 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
//                        date2.setVisibility(View.GONE);
//                    }
//
//                    Cursor c2 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
//                    if (c2.moveToLast()) {
//                        String id = c2.getString(0);
//                        String lim_pre_val = c2.getString(82);
//                        String lim_val = c2.getString(81);
//
//                        TextView v1 = new TextView(Customer_Info_Activity.this);
//                        v1.setText(lim_pre_val);
//
//                        TextView v2 = new TextView(Customer_Info_Activity.this);
//                        v2.setText(lim_val);
//
//                        if (v1.getText().toString().equals("") || v2.getText().toString().equals("")) {
//
//                        }else {
//                            float nw = Float.parseFloat(lim_val) - Float.parseFloat(total_balance.getText().toString());
//                            ContentValues contentValues5 = new ContentValues();
//                            contentValues5.put("limit_present_value", String.format("%.2f", nw));
//
//                            String where = "_id = '" + id + "'";
//
//                            contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
//                            getContentResolver().update(contentUri, contentValues5,where,new String[]{});
//                            resultUri = new Uri.Builder()
//                                    .scheme("content")
//                                    .authority(StubProvider.AUTHORITY)
//                                    .path("Customerdetails")
//                                    .appendQueryParameter("operation", "update")
//                                    .appendQueryParameter("_id",id)
//                                    .build();
//                            getContentResolver().notifyChange(resultUri, null);
//                        }
//                    }
//                    c2.close();

                }
            }
            pin.close();

            return null;
        }

        // Show Progress bar before downloading Music
        @Override
        protected void onPreExecute() {
            super.onPreExecute();
            // Shows Progress Bar Dialog and then call doInBackground method
            //showDialog(progress_bar_type);

            dialog_1.setMessage("Loading");
            dialog_1.setCanceledOnTouchOutside(false);
            dialog_1.setCancelable(false);

            dialog_1.setMax(1000);
            //Set the current progress to zero
            dialog_1.setProgress(0);
            dialog_1.show();
        }


        @Override
        protected void onPostExecute(Void result) {

            Cursor cursor1 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
            if (cursor1.moveToFirst()) {
                String pin5 = cursor1.getString(15);
                String dob = cursor1.getString(17);
                String cre_def = cursor1.getString(21);
                String pin_statu = cursor1.getString(25);
                String dob_alarm = cursor1.getString(26);
                String dis_sta = cursor1.getString(27);
                String dis_amou = cursor1.getString(28);
                String dis_val = cursor1.getString(29);
                String dis_typ = cursor1.getString(30);
                String usr_id = cursor1.getString(37);
                Cursor cursor11 = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '" + pho_num.getText().toString() + "'", null);
                if (cursor11.moveToFirst()){
                    do {
                        String id = cursor11.getString(0);
                        ContentValues contentValues5 = new ContentValues();
                        contentValues5.put("authentication_pin", pin5);
                        contentValues5.put("dob", dob);
                        contentValues5.put("user_id", usr_id);
                        contentValues5.put("credit_default", cre_def);
                        contentValues5.put("authentication_pin_status", pin_statu);
                        contentValues5.put("dob_alaram", dob_alarm);
                        contentValues5.put("default_discount_status", dis_sta);
                        contentValues5.put("default_discount_amount", dis_amou);
                        contentValues5.put("default_discount_value", dis_val);
                        contentValues5.put("default_discount_type", dis_typ);
                        String where = "_id = '" + id + "'";

                        contentUri = Uri.withAppendedPath(StubProvider.CONTENT_URI, "Customerdetails");
                        getContentResolver().update(contentUri, contentValues5,where,new String[]{});
                        resultUri = new Uri.Builder()
                                .scheme("content")
                                .authority(StubProvider.AUTHORITY)
                                .path("Customerdetails")
                                .appendQueryParameter("operation", "update")
                                .appendQueryParameter("_id",id)
                                .build();
                        getContentResolver().notifyChange(resultUri, null);

                        Cursor set21w = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+name+"'", null);
                        if (set21w.moveToFirst()){
                            dis_val = set21w.getString(29);
                            dis_status = set21w.getString(27);
                            dis_ty = set21w.getString(30);

                            TextView one = new TextView(Customer_Info_Activity.this);
                            one.setText(dis_val);

                            TextView two = new TextView(Customer_Info_Activity.this);
                            two.setText(dis_ty);

                            if (one.getText().toString().equals("") || one.getText().toString().equals("0")) {
                                disc_val_def.setText("0");
                            }else {
                                disc_val_def.setText(dis_val);
                            }
                            if (two.getText().toString().equals("") || two.getText().toString().equals("0")) {
                                disc_per_def.setText("%");
                            }else {
                                disc_per_def.setText(dis_ty);
                            }


                        }
                        set21w.close();

                        //          db.update("Customerdetails", contentValues5, where, new String[]{});
                    }while (cursor11.moveToNext());
                }
                cursor11.close();

            }
            cursor1.close();

            Cursor return_items = db1.rawQuery("SELECT * FROM Items WHERE checked = 'checked'", null);
            if (return_items.moveToFirst()){
                do {
                    String id = return_items.getString(0);
                    String pre_qu = return_items.getString(3);
                    String add = return_items.getString(18);

                    float a = Float.parseFloat(pre_qu) + Float.parseFloat(add);

                    ContentValues con = new ContentValues();
                    con.put("stockquan", String.valueOf(a));
                    String where = "_id = '" + id + "'";
                    //      db1.update("Items", con, where, new String[]{});

                    String where1_v1 = "docid = '" + id + "'";
                    db1.update("Items_Virtual", con, where1_v1, new String[]{});

                    contentUri = Uri.withAppendedPath(StubProviderApp.CONTENT_URI, "Items");
                    getContentResolver().update(contentUri, con,where,new String[]{});
                    resultUri = new Uri.Builder()
                            .scheme("content")
                            .authority(StubProviderApp.AUTHORITY)
                            .path("Items")
                            .appendQueryParameter("operation", "update")
                            .appendQueryParameter("_id",id)
                            .build();
                    getContentResolver().notifyChange(resultUri, null);


                    //                 db1.update("Items", con, where, new String[]{});
                }while (return_items.moveToNext());
            }
            return_items.close();

            TextView total_sales = (TextView) findViewById(R.id.sale_value);

            Cursor cursor_sales = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
            if (cursor_sales.moveToFirst()){
                float dsirsq = cursor_sales.getFloat(0);
                String rop = String.format("%.1f", dsirsq);
                total_sales.setText(rop);
            }
            cursor_sales.close();


            TextView total_credit = (TextView) findViewById(R.id.credit_value);

            Cursor cursor_credit = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"' ", null);
            if (cursor_credit.moveToFirst()){
                float dsirsq = cursor_credit.getFloat(0);
                String rop = String.format("%.1f", dsirsq);
                total_credit.setText(rop);
            }
            cursor_credit.close();


            RelativeLayout refunds_tot = (RelativeLayout) findViewById(R.id.refunds_tot);
            RelativeLayout charges_tot = (RelativeLayout) findViewById(R.id.charges_tot);
            RelativeLayout deposits_tot = (RelativeLayout) findViewById(R.id.deposits_tot);

            TextView refunds_tot_val = (TextView) findViewById(R.id.refunds_tot_val);
            TextView charges_tot_val = (TextView) findViewById(R.id.charges_tot_val);
            TextView deposits_tot_val = (TextView) findViewById(R.id.deposits_tot_val);

            Cursor cursor_refunds_tot_val = db.rawQuery("SELECT SUM(refunds) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (cursor_refunds_tot_val.moveToFirst()){
                refunds_tot.setVisibility(View.VISIBLE);
                float dsirsq = cursor_refunds_tot_val.getFloat(0);
                String rop = String.format("%.1f", dsirsq);
                refunds_tot_val.setText(rop);
            }else {
                refunds_tot.setVisibility(View.GONE);
            }
            cursor_refunds_tot_val.close();

            Cursor cursor_charges_tot_val = db.rawQuery("SELECT SUM(charges) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (cursor_charges_tot_val.moveToFirst()){
                charges_tot.setVisibility(View.VISIBLE);
                float dsirsq = cursor_charges_tot_val.getFloat(0);
                String rop = String.format("%.1f", dsirsq);
                charges_tot_val.setText(rop);
            }else {
                charges_tot.setVisibility(View.GONE);
            }
            cursor_charges_tot_val.close();

            Cursor cursor_deposits_tot_val = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (cursor_deposits_tot_val.moveToFirst()){
                deposits_tot.setVisibility(View.VISIBLE);
                float dsirsq = cursor_deposits_tot_val.getFloat(0);
                String rop = String.format("%.1f", dsirsq);
                deposits_tot_val.setText(rop);
            }else {
                deposits_tot.setVisibility(View.GONE);
            }
            cursor_deposits_tot_val.close();

            ListView listView = (ListView) findViewById(R.id.listView);

//                                                    Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
//                                                    String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
//                                                    // the XML defined views which the data will be bound to
//                                                    int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_cashout_val};
//                                                    Log.e("Checamos que hay id", String.valueOf(R.id.name));
//                                                    Customer_ListviewAdapter dataAdapterr = new Customer_ListviewAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID);
//                                                    listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

            Cursor cursorli = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'  ORDER BY _id DESC", null);
            String[] fromFieldNames = {"date1", "time1", "billnumber", "refunds", "total_amount", "deposit", "cashout", "credit", "write_off", "charges", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type", "cashout_type"};;
            // the XML defined views which the data will be bound to
            int[] toViewsID = {R.id.date1, R.id.time1, R.id.bill_no, R.id.refunds_val, R.id.sale1, R.id.deposits_val, R.id.cashout_val, R.id.credit1, R.id.write_off_val, R.id.charges_val, R.id.m_text, R.id.rs_sale1, R.id.rs_credit1, R.id.rs_refunds_val, R.id.rs_charges_val, R.id.rs_deposits_val, R.id.rs_write_off_val, R.id.rs_cashout_val};
            Log.e("Checamos que hay id", String.valueOf(R.id.name));
            final SimpleCursorAdapter dataAdapterr = new SimpleCursorAdapter(Customer_Info_Activity.this, R.layout.dialog_customer_management_listview, cursorli, fromFieldNames, toViewsID, 0);
            listView.setAdapter(dataAdapterr);// Assign adapter to ListView.... here... the bitch error

            Cursor sales_t = db.rawQuery("SELECT SUM(total_amount) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (sales_t.moveToFirst()){
                dsirsq1 = sales_t.getFloat(0);
            }
            sales_t.close();

            Cursor credit_t = db.rawQuery("SELECT SUM(credit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (credit_t.moveToFirst()){
                dsirsq2 = credit_t.getFloat(0);
            }
            credit_t.close();

            Cursor deposi_t = db.rawQuery("SELECT SUM(deposit) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (deposi_t.moveToFirst()){
                dsirsq3 = deposi_t.getFloat(0);
            }
            deposi_t.close();

            Cursor cashout_t = db.rawQuery("SELECT SUM(cashout) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (cashout_t.moveToFirst()){
                dsirsq4 = cashout_t.getFloat(0);
            }
            cashout_t.close();

            Cursor write_off_t = db.rawQuery("SELECT SUM(write_off) FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date >= '"+date1_hide.getText().toString()+"' AND date <='"+date2_hide.getText().toString()+"'", null);
            if (write_off_t.moveToFirst()){
                dsirsq5 = write_off_t.getFloat(0);
            }
            write_off_t.close();

            final float cal_sale = ((dsirsq4 + dsirsq2) - dsirsq3) - dsirsq5;

            TextView total_balance = (TextView) findViewById(R.id.total_balance);
            total_balance.setText(String.format("%.1f", cal_sale));

            Cursor vb = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date1 IS NOT NULL", null);
            if (vb.moveToFirst()){
                name_name = vb.getString(1);
                date_first = vb.getString(7);
                date_first_hide = vb.getString(9);
//                                                        Toast.makeText(Customer_Info_Activity.this, "1 "+date_first, Toast.LENGTH_SHORT).show();
            }else {
//                                                        Toast.makeText(Customer_Info_Activity.this, "2", Toast.LENGTH_SHORT).show();
            }
            vb.close();

            date1 = (TextView) findViewById(R.id.date1_visible);
            date1.setText(date_first);

            date2 = (TextView) findViewById(R.id.date2_visible);
            Cursor cd = db.rawQuery("SELECT * FROM Customerdetails WHERE phoneno = '"+pho_num.getText().toString()+"' AND date1 IS NOT NULL", null);
            int coud = cd.getCount();
            if (coud>0){
                date2.setVisibility(View.VISIBLE);
                date2.setText(currentDateandTime2);
//                                                        Toast.makeText(Customer_Info_Activity.this, "3 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
            }else {
//                                                        Toast.makeText(Customer_Info_Activity.this, "4 "+currentDateandTime2, Toast.LENGTH_SHORT).show();
                date2.setVisibility(View.GONE);
            }

            dialog_1.dismiss();
        }

    }

    public void remaining_msgs1(final String bn){

        SharedPreferences sharedpreferences =  getDefaultSharedPreferencesMultiProcess(Customer_Info_Activity.this);
        final String company= sharedpreferences.getString("companyname", null);
        final String store= sharedpreferences.getString("storename", null);
        final String device= sharedpreferences.getString("devicename", null);

//        SharedPreferences pref = getApplicationContext().getSharedPreferences(Config.SHARED_PREF, 0);
//        final String regId = pref.getString("regId", null);
        RequestQueue requestQueue;
        requestQueue = Volley.newRequestQueue(Customer_Info_Activity.this);
        StringRequest sr = new StringRequest(
                Request.Method.POST,
                WebserviceUrl+"remaining_msg.php",
                new Response.Listener<String>() {
                    @Override
                    public void onResponse(String response) {
                        if(response.equalsIgnoreCase("success")) {

                        }
                    }
                },
                new Response.ErrorListener() {
                    @Override
                    public void onErrorResponse(VolleyError error) {
                        Log.d("Signup confirm", "Error: " + error.getMessage());
                    }
                }) {
            @Override
            protected Map<String, String> getParams()
            {
                Map<String,String> params = new HashMap<String, String>();
                params.put("company", company+ "");
                params.put("store", store+ "");
                params.put("device", device);
                params.put("msg",bn);
                return params;
            }
        };
        sr.setRetryPolicy(new DefaultRetryPolicy(DefaultRetryPolicy.DEFAULT_TIMEOUT_MS,
                DefaultRetryPolicy.DEFAULT_MAX_RETRIES,
                DefaultRetryPolicy.DEFAULT_BACKOFF_MULT));
        requestQueue.add(sr);

    }

    @Override
    public void onStart() {
        super.onStart();

        String printer_type="";
        Cursor aallrows = db1.rawQuery("SELECT * FROM Printer_type WHERE _id = '1'", null);
        if (aallrows.moveToFirst()) {
            do {
                printer_type = aallrows.getString(1);

            } while (aallrows.moveToNext());
        }
        aallrows.close();

        if(printer_type.equalsIgnoreCase("wiseposplus")){
            doBindMswipeWisepadDeviceService();
        }

    }

    @Override
    protected void onStop() {
        super.onStop();

        String printer_type="";
        Cursor aallrows = db1.rawQuery("SELECT * FROM Printer_type WHERE _id = '1'", null);
        if (aallrows.moveToFirst()) {
            do {
                printer_type = aallrows.getString(1);

            } while (aallrows.moveToNext());
        }
        aallrows.close();

        if(printer_type.equalsIgnoreCase("wiseposplus")){
            doUnbindMswipeWisepadDeviceService();
        }


    }

    void doBindMswipeWisepadDeviceService()
    {
        bindService(new Intent(this, MSWisepadDeviceController.class), mMSWisepadDeviceControllerService, Context.BIND_AUTO_CREATE);
    }


    public void doUnbindMswipeWisepadDeviceService()
    {

        if (ApplicationData.IS_DEBUGGING_ON)
            Logs.v(ApplicationData.packName,  "wisePadConnection ", true, true);

        unbindService(mMSWisepadDeviceControllerService);

    }

    private ServiceConnection mMSWisepadDeviceControllerService = new ServiceConnection()
    {
        public void onServiceConnected(ComponentName className, IBinder service)
        {
            try
            {
                MSWisepadDeviceController.LocalBinder localBinder = (MSWisepadDeviceController.LocalBinder) service;
                mMSWisepadDeviceController = localBinder.getService();

                if(mMSWisepadDeviceController != null) {

                    mMSWisepadDeviceController.initMswipeWisepadDeviceController(new Customer_Info_Activity.MSWisepadDeviceObserver(),
                            true, false, false,
                            false, null);

                }
            }
            catch (Exception e) {

                if (ApplicationData.IS_DEBUGGING_ON)
                    Logs.v(ApplicationData.packName, "exception."+e.toString(), true, true);
            }
        }

        public void onServiceDisconnected(ComponentName className)
        {
            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName, "Wisepad servcie un-binded and wisepad is disconnected...", true, true);
            /**
             * This is called when the connection with the service has been
             * unexpectedly disconnected - process crashed.
             *
             */

            mMSWisepadDeviceController = null;

        }
    };


    class MSWisepadDeviceObserver implements MSWisepadDeviceControllerResponseListener
    {

        @Override
        public void onReturnWisepadConnection(WisePadConnection wisePadConntection, BluetoothDevice bluetoothDevice) {

            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName,  "wisePadConntection " + wisePadConntection, true, true);

            String msg = getString(R.string.unknown);

            if(wisePadConntection == WisePadConnection.WisePadConnection_CONNECTED)
            {
                msg = getString(R.string.device_connected);
            }
            else if(wisePadConntection == WisePadConnection.WisePadConnection_CONNECTING){

                msg = getString(R.string.device_connecting);
            }
            else if(wisePadConntection == WisePadConnection.WisePadConnection_NOT_CONNECTED){

                msg = getString(R.string.device_not_connected);
            }
            else if(wisePadConntection == WisePadConnection.WisePadConnection_DIS_CONNECTED){

                msg = getString(R.string.device_disconnected);
            }

            //mTXTStatus.setText(msg);

        }

        @Override
        public void onRequestWisePadCheckCardProcess(CheckCardProcess checkCardProcess, ArrayList<String> dataList) {

        }

        @Override
        public void onReturnWisePadOfflineCardTransactionResults(CheckCardProcessResults checkCardResults, Hashtable<String, Object> paramHashtable) {

        }

        @Override
        public void onError(Error error, String errorMsg) {

            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName,  "error " + error, true, true);

        }

        @Override
        public void onRequestDisplayWispadStatusInfo(DisplayText msg) {

        }

        @Override
        public void onReturnDeviceInfo(Hashtable<String, String> paramHashtable) {

        }

        @Override
        public void onReturnFunctionKeyResult(FunctionKeyResult keyType) {

        }

        @Override
        public void onReturnWispadNetwrokSettingInfo(WispadNetwrokSetting wispadNetwrokSetting, boolean status, Hashtable<String, Object> netwrokSettingInfo) {

        }

        @Override
        public void onReturnNfcDetectCardResult(NfcDetectCardResult nfcDetectCardResult, Hashtable<String, Object> hashtable) {

        }

        @Override
        public void onReturnNfcDataExchangeResult(boolean isSuccess, Hashtable<String, String> data) {

        }

        @Override
        public void onPrintResult(PrintResult printResult) {


            if (ApplicationData.IS_DEBUGGING_ON)
                Logs.v(ApplicationData.packName,  "printResult " + printResult, true, true);

            String msg = getString(R.string.unknown);

            if(printResult == PrintResult.PRINT_SUCCESS)
            {
                msg = getString(R.string.printer_command_success);

            }
            else if(printResult == PrintResult.PRINT_NO_PAPER_OR_COVER_OPENED)
            {
                msg = getString(R.string.no_paper);

            }
            else if(printResult == PrintResult.PRINT_WRONG_PRINTER_COMMAND)
            {
                msg = getString(R.string.printer_command_not_available);

            }
            else if(printResult == PrintResult.PRINT_OVERHEAT)
            {
                msg = getString(R.string.printer_overheat);

            }
            else if(printResult == PrintResult.PRINT_PRINTER_ERROR)
            {
                msg = getString(R.string.printer_command_not_available);

            }

            //mTXTStatus.setText(msg);


        }
    }

}
